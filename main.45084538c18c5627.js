(self.webpackChunkshowcase=self.webpackChunkshowcase||[]).push([[179],{1681:(Bn,kt,j)=>{"use strict";j.d(kt,{a:()=>Ce});var T=j(4080),d=j(4650);function W(Ve,Je){1&Ve&&d.Hsn(0)}const c=["*"];let Ce=(()=>{class Ve{constructor(ye,Me){this.injector=ye,this.appRef=Me}ngAfterViewInit(){const ye=document.querySelector("left"===this.position?"#layout-left-custom-items":"#layout-right-custom-items");if(!ye)throw new Error("LayoutToolbarMenuComponent: No target found");this.portalOutlet=new T.u0(ye,void 0,this.appRef,this.injector),this.portalOutlet.attach(this.portal)}ngOnDestroy(){this.portalOutlet.detach()}}return Ve.\u0275fac=function(ye){return new(ye||Ve)(d.Y36(d.zs3),d.Y36(d.z2F))},Ve.\u0275cmp=d.Xpm({type:Ve,selectors:[["showcase-layout-toolbar-menu"]],viewQuery:function(ye,Me){if(1&ye&&d.Gf(T.ig,5),2&ye){let Ye;d.iGM(Ye=d.CRH())&&(Me.portal=Ye.first)}},inputs:{position:"position"},ngContentSelectors:c,decls:1,vars:0,consts:[["cdk-portal",""]],template:function(ye,Me){1&ye&&(d.F$t(),d.YNc(0,W,1,0,"ng-template",0))},dependencies:[T.bH],encapsulation:2}),Ve})()},7360:(Bn,kt,j)=>{"use strict";j.d(kt,{$:()=>Ve});var T=j(4650),d=j(2510),W=j(3683),c=j(7392),Ce=j(4859);let Ve=(()=>{class Je{}return Je.\u0275fac=function(Me){return new(Me||Je)},Je.\u0275cmp=T.Xpm({type:Je,selectors:[["ng-component"]],decls:16,vars:0,consts:[["color","primary"],["id","layout-left-custom-items"],["mat-button","","routerLink","/"],["svgIcon","ngx-mapbox-gl"],["mat-button","","routerLink","/demo"],["mat-button","","routerLink","/doc"],["id","layout-right-custom-items"],["mat-button","","href","https://github.com/Wykks/ngx-mapbox-gl"],["svgIcon","github"]],template:function(Me,Ye){1&Me&&(T.TgZ(0,"mat-toolbar",0)(1,"div"),T._UZ(2,"div",1),T.TgZ(3,"a",2),T._UZ(4,"mat-icon",3),T._uU(5," ngx-mapbox-gl "),T.qZA(),T.TgZ(6,"a",4),T._uU(7," Demo "),T.qZA(),T.TgZ(8,"a",5),T._uU(9," Documentation "),T.qZA()(),T.TgZ(10,"div"),T._UZ(11,"div",6),T.TgZ(12,"a",7),T._UZ(13,"mat-icon",8),T._uU(14," GitHub "),T.qZA()()(),T._UZ(15,"router-outlet"))},dependencies:[d.lC,d.yS,W.Ye,c.Hw,Ce.zs],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;height:100vh}mat-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 16px 0 0}div[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center}.menu-button[_ngcontent-%COMP%]{height:100%}"]}),Je})()},8445:(Bn,kt,j)=>{"use strict";j.d(kt,{x:()=>ft});var T=j(4080),d=j(6895),W=j(4859),c=j(7392),Ce=j(3683),Ve=j(2510),Me=(j(1681),j(7360),j(4650));let ft=(()=>{class Pe{}return Pe.\u0275fac=function(gt){return new(gt||Pe)},Pe.\u0275mod=Me.oAB({type:Pe}),Pe.\u0275inj=Me.cJS({imports:[d.ez,Ve.Bz,Ce.g0,c.Ps,W.ot,T.eL]}),Pe})()},9121:(Bn,kt,j)=>{"use strict";var T=j(1481),d=j(4650),W=j(2510);let c=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-root"]],decls:1,vars:0,template:function(o,_){1&o&&d._UZ(0,"router-outlet")},dependencies:[W.lC],encapsulation:2}),p})();var Ce=j(7392),Ve=j(7340);function ye(p){return new d.vHH(3e3,!1)}function kn(){return typeof window<"u"&&typeof window.document<"u"}function zn(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function gn(p){switch(p.length){case 0:return new Ve.ZN;case 1:return p[0];default:return new Ve.ZE(p)}}function wi(p,y,o,_,A=new Map,z=new Map){const ue=[],_e=[];let rt=-1,Lt=null;if(_.forEach(ln=>{const un=ln.get("offset"),ei=un==rt,yi=ei&&Lt||new Map;ln.forEach((si,hi)=>{let Fi=hi,Ki=si;if("offset"!==hi)switch(Fi=y.normalizePropertyName(Fi,ue),Ki){case Ve.k1:Ki=A.get(hi);break;case Ve.l3:Ki=z.get(hi);break;default:Ki=y.normalizeStyleValue(hi,Fi,Ki,ue)}yi.set(Fi,Ki)}),ei||_e.push(yi),Lt=yi,rt=un}),ue.length)throw function Cn(p){return new d.vHH(3502,!1)}();return _e}function Ei(p,y,o,_){switch(y){case"start":p.onStart(()=>_(o&&Ii(o,"start",p)));break;case"done":p.onDone(()=>_(o&&Ii(o,"done",p)));break;case"destroy":p.onDestroy(()=>_(o&&Ii(o,"destroy",p)))}}function Ii(p,y,o){const z=or(p.element,p.triggerName,p.fromState,p.toState,y||p.phaseName,o.totalTime??p.totalTime,!!o.disabled),ue=p._data;return null!=ue&&(z._data=ue),z}function or(p,y,o,_,A="",z=0,ue){return{element:p,triggerName:y,fromState:o,toState:_,phaseName:A,totalTime:z,disabled:!!ue}}function Oi(p,y,o){let _=p.get(y);return _||p.set(y,_=o),_}function En(p){const y=p.indexOf(":");return[p.substring(1,y),p.slice(y+1)]}let Wi=(p,y)=>!1,li=(p,y,o)=>[],ct=null;function K(p){const y=p.parentNode||p.host;return y===ct?null:y}(zn()||typeof Element<"u")&&(kn()?(ct=(()=>document.documentElement)(),Wi=(p,y)=>{for(;y;){if(y===p)return!0;y=K(y)}return!1}):Wi=(p,y)=>p.contains(y),li=(p,y,o)=>{if(o)return Array.from(p.querySelectorAll(y));const _=p.querySelector(y);return _?[_]:[]});let dt=null,ze=!1;const We=Wi,ht=li;let _n=(()=>{class p{validateStyleProperty(o){return function he(p){dt||(dt=function de(){return typeof document<"u"?document.body:null}()||{},ze=!!dt.style&&"WebkitAppearance"in dt.style);let y=!0;return dt.style&&!function De(p){return"ebkit"==p.substring(1,6)}(p)&&(y=p in dt.style,!y&&ze&&(y="Webkit"+p.charAt(0).toUpperCase()+p.slice(1)in dt.style)),y}(o)}matchesElement(o,_){return!1}containsElement(o,_){return We(o,_)}getParentElement(o){return K(o)}query(o,_,A){return ht(o,_,A)}computeStyle(o,_,A){return A||""}animate(o,_,A,z,ue,_e=[],rt){return new Ve.ZN(A,z)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})(),An=(()=>{class p{}return p.NOOP=new _n,p})();const mi="ng-enter",zt="ng-leave",mt="ng-trigger",_t=".ng-trigger",Ke="ng-animating",nt=".ng-animating";function Be(p){if("number"==typeof p)return p;const y=p.match(/^(-?[\.\d]+)(m?s)/);return!y||y.length<2?0:Dt(parseFloat(y[1]),y[2])}function Dt(p,y){return"s"===y?1e3*p:p}function ae(p,y,o){return p.hasOwnProperty("duration")?p:function Y(p,y,o){let A,z=0,ue="";if("string"==typeof p){const _e=p.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===_e)return y.push(ye()),{duration:0,delay:0,easing:""};A=Dt(parseFloat(_e[1]),_e[2]);const rt=_e[3];null!=rt&&(z=Dt(parseFloat(rt),_e[4]));const Lt=_e[5];Lt&&(ue=Lt)}else A=p;if(!o){let _e=!1,rt=y.length;A<0&&(y.push(function Me(){return new d.vHH(3100,!1)}()),_e=!0),z<0&&(y.push(function Ye(){return new d.vHH(3101,!1)}()),_e=!0),_e&&y.splice(rt,0,ye())}return{duration:A,delay:z,easing:ue}}(p,y,o)}function le(p,y={}){return Object.keys(p).forEach(o=>{y[o]=p[o]}),y}function Te(p){const y=new Map;return Object.keys(p).forEach(o=>{y.set(o,p[o])}),y}function Mt(p,y=new Map,o){if(o)for(let[_,A]of o)y.set(_,A);for(let[_,A]of p)y.set(_,A);return y}function Ct(p,y,o){return o?y+":"+o+";":""}function lt(p){let y="";for(let o=0;o<p.style.length;o++){const _=p.style.item(o);y+=Ct(0,_,p.style.getPropertyValue(_))}for(const o in p.style)p.style.hasOwnProperty(o)&&!o.startsWith("_")&&(y+=Ct(0,Ri(o),p.style[o]));p.setAttribute("style",y)}function Ot(p,y,o){p.style&&(y.forEach((_,A)=>{const z=ti(A);o&&!o.has(A)&&o.set(A,p.style[z]),p.style[z]=_}),zn()&&lt(p))}function Et(p,y){p.style&&(y.forEach((o,_)=>{const A=ti(_);p.style[A]=""}),zn()&&lt(p))}function en(p){return Array.isArray(p)?1==p.length?p[0]:(0,Ve.vP)(p):p}const Ge=new RegExp("{{\\s*(.+?)\\s*}}","g");function Oe(p){let y=[];if("string"==typeof p){let o;for(;o=Ge.exec(p);)y.push(o[1]);Ge.lastIndex=0}return y}function tt(p,y,o){const _=p.toString(),A=_.replace(Ge,(z,ue)=>{let _e=y[ue];return null==_e&&(o.push(function Pe(p){return new d.vHH(3003,!1)}()),_e=""),_e.toString()});return A==_?p:A}function Nt(p){const y=[];let o=p.next();for(;!o.done;)y.push(o.value),o=p.next();return y}const bn=/-+([a-z0-9])/g;function ti(p){return p.replace(bn,(...y)=>y[1].toUpperCase())}function Ri(p){return p.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function nr(p,y,o){switch(y.type){case 7:return p.visitTrigger(y,o);case 0:return p.visitState(y,o);case 1:return p.visitTransition(y,o);case 2:return p.visitSequence(y,o);case 3:return p.visitGroup(y,o);case 4:return p.visitAnimate(y,o);case 5:return p.visitKeyframes(y,o);case 6:return p.visitStyle(y,o);case 8:return p.visitReference(y,o);case 9:return p.visitAnimateChild(y,o);case 10:return p.visitAnimateRef(y,o);case 11:return p.visitQuery(y,o);case 12:return p.visitStagger(y,o);default:throw function ut(p){return new d.vHH(3004,!1)}()}}function br(p,y){return window.getComputedStyle(p)[y]}function ki(p,y){const o=[];return"string"==typeof p?p.split(/\s*,\s*/).forEach(_=>function ls(p,y,o){if(":"==p[0]){const rt=function po(p,y){switch(p){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(o,_)=>parseFloat(_)>parseFloat(o);case":decrement":return(o,_)=>parseFloat(_)<parseFloat(o);default:return y.push(function xt(p){return new d.vHH(3016,!1)}()),"* => *"}}(p,o);if("function"==typeof rt)return void y.push(rt);p=rt}const _=p.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==_||_.length<4)return o.push(function vn(p){return new d.vHH(3015,!1)}()),y;const A=_[1],z=_[2],ue=_[3];y.push(Go(A,ue));"<"==z[0]&&!("*"==A&&"*"==ue)&&y.push(Go(ue,A))}(_,o,y)):o.push(p),o}const vi=new Set(["true","1"]),so=new Set(["false","0"]);function Go(p,y){const o=vi.has(p)||so.has(p),_=vi.has(y)||so.has(y);return(A,z)=>{let ue="*"==p||p==A,_e="*"==y||y==z;return!ue&&o&&"boolean"==typeof A&&(ue=A?vi.has(p):so.has(p)),!_e&&_&&"boolean"==typeof z&&(_e=z?vi.has(y):so.has(y)),ue&&_e}}const yr=new RegExp("s*:selfs*,?","g");function Xi(p,y,o,_){return new ao(p).build(y,o,_)}class ao{constructor(y){this._driver=y}build(y,o,_){const A=new Vs(o);return this._resetContextStyleTimingState(A),nr(this,en(y),A)}_resetContextStyleTimingState(y){y.currentQuerySelector="",y.collectedStyles=new Map,y.collectedStyles.set("",new Map),y.currentTime=0}visitTrigger(y,o){let _=o.queryCount=0,A=o.depCount=0;const z=[],ue=[];return"@"==y.name.charAt(0)&&o.errors.push(function et(){return new d.vHH(3006,!1)}()),y.definitions.forEach(_e=>{if(this._resetContextStyleTimingState(o),0==_e.type){const rt=_e,Lt=rt.name;Lt.toString().split(/\s*,\s*/).forEach(ln=>{rt.name=ln,z.push(this.visitState(rt,o))}),rt.name=Lt}else if(1==_e.type){const rt=this.visitTransition(_e,o);_+=rt.queryCount,A+=rt.depCount,ue.push(rt)}else o.errors.push(function Ut(){return new d.vHH(3007,!1)}())}),{type:7,name:y.name,states:z,transitions:ue,queryCount:_,depCount:A,options:null}}visitState(y,o){const _=this.visitStyle(y.styles,o),A=y.options&&y.options.params||null;if(_.containsDynamicStyles){const z=new Set,ue=A||{};_.styles.forEach(_e=>{_e instanceof Map&&_e.forEach(rt=>{Oe(rt).forEach(Lt=>{ue.hasOwnProperty(Lt)||z.add(Lt)})})}),z.size&&(Nt(z.values()),o.errors.push(function Ft(p,y){return new d.vHH(3008,!1)}()))}return{type:0,name:y.name,style:_,options:A?{params:A}:null}}visitTransition(y,o){o.queryCount=0,o.depCount=0;const _=nr(this,en(y.animation),o);return{type:1,matchers:ki(y.expr,o.errors),animation:_,queryCount:o.queryCount,depCount:o.depCount,options:xr(y.options)}}visitSequence(y,o){return{type:2,steps:y.steps.map(_=>nr(this,_,o)),options:xr(y.options)}}visitGroup(y,o){const _=o.currentTime;let A=0;const z=y.steps.map(ue=>{o.currentTime=_;const _e=nr(this,ue,o);return A=Math.max(A,o.currentTime),_e});return o.currentTime=A,{type:3,steps:z,options:xr(y.options)}}visitAnimate(y,o){const _=function Jr(p,y){if(p.hasOwnProperty("duration"))return p;if("number"==typeof p)return Lo(ae(p,y).duration,0,"");const o=p;if(o.split(/\s+/).some(z=>"{"==z.charAt(0)&&"{"==z.charAt(1))){const z=Lo(0,0,"");return z.dynamic=!0,z.strValue=o,z}const A=ae(o,y);return Lo(A.duration,A.delay,A.easing)}(y.timings,o.errors);o.currentAnimateTimings=_;let A,z=y.styles?y.styles:(0,Ve.oB)({});if(5==z.type)A=this.visitKeyframes(z,o);else{let ue=y.styles,_e=!1;if(!ue){_e=!0;const Lt={};_.easing&&(Lt.easing=_.easing),ue=(0,Ve.oB)(Lt)}o.currentTime+=_.duration+_.delay;const rt=this.visitStyle(ue,o);rt.isEmptyStep=_e,A=rt}return o.currentAnimateTimings=null,{type:4,timings:_,style:A,options:null}}visitStyle(y,o){const _=this._makeStyleAst(y,o);return this._validateStyleAst(_,o),_}_makeStyleAst(y,o){const _=[],A=Array.isArray(y.styles)?y.styles:[y.styles];for(let _e of A)"string"==typeof _e?_e===Ve.l3?_.push(_e):o.errors.push(new d.vHH(3002,!1)):_.push(Te(_e));let z=!1,ue=null;return _.forEach(_e=>{if(_e instanceof Map&&(_e.has("easing")&&(ue=_e.get("easing"),_e.delete("easing")),!z))for(let rt of _e.values())if(rt.toString().indexOf("{{")>=0){z=!0;break}}),{type:6,styles:_,easing:ue,offset:y.offset,containsDynamicStyles:z,options:null}}_validateStyleAst(y,o){const _=o.currentAnimateTimings;let A=o.currentTime,z=o.currentTime;_&&z>0&&(z-=_.duration+_.delay),y.styles.forEach(ue=>{"string"!=typeof ue&&ue.forEach((_e,rt)=>{const Lt=o.collectedStyles.get(o.currentQuerySelector),ln=Lt.get(rt);let un=!0;ln&&(z!=A&&z>=ln.startTime&&A<=ln.endTime&&(o.errors.push(function Xn(p,y,o,_,A){return new d.vHH(3010,!1)}()),un=!1),z=ln.startTime),un&&Lt.set(rt,{startTime:z,endTime:A}),o.options&&function Le(p,y,o){const _=y.params||{},A=Oe(p);A.length&&A.forEach(z=>{_.hasOwnProperty(z)||o.push(function ft(p){return new d.vHH(3001,!1)}())})}(_e,o.options,o.errors)})})}visitKeyframes(y,o){const _={type:5,styles:[],options:null};if(!o.currentAnimateTimings)return o.errors.push(function Xt(){return new d.vHH(3011,!1)}()),_;let z=0;const ue=[];let _e=!1,rt=!1,Lt=0;const ln=y.steps.map(Ki=>{const Vr=this._makeStyleAst(Ki,o);let Ro=null!=Vr.offset?Vr.offset:function Ko(p){if("string"==typeof p)return null;let y=null;if(Array.isArray(p))p.forEach(o=>{if(o instanceof Map&&o.has("offset")){const _=o;y=parseFloat(_.get("offset")),_.delete("offset")}});else if(p instanceof Map&&p.has("offset")){const o=p;y=parseFloat(o.get("offset")),o.delete("offset")}return y}(Vr.styles),_o=0;return null!=Ro&&(z++,_o=Vr.offset=Ro),rt=rt||_o<0||_o>1,_e=_e||_o<Lt,Lt=_o,ue.push(_o),Vr});rt&&o.errors.push(function Fe(){return new d.vHH(3012,!1)}()),_e&&o.errors.push(function Qe(){return new d.vHH(3200,!1)}());const un=y.steps.length;let ei=0;z>0&&z<un?o.errors.push(function fn(){return new d.vHH(3202,!1)}()):0==z&&(ei=1/(un-1));const yi=un-1,si=o.currentTime,hi=o.currentAnimateTimings,Fi=hi.duration;return ln.forEach((Ki,Vr)=>{const Ro=ei>0?Vr==yi?1:ei*Vr:ue[Vr],_o=Ro*Fi;o.currentTime=si+hi.delay+_o,hi.duration=_o,this._validateStyleAst(Ki,o),Ki.offset=Ro,_.styles.push(Ki)}),_}visitReference(y,o){return{type:8,animation:nr(this,en(y.animation),o),options:xr(y.options)}}visitAnimateChild(y,o){return o.depCount++,{type:9,options:xr(y.options)}}visitAnimateRef(y,o){return{type:10,animation:this.visitReference(y.animation,o),options:xr(y.options)}}visitQuery(y,o){const _=o.currentQuerySelector,A=y.options||{};o.queryCount++,o.currentQuery=y;const[z,ue]=function xa(p){const y=!!p.split(/\s*,\s*/).find(o=>":self"==o);return y&&(p=p.replace(yr,"")),p=p.replace(/@\*/g,_t).replace(/@\w+/g,o=>_t+"-"+o.slice(1)).replace(/:animating/g,nt),[p,y]}(y.selector);o.currentQuerySelector=_.length?_+" "+z:z,Oi(o.collectedStyles,o.currentQuerySelector,new Map);const _e=nr(this,en(y.animation),o);return o.currentQuery=null,o.currentQuerySelector=_,{type:11,selector:z,limit:A.limit||0,optional:!!A.optional,includeSelf:ue,animation:_e,originalSelector:y.selector,options:xr(y.options)}}visitStagger(y,o){o.currentQuery||o.errors.push(function Jt(){return new d.vHH(3013,!1)}());const _="full"===y.timings?{duration:0,delay:0,easing:"full"}:ae(y.timings,o.errors,!0);return{type:12,animation:nr(this,en(y.animation),o),timings:_,options:null}}}class Vs{constructor(y){this.errors=y,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function xr(p){return p?(p=le(p)).params&&(p.params=function ys(p){return p?le(p):null}(p.params)):p={},p}function Lo(p,y,o){return{duration:p,delay:y,easing:o}}function ra(p,y,o,_,A,z,ue=null,_e=!1){return{type:1,element:p,keyframes:y,preStyleProps:o,postStyleProps:_,duration:A,delay:z,totalTime:A+z,easing:ue,subTimeline:_e}}class lo{constructor(){this._map=new Map}get(y){return this._map.get(y)||[]}append(y,o){let _=this._map.get(y);_||this._map.set(y,_=[]),_.push(...o)}has(y){return this._map.has(y)}clear(){this._map.clear()}}const el=new RegExp(":enter","g"),oa=new RegExp(":leave","g");function Oa(p,y,o,_,A,z=new Map,ue=new Map,_e,rt,Lt=[]){return(new sa).buildKeyframes(p,y,o,_,A,z,ue,_e,rt,Lt)}class sa{buildKeyframes(y,o,_,A,z,ue,_e,rt,Lt,ln=[]){Lt=Lt||new lo;const un=new vs(y,o,Lt,A,z,ln,[]);un.options=rt;const ei=rt.delay?Be(rt.delay):0;un.currentTimeline.delayNextStep(ei),un.currentTimeline.setStyles([ue],null,un.errors,rt),nr(this,_,un);const yi=un.timelines.filter(si=>si.containsAnimation());if(yi.length&&_e.size){let si;for(let hi=yi.length-1;hi>=0;hi--){const Fi=yi[hi];if(Fi.element===o){si=Fi;break}}si&&!si.allowOnlyTimelineStyles()&&si.setStyles([_e],null,un.errors,rt)}return yi.length?yi.map(si=>si.buildKeyframes()):[ra(o,[],[],[],0,ei,"",!1)]}visitTrigger(y,o){}visitState(y,o){}visitTransition(y,o){}visitAnimateChild(y,o){const _=o.subInstructions.get(o.element);if(_){const A=o.createSubContext(y.options),z=o.currentTimeline.currentTime,ue=this._visitSubInstructions(_,A,A.options);z!=ue&&o.transformIntoNewTimeline(ue)}o.previousNode=y}visitAnimateRef(y,o){const _=o.createSubContext(y.options);_.transformIntoNewTimeline(),this.visitReference(y.animation,_),o.transformIntoNewTimeline(_.currentTimeline.currentTime),o.previousNode=y}_visitSubInstructions(y,o,_){let z=o.currentTimeline.currentTime;const ue=null!=_.duration?Be(_.duration):null,_e=null!=_.delay?Be(_.delay):null;return 0!==ue&&y.forEach(rt=>{const Lt=o.appendInstructionToTimeline(rt,ue,_e);z=Math.max(z,Lt.duration+Lt.delay)}),z}visitReference(y,o){o.updateOptions(y.options,!0),nr(this,y.animation,o),o.previousNode=y}visitSequence(y,o){const _=o.subContextCount;let A=o;const z=y.options;if(z&&(z.params||z.delay)&&(A=o.createSubContext(z),A.transformIntoNewTimeline(),null!=z.delay)){6==A.previousNode.type&&(A.currentTimeline.snapshotCurrentStyles(),A.previousNode=Sr);const ue=Be(z.delay);A.delayNextStep(ue)}y.steps.length&&(y.steps.forEach(ue=>nr(this,ue,A)),A.currentTimeline.applyStylesToKeyframe(),A.subContextCount>_&&A.transformIntoNewTimeline()),o.previousNode=y}visitGroup(y,o){const _=[];let A=o.currentTimeline.currentTime;const z=y.options&&y.options.delay?Be(y.options.delay):0;y.steps.forEach(ue=>{const _e=o.createSubContext(y.options);z&&_e.delayNextStep(z),nr(this,ue,_e),A=Math.max(A,_e.currentTimeline.currentTime),_.push(_e.currentTimeline)}),_.forEach(ue=>o.currentTimeline.mergeTimelineCollectedStyles(ue)),o.transformIntoNewTimeline(A),o.previousNode=y}_visitTiming(y,o){if(y.dynamic){const _=y.strValue;return ae(o.params?tt(_,o.params,o.errors):_,o.errors)}return{duration:y.duration,delay:y.delay,easing:y.easing}}visitAnimate(y,o){const _=o.currentAnimateTimings=this._visitTiming(y.timings,o),A=o.currentTimeline;_.delay&&(o.incrementTime(_.delay),A.snapshotCurrentStyles());const z=y.style;5==z.type?this.visitKeyframes(z,o):(o.incrementTime(_.duration),this.visitStyle(z,o),A.applyStylesToKeyframe()),o.currentAnimateTimings=null,o.previousNode=y}visitStyle(y,o){const _=o.currentTimeline,A=o.currentAnimateTimings;!A&&_.hasCurrentStyleProperties()&&_.forwardFrame();const z=A&&A.easing||y.easing;y.isEmptyStep?_.applyEmptyStep(z):_.setStyles(y.styles,z,o.errors,o.options),o.previousNode=y}visitKeyframes(y,o){const _=o.currentAnimateTimings,A=o.currentTimeline.duration,z=_.duration,_e=o.createSubContext().currentTimeline;_e.easing=_.easing,y.styles.forEach(rt=>{_e.forwardTime((rt.offset||0)*z),_e.setStyles(rt.styles,rt.easing,o.errors,o.options),_e.applyStylesToKeyframe()}),o.currentTimeline.mergeTimelineCollectedStyles(_e),o.transformIntoNewTimeline(A+z),o.previousNode=y}visitQuery(y,o){const _=o.currentTimeline.currentTime,A=y.options||{},z=A.delay?Be(A.delay):0;z&&(6===o.previousNode.type||0==_&&o.currentTimeline.hasCurrentStyleProperties())&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=Sr);let ue=_;const _e=o.invokeQuery(y.selector,y.originalSelector,y.limit,y.includeSelf,!!A.optional,o.errors);o.currentQueryTotal=_e.length;let rt=null;_e.forEach((Lt,ln)=>{o.currentQueryIndex=ln;const un=o.createSubContext(y.options,Lt);z&&un.delayNextStep(z),Lt===o.element&&(rt=un.currentTimeline),nr(this,y.animation,un),un.currentTimeline.applyStylesToKeyframe(),ue=Math.max(ue,un.currentTimeline.currentTime)}),o.currentQueryIndex=0,o.currentQueryTotal=0,o.transformIntoNewTimeline(ue),rt&&(o.currentTimeline.mergeTimelineCollectedStyles(rt),o.currentTimeline.snapshotCurrentStyles()),o.previousNode=y}visitStagger(y,o){const _=o.parentContext,A=o.currentTimeline,z=y.timings,ue=Math.abs(z.duration),_e=ue*(o.currentQueryTotal-1);let rt=ue*o.currentQueryIndex;switch(z.duration<0?"reverse":z.easing){case"reverse":rt=_e-rt;break;case"full":rt=_.currentStaggerTime}const ln=o.currentTimeline;rt&&ln.delayNextStep(rt);const un=ln.currentTime;nr(this,y.animation,o),o.previousNode=y,_.currentStaggerTime=A.currentTime-un+(A.startTime-_.currentTimeline.startTime)}}const Sr={};class vs{constructor(y,o,_,A,z,ue,_e,rt){this._driver=y,this.element=o,this.subInstructions=_,this._enterClassName=A,this._leaveClassName=z,this.errors=ue,this.timelines=_e,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Sr,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=rt||new Us(this._driver,o,0),_e.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(y,o){if(!y)return;const _=y;let A=this.options;null!=_.duration&&(A.duration=Be(_.duration)),null!=_.delay&&(A.delay=Be(_.delay));const z=_.params;if(z){let ue=A.params;ue||(ue=this.options.params={}),Object.keys(z).forEach(_e=>{(!o||!ue.hasOwnProperty(_e))&&(ue[_e]=tt(z[_e],ue,this.errors))})}}_copyOptions(){const y={};if(this.options){const o=this.options.params;if(o){const _=y.params={};Object.keys(o).forEach(A=>{_[A]=o[A]})}}return y}createSubContext(y=null,o,_){const A=o||this.element,z=new vs(this._driver,A,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(A,_||0));return z.previousNode=this.previousNode,z.currentAnimateTimings=this.currentAnimateTimings,z.options=this._copyOptions(),z.updateOptions(y),z.currentQueryIndex=this.currentQueryIndex,z.currentQueryTotal=this.currentQueryTotal,z.parentContext=this,this.subContextCount++,z}transformIntoNewTimeline(y){return this.previousNode=Sr,this.currentTimeline=this.currentTimeline.fork(this.element,y),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(y,o,_){const A={duration:o??y.duration,delay:this.currentTimeline.currentTime+(_??0)+y.delay,easing:""},z=new js(this._driver,y.element,y.keyframes,y.preStyleProps,y.postStyleProps,A,y.stretchStartingKeyframe);return this.timelines.push(z),A}incrementTime(y){this.currentTimeline.forwardTime(this.currentTimeline.duration+y)}delayNextStep(y){y>0&&this.currentTimeline.delayNextStep(y)}invokeQuery(y,o,_,A,z,ue){let _e=[];if(A&&_e.push(this.element),y.length>0){y=(y=y.replace(el,"."+this._enterClassName)).replace(oa,"."+this._leaveClassName);let Lt=this._driver.query(this.element,y,1!=_);0!==_&&(Lt=_<0?Lt.slice(Lt.length+_,Lt.length):Lt.slice(0,_)),_e.push(...Lt)}return!z&&0==_e.length&&ue.push(function rn(p){return new d.vHH(3014,!1)}()),_e}}class Us{constructor(y,o,_,A){this._driver=y,this.element=o,this.startTime=_,this._elementTimelineStylesLookup=A,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(o),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(o,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(y){const o=1===this._keyframes.size&&this._pendingStyles.size;this.duration||o?(this.forwardTime(this.currentTime+y),o&&this.snapshotCurrentStyles()):this.startTime+=y}fork(y,o){return this.applyStylesToKeyframe(),new Us(this._driver,y,o||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(y){this.applyStylesToKeyframe(),this.duration=y,this._loadKeyframe()}_updateStyle(y,o){this._localTimelineStyles.set(y,o),this._globalTimelineStyles.set(y,o),this._styleSummary.set(y,{time:this.currentTime,value:o})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(y){y&&this._previousKeyframe.set("easing",y);for(let[o,_]of this._globalTimelineStyles)this._backFill.set(o,_||Ve.l3),this._currentKeyframe.set(o,Ve.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(y,o,_,A){o&&this._previousKeyframe.set("easing",o);const z=A&&A.params||{},ue=function Hs(p,y){const o=new Map;let _;return p.forEach(A=>{if("*"===A){_=_||y.keys();for(let z of _)o.set(z,Ve.l3)}else Mt(A,o)}),o}(y,this._globalTimelineStyles);for(let[_e,rt]of ue){const Lt=tt(rt,z,_);this._pendingStyles.set(_e,Lt),this._localTimelineStyles.has(_e)||this._backFill.set(_e,this._globalTimelineStyles.get(_e)??Ve.l3),this._updateStyle(_e,Lt)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((y,o)=>{this._currentKeyframe.set(o,y)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((y,o)=>{this._currentKeyframe.has(o)||this._currentKeyframe.set(o,y)}))}snapshotCurrentStyles(){for(let[y,o]of this._localTimelineStyles)this._pendingStyles.set(y,o),this._updateStyle(y,o)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const y=[];for(let o in this._currentKeyframe)y.push(o);return y}mergeTimelineCollectedStyles(y){y._styleSummary.forEach((o,_)=>{const A=this._styleSummary.get(_);(!A||o.time>A.time)&&this._updateStyle(_,o.value)})}buildKeyframes(){this.applyStylesToKeyframe();const y=new Set,o=new Set,_=1===this._keyframes.size&&0===this.duration;let A=[];this._keyframes.forEach((_e,rt)=>{const Lt=Mt(_e,new Map,this._backFill);Lt.forEach((ln,un)=>{ln===Ve.k1?y.add(un):ln===Ve.l3&&o.add(un)}),_||Lt.set("offset",rt/this.duration),A.push(Lt)});const z=y.size?Nt(y.values()):[],ue=o.size?Nt(o.values()):[];if(_){const _e=A[0],rt=new Map(_e);_e.set("offset",0),rt.set("offset",1),A=[_e,rt]}return ra(this.element,A,z,ue,this.duration,this.startTime,this.easing,!1)}}class js extends Us{constructor(y,o,_,A,z,ue,_e=!1){super(y,o,ue.delay),this.keyframes=_,this.preStyleProps=A,this.postStyleProps=z,this._stretchStartingKeyframe=_e,this.timings={duration:ue.duration,delay:ue.delay,easing:ue.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let y=this.keyframes,{delay:o,duration:_,easing:A}=this.timings;if(this._stretchStartingKeyframe&&o){const z=[],ue=_+o,_e=o/ue,rt=Mt(y[0]);rt.set("offset",0),z.push(rt);const Lt=Mt(y[0]);Lt.set("offset",Gs(_e)),z.push(Lt);const ln=y.length-1;for(let un=1;un<=ln;un++){let ei=Mt(y[un]);const yi=ei.get("offset");ei.set("offset",Gs((o+yi*_)/ue)),z.push(ei)}_=ue,o=0,A="",y=z}return ra(this.element,y,this.preStyleProps,this.postStyleProps,_,o,A,!0)}}function Gs(p,y=3){const o=Math.pow(10,y-1);return Math.round(p*o)/o}class wa{}const Sc=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class nl extends wa{normalizePropertyName(y,o){return ti(y)}normalizeStyleValue(y,o,_,A){let z="";const ue=_.toString().trim();if(Sc.has(o)&&0!==_&&"0"!==_)if("number"==typeof _)z="px";else{const _e=_.match(/^[+-]?[\d\.]+([a-z]*)$/);_e&&0==_e[1].length&&A.push(function gt(p,y){return new d.vHH(3005,!1)}())}return ue+z}}function Fo(p,y,o,_,A,z,ue,_e,rt,Lt,ln,un,ei){return{type:0,element:p,triggerName:y,isRemovalTransition:A,fromState:o,fromStyles:z,toState:_,toStyles:ue,timelines:_e,queriedElements:rt,preStyleProps:Lt,postStyleProps:ln,totalTime:un,errors:ei}}const $o={};class Xo{constructor(y,o,_){this._triggerName=y,this.ast=o,this._stateStyles=_}match(y,o,_,A){return function la(p,y,o,_,A){return p.some(z=>z(y,o,_,A))}(this.ast.matchers,y,o,_,A)}buildStyles(y,o,_){let A=this._stateStyles.get("*");return void 0!==y&&(A=this._stateStyles.get(y?.toString())||A),A?A.buildStyles(o,_):new Map}build(y,o,_,A,z,ue,_e,rt,Lt,ln){const un=[],ei=this.ast.options&&this.ast.options.params||$o,si=this.buildStyles(_,_e&&_e.params||$o,un),hi=rt&&rt.params||$o,Fi=this.buildStyles(A,hi,un),Ki=new Set,Vr=new Map,Ro=new Map,_o="void"===A,Pa={params:ka(hi,ei),delay:this.ast.options?.delay},gs=ln?[]:Oa(y,o,this.ast.animation,z,ue,si,Fi,Pa,Lt,un);let yo=0;if(gs.forEach(Is=>{yo=Math.max(Is.duration+Is.delay,yo)}),un.length)return Fo(o,this._triggerName,_,A,_o,si,Fi,[],[],Vr,Ro,yo,un);gs.forEach(Is=>{const Jl=Is.element,Ja=Oi(Vr,Jl,new Set);Is.preStyleProps.forEach(iu=>Ja.add(iu));const Tc=Oi(Ro,Jl,new Set);Is.postStyleProps.forEach(iu=>Tc.add(iu)),Jl!==o&&Ki.add(Jl)});const os=Nt(Ki.values());return Fo(o,this._triggerName,_,A,_o,si,Fi,gs,os,Vr,Ro,yo)}}function ka(p,y){const o=le(y);for(const _ in p)p.hasOwnProperty(_)&&null!=p[_]&&(o[_]=p[_]);return o}class Ra{constructor(y,o,_){this.styles=y,this.defaultParams=o,this.normalizer=_}buildStyles(y,o){const _=new Map,A=le(this.defaultParams);return Object.keys(y).forEach(z=>{const ue=y[z];null!==ue&&(A[z]=ue)}),this.styles.styles.forEach(z=>{"string"!=typeof z&&z.forEach((ue,_e)=>{ue&&(ue=tt(ue,A,o));const rt=this.normalizer.normalizePropertyName(_e,o);ue=this.normalizer.normalizeStyleValue(_e,rt,ue,o),_.set(rt,ue)})}),_}}class Al{constructor(y,o,_){this.name=y,this.ast=o,this._normalizer=_,this.transitionFactories=[],this.states=new Map,o.states.forEach(A=>{this.states.set(A.name,new Ra(A.style,A.options&&A.options.params||{},_))}),ca(this.states,"true","1"),ca(this.states,"false","0"),o.transitions.forEach(A=>{this.transitionFactories.push(new Xo(y,A,this.states))}),this.fallbackTransition=function La(p,y,o){return new Xo(p,{type:1,animation:{type:2,steps:[],options:null},matchers:[(ue,_e)=>!0],options:null,queryCount:0,depCount:0},y)}(y,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(y,o,_,A){return this.transitionFactories.find(ue=>ue.match(y,o,_,A))||null}matchStyles(y,o,_){return this.fallbackTransition.buildStyles(y,o,_)}}function ca(p,y,o){p.has(y)?p.has(o)||p.set(o,p.get(y)):p.has(o)&&p.set(y,p.get(o))}const cs=new lo;class Fa{constructor(y,o,_){this.bodyNode=y,this._driver=o,this._normalizer=_,this._animations=new Map,this._playersById=new Map,this.players=[]}register(y,o){const _=[],z=Xi(this._driver,o,_,[]);if(_.length)throw function mn(p){return new d.vHH(3503,!1)}();this._animations.set(y,z)}_buildPlayer(y,o,_){const A=y.element,z=wi(0,this._normalizer,0,y.keyframes,o,_);return this._driver.animate(A,z,y.duration,y.delay,y.easing,[],!0)}create(y,o,_={}){const A=[],z=this._animations.get(y);let ue;const _e=new Map;if(z?(ue=Oa(this._driver,o,z,mi,zt,new Map,new Map,_,cs,A),ue.forEach(ln=>{const un=Oi(_e,ln.element,new Map);ln.postStyleProps.forEach(ei=>un.set(ei,null))})):(A.push(function oi(){return new d.vHH(3300,!1)}()),ue=[]),A.length)throw function Yn(p){return new d.vHH(3504,!1)}();_e.forEach((ln,un)=>{ln.forEach((ei,yi)=>{ln.set(yi,this._driver.computeStyle(un,yi,Ve.l3))})});const Lt=gn(ue.map(ln=>{const un=_e.get(ln.element);return this._buildPlayer(ln,new Map,un)}));return this._playersById.set(y,Lt),Lt.onDestroy(()=>this.destroy(y)),this.players.push(Lt),Lt}destroy(y){const o=this._getPlayer(y);o.destroy(),this._playersById.delete(y);const _=this.players.indexOf(o);_>=0&&this.players.splice(_,1)}_getPlayer(y){const o=this._playersById.get(y);if(!o)throw function fi(p){return new d.vHH(3301,!1)}();return o}listen(y,o,_,A){const z=or(o,"","","");return Ei(this._getPlayer(y),_,z,A),()=>{}}command(y,o,_,A){if("register"==_)return void this.register(y,A[0]);if("create"==_)return void this.create(y,o,A[0]||{});const z=this._getPlayer(y);switch(_){case"play":z.play();break;case"pause":z.pause();break;case"reset":z.reset();break;case"restart":z.restart();break;case"finish":z.finish();break;case"init":z.init();break;case"setPosition":z.setPosition(parseFloat(A[0]));break;case"destroy":this.destroy(y)}}}const Ba="ng-animate-queued",Bo="ng-animate-disabled",Ws=[],ua={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},vo={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Co="__ng_removed";class da{constructor(y,o=""){this.namespaceId=o;const _=y&&y.hasOwnProperty("value");if(this.value=function sn(p){return p??null}(_?y.value:y),_){const z=le(y);delete z.value,this.options=z}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(y){const o=y.params;if(o){const _=this.options.params;Object.keys(o).forEach(A=>{null==_[A]&&(_[A]=o[A])})}}}const Li="void",X=new da(Li);class be{constructor(y,o,_){this.id=y,this.hostElement=o,this._engine=_,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+y,Vi(o,this._hostClassName)}listen(y,o,_,A){if(!this._triggers.has(o))throw function On(p,y){return new d.vHH(3302,!1)}();if(null==_||0==_.length)throw function Di(p){return new d.vHH(3303,!1)}();if(!function nn(p){return"start"==p||"done"==p}(_))throw function Ui(p,y){return new d.vHH(3400,!1)}();const z=Oi(this._elementListeners,y,[]),ue={name:o,phase:_,callback:A};z.push(ue);const _e=Oi(this._engine.statesByElement,y,new Map);return _e.has(o)||(Vi(y,mt),Vi(y,mt+"-"+o),_e.set(o,X)),()=>{this._engine.afterFlush(()=>{const rt=z.indexOf(ue);rt>=0&&z.splice(rt,1),this._triggers.has(o)||_e.delete(o)})}}register(y,o){return!this._triggers.has(y)&&(this._triggers.set(y,o),!0)}_getTrigger(y){const o=this._triggers.get(y);if(!o)throw function Pi(p){return new d.vHH(3401,!1)}();return o}trigger(y,o,_,A=!0){const z=this._getTrigger(o),ue=new Ae(this.id,o,y);let _e=this._engine.statesByElement.get(y);_e||(Vi(y,mt),Vi(y,mt+"-"+o),this._engine.statesByElement.set(y,_e=new Map));let rt=_e.get(o);const Lt=new da(_,this.id);if(!(_&&_.hasOwnProperty("value"))&&rt&&Lt.absorbOptions(rt.options),_e.set(o,Lt),rt||(rt=X),Lt.value!==Li&&rt.value===Lt.value){if(!function yn(p,y){const o=Object.keys(p),_=Object.keys(y);if(o.length!=_.length)return!1;for(let A=0;A<o.length;A++){const z=o[A];if(!y.hasOwnProperty(z)||p[z]!==y[z])return!1}return!0}(rt.params,Lt.params)){const hi=[],Fi=z.matchStyles(rt.value,rt.params,hi),Ki=z.matchStyles(Lt.value,Lt.params,hi);hi.length?this._engine.reportError(hi):this._engine.afterFlush(()=>{Et(y,Fi),Ot(y,Ki)})}return}const ei=Oi(this._engine.playersByElement,y,[]);ei.forEach(hi=>{hi.namespaceId==this.id&&hi.triggerName==o&&hi.queued&&hi.destroy()});let yi=z.matchTransition(rt.value,Lt.value,y,Lt.params),si=!1;if(!yi){if(!A)return;yi=z.fallbackTransition,si=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:y,triggerName:o,transition:yi,fromState:rt,toState:Lt,player:ue,isFallbackTransition:si}),si||(Vi(y,Ba),ue.onStart(()=>{kr(y,Ba)})),ue.onDone(()=>{let hi=this.players.indexOf(ue);hi>=0&&this.players.splice(hi,1);const Fi=this._engine.playersByElement.get(y);if(Fi){let Ki=Fi.indexOf(ue);Ki>=0&&Fi.splice(Ki,1)}}),this.players.push(ue),ei.push(ue),ue}deregister(y){this._triggers.delete(y),this._engine.statesByElement.forEach(o=>o.delete(y)),this._elementListeners.forEach((o,_)=>{this._elementListeners.set(_,o.filter(A=>A.name!=y))})}clearElementCache(y){this._engine.statesByElement.delete(y),this._elementListeners.delete(y);const o=this._engine.playersByElement.get(y);o&&(o.forEach(_=>_.destroy()),this._engine.playersByElement.delete(y))}_signalRemovalForInnerTriggers(y,o){const _=this._engine.driver.query(y,_t,!0);_.forEach(A=>{if(A[Co])return;const z=this._engine.fetchNamespacesByElement(A);z.size?z.forEach(ue=>ue.triggerLeaveAnimation(A,o,!1,!0)):this.clearElementCache(A)}),this._engine.afterFlushAnimationsDone(()=>_.forEach(A=>this.clearElementCache(A)))}triggerLeaveAnimation(y,o,_,A){const z=this._engine.statesByElement.get(y),ue=new Map;if(z){const _e=[];if(z.forEach((rt,Lt)=>{if(ue.set(Lt,rt.value),this._triggers.has(Lt)){const ln=this.trigger(y,Lt,Li,A);ln&&_e.push(ln)}}),_e.length)return this._engine.markElementAsRemoved(this.id,y,!0,o,ue),_&&gn(_e).onDone(()=>this._engine.processLeaveNode(y)),!0}return!1}prepareLeaveAnimationListeners(y){const o=this._elementListeners.get(y),_=this._engine.statesByElement.get(y);if(o&&_){const A=new Set;o.forEach(z=>{const ue=z.name;if(A.has(ue))return;A.add(ue);const rt=this._triggers.get(ue).fallbackTransition,Lt=_.get(ue)||X,ln=new da(Li),un=new Ae(this.id,ue,y);this._engine.totalQueuedPlayers++,this._queue.push({element:y,triggerName:ue,transition:rt,fromState:Lt,toState:ln,player:un,isFallbackTransition:!0})})}}removeNode(y,o){const _=this._engine;if(y.childElementCount&&this._signalRemovalForInnerTriggers(y,o),this.triggerLeaveAnimation(y,o,!0))return;let A=!1;if(_.totalAnimations){const z=_.players.length?_.playersByQueriedElement.get(y):[];if(z&&z.length)A=!0;else{let ue=y;for(;ue=ue.parentNode;)if(_.statesByElement.get(ue)){A=!0;break}}}if(this.prepareLeaveAnimationListeners(y),A)_.markElementAsRemoved(this.id,y,!1,o);else{const z=y[Co];(!z||z===ua)&&(_.afterFlush(()=>this.clearElementCache(y)),_.destroyInnerAnimations(y),_._onRemovalComplete(y,o))}}insertNode(y,o){Vi(y,this._hostClassName)}drainQueuedTransitions(y){const o=[];return this._queue.forEach(_=>{const A=_.player;if(A.destroyed)return;const z=_.element,ue=this._elementListeners.get(z);ue&&ue.forEach(_e=>{if(_e.name==_.triggerName){const rt=or(z,_.triggerName,_.fromState.value,_.toState.value);rt._data=y,Ei(_.player,_e.phase,rt,_e.callback)}}),A.markedForDestroy?this._engine.afterFlush(()=>{A.destroy()}):o.push(_)}),this._queue=[],o.sort((_,A)=>{const z=_.transition.ast.depCount,ue=A.transition.ast.depCount;return 0==z||0==ue?z-ue:this._engine.driver.containsElement(_.element,A.element)?1:-1})}destroy(y){this.players.forEach(o=>o.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,y)}elementContainsData(y){let o=!1;return this._elementListeners.has(y)&&(o=!0),o=!!this._queue.find(_=>_.element===y)||o,o}}class J{constructor(y,o,_){this.bodyNode=y,this.driver=o,this._normalizer=_,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(A,z)=>{}}_onRemovalComplete(y,o){this.onRemovalComplete(y,o)}get queuedPlayers(){const y=[];return this._namespaceList.forEach(o=>{o.players.forEach(_=>{_.queued&&y.push(_)})}),y}createNamespace(y,o){const _=new be(y,o,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,o)?this._balanceNamespaceList(_,o):(this.newHostElements.set(o,_),this.collectEnterElement(o)),this._namespaceLookup[y]=_}_balanceNamespaceList(y,o){const _=this._namespaceList,A=this.namespacesByHostElement;if(_.length-1>=0){let ue=!1,_e=this.driver.getParentElement(o);for(;_e;){const rt=A.get(_e);if(rt){const Lt=_.indexOf(rt);_.splice(Lt+1,0,y),ue=!0;break}_e=this.driver.getParentElement(_e)}ue||_.unshift(y)}else _.push(y);return A.set(o,y),y}register(y,o){let _=this._namespaceLookup[y];return _||(_=this.createNamespace(y,o)),_}registerTrigger(y,o,_){let A=this._namespaceLookup[y];A&&A.register(o,_)&&this.totalAnimations++}destroy(y,o){if(!y)return;const _=this._fetchNamespace(y);this.afterFlush(()=>{this.namespacesByHostElement.delete(_.hostElement),delete this._namespaceLookup[y];const A=this._namespaceList.indexOf(_);A>=0&&this._namespaceList.splice(A,1)}),this.afterFlushAnimationsDone(()=>_.destroy(o))}_fetchNamespace(y){return this._namespaceLookup[y]}fetchNamespacesByElement(y){const o=new Set,_=this.statesByElement.get(y);if(_)for(let A of _.values())if(A.namespaceId){const z=this._fetchNamespace(A.namespaceId);z&&o.add(z)}return o}trigger(y,o,_,A){if(xn(o)){const z=this._fetchNamespace(y);if(z)return z.trigger(o,_,A),!0}return!1}insertNode(y,o,_,A){if(!xn(o))return;const z=o[Co];if(z&&z.setForRemoval){z.setForRemoval=!1,z.setForMove=!0;const ue=this.collectedLeaveElements.indexOf(o);ue>=0&&this.collectedLeaveElements.splice(ue,1)}if(y){const ue=this._fetchNamespace(y);ue&&ue.insertNode(o,_)}A&&this.collectEnterElement(o)}collectEnterElement(y){this.collectedEnterElements.push(y)}markElementAsDisabled(y,o){o?this.disabledNodes.has(y)||(this.disabledNodes.add(y),Vi(y,Bo)):this.disabledNodes.has(y)&&(this.disabledNodes.delete(y),kr(y,Bo))}removeNode(y,o,_,A){if(xn(o)){const z=y?this._fetchNamespace(y):null;if(z?z.removeNode(o,A):this.markElementAsRemoved(y,o,!1,A),_){const ue=this.namespacesByHostElement.get(o);ue&&ue.id!==y&&ue.removeNode(o,A)}}else this._onRemovalComplete(o,A)}markElementAsRemoved(y,o,_,A,z){this.collectedLeaveElements.push(o),o[Co]={namespaceId:y,setForRemoval:A,hasAnimation:_,removedBeforeQueried:!1,previousTriggersValues:z}}listen(y,o,_,A,z){return xn(o)?this._fetchNamespace(y).listen(o,_,A,z):()=>{}}_buildInstruction(y,o,_,A,z){return y.transition.build(this.driver,y.element,y.fromState.value,y.toState.value,_,A,y.fromState.options,y.toState.options,o,z)}destroyInnerAnimations(y){let o=this.driver.query(y,_t,!0);o.forEach(_=>this.destroyActiveAnimationsForElement(_)),0!=this.playersByQueriedElement.size&&(o=this.driver.query(y,nt,!0),o.forEach(_=>this.finishActiveQueriedAnimationOnElement(_)))}destroyActiveAnimationsForElement(y){const o=this.playersByElement.get(y);o&&o.forEach(_=>{_.queued?_.markedForDestroy=!0:_.destroy()})}finishActiveQueriedAnimationOnElement(y){const o=this.playersByQueriedElement.get(y);o&&o.forEach(_=>_.finish())}whenRenderingDone(){return new Promise(y=>{if(this.players.length)return gn(this.players).onDone(()=>y());y()})}processLeaveNode(y){const o=y[Co];if(o&&o.setForRemoval){if(y[Co]=ua,o.namespaceId){this.destroyInnerAnimations(y);const _=this._fetchNamespace(o.namespaceId);_&&_.clearElementCache(y)}this._onRemovalComplete(y,o.setForRemoval)}y.classList?.contains(Bo)&&this.markElementAsDisabled(y,!1),this.driver.query(y,".ng-animate-disabled",!0).forEach(_=>{this.markElementAsDisabled(_,!1)})}flush(y=-1){let o=[];if(this.newHostElements.size&&(this.newHostElements.forEach((_,A)=>this._balanceNamespaceList(_,A)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let _=0;_<this.collectedEnterElements.length;_++)Vi(this.collectedEnterElements[_],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const _=[];try{o=this._flushAnimations(_,y)}finally{for(let A=0;A<_.length;A++)_[A]()}}else for(let _=0;_<this.collectedLeaveElements.length;_++)this.processLeaveNode(this.collectedLeaveElements[_]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(_=>_()),this._flushFns=[],this._whenQuietFns.length){const _=this._whenQuietFns;this._whenQuietFns=[],o.length?gn(o).onDone(()=>{_.forEach(A=>A())}):_.forEach(A=>A())}}reportError(y){throw function Ln(p){return new d.vHH(3402,!1)}()}_flushAnimations(y,o){const _=new lo,A=[],z=new Map,ue=[],_e=new Map,rt=new Map,Lt=new Map,ln=new Set;this.disabledNodes.forEach(xi=>{ln.add(xi);const Bi=this.driver.query(xi,".ng-animate-queued",!0);for(let Ni=0;Ni<Bi.length;Ni++)ln.add(Bi[Ni])});const un=this.bodyNode,ei=Array.from(this.statesByElement.keys()),yi=_r(ei,this.collectedEnterElements),si=new Map;let hi=0;yi.forEach((xi,Bi)=>{const Ni=mi+hi++;si.set(Bi,Ni),xi.forEach(Tr=>Vi(Tr,Ni))});const Fi=[],Ki=new Set,Vr=new Set;for(let xi=0;xi<this.collectedLeaveElements.length;xi++){const Bi=this.collectedLeaveElements[xi],Ni=Bi[Co];Ni&&Ni.setForRemoval&&(Fi.push(Bi),Ki.add(Bi),Ni.hasAnimation?this.driver.query(Bi,".ng-star-inserted",!0).forEach(Tr=>Ki.add(Tr)):Vr.add(Bi))}const Ro=new Map,_o=_r(ei,Array.from(Ki));_o.forEach((xi,Bi)=>{const Ni=zt+hi++;Ro.set(Bi,Ni),xi.forEach(Tr=>Vi(Tr,Ni))}),y.push(()=>{yi.forEach((xi,Bi)=>{const Ni=si.get(Bi);xi.forEach(Tr=>kr(Tr,Ni))}),_o.forEach((xi,Bi)=>{const Ni=Ro.get(Bi);xi.forEach(Tr=>kr(Tr,Ni))}),Fi.forEach(xi=>{this.processLeaveNode(xi)})});const Pa=[],gs=[];for(let xi=this._namespaceList.length-1;xi>=0;xi--)this._namespaceList[xi].drainQueuedTransitions(o).forEach(Ni=>{const Tr=Ni.player,Yo=Ni.element;if(Pa.push(Tr),this.collectedEnterElements.length){const _s=Yo[Co];if(_s&&_s.setForMove){if(_s.previousTriggersValues&&_s.previousTriggersValues.has(Ni.triggerName)){const ec=_s.previousTriggersValues.get(Ni.triggerName),ba=this.statesByElement.get(Ni.element);if(ba&&ba.has(Ni.triggerName)){const up=ba.get(Ni.triggerName);up.value=ec,ba.set(Ni.triggerName,up)}}return void Tr.destroy()}}const Tl=!un||!this.driver.containsElement(un,Yo),Ns=Ro.get(Yo),Sl=si.get(Yo),Xr=this._buildInstruction(Ni,_,Sl,Ns,Tl);if(Xr.errors&&Xr.errors.length)return void gs.push(Xr);if(Tl)return Tr.onStart(()=>Et(Yo,Xr.fromStyles)),Tr.onDestroy(()=>Ot(Yo,Xr.toStyles)),void A.push(Tr);if(Ni.isFallbackTransition)return Tr.onStart(()=>Et(Yo,Xr.fromStyles)),Tr.onDestroy(()=>Ot(Yo,Xr.toStyles)),void A.push(Tr);const Bu=[];Xr.timelines.forEach(_s=>{_s.stretchStartingKeyframe=!0,this.disabledNodes.has(_s.element)||Bu.push(_s)}),Xr.timelines=Bu,_.append(Yo,Xr.timelines),ue.push({instruction:Xr,player:Tr,element:Yo}),Xr.queriedElements.forEach(_s=>Oi(_e,_s,[]).push(Tr)),Xr.preStyleProps.forEach((_s,ec)=>{if(_s.size){let ba=rt.get(ec);ba||rt.set(ec,ba=new Set),_s.forEach((up,wv)=>ba.add(wv))}}),Xr.postStyleProps.forEach((_s,ec)=>{let ba=Lt.get(ec);ba||Lt.set(ec,ba=new Set),_s.forEach((up,wv)=>ba.add(wv))})});if(gs.length){const xi=[];gs.forEach(Bi=>{xi.push(function Rt(p,y){return new d.vHH(3505,!1)}())}),Pa.forEach(Bi=>Bi.destroy()),this.reportError(xi)}const yo=new Map,os=new Map;ue.forEach(xi=>{const Bi=xi.element;_.has(Bi)&&(os.set(Bi,Bi),this._beforeAnimationBuild(xi.player.namespaceId,xi.instruction,yo))}),A.forEach(xi=>{const Bi=xi.element;this._getPreviousPlayers(Bi,!1,xi.namespaceId,xi.triggerName,null).forEach(Tr=>{Oi(yo,Bi,[]).push(Tr),Tr.destroy()})});const Is=Fi.filter(xi=>ji(xi,rt,Lt)),Jl=new Map;vr(Jl,this.driver,Vr,Lt,Ve.l3).forEach(xi=>{ji(xi,rt,Lt)&&Is.push(xi)});const Tc=new Map;yi.forEach((xi,Bi)=>{vr(Tc,this.driver,new Set(xi),rt,Ve.k1)}),Is.forEach(xi=>{const Bi=Jl.get(xi),Ni=Tc.get(xi);Jl.set(xi,new Map([...Array.from(Bi?.entries()??[]),...Array.from(Ni?.entries()??[])]))});const iu=[],_f=[],lp={};ue.forEach(xi=>{const{element:Bi,player:Ni,instruction:Tr}=xi;if(_.has(Bi)){if(ln.has(Bi))return Ni.onDestroy(()=>Ot(Bi,Tr.toStyles)),Ni.disabled=!0,Ni.overrideTotalTime(Tr.totalTime),void A.push(Ni);let Yo=lp;if(os.size>1){let Ns=Bi;const Sl=[];for(;Ns=Ns.parentNode;){const Xr=os.get(Ns);if(Xr){Yo=Xr;break}Sl.push(Ns)}Sl.forEach(Xr=>os.set(Xr,Yo))}const Tl=this._buildAnimation(Ni.namespaceId,Tr,yo,z,Tc,Jl);if(Ni.setRealPlayer(Tl),Yo===lp)iu.push(Ni);else{const Ns=this.playersByElement.get(Yo);Ns&&Ns.length&&(Ni.parentPlayer=gn(Ns)),A.push(Ni)}}else Et(Bi,Tr.fromStyles),Ni.onDestroy(()=>Ot(Bi,Tr.toStyles)),_f.push(Ni),ln.has(Bi)&&A.push(Ni)}),_f.forEach(xi=>{const Bi=z.get(xi.element);if(Bi&&Bi.length){const Ni=gn(Bi);xi.setRealPlayer(Ni)}}),A.forEach(xi=>{xi.parentPlayer?xi.syncPlayerEvents(xi.parentPlayer):xi.destroy()});for(let xi=0;xi<Fi.length;xi++){const Bi=Fi[xi],Ni=Bi[Co];if(kr(Bi,zt),Ni&&Ni.hasAnimation)continue;let Tr=[];if(_e.size){let Tl=_e.get(Bi);Tl&&Tl.length&&Tr.push(...Tl);let Ns=this.driver.query(Bi,nt,!0);for(let Sl=0;Sl<Ns.length;Sl++){let Xr=_e.get(Ns[Sl]);Xr&&Xr.length&&Tr.push(...Xr)}}const Yo=Tr.filter(Tl=>!Tl.destroyed);Yo.length?Dr(this,Bi,Yo):this.processLeaveNode(Bi)}return Fi.length=0,iu.forEach(xi=>{this.players.push(xi),xi.onDone(()=>{xi.destroy();const Bi=this.players.indexOf(xi);this.players.splice(Bi,1)}),xi.play()}),iu}elementContainsData(y,o){let _=!1;const A=o[Co];return A&&A.setForRemoval&&(_=!0),this.playersByElement.has(o)&&(_=!0),this.playersByQueriedElement.has(o)&&(_=!0),this.statesByElement.has(o)&&(_=!0),this._fetchNamespace(y).elementContainsData(o)||_}afterFlush(y){this._flushFns.push(y)}afterFlushAnimationsDone(y){this._whenQuietFns.push(y)}_getPreviousPlayers(y,o,_,A,z){let ue=[];if(o){const _e=this.playersByQueriedElement.get(y);_e&&(ue=_e)}else{const _e=this.playersByElement.get(y);if(_e){const rt=!z||z==Li;_e.forEach(Lt=>{Lt.queued||!rt&&Lt.triggerName!=A||ue.push(Lt)})}}return(_||A)&&(ue=ue.filter(_e=>!(_&&_!=_e.namespaceId||A&&A!=_e.triggerName))),ue}_beforeAnimationBuild(y,o,_){const z=o.element,ue=o.isRemovalTransition?void 0:y,_e=o.isRemovalTransition?void 0:o.triggerName;for(const rt of o.timelines){const Lt=rt.element,ln=Lt!==z,un=Oi(_,Lt,[]);this._getPreviousPlayers(Lt,ln,ue,_e,o.toState).forEach(yi=>{const si=yi.getRealPlayer();si.beforeDestroy&&si.beforeDestroy(),yi.destroy(),un.push(yi)})}Et(z,o.fromStyles)}_buildAnimation(y,o,_,A,z,ue){const _e=o.triggerName,rt=o.element,Lt=[],ln=new Set,un=new Set,ei=o.timelines.map(si=>{const hi=si.element;ln.add(hi);const Fi=hi[Co];if(Fi&&Fi.removedBeforeQueried)return new Ve.ZN(si.duration,si.delay);const Ki=hi!==rt,Vr=function co(p){const y=[];return il(p,y),y}((_.get(hi)||Ws).map(yo=>yo.getRealPlayer())).filter(yo=>!!yo.element&&yo.element===hi),Ro=z.get(hi),_o=ue.get(hi),Pa=wi(0,this._normalizer,0,si.keyframes,Ro,_o),gs=this._buildPlayer(si,Pa,Vr);if(si.subTimeline&&A&&un.add(hi),Ki){const yo=new Ae(y,_e,hi);yo.setRealPlayer(gs),Lt.push(yo)}return gs});Lt.forEach(si=>{Oi(this.playersByQueriedElement,si.element,[]).push(si),si.onDone(()=>function vt(p,y,o){let _=p.get(y);if(_){if(_.length){const A=_.indexOf(o);_.splice(A,1)}0==_.length&&p.delete(y)}return _}(this.playersByQueriedElement,si.element,si))}),ln.forEach(si=>Vi(si,Ke));const yi=gn(ei);return yi.onDestroy(()=>{ln.forEach(si=>kr(si,Ke)),Ot(rt,o.toStyles)}),un.forEach(si=>{Oi(A,si,[]).push(yi)}),yi}_buildPlayer(y,o,_){return o.length>0?this.driver.animate(y.element,o,y.duration,y.delay,y.easing,_):new Ve.ZN(y.duration,y.delay)}}class Ae{constructor(y,o,_){this.namespaceId=y,this.triggerName=o,this.element=_,this._player=new Ve.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(y){this._containsRealPlayer||(this._player=y,this._queuedCallbacks.forEach((o,_)=>{o.forEach(A=>Ei(y,_,void 0,A))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(y.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(y){this.totalTime=y}syncPlayerEvents(y){const o=this._player;o.triggerCallback&&y.onStart(()=>o.triggerCallback("start")),y.onDone(()=>this.finish()),y.onDestroy(()=>this.destroy())}_queueEvent(y,o){Oi(this._queuedCallbacks,y,[]).push(o)}onDone(y){this.queued&&this._queueEvent("done",y),this._player.onDone(y)}onStart(y){this.queued&&this._queueEvent("start",y),this._player.onStart(y)}onDestroy(y){this.queued&&this._queueEvent("destroy",y),this._player.onDestroy(y)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(y){this.queued||this._player.setPosition(y)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(y){const o=this._player;o.triggerCallback&&o.triggerCallback(y)}}function xn(p){return p&&1===p.nodeType}function wr(p,y){const o=p.style.display;return p.style.display=y??"none",o}function vr(p,y,o,_,A){const z=[];o.forEach(rt=>z.push(wr(rt)));const ue=[];_.forEach((rt,Lt)=>{const ln=new Map;rt.forEach(un=>{const ei=y.computeStyle(Lt,un,A);ln.set(un,ei),(!ei||0==ei.length)&&(Lt[Co]=vo,ue.push(Lt))}),p.set(Lt,ln)});let _e=0;return o.forEach(rt=>wr(rt,z[_e++])),ue}function _r(p,y){const o=new Map;if(p.forEach(_e=>o.set(_e,[])),0==y.length)return o;const A=new Set(y),z=new Map;function ue(_e){if(!_e)return 1;let rt=z.get(_e);if(rt)return rt;const Lt=_e.parentNode;return rt=o.has(Lt)?Lt:A.has(Lt)?1:ue(Lt),z.set(_e,rt),rt}return y.forEach(_e=>{const rt=ue(_e);1!==rt&&o.get(rt).push(_e)}),o}function Vi(p,y){p.classList?.add(y)}function kr(p,y){p.classList?.remove(y)}function Dr(p,y,o){gn(o).onDone(()=>p.processLeaveNode(y))}function il(p,y){for(let o=0;o<p.length;o++){const _=p[o];_ instanceof Ve.ZE?il(_.players,y):y.push(_)}}function ji(p,y,o){const _=o.get(p);if(!_)return!1;let A=y.get(p);return A?_.forEach(z=>A.add(z)):y.set(p,_),o.delete(p),!0}class Eo{constructor(y,o,_){this.bodyNode=y,this._driver=o,this._normalizer=_,this._triggerCache={},this.onRemovalComplete=(A,z)=>{},this._transitionEngine=new J(y,o,_),this._timelineEngine=new Fa(y,o,_),this._transitionEngine.onRemovalComplete=(A,z)=>this.onRemovalComplete(A,z)}registerTrigger(y,o,_,A,z){const ue=y+"-"+A;let _e=this._triggerCache[ue];if(!_e){const rt=[],ln=Xi(this._driver,z,rt,[]);if(rt.length)throw function Bt(p,y){return new d.vHH(3404,!1)}();_e=function _l(p,y,o){return new Al(p,y,o)}(A,ln,this._normalizer),this._triggerCache[ue]=_e}this._transitionEngine.registerTrigger(o,A,_e)}register(y,o){this._transitionEngine.register(y,o)}destroy(y,o){this._transitionEngine.destroy(y,o)}onInsert(y,o,_,A){this._transitionEngine.insertNode(y,o,_,A)}onRemove(y,o,_,A){this._transitionEngine.removeNode(y,o,A||!1,_)}disableAnimations(y,o){this._transitionEngine.markElementAsDisabled(y,o)}process(y,o,_,A){if("@"==_.charAt(0)){const[z,ue]=En(_);this._timelineEngine.command(z,o,ue,A)}else this._transitionEngine.trigger(y,o,_,A)}listen(y,o,_,A,z){if("@"==_.charAt(0)){const[ue,_e]=En(_);return this._timelineEngine.listen(ue,o,_e,z)}return this._transitionEngine.listen(y,o,_,A,z)}flush(y=-1){this._transitionEngine.flush(y)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let qr=(()=>{class p{constructor(o,_,A){this._element=o,this._startStyles=_,this._endStyles=A,this._state=0;let z=p.initialStylesByElement.get(o);z||p.initialStylesByElement.set(o,z=new Map),this._initialStyles=z}start(){this._state<1&&(this._startStyles&&Ot(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ot(this._element,this._initialStyles),this._endStyles&&(Ot(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(p.initialStylesByElement.delete(this._element),this._startStyles&&(Et(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Et(this._element,this._endStyles),this._endStyles=null),Ot(this._element,this._initialStyles),this._state=3)}}return p.initialStylesByElement=new WeakMap,p})();function ol(p){let y=null;return p.forEach((o,_)=>{(function ne(p){return"display"===p||"position"===p})(_)&&(y=y||new Map,y.set(_,o))}),y}class q{constructor(y,o,_,A){this.element=y,this.keyframes=o,this.options=_,this._specialStyles=A,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=_.duration,this._delay=_.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(y=>y()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const y=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,y,this.options),this._finalKeyframe=y.length?y[y.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(y){const o=[];return y.forEach(_=>{o.push(Object.fromEntries(_))}),o}_triggerWebAnimation(y,o,_){return y.animate(this._convertKeyframesToObject(o),_)}onStart(y){this._originalOnStartFns.push(y),this._onStartFns.push(y)}onDone(y){this._originalOnDoneFns.push(y),this._onDoneFns.push(y)}onDestroy(y){this._onDestroyFns.push(y)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(y=>y()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(y=>y()),this._onDestroyFns=[])}setPosition(y){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=y*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const y=new Map;this.hasStarted()&&this._finalKeyframe.forEach((_,A)=>{"offset"!==A&&y.set(A,this._finished?_:br(this.element,A))}),this.currentSnapshot=y}triggerCallback(y){const o="start"===y?this._onStartFns:this._onDoneFns;o.forEach(_=>_()),o.length=0}}class ${validateStyleProperty(y){return!0}validateAnimatableStyleProperty(y){return!0}matchesElement(y,o){return!1}containsElement(y,o){return We(y,o)}getParentElement(y){return K(y)}query(y,o,_){return ht(y,o,_)}computeStyle(y,o,_){return window.getComputedStyle(y)[o]}animate(y,o,_,A,z,ue=[]){const rt={duration:_,delay:A,fill:0==A?"both":"forwards"};z&&(rt.easing=z);const Lt=new Map,ln=ue.filter(yi=>yi instanceof q);(function jn(p,y){return 0===p||0===y})(_,A)&&ln.forEach(yi=>{yi.currentSnapshot.forEach((si,hi)=>Lt.set(hi,si))});let un=function He(p){return p.length?p[0]instanceof Map?p:p.map(y=>Te(y)):[]}(o).map(yi=>Mt(yi));un=function At(p,y,o){if(o.size&&y.length){let _=y[0],A=[];if(o.forEach((z,ue)=>{_.has(ue)||A.push(ue),_.set(ue,z)}),A.length)for(let z=1;z<y.length;z++){let ue=y[z];A.forEach(_e=>ue.set(_e,br(p,_e)))}}return y}(y,un,Lt);const ei=function rl(p,y){let o=null,_=null;return Array.isArray(y)&&y.length?(o=ol(y[0]),y.length>1&&(_=ol(y[y.length-1]))):y instanceof Map&&(o=ol(y)),o||_?new qr(p,o,_):null}(y,un);return new q(y,un,rt,ei)}}var me=j(6895);let cn=(()=>{class p extends Ve._j{constructor(o,_){super(),this._nextAnimationId=0,this._renderer=o.createRenderer(_.body,{id:"0",encapsulation:d.ifc.None,styles:[],data:{animation:[]}})}build(o){const _=this._nextAnimationId.toString();this._nextAnimationId++;const A=Array.isArray(o)?(0,Ve.vP)(o):o;return bs(this._renderer,null,_,"register",[A]),new Ci(_,this._renderer)}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(d.FYo),d.LFG(me.K0))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})();class Ci extends Ve.LC{constructor(y,o){super(),this._id=y,this._renderer=o}create(y,o){return new Ar(this._id,y,o||{},this._renderer)}}class Ar{constructor(y,o,_,A){this.id=y,this.element=o,this._renderer=A,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",_)}_listen(y,o){return this._renderer.listen(this.element,`@@${this.id}:${y}`,o)}_command(y,...o){return bs(this._renderer,this.element,this.id,y,o)}onDone(y){this._listen("done",y)}onStart(y){this._listen("start",y)}onDestroy(y){this._listen("destroy",y)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(y){this._command("setPosition",y)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function bs(p,y,o,_,A){return p.setProperty(y,`@@${o}:${_}`,A)}const us="@.disabled";let ru=(()=>{class p{constructor(o,_,A){this.delegate=o,this.engine=_,this._zone=A,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),_.onRemovalComplete=(z,ue)=>{const _e=ue?.parentNode(z);_e&&ue.removeChild(_e,z)}}createRenderer(o,_){const z=this.delegate.createRenderer(o,_);if(!(o&&_&&_.data&&_.data.animation)){let ln=this._rendererCache.get(z);return ln||(ln=new sl("",z,this.engine),this._rendererCache.set(z,ln)),ln}const ue=_.id,_e=_.id+"-"+this._currentId;this._currentId++,this.engine.register(_e,o);const rt=ln=>{Array.isArray(ln)?ln.forEach(rt):this.engine.registerTrigger(ue,_e,o,ln.name,ln)};return _.data.animation.forEach(rt),new al(this,_e,z,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(o,_,A){o>=0&&o<this._microtaskId?this._zone.run(()=>_(A)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(z=>{const[ue,_e]=z;ue(_e)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([_,A]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(d.FYo),d.LFG(Eo),d.LFG(d.R0b))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})();class sl{constructor(y,o,_){this.namespaceId=y,this.delegate=o,this.engine=_,this.destroyNode=this.delegate.destroyNode?A=>o.destroyNode(A):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(y,o){return this.delegate.createElement(y,o)}createComment(y){return this.delegate.createComment(y)}createText(y){return this.delegate.createText(y)}appendChild(y,o){this.delegate.appendChild(y,o),this.engine.onInsert(this.namespaceId,o,y,!1)}insertBefore(y,o,_,A=!0){this.delegate.insertBefore(y,o,_),this.engine.onInsert(this.namespaceId,o,y,A)}removeChild(y,o,_){this.engine.onRemove(this.namespaceId,o,this.delegate,_)}selectRootElement(y,o){return this.delegate.selectRootElement(y,o)}parentNode(y){return this.delegate.parentNode(y)}nextSibling(y){return this.delegate.nextSibling(y)}setAttribute(y,o,_,A){this.delegate.setAttribute(y,o,_,A)}removeAttribute(y,o,_){this.delegate.removeAttribute(y,o,_)}addClass(y,o){this.delegate.addClass(y,o)}removeClass(y,o){this.delegate.removeClass(y,o)}setStyle(y,o,_,A){this.delegate.setStyle(y,o,_,A)}removeStyle(y,o,_){this.delegate.removeStyle(y,o,_)}setProperty(y,o,_){"@"==o.charAt(0)&&o==us?this.disableAnimations(y,!!_):this.delegate.setProperty(y,o,_)}setValue(y,o){this.delegate.setValue(y,o)}listen(y,o,_){return this.delegate.listen(y,o,_)}disableAnimations(y,o){this.engine.disableAnimations(y,o)}}class al extends sl{constructor(y,o,_,A){super(o,_,A),this.factory=y,this.namespaceId=o}setProperty(y,o,_){"@"==o.charAt(0)?"."==o.charAt(1)&&o==us?this.disableAnimations(y,_=void 0===_||!!_):this.engine.process(this.namespaceId,y,o.slice(1),_):this.delegate.setProperty(y,o,_)}listen(y,o,_){if("@"==o.charAt(0)){const A=function zu(p){switch(p){case"body":return document.body;case"document":return document;case"window":return window;default:return p}}(y);let z=o.slice(1),ue="";return"@"!=z.charAt(0)&&([z,ue]=function Pd(p){const y=p.indexOf(".");return[p.substring(0,y),p.slice(y+1)]}(z)),this.engine.listen(this.namespaceId,A,z,ue,_e=>{this.factory.scheduleListenerCallback(_e._data||-1,_,_e)})}return this.delegate.listen(y,o,_)}}let Ac=(()=>{class p extends Eo{constructor(o,_,A,z){super(o.body,_,A)}ngOnDestroy(){this.flush()}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(me.K0),d.LFG(An),d.LFG(wa),d.LFG(d.z2F))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})();const nc=[{provide:Ve._j,useClass:cn},{provide:wa,useFactory:function Nu(){return new nl}},{provide:Eo,useClass:Ac},{provide:d.FYo,useFactory:function tc(p,y,o){return new ru(p,y,o)},deps:[T.se,Eo,d.R0b]}],Il=[{provide:An,useFactory:()=>new $},{provide:d.QbO,useValue:"BrowserAnimations"},...nc],Pl=[{provide:An,useClass:_n},{provide:d.QbO,useValue:"NoopAnimations"},...nc];let yl=(()=>{class p{static withConfig(o){return{ngModule:p,providers:o.disableAnimations?Pl:Il}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({providers:Il,imports:[T.b2]}),p})();var ds=j(9898);function ic(p,y,o,_,A,z,ue){try{var _e=p[z](ue),rt=_e.value}catch(Lt){return void o(Lt)}_e.done?y(rt):Promise.resolve(rt).then(_,A)}function fo(p){return function(){var y=this,o=arguments;return new Promise(function(_,A){var z=p.apply(y,o);function ue(rt){ic(z,_,A,ue,_e,"next",rt)}function _e(rt){ic(z,_,A,ue,_e,"throw",rt)}ue(void 0)})}}var to=j(7579);class rc extends to.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(y){const{hasError:o,_hasValue:_,_value:A,thrownError:z,isStopped:ue,_isComplete:_e}=this;o?y.error(z):(ue||_e)&&(_&&y.next(A),y.complete())}next(y){this.isStopped||(this._value=y,this._hasValue=!0)}complete(){const{_hasValue:y,_value:o,_isComplete:_}=this;_||(this._isComplete=!0,y&&super.next(o),super.complete())}}var Na=j(727),Qo=j(590);const xs=new d.OlP("MapboxApiKey");let ir=(()=>{class p{constructor(o,_){this.zone=o,this.MAPBOX_API_KEY=_,this.mapCreated=new rc,this.mapLoaded=new rc,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new Na.w0,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(o){this.zone.onStable.pipe((0,Qo.P)()).subscribe(()=>{o.customMapboxApiUrl&&this.assign(ds,"config.API_URL",o.customMapboxApiUrl),this.createMap({...o.mapOptions,accessToken:o.accessToken||this.MAPBOX_API_KEY||""}),this.hookEvents(o.mapEvents),this.mapEvents=o.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateProjection(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setProjection(o)})}updateMinZoom(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(o)})}updateMaxZoom(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(o)})}updateMinPitch(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(o)})}updateMaxPitch(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(o)})}updateRenderWorldCopies(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(o)})}updateScrollZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(o)})}updateMaxBounds(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(o)})}changeCanvasCursor(o){this.mapInstance.getCanvasContainer().style.cursor=o}queryRenderedFeatures(o,_){return this.mapInstance.queryRenderedFeatures(o,_)}panTo(o,_){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(o,_)})}move(o,_,A,z,ue,_e){return this.zone.runOutsideAngular(()=>{this.mapInstance[o]({..._,zoom:A??this.mapInstance.getZoom(),center:z??this.mapInstance.getCenter(),bearing:ue??this.mapInstance.getBearing(),pitch:_e??this.mapInstance.getPitch()})})}addLayer(o,_,A){this.zone.runOutsideAngular(()=>{Object.keys(o.layerOptions).forEach(z=>{void 0===o.layerOptions[z]&&delete o.layerOptions[z]}),this.mapInstance.addLayer(o.layerOptions,A),_&&((o.layerEvents.layerClick.observed||o.layerEvents.click.observed)&&this.mapInstance.on("click",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerClick.emit(z),o.layerEvents.click.emit(z)})}),(o.layerEvents.layerDblClick.observed||o.layerEvents.dblClick.observed)&&this.mapInstance.on("dblclick",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerDblClick.emit(z),o.layerEvents.dblClick.emit(z)})}),(o.layerEvents.layerMouseDown.observed||o.layerEvents.mouseDown.observed)&&this.mapInstance.on("mousedown",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseDown.emit(z),o.layerEvents.mouseDown.emit(z)})}),(o.layerEvents.layerMouseUp.observed||o.layerEvents.mouseUp.observed)&&this.mapInstance.on("mouseup",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseUp.emit(z),o.layerEvents.mouseUp.emit(z)})}),(o.layerEvents.layerMouseEnter.observed||o.layerEvents.mouseEnter.observed)&&this.mapInstance.on("mouseenter",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseEnter.emit(z),o.layerEvents.mouseEnter.emit(z)})}),(o.layerEvents.layerMouseLeave.observed||o.layerEvents.mouseLeave.observed)&&this.mapInstance.on("mouseleave",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseLeave.emit(z),o.layerEvents.mouseLeave.emit(z)})}),(o.layerEvents.layerMouseMove.observed||o.layerEvents.mouseMove.observed)&&this.mapInstance.on("mousemove",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseMove.emit(z),o.layerEvents.mouseMove.emit(z)})}),(o.layerEvents.layerMouseOver.observed||o.layerEvents.mouseOver.observed)&&this.mapInstance.on("mouseover",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseOver.emit(z),o.layerEvents.mouseOver.emit(z)})}),(o.layerEvents.layerMouseOut.observed||o.layerEvents.mouseOut.observed)&&this.mapInstance.on("mouseout",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerMouseOut.emit(z),o.layerEvents.mouseOut.emit(z)})}),(o.layerEvents.layerContextMenu.observed||o.layerEvents.contextMenu.observed)&&this.mapInstance.on("contextmenu",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerContextMenu.emit(z),o.layerEvents.contextMenu.emit(z)})}),(o.layerEvents.layerTouchStart.observed||o.layerEvents.touchStart.observed)&&this.mapInstance.on("touchstart",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerTouchStart.emit(z),o.layerEvents.touchStart.emit(z)})}),(o.layerEvents.layerTouchEnd.observed||o.layerEvents.touchEnd.observed)&&this.mapInstance.on("touchend",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerTouchEnd.emit(z),o.layerEvents.touchEnd.emit(z)})}),(o.layerEvents.layerTouchCancel.observed||o.layerEvents.touchCancel.observed)&&this.mapInstance.on("touchcancel",o.layerOptions.id,z=>{this.zone.run(()=>{o.layerEvents.layerTouchCancel.emit(z),o.layerEvents.touchCancel.emit(z)})}))})}removeLayer(o){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(o)&&this.mapInstance.removeLayer(o)})}addMarker(o){const _={offset:o.markersOptions.offset,anchor:o.markersOptions.anchor,draggable:!!o.markersOptions.draggable,rotationAlignment:o.markersOptions.rotationAlignment,pitchAlignment:o.markersOptions.pitchAlignment,clickTolerance:o.markersOptions.clickTolerance};o.markersOptions.element.childNodes.length>0&&(_.element=o.markersOptions.element);const A=new ds.Marker(_);return(o.markersEvents.markerDragStart.observed||o.markersEvents.dragStart.observed)&&A.on("dragstart",ue=>{if(ue){const{target:_e}=ue;this.zone.run(()=>{o.markersEvents.markerDragStart.emit(_e),o.markersEvents.dragStart.emit(_e)})}}),(o.markersEvents.markerDrag.observed||o.markersEvents.drag.observed)&&A.on("drag",ue=>{if(ue){const{target:_e}=ue;this.zone.run(()=>{o.markersEvents.markerDrag.emit(_e),o.markersEvents.drag.emit(_e)})}}),(o.markersEvents.markerDragEnd.observed||o.markersEvents.dragEnd.observed)&&A.on("dragend",ue=>{if(ue){const{target:_e}=ue;this.zone.run(()=>{o.markersEvents.markerDragEnd.emit(_e),o.markersEvents.dragEnd.emit(_e)})}}),A.setLngLat(o.markersOptions.feature?o.markersOptions.feature.geometry.coordinates:o.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(A.addTo(this.mapInstance),A))}removeMarker(o){this.markersToRemove.push(o)}createPopup(o,_){return this.zone.runOutsideAngular(()=>{Object.keys(o.popupOptions).forEach(z=>void 0===o.popupOptions[z]&&delete o.popupOptions[z]);const A=new ds.Popup(o.popupOptions);return A.setDOMContent(_),(o.popupEvents.popupClose.observed||o.popupEvents.close.observed)&&A.on("close",()=>{this.zone.run(()=>{o.popupEvents.popupClose.emit(),o.popupEvents.close.emit()})}),(o.popupEvents.popupOpen.observed||o.popupEvents.open.observed)&&A.on("open",()=>{this.zone.run(()=>{o.popupEvents.popupOpen.emit(),o.popupEvents.open.emit()})}),A})}addPopupToMap(o,_,A=!1){return this.zone.runOutsideAngular(()=>{A&&o._listeners&&delete o._listeners.open,o.setLngLat(_),o.addTo(this.mapInstance)})}addPopupToMarker(o,_){return this.zone.runOutsideAngular(()=>{o.setPopup(_)})}removePopupFromMap(o,_=!1){_&&o._listeners&&delete o._listeners.close,this.popupsToRemove.push(o)}removePopupFromMarker(o){return this.zone.runOutsideAngular(()=>{o.setPopup(void 0)})}addControl(o,_){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(o,_)})}removeControl(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(o)})}loadAndAddImage(o,_,A){var z=this;return fo(function*(){return z.zone.runOutsideAngular(()=>new Promise((ue,_e)=>{z.mapInstance.loadImage(_,(rt,Lt)=>{rt?_e(rt):(z.addImage(o,Lt,A),ue())})}))})()}addImage(o,_,A){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(o,_,A)})}removeImage(o){this.imageIdsToRemove.push(o)}addSource(o,_){return this.zone.runOutsideAngular(()=>{Object.keys(_).forEach(A=>void 0===_[A]&&delete _[A]),this.mapInstance.addSource(o,_)})}getSource(o){return this.mapInstance.getSource(o)}removeSource(o){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(o).forEach(_=>this.mapInstance.removeLayer(_.id)),this.mapInstance.removeSource(o)})}setAllLayerPaintProperty(o,_){return this.zone.runOutsideAngular(()=>{Object.keys(_).forEach(A=>{this.mapInstance.setPaintProperty(o,A,_[A])})})}setAllLayerLayoutProperty(o,_){return this.zone.runOutsideAngular(()=>{Object.keys(_).forEach(A=>{this.mapInstance.setLayoutProperty(o,A,_[A])})})}setLayerFilter(o,_){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(o,_)})}setLayerBefore(o,_){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(o,_)})}setLayerZoomRange(o,_,A){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(o,_||0,A||20)})}fitBounds(o,_){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(o,_)})}fitScreenCoordinates(o,_,A){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(o[0],o[1],_,A)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(o){d.R0b.assertNotInAngularZone(),Object.keys(o).forEach(A=>{void 0===o[A]&&delete o[A]}),this.mapInstance=new ds.Map(o),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(o.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const o of this.markersToRemove)o.remove();this.markersToRemove=[]}removePopups(){for(const o of this.popupsToRemove)o.remove();this.popupsToRemove=[]}removeImages(){for(const o of this.imageIdsToRemove)this.mapInstance.removeImage(o);this.imageIdsToRemove=[]}findLayersBySourceId(o){const _=this.mapInstance.getStyle().layers;return null==_?[]:_.filter(A=>"source"in A&&A.source===o)}hookEvents(o){this.mapInstance.on("load",_=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{o.mapLoad.emit(_.target),o.load.emit(_.target)})}),(o.mapResize.observed||o.resize.observed)&&this.mapInstance.on("resize",_=>this.zone.run(()=>{o.mapResize.emit(_),o.resize.emit(_)})),(o.mapRemove.observed||o.remove.observed)&&this.mapInstance.on("remove",_=>this.zone.run(()=>{o.mapRemove.emit(_),o.remove.emit(_)})),(o.mapMouseDown.observed||o.mouseDown.observed)&&this.mapInstance.on("mousedown",_=>this.zone.run(()=>{o.mapMouseDown.emit(_),o.mouseDown.emit(_)})),(o.mapMouseUp.observed||o.mouseUp.observed)&&this.mapInstance.on("mouseup",_=>this.zone.run(()=>{o.mapMouseUp.emit(_),o.mouseUp.emit(_)})),(o.mapMouseMove.observed||o.mouseMove.observed)&&this.mapInstance.on("mousemove",_=>this.zone.run(()=>{o.mapMouseMove.emit(_),o.mouseMove.emit(_)})),(o.mapClick.observed||o.click.observed)&&this.mapInstance.on("click",_=>this.zone.run(()=>{o.mapClick.emit(_),o.click.emit(_)})),(o.mapDblClick.observed||o.dblClick.observed)&&this.mapInstance.on("dblclick",_=>this.zone.run(()=>{o.mapDblClick.emit(_),o.dblClick.emit(_)})),(o.mapMouseOver.observed||o.mouseOver.observed)&&this.mapInstance.on("mouseover",_=>this.zone.run(()=>{o.mapMouseOver.emit(_),o.mouseOver.emit(_)})),(o.mapMouseOut.observed||o.mouseOut.observed)&&this.mapInstance.on("mouseout",_=>this.zone.run(()=>{o.mapMouseOut.emit(_),o.mouseOut.emit(_)})),(o.mapContextMenu.observed||o.contextMenu.observed)&&this.mapInstance.on("contextmenu",_=>this.zone.run(()=>{o.mapContextMenu.emit(_),o.contextMenu.emit(_)})),(o.mapTouchStart.observed||o.touchStart.observed)&&this.mapInstance.on("touchstart",_=>this.zone.run(()=>{o.mapTouchStart.emit(_),o.touchStart.emit(_)})),(o.mapTouchEnd.observed||o.touchEnd.observed)&&this.mapInstance.on("touchend",_=>this.zone.run(()=>{o.mapTouchEnd.emit(_),o.touchEnd.emit(_)})),(o.mapTouchMove.observed||o.touchMove.observed)&&this.mapInstance.on("touchmove",_=>this.zone.run(()=>{o.mapTouchMove.emit(_),o.touchMove.emit(_)})),(o.mapTouchCancel.observed||o.touchCancel.observed)&&this.mapInstance.on("touchcancel",_=>this.zone.run(()=>{o.mapTouchCancel.emit(_),o.touchCancel.emit(_)})),(o.mapWheel.observed||o.wheel.observed)&&this.mapInstance.on("wheel",_=>this.zone.run(()=>{o.mapWheel.emit(_),o.wheel.emit(_)})),o.moveStart.observed&&this.mapInstance.on("movestart",_=>this.zone.run(()=>o.moveStart.emit(_))),o.move.observed&&this.mapInstance.on("move",_=>this.zone.run(()=>o.move.emit(_))),o.moveEnd.observed&&this.mapInstance.on("moveend",_=>this.zone.run(()=>o.moveEnd.emit(_))),(o.mapDragStart.observed||o.dragStart.observed)&&this.mapInstance.on("dragstart",_=>this.zone.run(()=>{o.mapDragStart.emit(_),o.dragStart.emit(_)})),(o.mapDrag.observed||o.drag.observed)&&this.mapInstance.on("drag",_=>this.zone.run(()=>{o.mapDrag.emit(_),o.drag.emit(_)})),(o.mapDragEnd.observed||o.dragEnd.observed)&&this.mapInstance.on("dragend",_=>this.zone.run(()=>{o.mapDragEnd.emit(_),o.dragEnd.emit(_)})),o.zoomStart.observed&&this.mapInstance.on("zoomstart",_=>this.zone.run(()=>o.zoomStart.emit(_))),o.zoomEvt.observed&&this.mapInstance.on("zoom",_=>this.zone.run(()=>o.zoomEvt.emit(_))),o.zoomEnd.observed&&this.mapInstance.on("zoomend",_=>this.zone.run(()=>o.zoomEnd.emit(_))),o.rotateStart.observed&&this.mapInstance.on("rotatestart",_=>this.zone.run(()=>o.rotateStart.emit(_))),o.rotate.observed&&this.mapInstance.on("rotate",_=>this.zone.run(()=>o.rotate.emit(_))),o.rotateEnd.observed&&this.mapInstance.on("rotateend",_=>this.zone.run(()=>o.rotateEnd.emit(_))),o.pitchStart.observed&&this.mapInstance.on("pitchstart",_=>this.zone.run(()=>o.pitchStart.emit(_))),o.pitchEvt.observed&&this.mapInstance.on("pitch",_=>this.zone.run(()=>o.pitchEvt.emit(_))),o.pitchEnd.observed&&this.mapInstance.on("pitchend",_=>this.zone.run(()=>o.pitchEnd.emit(_))),o.boxZoomStart.observed&&this.mapInstance.on("boxzoomstart",_=>this.zone.run(()=>o.boxZoomStart.emit(_))),o.boxZoomEnd.observed&&this.mapInstance.on("boxzoomend",_=>this.zone.run(()=>o.boxZoomEnd.emit(_))),o.boxZoomCancel.observed&&this.mapInstance.on("boxzoomcancel",_=>this.zone.run(()=>o.boxZoomCancel.emit(_))),o.webGlContextLost.observed&&this.mapInstance.on("webglcontextlost",_=>this.zone.run(()=>o.webGlContextLost.emit(_))),o.webGlContextRestored.observed&&this.mapInstance.on("webglcontextrestored",_=>this.zone.run(()=>o.webGlContextRestored.emit(_))),o.render.observed&&this.mapInstance.on("render",_=>this.zone.run(()=>o.render.emit(_))),(o.mapError.observed||o.error.observed)&&this.mapInstance.on("error",_=>this.zone.run(()=>{o.mapError.emit(_),o.error.emit(_)})),o.data.observed&&this.mapInstance.on("data",_=>this.zone.run(()=>o.data.emit(_))),o.styleData.observed&&this.mapInstance.on("styledata",_=>this.zone.run(()=>o.styleData.emit(_))),o.sourceData.observed&&this.mapInstance.on("sourcedata",_=>this.zone.run(()=>o.sourceData.emit(_))),o.dataLoading.observed&&this.mapInstance.on("dataloading",_=>this.zone.run(()=>o.dataLoading.emit(_))),o.styleDataLoading.observed&&this.mapInstance.on("styledataloading",_=>this.zone.run(()=>o.styleDataLoading.emit(_))),o.sourceDataLoading.observed&&this.mapInstance.on("sourcedataloading",_=>this.zone.run(()=>o.sourceDataLoading.emit(_))),o.styleImageMissing.observed&&this.mapInstance.on("styleimagemissing",_=>this.zone.run(()=>o.styleImageMissing.emit(_))),o.idle.observed&&this.mapInstance.on("idle",_=>this.zone.run(()=>o.idle.emit(_)))}assign(o,_,A){if("string"==typeof _&&(_=_.split(".")),_.length>1){const z=_.shift();this.assign(o[z]="[object Object]"===Object.prototype.toString.call(o[z])?o[z]:{},_,A)}else o[_[0]]=A}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(d.R0b),d.LFG(xs,8))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})();const ou=["content"],Uu=["*"];class Ic{constructor(y){this.container=y}onAdd(){return this.container}onRemove(){return this.container.parentNode.removeChild(this.container)}getDefaultPosition(){return"top-right"}}let zo=(()=>{class p{constructor(o){this.mapService=o,this.controlAdded=!1}ngAfterContentInit(){this.content.nativeElement.childNodes.length&&(this.control=new Ic(this.content.nativeElement),this.mapService.mapCreated$.subscribe(()=>{this.mapService.addControl(this.control,this.position),this.controlAdded=!0}))}ngOnDestroy(){this.controlAdded&&this.mapService.removeControl(this.control)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-control"]],viewQuery:function(o,_){if(1&o&&d.Gf(ou,7),2&o){let A;d.iGM(A=d.CRH())&&(_.content=A.first)}},inputs:{position:"position"},ngContentSelectors:Uu,decls:3,vars:0,consts:[[1,"mapboxgl-ctrl"],["content",""]],template:function(o,_){1&o&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA())},encapsulation:2,changeDetection:0}),p})(),ll=(()=>{class p{constructor(o,_){this.mapService=o,this.controlComponent=_}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const o={};void 0!==this.compact&&(o.compact=this.compact),void 0!==this.customAttribution&&(o.customAttribution=this.customAttribution),this.controlComponent.control=new ds.AttributionControl(o),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(zo,1))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglAttribution",""]],inputs:{compact:"compact",customAttribution:"customAttribution"}}),p})(),Va=(()=>{class p{constructor(o,_){this.mapService=o,this.controlComponent=_}onFullscreen(){this.mapService.mapInstance.resize()}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");this.controlComponent.control=new ds.FullscreenControl({container:this.container}),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(zo,1))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglFullscreen",""]],hostBindings:function(o,_){1&o&&d.NdJ("webkitfullscreenchange",function(z){return _.onFullscreen(z.target)},!1,d.Jf7)},inputs:{container:"container"}}),p})(),Ol=(()=>{class p{constructor(o,_){this.mapService=o,this.controlComponent=_,this.geolocate=new d.vpe}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const o={positionOptions:this.positionOptions,fitBoundsOptions:this.fitBoundsOptions,trackUserLocation:this.trackUserLocation,showUserLocation:this.showUserLocation,showUserHeading:this.showUserHeading};Object.keys(o).forEach(_=>{void 0===o[_]&&delete o[_]}),this.controlComponent.control=new ds.GeolocateControl(o),this.controlComponent.control.on("geolocate",_=>{this.geolocate.emit(_)}),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(zo,1))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglGeolocate",""]],inputs:{positionOptions:"positionOptions",fitBoundsOptions:"fitBoundsOptions",trackUserLocation:"trackUserLocation",showUserLocation:"showUserLocation",showUserHeading:"showUserHeading"},outputs:{geolocate:"geolocate"}}),p})(),Ea=(()=>{class p{constructor(o,_){this.mapService=o,this.controlComponent=_}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const o={};void 0!==this.showCompass&&(o.showCompass=this.showCompass),void 0!==this.showZoom&&(o.showZoom=this.showZoom),this.controlComponent.control=new ds.NavigationControl(o),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(zo,1))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglNavigation",""]],inputs:{showCompass:"showCompass",showZoom:"showZoom"}}),p})(),Ma=(()=>{class p{constructor(o,_){this.mapService=o,this.controlComponent=_}ngOnChanges(o){o.unit&&!o.unit.isFirstChange()&&this.controlComponent.control.setUnit(o.unit.currentValue)}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const o={};void 0!==this.maxWidth&&(o.maxWidth=this.maxWidth),void 0!==this.unit&&(o.unit=this.unit),this.controlComponent.control=new ds.ScaleControl(o),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(zo,1))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglScale",""]],inputs:{maxWidth:"maxWidth",unit:"unit"},features:[d.TTD]}),p})();var ws=j(4968),Zo=j(9300),cr=j(8505),Mo=j(3900),Rr=j(2722),Pc=j(5698),Cs=j(9718),ha=j(8675);const Os=(p,y,o)=>{console.warn(`[ngx-mapbox-gl]: ${p}: ${y} is deprecated, please use ${o} instead.`)};let bo=(()=>{class p{constructor(o){this.mapService=o,this.layerClick=new d.vpe,this.layerDblClick=new d.vpe,this.layerMouseDown=new d.vpe,this.layerMouseUp=new d.vpe,this.layerMouseEnter=new d.vpe,this.layerMouseLeave=new d.vpe,this.layerMouseMove=new d.vpe,this.layerMouseOver=new d.vpe,this.layerMouseOut=new d.vpe,this.layerContextMenu=new d.vpe,this.layerTouchStart=new d.vpe,this.layerTouchEnd=new d.vpe,this.layerTouchCancel=new d.vpe,this.click=new d.vpe,this.dblClick=new d.vpe,this.mouseDown=new d.vpe,this.mouseUp=new d.vpe,this.mouseEnter=new d.vpe,this.mouseLeave=new d.vpe,this.mouseMove=new d.vpe,this.mouseOver=new d.vpe,this.mouseOut=new d.vpe,this.contextMenu=new d.vpe,this.touchStart=new d.vpe,this.touchEnd=new d.vpe,this.touchCancel=new d.vpe,this.layerAdded=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.mapService.mapLoaded$.pipe((0,Mo.w)(()=>(0,ws.R)(this.mapService.mapInstance,"styledata").pipe((0,Cs.h)(!1),(0,Zo.h)(()=>!this.mapService.mapInstance.getLayer(this.id)),(0,ha.O)(!0)))).subscribe(o=>this.init(o))}ngOnChanges(o){!this.layerAdded||(o.paint&&!o.paint.isFirstChange()&&this.mapService.setAllLayerPaintProperty(this.id,o.paint.currentValue),o.layout&&!o.layout.isFirstChange()&&this.mapService.setAllLayerLayoutProperty(this.id,o.layout.currentValue),o.filter&&!o.filter.isFirstChange()&&this.mapService.setLayerFilter(this.id,o.filter.currentValue),o.before&&!o.before.isFirstChange()&&this.mapService.setLayerBefore(this.id,o.before.currentValue),(o.minzoom&&!o.minzoom.isFirstChange()||o.maxzoom&&!o.maxzoom.isFirstChange())&&this.mapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&this.mapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()}init(o){this.mapService.addLayer({layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}},o,this.before),this.layerAdded=!0}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.click.observed&&o("click","layerClick"),this.dblClick.observed&&o("dblClick","layerDblClick"),this.mouseDown.observed&&o("mouseDown","layerMouseDown"),this.mouseUp.observed&&o("mouseUp","layerMouseUp"),this.mouseEnter.observed&&o("mouseEnter","layerMouseEnter"),this.mouseLeave.observed&&o("mouseLeave","layerMouseLeave"),this.mouseMove.observed&&o("mouseMove","layerMouseMove"),this.mouseOver.observed&&o("mouseOver","layerMouseOver"),this.mouseOut.observed&&o("mouseOut","layerMouseOut"),this.contextMenu.observed&&o("contextMenu","layerContextMenu"),this.touchStart.observed&&o("touchStart","layerTouchStart"),this.touchEnd.observed&&o("touchEnd","layerTouchEnd"),this.touchCancel.observed&&o("touchCancel","layerTouchCancel")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel",click:"click",dblClick:"dblClick",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchCancel:"touchCancel"},features:[d.TTD],decls:0,vars:0,template:function(o,_){},encapsulation:2}),p})();var ju=j(8372);let qs=(()=>{class p{constructor(o,_){this.mapService=o,this.zone=_,this.updateFeatureData=new to.x,this.sub=new Na.w0,this.sourceAdded=!1,this.featureIdCounter=0}ngOnInit(){this.data||(this.data={type:"FeatureCollection",features:[]});const o=this.mapService.mapLoaded$.subscribe(()=>{this.init();const _=(0,ws.R)(this.mapService.mapInstance,"styledata").pipe((0,Zo.h)(()=>!this.mapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(_)});this.sub.add(o)}ngOnChanges(o){if(this.sourceAdded&&((o.maxzoom&&!o.maxzoom.isFirstChange()||o.attribution&&!o.attribution.isFirstChange()||o.buffer&&!o.buffer.isFirstChange()||o.tolerance&&!o.tolerance.isFirstChange()||o.cluster&&!o.cluster.isFirstChange()||o.clusterRadius&&!o.clusterRadius.isFirstChange()||o.clusterMaxZoom&&!o.clusterMaxZoom.isFirstChange()||o.clusterMinPoints&&!o.clusterMinPoints.isFirstChange()||o.clusterProperties&&!o.clusterProperties.isFirstChange()||o.lineMetrics&&!o.lineMetrics.isFirstChange()||o.generateId&&!o.generateId.isFirstChange()||o.promoteId&&!o.promoteId.isFirstChange()||o.filter&&!o.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),o.data&&!o.data.isFirstChange())){const _=this.mapService.getSource(this.id);if(void 0===_)return;_.setData(this.data)}}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.mapService.removeSource(this.id),this.sourceAdded=!1)}getClusterExpansionZoom(o){var _=this;return fo(function*(){const A=_.mapService.getSource(_.id);return _.zone.run(fo(function*(){return new Promise((z,ue)=>{A.getClusterExpansionZoom(o,(_e,rt)=>{_e?ue(_e):z(rt)})})}))})()}getClusterChildren(o){var _=this;return fo(function*(){const A=_.mapService.getSource(_.id);return _.zone.run(fo(function*(){return new Promise((z,ue)=>{A.getClusterChildren(o,(_e,rt)=>{_e?ue(_e):z(rt)})})}))})()}getClusterLeaves(o,_,A){var z=this;return fo(function*(){const ue=z.mapService.getSource(z.id);return z.zone.run(fo(function*(){return new Promise((_e,rt)=>{ue.getClusterLeaves(o,_,A,(Lt,ln)=>{Lt?rt(Lt):_e(ln)})})}))})()}_addFeature(o){this.data.features.push(o),this.updateFeatureData.next(null)}_removeFeature(o){const _=this.data,A=_.features.indexOf(o);A>-1&&_.features.splice(A,1),this.updateFeatureData.next(null)}_getNewFeatureId(){return++this.featureIdCounter}init(){this.mapService.addSource(this.id,{type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter});const _=this.updateFeatureData.pipe((0,ju.b)(0)).subscribe(()=>{const A=this.mapService.getSource(this.id);void 0!==A&&A.setData(this.data)});this.sub.add(_),this.sourceAdded=!0}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(d.R0b))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-geojson-source"]],inputs:{id:"id",data:"data",maxzoom:"maxzoom",attribution:"attribution",buffer:"buffer",tolerance:"tolerance",cluster:"cluster",clusterRadius:"clusterRadius",clusterMaxZoom:"clusterMaxZoom",clusterMinPoints:"clusterMinPoints",clusterProperties:"clusterProperties",lineMetrics:"lineMetrics",generateId:"generateId",promoteId:"promoteId",filter:"filter"},features:[d.TTD],decls:0,vars:0,template:function(o,_){},encapsulation:2,changeDetection:0}),p})(),vl=(()=>{class p{constructor(o){this.GeoJSONSourceComponent=o,this.type="Feature"}ngOnInit(){this.id||(this.id=this.GeoJSONSourceComponent._getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent._addFeature(this.feature)}ngOnDestroy(){this.GeoJSONSourceComponent._removeFeature(this.feature)}updateCoordinates(o){this.feature.geometry.coordinates=o,this.GeoJSONSourceComponent.updateFeatureData.next(null)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36((0,d.Gpc)(()=>qs)))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-feature"]],inputs:{id:"id",geometry:"geometry",properties:"properties"},decls:0,vars:0,template:function(o,_){},encapsulation:2,changeDetection:0}),p})(),Ua=(()=>{class p{constructor(o,_,A){this.mapService=o,this.ngZone=_,this.featureComponent=A,this.featureDragStart=new d.vpe,this.featureDragEnd=new d.vpe,this.featureDrag=new d.vpe,this.dragStart=new d.vpe,this.dragEnd=new d.vpe,this.drag=new d.vpe,this.sub=new Na.w0}ngOnInit(){let o,_,A;if(this.warnDeprecatedOutputs(),!this.featureComponent||!this.layer)throw new Error("mglDraggable can only be used on Feature (with a layer as input) or Marker");if(o=this.layer.layerMouseEnter,_=this.layer.layerMouseLeave,A=this.featureComponent.updateCoordinates.bind(this.featureComponent),"Point"!==this.featureComponent.geometry.type)throw new Error("mglDraggable only support point feature");this.handleDraggable(o,_,A)}ngOnDestroy(){this.sub.unsubscribe()}handleDraggable(o,_,A){let z=!1,ue=!1;this.mapService.mapCreated$.subscribe(()=>{const _e=(0,ws.R)(this.mapService.mapInstance,"mouseup"),rt=o.pipe((0,Zo.h)(()=>!z),(0,Zo.h)(un=>this.filterFeature(un)),(0,cr.b)(()=>{ue=!0,this.mapService.changeCanvasCursor("move"),this.mapService.updateDragPan(!1)}),(0,Mo.w)(()=>(0,ws.R)(this.mapService.mapInstance,"mousedown").pipe((0,Rr.R)(_)))),Lt=rt.pipe((0,Mo.w)(()=>(0,ws.R)(this.mapService.mapInstance,"mousemove").pipe((0,Rr.R)(_e)))),ln=rt.pipe((0,Mo.w)(()=>_e.pipe((0,Pc.q)(1))));this.sub.add(rt.subscribe(un=>{z=!0,(this.featureDragStart.observed||this.dragStart.observed)&&this.ngZone.run(()=>{this.featureDragStart.emit(un),this.dragStart.emit(un)})})),this.sub.add(Lt.subscribe(un=>{A([un.lngLat.lng,un.lngLat.lat]),(this.featureDrag.observed||this.drag.observed)&&this.ngZone.run(()=>{this.featureDrag.emit(un),this.drag.emit(un)})})),this.sub.add(ln.subscribe(un=>{z=!1,(this.featureDragEnd.observed||this.dragEnd.observed)&&this.ngZone.run(()=>{this.featureDragEnd.emit(un),this.dragEnd.emit(un)}),ue||(this.mapService.changeCanvasCursor(""),this.mapService.updateDragPan(!0))})),this.sub.add(_.pipe((0,cr.b)(()=>ue=!1),(0,Zo.h)(()=>!z)).subscribe(()=>{this.mapService.changeCanvasCursor(""),this.mapService.updateDragPan(!0)}))})}filterFeature(o){return!(this.featureComponent&&this.layer&&!this.mapService.queryRenderedFeatures(o.point,{layers:[this.layer.id],filter:["all",["==","$type","Point"],["==","$id",this.featureComponent.id]]})[0])}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.dragStart.observed&&o("dragStart","featureDragStart"),this.dragEnd.observed&&o("dragEnd","featureDragEnd"),this.drag.observed&&o("drag","featureDrag")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(d.R0b),d.Y36(vl,9))},p.\u0275dir=d.lG2({type:p,selectors:[["","mglDraggable",""]],inputs:{layer:["mglDraggable","layer"]},outputs:{featureDragStart:"featureDragStart",featureDragEnd:"featureDragEnd",featureDrag:"featureDrag",dragStart:"dragStart",dragEnd:"dragEnd",drag:"drag"}}),p})(),kl=(()=>{class p{constructor(o,_){this.mapService=o,this.zone=_,this.imageError=new d.vpe,this.imageLoaded=new d.vpe,this.error=new d.vpe,this.loaded=new d.vpe,this.isAdded=!1,this.isAdding=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.mapService.mapLoaded$.pipe((0,Mo.w)(()=>(0,ws.R)(this.mapService.mapInstance,"styledata").pipe((0,ha.O)(void 0),(0,Zo.h)(()=>!this.isAdding&&!this.mapService.mapInstance.hasImage(this.id))))).subscribe(()=>this.init())}ngOnChanges(o){(o.data&&!o.data.isFirstChange()||o.options&&!o.options.isFirstChange()||o.url&&!o.url.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())}ngOnDestroy(){this.isAdded&&this.mapService.removeImage(this.id),this.sub&&this.sub.unsubscribe()}init(){var o=this;return fo(function*(){if(o.isAdding=!0,o.data)o.mapService.addImage(o.id,o.data,o.options),o.isAdded=!0,o.isAdding=!1;else if(o.url)try{yield o.mapService.loadAndAddImage(o.id,o.url,o.options),o.isAdded=!0,o.isAdding=!1,o.zone.run(()=>{o.imageLoaded.emit(),o.loaded.emit()})}catch(_){o.zone.run(()=>{o.imageError.emit(_),o.error.emit(_)})}})()}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.error.observed&&o("error","imageError"),this.loaded.observed&&o("loaded","imageLoaded")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(d.R0b))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-image"]],inputs:{id:"id",data:"data",options:"options",url:"url"},outputs:{imageError:"imageError",imageLoaded:"imageLoaded",error:"error",loaded:"loaded"},features:[d.TTD],decls:0,vars:0,template:function(o,_){},encapsulation:2}),p})();var oc=j(6805);const sc=["container"];let zi=(()=>{class p{constructor(o){this.mapService=o,this.movingMethod="flyTo",this.mapResize=new d.vpe,this.mapRemove=new d.vpe,this.mapMouseDown=new d.vpe,this.mapMouseUp=new d.vpe,this.mapMouseMove=new d.vpe,this.mapClick=new d.vpe,this.mapDblClick=new d.vpe,this.mapMouseOver=new d.vpe,this.mapMouseOut=new d.vpe,this.mapContextMenu=new d.vpe,this.mapTouchStart=new d.vpe,this.mapTouchEnd=new d.vpe,this.mapTouchMove=new d.vpe,this.mapTouchCancel=new d.vpe,this.mapWheel=new d.vpe,this.moveStart=new d.vpe,this.move=new d.vpe,this.moveEnd=new d.vpe,this.mapDragStart=new d.vpe,this.mapDrag=new d.vpe,this.mapDragEnd=new d.vpe,this.zoomStart=new d.vpe,this.zoomEvt=new d.vpe,this.zoomEnd=new d.vpe,this.rotateStart=new d.vpe,this.rotate=new d.vpe,this.rotateEnd=new d.vpe,this.pitchStart=new d.vpe,this.pitchEvt=new d.vpe,this.pitchEnd=new d.vpe,this.boxZoomStart=new d.vpe,this.boxZoomEnd=new d.vpe,this.boxZoomCancel=new d.vpe,this.webGlContextLost=new d.vpe,this.webGlContextRestored=new d.vpe,this.mapLoad=new d.vpe,this.idle=new d.vpe,this.render=new d.vpe,this.mapError=new d.vpe,this.data=new d.vpe,this.styleData=new d.vpe,this.sourceData=new d.vpe,this.dataLoading=new d.vpe,this.styleDataLoading=new d.vpe,this.sourceDataLoading=new d.vpe,this.styleImageMissing=new d.vpe,this.resize=new d.vpe,this.remove=new d.vpe,this.mouseDown=new d.vpe,this.mouseUp=new d.vpe,this.mouseMove=new d.vpe,this.click=new d.vpe,this.dblClick=new d.vpe,this.mouseOver=new d.vpe,this.mouseOut=new d.vpe,this.contextMenu=new d.vpe,this.touchStart=new d.vpe,this.touchEnd=new d.vpe,this.touchMove=new d.vpe,this.touchCancel=new d.vpe,this.wheel=new d.vpe,this.dragStart=new d.vpe,this.drag=new d.vpe,this.dragEnd=new d.vpe,this.load=new d.vpe,this.error=new d.vpe}get mapInstance(){return this.mapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.mapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale,projection:this.projection},mapEvents:this}),this.cursorStyle&&this.mapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.mapService.destroyMap()}ngOnChanges(o){var _=this;return fo(function*(){yield function Rl(p,y){const o="object"==typeof y;return new Promise((_,A)=>{let ue,z=!1;p.subscribe({next:_e=>{ue=_e,z=!0},error:A,complete:()=>{z?_(ue):o?_(y.defaultValue):A(new oc.K)}})})}(_.mapService.mapCreated$),o.cursorStyle&&!o.cursorStyle.isFirstChange()&&_.mapService.changeCanvasCursor(o.cursorStyle.currentValue),o.projection&&!o.projection.isFirstChange()&&_.mapService.updateProjection(o.projection.currentValue),o.minZoom&&!o.minZoom.isFirstChange()&&_.mapService.updateMinZoom(o.minZoom.currentValue),o.maxZoom&&!o.maxZoom.isFirstChange()&&_.mapService.updateMaxZoom(o.maxZoom.currentValue),o.minPitch&&!o.minPitch.isFirstChange()&&_.mapService.updateMinPitch(o.minPitch.currentValue),o.maxPitch&&!o.maxPitch.isFirstChange()&&_.mapService.updateMaxPitch(o.maxPitch.currentValue),o.renderWorldCopies&&!o.renderWorldCopies.isFirstChange()&&_.mapService.updateRenderWorldCopies(o.renderWorldCopies.currentValue),o.scrollZoom&&!o.scrollZoom.isFirstChange()&&_.mapService.updateScrollZoom(o.scrollZoom.currentValue),o.dragRotate&&!o.dragRotate.isFirstChange()&&_.mapService.updateDragRotate(o.dragRotate.currentValue),o.touchPitch&&!o.touchPitch.isFirstChange()&&_.mapService.updateTouchPitch(o.touchPitch.currentValue),o.touchZoomRotate&&!o.touchZoomRotate.isFirstChange()&&_.mapService.updateTouchZoomRotate(o.touchZoomRotate.currentValue),o.doubleClickZoom&&!o.doubleClickZoom.isFirstChange()&&_.mapService.updateDoubleClickZoom(o.doubleClickZoom.currentValue),o.keyboard&&!o.keyboard.isFirstChange()&&_.mapService.updateKeyboard(o.keyboard.currentValue),o.dragPan&&!o.dragPan.isFirstChange()&&_.mapService.updateDragPan(o.dragPan.currentValue),o.boxZoom&&!o.boxZoom.isFirstChange()&&_.mapService.updateBoxZoom(o.boxZoom.currentValue),o.style&&!o.style.isFirstChange()&&_.mapService.updateStyle(o.style.currentValue),o.maxBounds&&!o.maxBounds.isFirstChange()&&_.mapService.updateMaxBounds(o.maxBounds.currentValue),o.fitBounds&&o.fitBounds.currentValue&&!o.fitBounds.isFirstChange()&&_.mapService.fitBounds(o.fitBounds.currentValue,_.fitBoundsOptions),o.fitScreenCoordinates&&o.fitScreenCoordinates.currentValue&&((_.center||_.zoom||_.pitch||_.fitBounds)&&o.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),_.mapService.fitScreenCoordinates(o.fitScreenCoordinates.currentValue,_.bearing?_.bearing[0]:0,_.movingOptions)),!_.centerWithPanTo||!o.center||o.center.isFirstChange()||o.zoom||o.bearing||o.pitch?(o.center&&!o.center.isFirstChange()||o.zoom&&!o.zoom.isFirstChange()||o.bearing&&!o.bearing.isFirstChange()&&!o.fitScreenCoordinates||o.pitch&&!o.pitch.isFirstChange())&&_.mapService.move(_.movingMethod,_.movingOptions,o.zoom&&_.zoom?_.zoom[0]:void 0,o.center?_.center:void 0,o.bearing&&_.bearing?_.bearing[0]:void 0,o.pitch&&_.pitch?_.pitch[0]:void 0):_.mapService.panTo(_.center,_.panToOptions)})()}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.resize.observed&&o("resize","mapResize"),this.remove.observed&&o("remove","mapRemove"),this.mouseDown.observed&&o("mouseDown","mapMouseDown"),this.mouseUp.observed&&o("mouseUp","mapMouseUp"),this.mouseMove.observed&&o("mouseMove","mapMouseMove"),this.click.observed&&o("click","mapClick"),this.dblClick.observed&&o("dblClick","mapDblClick"),this.mouseOver.observed&&o("mouseOver","mapMouseOver"),this.mouseOut.observed&&o("mouseOut","mapMouseOut"),this.contextMenu.observed&&o("contextMenu","mapContextMenu"),this.touchStart.observed&&o("touchStart","mapTouchStart"),this.touchEnd.observed&&o("touchEnd","mapTouchEnd"),this.touchMove.observed&&o("touchMove","mapTouchMove"),this.touchCancel.observed&&o("touchCancel","mapTouchCancel"),this.wheel.observed&&o("wheel","mapWheel"),this.dragStart.observed&&o("dragStart","mapDragStart"),this.drag.observed&&o("drag","mapDrag"),this.dragEnd.observed&&o("dragEnd","mapDragEnd"),this.load.observed&&o("load","mapLoad"),this.error.observed&&o("error","mapError")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-map"]],viewQuery:function(o,_){if(1&o&&d.Gf(sc,7),2&o){let A;d.iGM(A=d.CRH())&&(_.mapContainer=A.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",projection:"projection",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[d._Bn([ir]),d.TTD],decls:2,vars:0,consts:[["container",""]],template:function(o,_){1&o&&d._UZ(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),p})();const Hn=["content"],Ys=["*"];let hs=(()=>{class p{constructor(o){this.mapService=o,this.markerDragStart=new d.vpe,this.markerDragEnd=new d.vpe,this.markerDrag=new d.vpe,this.dragStart=new d.vpe,this.dragEnd=new d.vpe,this.drag=new d.vpe}ngOnInit(){if(this.warnDeprecatedOutputs(),this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")}ngOnChanges(o){o.lngLat&&!o.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),o.feature&&!o.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates),o.draggable&&!o.draggable.isFirstChange()&&this.markerInstance.setDraggable(!!this.draggable),o.popupShown&&!o.popupShown.isFirstChange()&&(o.popupShown.currentValue?this.markerInstance.getPopup().addTo(this.mapService.mapInstance):this.markerInstance.getPopup().remove()),o.pitchAlignment&&!o.pitchAlignment.isFirstChange()&&this.markerInstance.setPitchAlignment(o.pitchAlignment.currentValue),o.rotationAlignment&&!o.rotationAlignment.isFirstChange()&&this.markerInstance.setRotationAlignment(o.rotationAlignment.currentValue)}ngAfterViewInit(){this.mapService.mapCreated$.subscribe(()=>{this.markerInstance=this.mapService.addMarker({markersOptions:{offset:this.offset,anchor:this.anchor,pitchAlignment:this.pitchAlignment,rotationAlignment:this.rotationAlignment,draggable:!!this.draggable,element:this.content.nativeElement,feature:this.feature,lngLat:this.lngLat,clickTolerance:this.clickTolerance},markersEvents:{markerDragStart:this.markerDragStart,markerDrag:this.markerDrag,markerDragEnd:this.markerDragEnd,dragStart:this.markerDragStart,drag:this.markerDrag,dragEnd:this.markerDragEnd}})})}ngOnDestroy(){this.mapService.removeMarker(this.markerInstance),this.markerInstance=void 0}togglePopup(){this.markerInstance.togglePopup()}updateCoordinates(o){this.markerInstance.setLngLat(o)}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.markerDragStart.observed&&o("dragStart","markerDragStart"),this.markerDragEnd.observed&&o("dragEnd","markerDragEnd"),this.markerDrag.observed&&o("drag","markerDrag")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-marker"]],viewQuery:function(o,_){if(1&o&&d.Gf(Hn,7),2&o){let A;d.iGM(A=d.CRH())&&(_.content=A.first)}},inputs:{offset:"offset",anchor:"anchor",clickTolerance:"clickTolerance",feature:"feature",lngLat:"lngLat",draggable:"draggable",popupShown:"popupShown",className:"className",pitchAlignment:"pitchAlignment",rotationAlignment:"rotationAlignment"},outputs:{markerDragStart:"markerDragStart",markerDragEnd:"markerDragEnd",markerDrag:"markerDrag",dragStart:"dragStart",dragEnd:"dragEnd",drag:"drag"},features:[d.TTD],ngContentSelectors:Ys,decls:3,vars:2,consts:[["content",""]],template:function(o,_){1&o&&(d.F$t(),d.TgZ(0,"div",null,0),d.Hsn(2),d.qZA()),2&o&&d.Tol(_.className)},encapsulation:2,changeDetection:0}),p})();var ja=j(6451);function ac(p,y){1&p&&d.GkF(0)}const Ll=function(p){return{$implicit:p}};function Oc(p,y){if(1&p&&(d.ynx(0),d.TgZ(1,"mgl-marker",3),d.YNc(2,ac,1,0,"ng-container",4),d.qZA(),d.BQk()),2&p){const o=d.oxw().$implicit,_=d.oxw();d.xp6(1),d.Q6J("feature",o),d.xp6(1),d.Q6J("ngTemplateOutlet",_.clusterPointTpl)("ngTemplateOutletContext",d.VKq(3,Ll,o))}}function bl(p,y){1&p&&d.GkF(0)}function su(p,y){if(1&p&&(d.ynx(0),d.TgZ(1,"mgl-marker",3),d.YNc(2,bl,1,0,"ng-container",4),d.qZA(),d.BQk()),2&p){const o=d.oxw().$implicit,_=d.oxw();d.xp6(1),d.Q6J("feature",o),d.xp6(1),d.Q6J("ngTemplateOutlet",_.pointTpl)("ngTemplateOutletContext",d.VKq(3,Ll,o))}}function Wo(p,y){if(1&p&&(d.ynx(0),d.YNc(1,Oc,3,5,"ng-container",2),d.YNc(2,su,3,5,"ng-container",2),d.BQk()),2&p){const o=y.$implicit;d.xp6(1),d.Q6J("ngIf",o.properties.cluster),d.xp6(1),d.Q6J("ngIf",!o.properties.cluster)}}const au=function(){return{"circle-radius":0}};let Fl=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275dir=d.lG2({type:p,selectors:[["ng-template","mglPoint",""]]}),p})(),Ga=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275dir=d.lG2({type:p,selectors:[["ng-template","mglClusterPoint",""]]}),p})(),lc=0,kc=(()=>{class p{constructor(o,_,A){this.mapService=o,this.ChangeDetectorRef=_,this.zone=A,this.layerId="mgl-markers-for-clusters-"+lc++,this.sub=new Na.w0}ngAfterContentInit(){const _=this.mapService.mapCreated$.pipe((0,Mo.w)(()=>(0,ws.R)(this.mapService.mapInstance,"data").pipe((0,Zo.h)(A=>A.sourceId===this.source&&"metadata"!==A.sourceDataType&&this.mapService.mapInstance.isSourceLoaded(this.source)))),(0,Mo.w)(()=>(0,ja.T)((0,ws.R)(this.mapService.mapInstance,"move"),(0,ws.R)(this.mapService.mapInstance,"moveend")).pipe((0,ha.O)(void 0)))).subscribe(()=>{this.zone.run(()=>{this.updateCluster()})});this.sub.add(_)}ngOnDestroy(){this.sub.unsubscribe()}trackByClusterPoint(o,_){return _.id}updateCluster(){const o={layers:[this.layerId]};this.pointTpl||(o.filter=["==","cluster",!0]),this.clusterPoints=this.mapService.mapInstance.queryRenderedFeatures(o),this.ChangeDetectorRef.markForCheck()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir),d.Y36(d.sBO),d.Y36(d.R0b))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-markers-for-clusters"]],contentQueries:function(o,_,A){if(1&o&&(d.Suo(A,Fl,5,d.Rgc),d.Suo(A,Ga,5,d.Rgc)),2&o){let z;d.iGM(z=d.CRH())&&(_.pointTpl=z.first),d.iGM(z=d.CRH())&&(_.clusterPointTpl=z.first)}},inputs:{source:"source"},decls:2,vars:6,consts:[["type","circle",3,"id","source","paint"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[3,"feature"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(o,_){1&o&&(d._UZ(0,"mgl-layer",0),d.YNc(1,Wo,3,2,"ng-container",1)),2&o&&(d.Q6J("id",_.layerId)("source",_.source)("paint",d.DdM(5,au)),d.xp6(1),d.Q6J("ngForOf",_.clusterPoints)("ngForTrackBy",_.trackByClusterPoint))},dependencies:[me.sg,me.O5,me.tP,bo,hs],encapsulation:2,changeDetection:0}),p})(),Ha=(()=>{class p{static withConfig(o){return{ngModule:p,providers:[{provide:xs,useValue:o.accessToken}]}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[me.ez]}),p})();const Bl=["content"],ps=["*"];let $a=(()=>{class p{constructor(o){this.mapService=o,this.popupClose=new d.vpe,this.popupOpen=new d.vpe,this.close=new d.vpe,this.open=new d.vpe}ngOnInit(){if(this.warnDeprecatedOutputs(),this.lngLat&&this.marker||this.feature&&this.lngLat||this.feature&&this.marker)throw new Error("marker, lngLat, feature input are mutually exclusive")}ngOnChanges(o){if(o.lngLat&&!o.lngLat.isFirstChange()||o.feature&&!o.feature.isFirstChange()){const _=o.lngLat?this.lngLat:this.feature.geometry.coordinates;this.mapService.removePopupFromMap(this.popupInstance,!0);const A=this.createPopup();this.mapService.addPopupToMap(A,_,this.popupInstance.isOpen()),this.popupInstance=A}if(o.marker&&!o.marker.isFirstChange()){const _=o.marker.previousValue;_.markerInstance&&this.mapService.removePopupFromMarker(_.markerInstance),this.marker&&this.marker.markerInstance&&this.popupInstance&&this.mapService.addPopupToMarker(this.marker.markerInstance,this.popupInstance)}o.offset&&!o.offset.isFirstChange()&&this.popupInstance&&this.popupInstance.setOffset(this.offset)}ngAfterViewInit(){this.popupInstance=this.createPopup(),this.addPopup(this.popupInstance)}ngOnDestroy(){this.popupInstance&&(this.lngLat||this.feature?this.mapService.removePopupFromMap(this.popupInstance):this.marker&&this.marker.markerInstance&&this.mapService.removePopupFromMarker(this.marker.markerInstance)),this.popupInstance=void 0}createPopup(){return this.mapService.createPopup({popupOptions:{closeButton:this.closeButton,closeOnClick:this.closeOnClick,closeOnMove:this.closeOnMove,focusAfterOpen:this.focusAfterOpen,anchor:this.anchor,offset:this.offset,className:this.className,maxWidth:this.maxWidth},popupEvents:{open:this.open,close:this.close,popupOpen:this.popupOpen,popupClose:this.popupClose}},this.content.nativeElement)}addPopup(o){this.mapService.mapCreated$.subscribe(()=>{if(this.lngLat||this.feature)this.mapService.addPopupToMap(o,this.lngLat?this.lngLat:this.feature.geometry.coordinates);else{if(!this.marker||!this.marker.markerInstance)throw new Error("mgl-popup need either lngLat/marker/feature to be set");this.mapService.addPopupToMarker(this.marker.markerInstance,o)}})}warnDeprecatedOutputs(){const o=Os.bind(void 0,p.name);this.close.observed&&o("close","popupClose"),this.open.observed&&o("open","popupOpen")}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-popup"]],viewQuery:function(o,_){if(1&o&&d.Gf(Bl,7),2&o){let A;d.iGM(A=d.CRH())&&(_.content=A.first)}},inputs:{closeButton:"closeButton",closeOnClick:"closeOnClick",closeOnMove:"closeOnMove",focusAfterOpen:"focusAfterOpen",anchor:"anchor",className:"className",maxWidth:"maxWidth",feature:"feature",lngLat:"lngLat",marker:"marker",offset:"offset"},outputs:{popupClose:"popupClose",popupOpen:"popupOpen",close:"close",open:"open"},features:[d.TTD],ngContentSelectors:ps,decls:3,vars:0,consts:[["content",""]],template:function(o,_){1&o&&(d.F$t(),d.TgZ(0,"div",null,0),d.Hsn(2),d.qZA())},encapsulation:2,changeDetection:0}),p})(),Do=(()=>{class p{constructor(o){this.mapService=o}ngOnInit(){this.sub=this.mapService.mapLoaded$.subscribe(()=>this.init())}ngOnChanges(o){if(void 0===this.sourceId)return;const _=this.mapService.getSource(this.sourceId);void 0!==_&&_.updateImage({url:void 0===o.url?void 0:this.url,coordinates:void 0===o.coordinates?void 0:this.coordinates})}ngOnDestroy(){void 0!==this.sub&&this.sub.unsubscribe(),void 0!==this.sourceId&&(this.mapService.removeSource(this.sourceId),this.sourceId=void 0)}init(){this.mapService.addSource(this.id,{type:"image",url:this.url,coordinates:this.coordinates}),this.sourceId=this.id}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-image-source"]],inputs:{id:"id",url:"url",coordinates:"coordinates"},features:[d.TTD],decls:0,vars:0,template:function(o,_){},encapsulation:2,changeDetection:0}),p})(),Za=(()=>{class p{constructor(o){this.mapService=o,this.type="vector",this.sourceAdded=!1,this.sub=new Na.w0}ngOnInit(){const o=this.mapService.mapLoaded$.subscribe(()=>{this.init();const _=(0,ws.R)(this.mapService.mapInstance,"styledata").pipe((0,Zo.h)(()=>!this.mapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(_)});this.sub.add(o)}ngOnChanges(o){if(this.sourceAdded)if(o.bounds&&!o.bounds.isFirstChange()||o.scheme&&!o.scheme.isFirstChange()||o.minzoom&&!o.minzoom.isFirstChange()||o.maxzoom&&!o.maxzoom.isFirstChange()||o.attribution&&!o.attribution.isFirstChange()||o.promoteId&&!o.promoteId.isFirstChange())this.ngOnDestroy(),this.ngOnInit();else if(o.url&&!o.url.isFirstChange()||o.tiles&&!o.tiles.isFirstChange()){const _=this.mapService.getSource(this.id);if(void 0===_)return;o.url&&this.url&&_.setUrl(this.url),o.tiles&&this.tiles&&_.setTiles(this.tiles)}}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.mapService.removeSource(this.id),this.sourceAdded=!1)}init(){this.mapService.addSource(this.id,{type:this.type,url:this.url,tiles:this.tiles,bounds:this.bounds,scheme:this.scheme,minzoom:this.minzoom,maxzoom:this.maxzoom,attribution:this.attribution,promoteId:this.promoteId}),this.sourceAdded=!0}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ir))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mgl-vector-source"]],inputs:{id:"id",url:"url",tiles:"tiles",bounds:"bounds",scheme:"scheme",minzoom:"minzoom",maxzoom:"maxzoom",attribution:"attribution",promoteId:"promoteId"},features:[d.TTD],decls:0,vars:0,template:function(o,_){},encapsulation:2,changeDetection:0}),p})();var zl=j(8445);const Ks="object"==typeof global&&global&&global.Object===Object&&global;var $u="object"==typeof self&&self&&self.Object===Object&&self;const Es=Ks||$u||Function("return this")(),pa=Es.Symbol;var ks=Object.prototype,uo=ks.hasOwnProperty,xl=ks.toString,fa=pa?pa.toStringTag:void 0;var wh=Object.prototype.toString;var Yu=pa?pa.toStringTag:void 0;const Wa=function Ch(p){return null==p?void 0===p?"[object Undefined]":"[object Null]":Yu&&Yu in Object(p)?function Zu(p){var y=uo.call(p,fa),o=p[fa];try{p[fa]=void 0;var _=!0}catch{}var A=xl.call(p);return _&&(y?p[fa]=o:delete p[fa]),A}(p):function cc(p){return wh.call(p)}(p)},uc=function uu(p){var y=typeof p;return null!=p&&("object"==y||"function"==y)},qa=function du(p){if(!uc(p))return!1;var y=Wa(p);return"[object Function]"==y||"[object GeneratorFunction]"==y||"[object AsyncFunction]"==y||"[object Proxy]"==y};var p,Fd=Es["__core-js_shared__"],L=(p=/[^.]+$/.exec(Fd&&Fd.keys&&Fd.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"";var ge=Function.prototype.toString;const pt=function qe(p){if(null!=p){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""};var ni=/^\[object .+?Constructor\]$/,ms=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Rs=function Vl(p){return!(!uc(p)||function O(p){return!!L&&L in p}(p))&&(qa(p)?ms:ni).test(pt(p))},wl=function Ku(p,y){var o=function hu(p,y){return p?.[y]}(p,y);return Rs(o)?o:void 0};var Bd=function(){try{var p=wl(Object,"defineProperty");return p({},"",{}),p}catch{}}();const f=Bd,u=function t(p,y,o){"__proto__"==y&&f?f(p,y,{configurable:!0,enumerable:!0,value:o,writable:!0}):p[y]=o},w=function v(p,y,o,_){for(var A=-1,z=null==p?0:p.length;++A<z;){var ue=p[A];y(_,ue,o(ue),p)}return _};var k=function E(p){return function(y,o,_){for(var A=-1,z=Object(y),ue=_(y),_e=ue.length;_e--;){var rt=ue[p?_e:++A];if(!1===o(z[rt],rt,z))break}return y}}();const B=k,fe=function se(p){return null!=p&&"object"==typeof p},xe=function we(p){return fe(p)&&"[object Arguments]"==Wa(p)};var $e=Object.prototype,Ee=$e.hasOwnProperty,ke=$e.propertyIsEnumerable,Re=xe(function(){return arguments}())?xe:function(p){return fe(p)&&Ee.call(p,"callee")&&!ke.call(p,"callee")};const st=Re,je=Array.isArray;var Zt="object"==typeof exports&&exports&&!exports.nodeType&&exports,$t=Zt&&"object"==typeof module&&module&&!module.nodeType&&module,it=$t&&$t.exports===Zt?Es.Buffer:void 0;const Un=(it?it.isBuffer:void 0)||function bt(){return!1};var ci=/^(?:0|[1-9]\d*)$/;const Vn=function Fn(p,y){var o=typeof p;return!!(y=y??9007199254740991)&&("number"==o||"symbol"!=o&&ci.test(p))&&p>-1&&p%1==0&&p<y},Si=function Nn(p){return"number"==typeof p&&p>-1&&p%1==0&&p<=9007199254740991};var Er={};Er["[object Float32Array]"]=Er["[object Float64Array]"]=Er["[object Int8Array]"]=Er["[object Int16Array]"]=Er["[object Int32Array]"]=Er["[object Uint8Array]"]=Er["[object Uint8ClampedArray]"]=Er["[object Uint16Array]"]=Er["[object Uint32Array]"]=!0,Er["[object Arguments]"]=Er["[object Array]"]=Er["[object ArrayBuffer]"]=Er["[object Boolean]"]=Er["[object DataView]"]=Er["[object Date]"]=Er["[object Error]"]=Er["[object Function]"]=Er["[object Map]"]=Er["[object Number]"]=Er["[object Object]"]=Er["[object RegExp]"]=Er["[object Set]"]=Er["[object String]"]=Er["[object WeakMap]"]=!1;const dp=function eg(p){return function(y){return p(y)}};var hp="object"==typeof exports&&exports&&!exports.nodeType&&exports,zd=hp&&"object"==typeof module&&module&&!module.nodeType&&module,Fc=zd&&zd.exports===hp&&Ks.process;const Qu=function(){try{return zd&&zd.require&&zd.require("util").types||Fc&&Fc.binding&&Fc.binding("util")}catch{}}();var yf=Qu&&Qu.isTypedArray;const vf=yf?dp(yf):function Xs(p){return fe(p)&&Si(p.length)&&!!Er[Wa(p)]};var bf=Object.prototype.hasOwnProperty;const xf=function rg(p,y){var o=je(p),_=!o&&st(p),A=!o&&!_&&Un(p),z=!o&&!_&&!A&&vf(p),ue=o||_||A||z,_e=ue?function Z(p,y){for(var o=-1,_=Array(p);++o<p;)_[o]=y(o);return _}(p.length,String):[],rt=_e.length;for(var Lt in p)(y||bf.call(p,Lt))&&(!ue||!("length"==Lt||A&&("offset"==Lt||"parent"==Lt)||z&&("buffer"==Lt||"byteLength"==Lt||"byteOffset"==Lt)||Vn(Lt,rt)))&&_e.push(Lt);return _e};var H_=Object.prototype;const wf=function $_(p){var y=p&&p.constructor;return p===("function"==typeof y&&y.prototype||H_)},mc=function Z_(p,y){return function(o){return p(y(o))}},ul=mc(Object.keys,Object);var pp=Object.prototype.hasOwnProperty;const Ef=function Cf(p){return null!=p&&Si(p.length)&&!qa(p)},Ju=function W_(p){return Ef(p)?xf(p):function Mh(p){if(!wf(p))return ul(p);var y=[];for(var o in Object(p))pp.call(p,o)&&"constructor"!=o&&y.push(o);return y}(p)};var ed=function sg(p,y){return function(o,_){if(null==o)return o;if(!Ef(o))return p(o,_);for(var A=o.length,z=y?A:-1,ue=Object(o);(y?z--:++z<A)&&!1!==_(ue[z],z,ue););return o}}(function Mf(p,y){return p&&B(p,y,Ju)});const Bc=ed,pu=function Hl(p,y,o,_){return Bc(p,function(A,z,ue){y(_,A,o(A),ue)}),_},mp=function fp(p,y){return p===y||p!=p&&y!=y},gp=function Sf(p,y){for(var o=p.length;o--;)if(mp(p[o][0],y))return o;return-1};var Dh=Array.prototype.splice;function Vd(p){var y=-1,o=null==p?0:p.length;for(this.clear();++y<o;){var _=p[y];this.set(_[0],_[1])}}Vd.prototype.clear=function fu(){this.__data__=[],this.size=0},Vd.prototype.delete=function $l(p){var y=this.__data__,o=gp(y,p);return!(o<0||(o==y.length-1?y.pop():Dh.call(y,o,1),--this.size,0))},Vd.prototype.get=function ag(p){var y=this.__data__,o=gp(y,p);return o<0?void 0:y[o][1]},Vd.prototype.has=function Ti(p){return gp(this.__data__,p)>-1},Vd.prototype.set=function If(p,y){var o=this.__data__,_=gp(o,p);return _<0?(++this.size,o.push([p,y])):o[_][1]=y,this};const Th=Vd,Ah=wl(Es,"Map"),nd=wl(Object,"create");var yp=Object.prototype.hasOwnProperty;var kf=Object.prototype.hasOwnProperty;function ad(p){var y=-1,o=null==p?0:p.length;for(this.clear();++y<o;){var _=p[y];this.set(_[0],_[1])}}ad.prototype.clear=function _p(){this.__data__=nd?nd(null):{},this.size=0},ad.prototype.delete=function id(p){var y=this.has(p)&&delete this.__data__[p];return this.size-=y?1:0,y},ad.prototype.get=function Ih(p){var y=this.__data__;if(nd){var o=y[p];return"__lodash_hash_undefined__"===o?void 0:o}return yp.call(y,p)?y[p]:void 0},ad.prototype.has=function Rf(p){var y=this.__data__;return nd?void 0!==y[p]:kf.call(y,p)},ad.prototype.set=function vp(p,y){var o=this.__data__;return this.size+=this.has(p)?0:1,o[p]=nd&&void 0===y?"__lodash_hash_undefined__":y,this};const _u=ad,Oh=function Ff(p,y){var o=p.__data__;return function yu(p){var y=typeof p;return"string"==y||"number"==y||"symbol"==y||"boolean"==y?"__proto__"!==p:null===p}(y)?o["string"==typeof y?"string":"hash"]:o.map};function Ka(p){var y=-1,o=null==p?0:p.length;for(this.clear();++y<o;){var _=p[y];this.set(_[0],_[1])}}Ka.prototype.clear=function cg(){this.size=0,this.__data__={hash:new _u,map:new(Ah||Th),string:new _u}},Ka.prototype.delete=function ug(p){var y=Oh(this,p).delete(p);return this.size-=y?1:0,y},Ka.prototype.get=function xp(p){return Oh(this,p).get(p)},Ka.prototype.has=function dg(p){return Oh(this,p).has(p)},Ka.prototype.set=function El(p,y){var o=Oh(this,p),_=o.size;return o.set(p,y),this.size+=o.size==_?0:1,this};const vu=Ka;function Uc(p){var y=this.__data__=new Th(p);this.size=y.size}Uc.prototype.clear=function Zl(){this.__data__=new Th,this.size=0},Uc.prototype.delete=function dl(p){var y=this.__data__,o=y.delete(p);return this.size=y.size,o},Uc.prototype.get=function No(p){return this.__data__.get(p)},Uc.prototype.has=function Wl(p){return this.__data__.has(p)},Uc.prototype.set=function hg(p,y){var o=this.__data__;if(o instanceof Th){var _=o.__data__;if(!Ah||_.length<199)return _.push([p,y]),this.size=++o.size,this;o=this.__data__=new vu(_)}return o.set(p,y),this.size=o.size,this};const Ud=Uc;function Gd(p){var y=-1,o=null==p?0:p.length;for(this.__data__=new vu;++y<o;)this.add(p[y])}Gd.prototype.add=Gd.prototype.push=function jd(p){return this.__data__.set(p,"__lodash_hash_undefined__"),this},Gd.prototype.has=function kh(p){return this.__data__.has(p)};const Hd=Gd,Bf=function jc(p,y){for(var o=-1,_=null==p?0:p.length;++o<_;)if(y(p[o],o,p))return!0;return!1},ql=function Da(p,y){return p.has(y)},xu=function zf(p,y,o,_,A,z){var ue=1&o,_e=p.length,rt=y.length;if(_e!=rt&&!(ue&&rt>_e))return!1;var Lt=z.get(p),ln=z.get(y);if(Lt&&ln)return Lt==y&&ln==p;var un=-1,ei=!0,yi=2&o?new Hd:void 0;for(z.set(p,y),z.set(y,p);++un<_e;){var si=p[un],hi=y[un];if(_)var Fi=ue?_(hi,si,un,y,p,z):_(si,hi,un,p,y,z);if(void 0!==Fi){if(Fi)continue;ei=!1;break}if(yi){if(!Bf(y,function(Ki,Vr){if(!ql(yi,Vr)&&(si===Ki||A(si,Ki,o,_,z)))return yi.push(Vr)})){ei=!1;break}}else if(si!==hi&&!A(si,hi,o,_,z)){ei=!1;break}}return z.delete(p),z.delete(y),ei},Rh=Es.Uint8Array,Cp=function fg(p){var y=-1,o=Array(p.size);return p.forEach(function(_,A){o[++y]=[A,_]}),o},Ep=function ud(p){var y=-1,o=Array(p.size);return p.forEach(function(_){o[++y]=_}),o};var Tp=pa?pa.prototype:void 0,Sp=Tp?Tp.valueOf:void 0;const jf=function ga(p,y){for(var o=-1,_=y.length,A=p.length;++o<_;)p[A+o]=y[o];return p},Js=function Lh(p,y,o){var _=y(p);return je(p)?_:jf(_,o(p))},vg=function Ap(){return[]};var bg=Object.prototype.propertyIsEnumerable,_c=Object.getOwnPropertySymbols,zh=_c?function(p){return null==p?[]:(p=Object(p),function Fh(p,y){for(var o=-1,_=null==p?0:p.length,A=0,z=[];++o<_;){var ue=p[o];y(ue,o,p)&&(z[A++]=ue)}return z}(_c(p),function(y){return bg.call(p,y)}))}:vg;const Ip=zh,Hf=function ty(p){return Js(p,Ju,Ip)};var iy=Object.prototype.hasOwnProperty;const Cu=wl(Es,"DataView"),Po=wl(Es,"Promise"),Nh=wl(Es,"Set"),Ta=wl(Es,"WeakMap");var Eu="[object Map]",Wf="[object Promise]",dd="[object Set]",Op="[object WeakMap]",Mu="[object DataView]",sy=pt(Cu),qf=pt(Ah),hd=pt(Po),Yf=pt(Nh),kp=pt(Ta),Zd=Wa;(Cu&&Zd(new Cu(new ArrayBuffer(1)))!=Mu||Ah&&Zd(new Ah)!=Eu||Po&&Zd(Po.resolve())!=Wf||Nh&&Zd(new Nh)!=dd||Ta&&Zd(new Ta)!=Op)&&(Zd=function(p){var y=Wa(p),o="[object Object]"==y?p.constructor:void 0,_=o?pt(o):"";if(_)switch(_){case sy:return Mu;case qf:return Eu;case hd:return Wf;case Yf:return dd;case kp:return Op}return y});const Ml=Zd;var Wd="[object Arguments]",wg="[object Array]",qd="[object Object]",Cg=Object.prototype.hasOwnProperty;const cy=function ly(p,y,o,_,A,z){var ue=je(p),_e=je(y),rt=ue?wg:Ml(p),Lt=_e?wg:Ml(y),ln=(rt=rt==Wd?qd:rt)==qd,un=(Lt=Lt==Wd?qd:Lt)==qd,ei=rt==Lt;if(ei&&Un(p)){if(!Un(y))return!1;ue=!0,ln=!1}if(ei&&!ln)return z||(z=new Ud),ue||vf(p)?xu(p,y,o,_,A,z):function Uf(p,y,o,_,A,z,ue){switch(o){case"[object DataView]":if(p.byteLength!=y.byteLength||p.byteOffset!=y.byteOffset)return!1;p=p.buffer,y=y.buffer;case"[object ArrayBuffer]":return!(p.byteLength!=y.byteLength||!z(new Rh(p),new Rh(y)));case"[object Boolean]":case"[object Date]":case"[object Number]":return mp(+p,+y);case"[object Error]":return p.name==y.name&&p.message==y.message;case"[object RegExp]":case"[object String]":return p==y+"";case"[object Map]":var _e=Cp;case"[object Set]":if(_e||(_e=Ep),p.size!=y.size&&!(1&_))return!1;var Lt=ue.get(p);if(Lt)return Lt==y;_|=2,ue.set(p,y);var ln=xu(_e(p),_e(y),_,A,z,ue);return ue.delete(p),ln;case"[object Symbol]":if(Sp)return Sp.call(p)==Sp.call(y)}return!1}(p,y,rt,o,_,A,z);if(!(1&o)){var yi=ln&&Cg.call(p,"__wrapped__"),si=un&&Cg.call(y,"__wrapped__");if(yi||si){var hi=yi?p.value():p,Fi=si?y.value():y;return z||(z=new Ud),A(hi,Fi,o,_,z)}}return!!ei&&(z||(z=new Ud),function ry(p,y,o,_,A,z){var ue=1&o,_e=Hf(p),rt=_e.length;if(rt!=Hf(y).length&&!ue)return!1;for(var un=rt;un--;){var ei=_e[un];if(!(ue?ei in y:iy.call(y,ei)))return!1}var yi=z.get(p),si=z.get(y);if(yi&&si)return yi==y&&si==p;var hi=!0;z.set(p,y),z.set(y,p);for(var Fi=ue;++un<rt;){var Ki=p[ei=_e[un]],Vr=y[ei];if(_)var Ro=ue?_(Vr,Ki,ei,y,p,z):_(Ki,Vr,ei,p,y,z);if(!(void 0===Ro?Ki===Vr||A(Ki,Vr,o,_,z):Ro)){hi=!1;break}Fi||(Fi="constructor"==ei)}if(hi&&!Fi){var _o=p.constructor,Pa=y.constructor;_o!=Pa&&"constructor"in p&&"constructor"in y&&!("function"==typeof _o&&_o instanceof _o&&"function"==typeof Pa&&Pa instanceof Pa)&&(hi=!1)}return z.delete(p),z.delete(y),hi}(p,y,o,_,A,z))},pd=function Kf(p,y,o,_,A){return p===y||(null==p||null==y||!fe(p)&&!fe(y)?p!=p&&y!=y:cy(p,y,o,_,Kf,A))},Mg=function uy(p){return p==p&&!uc(p)},Jf=function fd(p,y){return function(o){return null!=o&&o[p]===y&&(void 0!==y||p in Object(o))}},jh=function Yd(p){var y=function Du(p){for(var y=Ju(p),o=y.length;o--;){var _=y[o],A=p[_];y[o]=[_,A,Mg(A)]}return y}(p);return 1==y.length&&y[0][2]?Jf(y[0][0],y[0][1]):function(o){return o===p||function Qf(p,y,o,_){var A=o.length,z=A,ue=!_;if(null==p)return!z;for(p=Object(p);A--;){var _e=o[A];if(ue&&_e[2]?_e[1]!==p[_e[0]]:!(_e[0]in p))return!1}for(;++A<z;){var rt=(_e=o[A])[0],Lt=p[rt],ln=_e[1];if(ue&&_e[2]){if(void 0===Lt&&!(rt in p))return!1}else{var un=new Ud;if(_)var ei=_(Lt,ln,rt,p,y,un);if(!(void 0===ei?pd(ln,Lt,3,_,un):ei))return!1}}return!0}(o,p,y)}},em=function Tu(p){return"symbol"==typeof p||fe(p)&&"[object Symbol]"==Wa(p)};var tm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nm=/^\w*$/;const Kd=function Dg(p,y){if(je(p))return!1;var o=typeof p;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=p&&!em(p))||nm.test(p)||!tm.test(p)||null!=y&&p in Object(y)};function md(p,y){if("function"!=typeof p||null!=y&&"function"!=typeof y)throw new TypeError("Expected a function");var o=function(){var _=arguments,A=y?y.apply(this,_):_[0],z=o.cache;if(z.has(A))return z.get(A);var ue=p.apply(this,_);return o.cache=z.set(A,ue)||z,ue};return o.cache=new(md.Cache||vu),o}md.Cache=vu;const Ds=md;var Qd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jd=/\\(\\)?/g,hy=function gd(p){var y=Ds(p,function(_){return 500===o.size&&o.clear(),_}),o=y.cache;return y}(function(p){var y=[];return 46===p.charCodeAt(0)&&y.push(""),p.replace(Qd,function(o,_,A,z){y.push(A?z.replace(Jd,"$1"):_||o)}),y});const Tg=hy;var Lp=pa?pa.prototype:void 0,eh=Lp?Lp.toString:void 0;const rm=function my(p){if("string"==typeof p)return p;if(je(p))return function py(p,y){for(var o=-1,_=null==p?0:p.length,A=Array(_);++o<_;)A[o]=y(p[o],o,p);return A}(p,my)+"";if(em(p))return eh?eh.call(p):"";var y=p+"";return"0"==y&&1/p==-1/0?"-0":y},Ig=function gy(p,y){return je(p)?p:Kd(p,y)?[p]:Tg(function Ag(p){return null==p?"":rm(p)}(p))},Hh=function _y(p){if("string"==typeof p||em(p))return p;var y=p+"";return"0"==y&&1/p==-1/0?"-0":y},Og=function Pg(p,y){for(var o=0,_=(y=Ig(y,p)).length;null!=p&&o<_;)p=p[Hh(y[o++])];return o&&o==_?p:void 0},Bp=function Fp(p,y){return null!=p&&y in Object(p)},nh=function ar(p,y){return null!=p&&function th(p,y,o){for(var _=-1,A=(y=Ig(y,p)).length,z=!1;++_<A;){var ue=Hh(y[_]);if(!(z=null!=p&&o(p,ue)))break;p=p[ue]}return z||++_!=A?z:!!(A=null==p?0:p.length)&&Si(A)&&Vn(ue,A)&&(je(p)||st(p))}(p,y,Bp)},Fg=function Lg(p,y){return Kd(p)&&Mg(y)?Jf(Hh(p),y):function(o){var _=function Bs(p,y,o){var _=null==p?void 0:Og(p,y);return void 0===_?o:_}(o,p);return void 0===_&&_===y?nh(o,p):pd(y,_,3)}},$r=function ih(p){return p},sm=function _d(p){return Kd(p)?function zp(p){return function(y){return y?.[p]}}(Hh(p)):function zg(p){return function(y){return Og(y,p)}}(p)};var Ev=Object.prototype.hasOwnProperty,Mv=function am(p,y){return function(o,_){var A=je(o)?w:pu,z=y?y():{};return A(o,p,function yd(p){return"function"==typeof p?p:null==p?$r:"object"==typeof p?je(p)?Fg(p[0],p[1]):jh(p):sm(p)}(_),z)}}(function(p,y,o){Ev.call(p,o)?p[o].push(y):u(p,o,[y])});const Dv=Mv;var Ng=Object.prototype.hasOwnProperty;const Vg=function rh(p,y,o){var _=p[y];(!Ng.call(p,y)||!mp(_,o)||void 0===o&&!(y in p))&&u(p,y,o)},Hc=function Ug(p,y,o,_){var A=!o;o||(o={});for(var z=-1,ue=y.length;++z<ue;){var _e=y[z],rt=_?_(o[_e],p[_e],_e,o,p):void 0;void 0===rt&&(rt=p[_e]),A?u(o,_e,rt):Vg(o,_e,rt)}return o};var dm=Object.prototype.hasOwnProperty;const jg=function Np(p){if(!uc(p))return function fl(p){var y=[];if(null!=p)for(var o in Object(p))y.push(o);return y}(p);var y=wf(p),o=[];for(var _ in p)"constructor"==_&&(y||!dm.call(p,_))||o.push(_);return o},qh=function Gg(p){return Ef(p)?xf(p,!0):jg(p)};var $g="object"==typeof exports&&exports&&!exports.nodeType&&exports,sh=$g&&"object"==typeof module&&module&&!module.nodeType&&module,Zg=sh&&sh.exports===$g?Es.Buffer:void 0,vd=Zg?Zg.allocUnsafe:void 0;const bc=mc(Object.getPrototypeOf,Object);var gm=Object.getOwnPropertySymbols?function(p){for(var y=[];p;)jf(y,Ip(p)),p=bc(p);return y}:vg;const Au=gm,$c=function qg(p){return Js(p,qh,Au)};var ah=Object.prototype.hasOwnProperty;const vm=function ym(p){var y=new p.constructor(p.byteLength);return new Rh(y).set(new Rh(p)),y};var My=/\w*$/;var Gp=pa?pa.prototype:void 0,Dy=Gp?Gp.valueOf:void 0;const Oy=function Kl(p,y,o){var _=p.constructor;switch(y){case"[object ArrayBuffer]":return vm(p);case"[object Boolean]":case"[object Date]":return new _(+p);case"[object DataView]":return function Cy(p,y){var o=y?vm(p.buffer):p.buffer;return new p.constructor(o,p.byteOffset,p.byteLength)}(p,o);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function xm(p,y){var o=y?vm(p.buffer):p.buffer;return new p.constructor(o,p.byteOffset,p.length)}(p,o);case"[object Map]":case"[object Set]":return new _;case"[object Number]":case"[object String]":return new _(p);case"[object RegExp]":return function Yg(p){var y=new p.constructor(p.source,My.exec(p));return y.lastIndex=p.lastIndex,y}(p);case"[object Symbol]":return function bm(p){return Dy?Object(Dy.call(p)):{}}(p)}};var uh=Object.create,Jg=function(){function p(){}return function(y){if(!uc(y))return{};if(uh)return uh(y);p.prototype=y;var o=new p;return p.prototype=void 0,o}}();const ea=Jg;var Zc=Qu&&Qu.isMap;const dh=Zc?dp(Zc):function xd(p){return fe(p)&&"[object Map]"==Ml(p)};var wc=Qu&&Qu.isSet;const Wc=wc?dp(wc):function t_(p){return fe(p)&&"[object Set]"==Ml(p)};var hh="[object Arguments]",wd="[object Function]",s_="[object Object]",io={};io[hh]=io["[object Array]"]=io["[object ArrayBuffer]"]=io["[object DataView]"]=io["[object Boolean]"]=io["[object Date]"]=io["[object Float32Array]"]=io["[object Float64Array]"]=io["[object Int8Array]"]=io["[object Int16Array]"]=io["[object Int32Array]"]=io["[object Map]"]=io["[object Number]"]=io[s_]=io["[object RegExp]"]=io["[object Set]"]=io["[object String]"]=io["[object Symbol]"]=io["[object Uint8Array]"]=io["[object Uint8ClampedArray]"]=io["[object Uint16Array]"]=io["[object Uint32Array]"]=!0,io["[object Error]"]=io[wd]=io["[object WeakMap]"]=!1;const Am=function np(p,y,o,_,A,z){var ue,_e=1&y,rt=2&y,Lt=4&y;if(o&&(ue=A?o(p,_,A,z):o(p)),void 0!==ue)return ue;if(!uc(p))return p;var ln=je(p);if(ln){if(ue=function jp(p){var y=p.length,o=new p.constructor(y);return y&&"string"==typeof p[0]&&ah.call(p,"index")&&(o.index=p.index,o.input=p.input),o}(p),!_e)return function Yh(p,y){var o=-1,_=p.length;for(y||(y=Array(_));++o<_;)y[o]=p[o];return y}(p,ue)}else{var un=Ml(p),ei=un==wd||"[object GeneratorFunction]"==un;if(Un(p))return function pm(p,y){if(y)return p.slice();var o=p.length,_=vd?vd(o):new p.constructor(o);return p.copy(_),_}(p,_e);if(un==s_||un==hh||ei&&!A){if(ue=rt||ei?{}:function e_(p){return"function"!=typeof p.constructor||wf(p)?{}:ea(bc(p))}(p),!_e)return rt?function wy(p,y){return Hc(p,Au(p),y)}(p,function Hg(p,y){return p&&Hc(y,qh(y),p)}(ue,p)):function fm(p,y){return Hc(p,Ip(p),y)}(p,function cm(p,y){return p&&Hc(y,Ju(y),p)}(ue,p))}else{if(!io[un])return A?p:{};ue=Oy(p,un,_e)}}z||(z=new Ud);var yi=z.get(p);if(yi)return yi;z.set(p,ue),Wc(p)?p.forEach(function(Fi){ue.add(np(Fi,y,o,Fi,p,z))}):dh(p)&&p.forEach(function(Fi,Ki){ue.set(Ki,np(Fi,y,o,Ki,p,z))});var hi=ln?void 0:(Lt?rt?$c:Hf:rt?qh:Ju)(p);return function xy(p,y){for(var o=-1,_=null==p?0:p.length;++o<_&&!1!==y(p[o],o,p););}(hi||p,function(Fi,Ki){hi&&(Fi=p[Ki=Fi]),Vg(ue,Ki,np(Fi,y,o,Ki,p,z))}),ue};function fh(p){return"object"==typeof p&&null!=p&&1===p.nodeType}function p_(p,y){return(!y||"hidden"!==p)&&"visible"!==p&&"clip"!==p}function Cd(p,y){if(p.clientHeight<p.scrollHeight||p.clientWidth<p.scrollWidth){var o=getComputedStyle(p,null);return p_(o.overflowY,y)||p_(o.overflowX,y)||!!(A=function(z){if(!z.ownerDocument||!z.ownerDocument.defaultView)return null;try{return z.ownerDocument.defaultView.frameElement}catch{return null}}(_=p))&&(A.clientHeight<_.scrollHeight||A.clientWidth<_.scrollWidth)}var _,A;return!1}function qc(p,y,o,_,A,z,ue,_e){return z<p&&ue>y||z>p&&ue<y?0:z<=p&&_e<=o||ue>=y&&_e>=o?z-p-_:ue>y&&_e<o||z<p&&_e>o?ue-y+A:0}function ef(p,y){var o=window,_=y.scrollMode,A=y.block,z=y.inline,ue=y.boundary,_e=y.skipOverflowHiddenElements,rt="function"==typeof ue?ue:function(up){return up!==ue};if(!fh(p))throw new TypeError("Invalid target");for(var Lt=document.scrollingElement||document.documentElement,ln=[],un=p;fh(un)&&rt(un);){if((un=un.parentElement)===Lt){ln.push(un);break}null!=un&&un===document.body&&Cd(un)&&!Cd(document.documentElement)||null!=un&&Cd(un,_e)&&ln.push(un)}for(var ei=o.visualViewport?o.visualViewport.width:innerWidth,yi=o.visualViewport?o.visualViewport.height:innerHeight,si=window.scrollX||pageXOffset,hi=window.scrollY||pageYOffset,Fi=p.getBoundingClientRect(),Ki=Fi.height,Vr=Fi.width,Ro=Fi.top,_o=Fi.right,Pa=Fi.bottom,gs=Fi.left,yo="start"===A||"nearest"===A?Ro:"end"===A?Pa:Ro+Ki/2,os="center"===z?gs+Vr/2:"end"===z?_o:gs,Is=[],Jl=0;Jl<ln.length;Jl++){var Ja=ln[Jl],Tc=Ja.getBoundingClientRect(),iu=Tc.height,_f=Tc.width,lp=Tc.top,xi=Tc.right,Bi=Tc.bottom,Ni=Tc.left;if("if-needed"===_&&Ro>=0&&gs>=0&&Pa<=yi&&_o<=ei&&Ro>=lp&&Pa<=Bi&&gs>=Ni&&_o<=xi)return Is;var Tr=getComputedStyle(Ja),Yo=parseInt(Tr.borderLeftWidth,10),Tl=parseInt(Tr.borderTopWidth,10),Ns=parseInt(Tr.borderRightWidth,10),Sl=parseInt(Tr.borderBottomWidth,10),Xr=0,Bu=0,cp="offsetWidth"in Ja?Ja.offsetWidth-Ja.clientWidth-Yo-Ns:0,_s="offsetHeight"in Ja?Ja.offsetHeight-Ja.clientHeight-Tl-Sl:0;if(Lt===Ja)Xr="start"===A?yo:"end"===A?yo-yi:"nearest"===A?qc(hi,hi+yi,yi,Tl,Sl,hi+yo,hi+yo+Ki,Ki):yo-yi/2,Bu="start"===z?os:"center"===z?os-ei/2:"end"===z?os-ei:qc(si,si+ei,ei,Yo,Ns,si+os,si+os+Vr,Vr),Xr=Math.max(0,Xr+hi),Bu=Math.max(0,Bu+si);else{Xr="start"===A?yo-lp-Tl:"end"===A?yo-Bi+Sl+_s:"nearest"===A?qc(lp,Bi,iu,Tl,Sl+_s,yo,yo+Ki,Ki):yo-(lp+iu/2)+_s/2,Bu="start"===z?os-Ni-Yo:"center"===z?os-(Ni+_f/2)+cp/2:"end"===z?os-xi+Ns+cp:qc(Ni,xi,_f,Yo,Ns+cp,os,os+Vr,Vr);var ec=Ja.scrollLeft,ba=Ja.scrollTop;yo+=ba-(Xr=Math.max(0,Math.min(ba+Xr,Ja.scrollHeight-iu+_s))),os+=ec-(Bu=Math.max(0,Math.min(ec+Bu,Ja.scrollWidth-_f+cp)))}Is.push({el:Ja,top:Xr,left:Bu})}return Is}function f_(p){return p===Object(p)&&0!==Object.keys(p).length}let Cc=(()=>{class p{constructor(){this.resize$=new to.x}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();var xo=j(4006),Yc=j(1681),Qa=j(4859),Ai=j(3238),Ji=j(1281),ml=j(2687),mh=j(5017),Aa=j(9521);let Kc=(()=>{class p{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(o){this._vertical=(0,Ji.Ig)(o)}get inset(){return this._inset}set inset(o){this._inset=(0,Ji.Ig)(o)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(o,_){2&o&&(d.uIk("aria-orientation",_.vertical?"vertical":"horizontal"),d.ekj("mat-divider-vertical",_.vertical)("mat-divider-horizontal",!_.vertical)("mat-divider-inset",_.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(o,_){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0}),p})(),ip=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.BQ,Ai.BQ]}),p})();const Ed=["*"],m_=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],tf=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],rp=(0,Ai.Id)((0,Ai.Kr)(class{})),Av=(0,Ai.Kr)(class{}),Dd=new d.OlP("MatList"),Rm=new d.OlP("MatNavList");let Lm=(()=>{class p extends rp{constructor(){super(...arguments),this._stateChanges=new to.x}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return p.\u0275fac=function(){let y;return function(_){return(y||(y=d.n5z(p)))(_||p)}}(),p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[d._Bn([{provide:Rm,useExisting:p}]),d.qOj,d.TTD],ngContentSelectors:Ed,decls:1,vars:0,template:function(o,_){1&o&&(d.F$t(),d.Hsn(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:hover{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}'],encapsulation:2,changeDetection:0}),p})(),Ec=(()=>{class p extends rp{constructor(o){super(),this._elementRef=o,this._stateChanges=new to.x,"action-list"===this._getListType()&&o.nativeElement.classList.add("mat-action-list")}_getListType(){const o=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===o?"list":"mat-action-list"===o?"action-list":null}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.SBq))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-list"],["mat-action-list"]],hostAttrs:[1,"mat-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matList"],features:[d._Bn([{provide:Dd,useExisting:p}]),d.qOj,d.TTD],ngContentSelectors:Ed,decls:1,vars:0,template:function(o,_){1&o&&(d.F$t(),d.Hsn(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:hover{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}'],encapsulation:2,changeDetection:0}),p})(),nf=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275dir=d.lG2({type:p,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),p})(),rf=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275dir=d.lG2({type:p,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),p})(),Mc=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275dir=d.lG2({type:p,selectors:[["","mat-subheader",""],["","matSubheader",""]],hostAttrs:[1,"mat-subheader"]}),p})(),Xc=(()=>{class p extends Av{constructor(o,_,A,z){super(),this._element=o,this._isInteractiveList=!1,this._destroyed=new to.x,this._disabled=!1,this._isInteractiveList=!!(A||z&&"action-list"===z._getListType()),this._list=A||z;const ue=this._getHostElement();"button"===ue.nodeName.toLowerCase()&&!ue.hasAttribute("type")&&ue.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe((0,Rr.R)(this._destroyed)).subscribe(()=>{_.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(o){this._disabled=(0,Ji.Ig)(o)}ngAfterContentInit(){(0,Ai.E0)(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(Rm,8),d.Y36(Dd,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(o,_,A){if(1&o&&(d.Suo(A,nf,5),d.Suo(A,rf,5),d.Suo(A,Ai.X2,5)),2&o){let z;d.iGM(z=d.CRH())&&(_._avatar=z.first),d.iGM(z=d.CRH())&&(_._icon=z.first),d.iGM(z=d.CRH())&&(_._lines=z)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:4,hostBindings:function(o,_){2&o&&d.ekj("mat-list-item-disabled",_.disabled)("mat-list-item-with-avatar",_._avatar||_._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[d.qOj],ngContentSelectors:tf,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(o,_){1&o&&(d.F$t(m_),d.TgZ(0,"span",0),d._UZ(1,"span",1),d.Hsn(2),d.TgZ(3,"span",2),d.Hsn(4,1),d.qZA(),d.Hsn(5,2),d.qZA()),2&o&&(d.xp6(1),d.Q6J("matRippleTrigger",_._getHostElement())("matRippleDisabled",_._isRippleDisabled()))},dependencies:[Ai.wG],encapsulation:2,changeDetection:0}),p})(),Vy=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.uc,Ai.si,Ai.BQ,Ai.us,me.ez,Ai.uc,Ai.BQ,Ai.us,ip]}),p})();var Ou=j(9549),Dc=j(3353),_h=j(515);const Qc=(0,Dc.i$)({passive:!0});let Uy=(()=>{class p{constructor(o,_){this._platform=o,this._ngZone=_,this._monitoredElements=new Map}monitor(o){if(!this._platform.isBrowser)return _h.E;const _=(0,Ji.fI)(o),A=this._monitoredElements.get(_);if(A)return A.subject;const z=new to.x,ue="cdk-text-field-autofilled",_e=rt=>{"cdk-text-field-autofill-start"!==rt.animationName||_.classList.contains(ue)?"cdk-text-field-autofill-end"===rt.animationName&&_.classList.contains(ue)&&(_.classList.remove(ue),this._ngZone.run(()=>z.next({target:rt.target,isAutofilled:!1}))):(_.classList.add(ue),this._ngZone.run(()=>z.next({target:rt.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{_.addEventListener("animationstart",_e,Qc),_.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(_,{subject:z,unlisten:()=>{_.removeEventListener("animationstart",_e,Qc)}}),z}stopMonitoring(o){const _=(0,Ji.fI)(o),A=this._monitoredElements.get(_);A&&(A.unlisten(),A.subject.complete(),_.classList.remove("cdk-text-field-autofill-monitored"),_.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(_))}ngOnDestroy(){this._monitoredElements.forEach((o,_)=>this.stopMonitoring(_))}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(Dc.t4),d.LFG(d.R0b))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),i=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({}),p})();const h=new d.OlP("MAT_INPUT_VALUE_ACCESSOR"),g=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let b=0;const C=(0,Ai.FD)(class{constructor(p,y,o,_){this._defaultErrorStateMatcher=p,this._parentForm=y,this._parentFormGroup=o,this.ngControl=_,this.stateChanges=new to.x}});let D=(()=>{class p extends C{constructor(o,_,A,z,ue,_e,rt,Lt,ln,un){super(_e,z,ue,A),this._elementRef=o,this._platform=_,this._autofillMonitor=Lt,this._formField=un,this._uid="mat-input-"+b++,this.focused=!1,this.stateChanges=new to.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(si=>(0,Dc.qK)().has(si)),this._iOSKeyupListener=si=>{const hi=si.target;!hi.value&&0===hi.selectionStart&&0===hi.selectionEnd&&(hi.setSelectionRange(1,1),hi.setSelectionRange(0,0))};const ei=this._elementRef.nativeElement,yi=ei.nodeName.toLowerCase();this._inputValueAccessor=rt||ei,this._previousNativeValue=this.value,this.id=this.id,_.IOS&&ln.runOutsideAngular(()=>{o.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===yi,this._isTextarea="textarea"===yi,this._isInFormField=!!un,this._isNativeSelect&&(this.controlType=ei.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(o){this._disabled=(0,Ji.Ig)(o),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(o){this._id=o||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(xo.kI.required)??!1}set required(o){this._required=(0,Ji.Ig)(o)}get type(){return this._type}set type(o){this._type=o||"text",this._validateType(),!this._isTextarea&&(0,Dc.qK)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(o){o!==this.value&&(this._inputValueAccessor.value=o,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(o){this._readonly=(0,Ji.Ig)(o)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(o=>{this.autofilled=o.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(o){this._elementRef.nativeElement.focus(o)}_focusChanged(o){o!==this.focused&&(this.focused=o,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const o=this._formField,_=o&&"legacy"===o.appearance&&!o._hasLabel?.()?null:this.placeholder;if(_!==this._previousPlaceholder){const A=this._elementRef.nativeElement;this._previousPlaceholder=_,_?A.setAttribute("placeholder",_):A.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const o=this._elementRef.nativeElement.value;this._previousNativeValue!==o&&(this._previousNativeValue=o,this.stateChanges.next())}_validateType(){g.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let o=this._elementRef.nativeElement.validity;return o&&o.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const o=this._elementRef.nativeElement,_=o.options[0];return this.focused||o.multiple||!this.empty||!!(o.selectedIndex>-1&&_&&_.label)}return this.focused||!this.empty}setDescribedByIds(o){o.length?this._elementRef.nativeElement.setAttribute("aria-describedby",o.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const o=this._elementRef.nativeElement;return this._isNativeSelect&&(o.multiple||o.size>1)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.SBq),d.Y36(Dc.t4),d.Y36(xo.a5,10),d.Y36(xo.F,8),d.Y36(xo.sg,8),d.Y36(Ai.rD),d.Y36(h,10),d.Y36(Uy),d.Y36(d.R0b),d.Y36(Ou.G_,8))},p.\u0275dir=d.lG2({type:p,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(o,_){1&o&&d.NdJ("focus",function(){return _._focusChanged(!0)})("blur",function(){return _._focusChanged(!1)})("input",function(){return _._onInput()}),2&o&&(d.Ikx("disabled",_.disabled)("required",_.required),d.uIk("id",_.id)("data-placeholder",_.placeholder)("name",_.name||null)("readonly",_.readonly&&!_._isNativeSelect||null)("aria-invalid",_.empty&&_.required?null:_.errorState)("aria-required",_.required),d.ekj("mat-input-server",_._isServer)("mat-native-select-inline",_._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[d._Bn([{provide:Ou.Eo,useExisting:p}]),d.qOj,d.TTD]}),p})(),S=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({providers:[Ai.rD],imports:[i,Ou.lN,Ai.BQ,i,Ou.lN]}),p})();var R=j(8605),V=j(445),U=j(4004),ee=j(1884);const oe=["*"],pe=["content"];function Ie(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"div",2),d.NdJ("click",function(){d.CHM(o);const A=d.oxw();return d.KtG(A._onBackdropClicked())}),d.qZA()}if(2&p){const o=d.oxw();d.ekj("mat-drawer-shown",o._isShowingBackdrop())}}function Ne(p,y){1&p&&(d.TgZ(0,"mat-drawer-content"),d.Hsn(1,2),d.qZA())}const at=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],ot=["mat-drawer","mat-drawer-content","*"];function yt(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"div",2),d.NdJ("click",function(){d.CHM(o);const A=d.oxw();return d.KtG(A._onBackdropClicked())}),d.qZA()}if(2&p){const o=d.oxw();d.ekj("mat-drawer-shown",o._isShowingBackdrop())}}function wt(p,y){1&p&&(d.TgZ(0,"mat-sidenav-content"),d.Hsn(1,2),d.qZA())}const It=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Wt=["mat-sidenav","mat-sidenav-content","*"],dn={transformDrawer:(0,Ve.X$)("transform",[(0,Ve.SB)("open, open-instant",(0,Ve.oB)({transform:"none",visibility:"visible"})),(0,Ve.SB)("void",(0,Ve.oB)({"box-shadow":"none",visibility:"hidden"})),(0,Ve.eR)("void => open-instant",(0,Ve.jt)("0ms")),(0,Ve.eR)("void <=> open, open-instant => void",(0,Ve.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Vt=new d.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Sn(){return!1}}),on=new d.OlP("MAT_DRAWER_CONTAINER");let Dn=(()=>{class p extends R.PQ{constructor(o,_,A,z,ue){super(A,z,ue),this._changeDetectorRef=o,this._container=_}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.sBO),d.Y36((0,d.Gpc)(()=>wn)),d.Y36(d.SBq),d.Y36(R.mF),d.Y36(d.R0b))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(o,_){2&o&&d.Udp("margin-left",_._container._contentMargins.left,"px")("margin-right",_._container._contentMargins.right,"px")},features:[d._Bn([{provide:R.PQ,useExisting:p}]),d.qOj],ngContentSelectors:oe,decls:1,vars:0,template:function(o,_){1&o&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),p})(),Kn=(()=>{class p{constructor(o,_,A,z,ue,_e,rt,Lt){this._elementRef=o,this._focusTrapFactory=_,this._focusMonitor=A,this._platform=z,this._ngZone=ue,this._interactivityChecker=_e,this._doc=rt,this._container=Lt,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new to.x,this._animationEnd=new to.x,this._animationState="void",this.openedChange=new d.vpe(!0),this._openedStream=this.openedChange.pipe((0,Zo.h)(ln=>ln),(0,U.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,Zo.h)(ln=>ln.fromState!==ln.toState&&0===ln.toState.indexOf("open")),(0,Cs.h)(void 0)),this._closedStream=this.openedChange.pipe((0,Zo.h)(ln=>!ln),(0,U.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,Zo.h)(ln=>ln.fromState!==ln.toState&&"void"===ln.toState),(0,Cs.h)(void 0)),this._destroyed=new to.x,this.onPositionChanged=new d.vpe,this._modeChanged=new to.x,this.openedChange.subscribe(ln=>{ln?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,ws.R)(this._elementRef.nativeElement,"keydown").pipe((0,Zo.h)(ln=>ln.keyCode===Aa.hY&&!this.disableClose&&!(0,Aa.Vb)(ln)),(0,Rr.R)(this._destroyed)).subscribe(ln=>this._ngZone.run(()=>{this.close(),ln.stopPropagation(),ln.preventDefault()}))}),this._animationEnd.pipe((0,ee.x)((ln,un)=>ln.fromState===un.fromState&&ln.toState===un.toState)).subscribe(ln=>{const{fromState:un,toState:ei}=ln;(0===ei.indexOf("open")&&"void"===un||"void"===ei&&0===un.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(o){(o="end"===o?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(o),this._position=o,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(o){this._mode=o,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(o){this._disableClose=(0,Ji.Ig)(o)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(o){("true"===o||"false"===o||null==o)&&(o=(0,Ji.Ig)(o)),this._autoFocus=o}get opened(){return this._opened}set opened(o){this.toggle((0,Ji.Ig)(o))}_forceFocus(o,_){this._interactivityChecker.isFocusable(o)||(o.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const A=()=>{o.removeEventListener("blur",A),o.removeEventListener("mousedown",A),o.removeAttribute("tabindex")};o.addEventListener("blur",A),o.addEventListener("mousedown",A)})),o.focus(_)}_focusByCssSelector(o,_){let A=this._elementRef.nativeElement.querySelector(o);A&&this._forceFocus(A,_)}_takeFocus(){if(!this._focusTrap)return;const o=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(_=>{!_&&"function"==typeof this._elementRef.nativeElement.focus&&o.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(o){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,o):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const o=this._doc.activeElement;return!!o&&this._elementRef.nativeElement.contains(o)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(o){return this.toggle(!0,o)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(o=!this.opened,_){o&&_&&(this._openedVia=_);const A=this._setOpen(o,!o&&this._isFocusWithinDrawer(),this._openedVia||"program");return o||(this._openedVia=null),A}_setOpen(o,_,A){return this._opened=o,o?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",_&&this._restoreFocus(A)),this._updateFocusTrapState(),new Promise(z=>{this.openedChange.pipe((0,Pc.q)(1)).subscribe(ue=>z(ue?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(o){const _=this._elementRef.nativeElement,A=_.parentNode;"end"===o?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),A.insertBefore(this._anchor,_)),A.appendChild(_)):this._anchor&&this._anchor.parentNode.insertBefore(_,this._anchor)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.SBq),d.Y36(ml.qV),d.Y36(ml.tE),d.Y36(Dc.t4),d.Y36(d.R0b),d.Y36(ml.ic),d.Y36(me.K0,8),d.Y36(on,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-drawer"]],viewQuery:function(o,_){if(1&o&&d.Gf(pe,5),2&o){let A;d.iGM(A=d.CRH())&&(_._content=A.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(o,_){1&o&&d.WFA("@transform.start",function(z){return _._animationStarted.next(z)})("@transform.done",function(z){return _._animationEnd.next(z)}),2&o&&(d.uIk("align",null),d.d8E("@transform",_._animationState),d.ekj("mat-drawer-end","end"===_.position)("mat-drawer-over","over"===_.mode)("mat-drawer-push","push"===_.mode)("mat-drawer-side","side"===_.mode)("mat-drawer-opened",_.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:oe,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(o,_){1&o&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA())},dependencies:[R.PQ],encapsulation:2,data:{animation:[dn.transformDrawer]},changeDetection:0}),p})(),wn=(()=>{class p{constructor(o,_,A,z,ue,_e=!1,rt){this._dir=o,this._element=_,this._ngZone=A,this._changeDetectorRef=z,this._animationMode=rt,this._drawers=new d.n_E,this.backdropClick=new d.vpe,this._destroyed=new to.x,this._doCheckSubject=new to.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new to.x,o&&o.change.pipe((0,Rr.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),ue.change().pipe((0,Rr.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=_e}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(o){this._autosize=(0,Ji.Ig)(o)}get hasBackdrop(){return this._backdropOverride??(!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode)}set hasBackdrop(o){this._backdropOverride=null==o?null:(0,Ji.Ig)(o)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,ha.O)(this._allDrawers),(0,Rr.R)(this._destroyed)).subscribe(o=>{this._drawers.reset(o.filter(_=>!_._container||_._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,ha.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(o=>{this._watchDrawerToggle(o),this._watchDrawerPosition(o),this._watchDrawerMode(o)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,ju.b)(10),(0,Rr.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(o=>o.open())}close(){this._drawers.forEach(o=>o.close())}updateContentMargins(){let o=0,_=0;if(this._left&&this._left.opened)if("side"==this._left.mode)o+=this._left._getWidth();else if("push"==this._left.mode){const A=this._left._getWidth();o+=A,_-=A}if(this._right&&this._right.opened)if("side"==this._right.mode)_+=this._right._getWidth();else if("push"==this._right.mode){const A=this._right._getWidth();_+=A,o-=A}o=o||null,_=_||null,(o!==this._contentMargins.left||_!==this._contentMargins.right)&&(this._contentMargins={left:o,right:_},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(o){o._animationStarted.pipe((0,Zo.h)(_=>_.fromState!==_.toState),(0,Rr.R)(this._drawers.changes)).subscribe(_=>{"open-instant"!==_.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==o.mode&&o.openedChange.pipe((0,Rr.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(o.opened))}_watchDrawerPosition(o){!o||o.onPositionChanged.pipe((0,Rr.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,Pc.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(o){o&&o._modeChanged.pipe((0,Rr.R)((0,ja.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(o){const _=this._element.nativeElement.classList,A="mat-drawer-container-has-open";o?_.add(A):_.remove(A)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(o=>{"end"==o.position?this._end=o:this._start=o}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(o=>o&&!o.disableClose&&this._canHaveBackdrop(o)).forEach(o=>o._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(o){return"side"!==o.mode||!!this._backdropOverride}_isDrawerOpen(o){return null!=o&&o.opened}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(V.Is,8),d.Y36(d.SBq),d.Y36(d.R0b),d.Y36(d.sBO),d.Y36(R.rL),d.Y36(Vt),d.Y36(d.QbO,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-drawer-container"]],contentQueries:function(o,_,A){if(1&o&&(d.Suo(A,Dn,5),d.Suo(A,Kn,5)),2&o){let z;d.iGM(z=d.CRH())&&(_._content=z.first),d.iGM(z=d.CRH())&&(_._allDrawers=z)}},viewQuery:function(o,_){if(1&o&&d.Gf(Dn,5),2&o){let A;d.iGM(A=d.CRH())&&(_._userContent=A.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(o,_){2&o&&d.ekj("mat-drawer-container-explicit-backdrop",_._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[d._Bn([{provide:on,useExisting:p}])],ngContentSelectors:ot,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(o,_){1&o&&(d.F$t(at),d.YNc(0,Ie,1,2,"div",0),d.Hsn(1),d.Hsn(2,1),d.YNc(3,Ne,2,0,"mat-drawer-content",1)),2&o&&(d.Q6J("ngIf",_.hasBackdrop),d.xp6(3),d.Q6J("ngIf",!_._content))},dependencies:[me.O5,Dn],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),p})(),$n=(()=>{class p extends Dn{constructor(o,_,A,z,ue){super(o,_,A,z,ue)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.sBO),d.Y36((0,d.Gpc)(()=>qi)),d.Y36(d.SBq),d.Y36(R.mF),d.Y36(d.R0b))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(o,_){2&o&&d.Udp("margin-left",_._container._contentMargins.left,"px")("margin-right",_._container._contentMargins.right,"px")},features:[d._Bn([{provide:R.PQ,useExisting:p}]),d.qOj],ngContentSelectors:oe,decls:1,vars:0,template:function(o,_){1&o&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),p})(),Hi=(()=>{class p extends Kn{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(o){this._fixedInViewport=(0,Ji.Ig)(o)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(o){this._fixedTopGap=(0,Ji.su)(o)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(o){this._fixedBottomGap=(0,Ji.su)(o)}}return p.\u0275fac=function(){let y;return function(_){return(y||(y=d.n5z(p)))(_||p)}}(),p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(o,_){2&o&&(d.uIk("align",null),d.Udp("top",_.fixedInViewport?_.fixedTopGap:null,"px")("bottom",_.fixedInViewport?_.fixedBottomGap:null,"px"),d.ekj("mat-drawer-end","end"===_.position)("mat-drawer-over","over"===_.mode)("mat-drawer-push","push"===_.mode)("mat-drawer-side","side"===_.mode)("mat-drawer-opened",_.opened)("mat-sidenav-fixed",_.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[d.qOj],ngContentSelectors:oe,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(o,_){1&o&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA())},dependencies:[R.PQ],encapsulation:2,data:{animation:[dn.transformDrawer]},changeDetection:0}),p})(),qi=(()=>{class p extends wn{}return p.\u0275fac=function(){let y;return function(_){return(y||(y=d.n5z(p)))(_||p)}}(),p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-sidenav-container"]],contentQueries:function(o,_,A){if(1&o&&(d.Suo(A,$n,5),d.Suo(A,Hi,5)),2&o){let z;d.iGM(z=d.CRH())&&(_._content=z.first),d.iGM(z=d.CRH())&&(_._allDrawers=z)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(o,_){2&o&&d.ekj("mat-drawer-container-explicit-backdrop",_._backdropOverride)},exportAs:["matSidenavContainer"],features:[d._Bn([{provide:on,useExisting:p}]),d.qOj],ngContentSelectors:Wt,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(o,_){1&o&&(d.F$t(It),d.YNc(0,yt,1,2,"div",0),d.Hsn(1),d.Hsn(2,1),d.YNc(3,wt,2,0,"mat-sidenav-content",1)),2&o&&(d.Q6J("ngIf",_.hasBackdrop),d.xp6(3),d.Q6J("ngIf",!_._content))},dependencies:[me.O5,$n],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),p})(),gi=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[me.ez,Ai.BQ,R.ZD,R.ZD,Ai.BQ]}),p})();var Qn=j(9643);const lr=["input"],$i=function(p){return{enterDuration:p}},ai=["*"],Oo=new d.OlP("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let ko=0;const ro={provide:xo.JU,useExisting:(0,d.Gpc)(()=>Pr),multi:!0};class er{constructor(y,o){this.source=y,this.checked=o}}const pr=(0,Ai.sb)((0,Ai.pj)((0,Ai.Kr)((0,Ai.Id)(class{constructor(p){this._elementRef=p}}))));let Nr=(()=>{class p extends pr{constructor(o,_,A,z,ue,_e,rt){super(o),this._focusMonitor=_,this._changeDetectorRef=A,this.defaults=ue,this._onChange=Lt=>{},this._onTouched=()=>{},this._required=!1,this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new d.vpe,this.toggleChange=new d.vpe,this.tabIndex=parseInt(z)||0,this.color=this.defaultColor=ue.color||"accent",this._noopAnimations="NoopAnimations"===_e,this.id=this._uniqueId=`${rt}${++ko}`}get required(){return this._required}set required(o){this._required=(0,Ji.Ig)(o)}get checked(){return this._checked}set checked(o){this._checked=(0,Ji.Ig)(o),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(o=>{"keyboard"===o||"program"===o?this._focused=!0:o||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(o){this.checked=!!o}registerOnChange(o){this._onChange=o}registerOnTouched(o){this._onTouched=o}setDisabledState(o){this.disabled=o,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}}return p.\u0275fac=function(o){d.$Z()},p.\u0275dir=d.lG2({type:p,inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},features:[d.qOj]}),p})(),Pr=(()=>{class p extends Nr{constructor(o,_,A,z,ue,_e){super(o,_,A,z,ue,_e,"mat-slide-toggle-")}_createChangeEvent(o){return new er(this,o)}_onChangeEvent(o){o.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(o){o.stopPropagation()}focus(o,_){_?this._focusMonitor.focusVia(this._inputElement,_,o):this._inputElement.nativeElement.focus(o)}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.SBq),d.Y36(ml.tE),d.Y36(d.sBO),d.$8M("tabindex"),d.Y36(Oo),d.Y36(d.QbO,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-slide-toggle"]],viewQuery:function(o,_){if(1&o&&d.Gf(lr,5),2&o){let A;d.iGM(A=d.CRH())&&(_._inputElement=A.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(o,_){2&o&&(d.Ikx("id",_.id),d.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),d.ekj("mat-checked",_.checked)("mat-disabled",_.disabled)("mat-slide-toggle-label-before","before"==_.labelPosition)("_mat-animation-noopable",_._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matSlideToggle"],features:[d._Bn([ro]),d.qOj],ngContentSelectors:ai,decls:14,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(o,_){if(1&o&&(d.F$t(),d.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),d.NdJ("change",function(z){return _._onChangeEvent(z)})("click",function(z){return _._onInputClick(z)}),d.qZA(),d.TgZ(5,"span",5),d._UZ(6,"span",6),d.TgZ(7,"span",7),d._UZ(8,"span",8),d.qZA()()(),d.TgZ(9,"span",9,10),d.NdJ("cdkObserveContent",function(){return _._onLabelTextChange()}),d.TgZ(11,"span",11),d._uU(12,"\xa0"),d.qZA(),d.Hsn(13),d.qZA()()),2&o){const A=d.MAs(1),z=d.MAs(10);d.uIk("for",_.inputId),d.xp6(2),d.ekj("mat-slide-toggle-bar-no-side-margin",!z.textContent||!z.textContent.trim()),d.xp6(1),d.Q6J("id",_.inputId)("required",_.required)("tabIndex",_.tabIndex)("checked",_.checked)("disabled",_.disabled),d.uIk("name",_.name)("aria-checked",_.checked)("aria-label",_.ariaLabel)("aria-labelledby",_.ariaLabelledby)("aria-describedby",_.ariaDescribedby),d.xp6(4),d.Q6J("matRippleTrigger",A)("matRippleDisabled",_.disableRipple||_.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",d.VKq(18,$i,_._noopAnimations?0:150))}},dependencies:[Ai.wG,Qn.wD],styles:['.mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.mat-slide-toggle-input:focus~.mat-slide-toggle-thumb-container .mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}'],encapsulation:2,changeDetection:0}),p})(),Kr=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({}),p})(),ts=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Kr,Ai.si,Ai.BQ,Qn.Q8,Kr,Ai.BQ]}),p})();const Ia=["exampleLink"];function dr(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"button",11),d.NdJ("click",function(){d.CHM(o);const A=d.oxw();return d.KtG(A.clearSearch())}),d.TgZ(1,"mat-icon"),d._uU(2,"close"),d.qZA()()}}const go=function(p){return{_routerLinkActiveWakeUpHack_:p}};function zs(p,y){if(1&p&&(d.TgZ(0,"a",14,15),d._uU(2),d.qZA()),2&p){const o=d.oxw().$implicit,_=d.oxw(2);d.Q6J("routerLink","/demo/"+(_.isEditMode?"/edit/":"")+o.path)("routerLinkActiveOptions",d.VKq(3,go,_.isEditMode)),d.xp6(2),d.hij(" ",o.data.label," ")}}function Mr(p,y){if(1&p&&(d.ynx(0),d.YNc(1,zs,3,5,"a",13),d.BQk()),2&p){const o=y.$implicit;d.xp6(1),d.Q6J("ngIf",o)}}function ho(p,y){if(1&p&&(d.ynx(0),d.TgZ(1,"h3",12),d._uU(2),d.qZA(),d.YNc(3,Mr,2,1,"ng-container",9),d._UZ(4,"mat-divider"),d.BQk()),2&p){const o=y.$implicit,_=d.oxw();d.xp6(2),d.Oqu(o),d.xp6(1),d.Q6J("ngForOf",_.routes[o])}}let na=(()=>{class p{constructor(o,_,A,z){this.zone=o,this.router=_,this.activatedRoute=A,this.mapResizeService=z,this.sidenavIsOpen=!0,this.isEditMode=!!this.activatedRoute.snapshot.firstChild?.params.demoUrl,this.originalRoutes=Dv(xv[0].children,ue=>ue.data?ue.data.cat:null),this.categories=Object.values(hr)}ngOnInit(){this.routes=this.originalRoutes}ngAfterViewInit(){this.scrollInToActiveExampleLink()}toggleSidenav(){this.sidenavIsOpen=!this.sidenavIsOpen}toggleEdit(o){const _=this.activatedRoute.snapshot.firstChild;this.router.navigate(o.checked?["demo","edit",_.url[0].path]:["demo",_.params.demoUrl])}onSidenavChange(){this.mapResizeService.resize$.next(void 0)}search(){this.routes=function zy(p){return Am(p,5)}(this.originalRoutes),Object.values(this.routes).forEach(o=>{o.forEach((_,A)=>{_.data&&!_.data.label.toLowerCase().includes(this.searchTerm.toLowerCase())&&delete o[A]})})}clearSearch(){this.searchTerm="",this.routes=this.originalRoutes}scrollInToActiveExampleLink(){this.zone.onStable.pipe((0,Qo.P)()).subscribe(()=>{const o=this.exampleLinks.find(_=>_.nativeElement.classList.contains("active"));o&&function Om(p,y){var o=p.isConnected||p.ownerDocument.documentElement.contains(p);if(f_(y)&&"function"==typeof y.behavior)return y.behavior(o?ef(p,y):[]);if(o){var _=function Pm(p){return!1===p?{block:"end",inline:"nearest"}:f_(p)?p:{block:"start",inline:"nearest"}}(y);(function Im(p,y){void 0===y&&(y="auto");var o="scrollBehavior"in document.body.style;p.forEach(function(_){var A=_.el,z=_.top,ue=_.left;A.scroll&&o?A.scroll({top:z,left:ue,behavior:y}):(A.scrollTop=z,A.scrollLeft=ue)})})(ef(p,_),_.behavior)}}(o.nativeElement,{block:"center",scrollMode:"if-needed"})})}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.R0b),d.Y36(W.F0),d.Y36(W.gz),d.Y36(Cc))},p.\u0275cmp=d.Xpm({type:p,selectors:[["ng-component"]],viewQuery:function(o,_){if(1&o&&d.Gf(Ia,5,d.SBq),2&o){let A;d.iGM(A=d.CRH())&&(_.exampleLinks=A)}},decls:18,vars:5,consts:[["position","left"],["mat-button","",1,"menu-button",3,"click"],["position","right"],["color","accent",3,"ngModel","ngModelChange","change"],["mode","side",3,"opened","openedChange"],["sidenav",""],[1,"search"],["matInput","","type","text","placeholder","Search",3,"ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"content"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["matSubheader",""],["mat-list-item","","routerLinkActive","active",3,"routerLink","routerLinkActiveOptions",4,"ngIf"],["mat-list-item","","routerLinkActive","active",3,"routerLink","routerLinkActiveOptions"],["exampleLink",""]],template:function(o,_){1&o&&(d.TgZ(0,"showcase-layout-toolbar-menu",0)(1,"button",1),d.NdJ("click",function(){return _.toggleSidenav()}),d.TgZ(2,"mat-icon"),d._uU(3,"menu"),d.qZA()()(),d.TgZ(4,"showcase-layout-toolbar-menu",2)(5,"mat-slide-toggle",3),d.NdJ("ngModelChange",function(z){return _.isEditMode=z})("change",function(z){return _.toggleEdit(z)}),d._uU(6," Edit! "),d.qZA()(),d.TgZ(7,"mat-sidenav-container")(8,"mat-sidenav",4,5),d.NdJ("openedChange",function(){return _.onSidenavChange()}),d.TgZ(10,"mat-form-field",6)(11,"input",7),d.NdJ("ngModelChange",function(z){return _.searchTerm=z})("ngModelChange",function(){return _.search()}),d.qZA(),d.YNc(12,dr,3,0,"button",8),d.qZA(),d.TgZ(13,"mat-nav-list"),d.YNc(14,ho,5,2,"ng-container",9),d.qZA()(),d.TgZ(15,"mat-sidenav-content")(16,"section",10),d._UZ(17,"router-outlet"),d.qZA()()()),2&o&&(d.xp6(5),d.Q6J("ngModel",_.isEditMode),d.xp6(3),d.Q6J("opened",_.sidenavIsOpen),d.xp6(3),d.Q6J("ngModel",_.searchTerm),d.xp6(1),d.Q6J("ngIf",_.searchTerm),d.xp6(2),d.Q6J("ngForOf",_.categories))},dependencies:[W.lC,W.yS,W.Od,me.sg,me.O5,xo.Fj,xo.JJ,xo.On,Yc.a,Qa.lW,Lm,Xc,Mc,Kc,Ou.KE,Ou.R9,D,Ce.Hw,Hi,qi,$n,Pr],styles:["[_nghost-%COMP%], .content[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:row}mat-sidenav[_ngcontent-%COMP%]{width:345px;display:flex;flex-direction:column;flex:1}mat-nav-list[_ngcontent-%COMP%]{overflow-y:auto}mat-sidenav-container[_ngcontent-%COMP%]{flex:1}.content[_ngcontent-%COMP%]{height:100%}mat-form-field.search[_ngcontent-%COMP%]{width:100%;margin-bottom:-1.25em}a.active[_ngcontent-%COMP%]{color:#fff;background-color:#3f51b5!important}"]}),p})(),_i=(()=>{class p{constructor(o,_){this.mapResizeService=o,this.map=_,this.sub=new Na.w0}ngOnInit(){this.sub.add(this.mapResizeService.resize$.subscribe(()=>{this.map.mapInstance.resize()}))}ngOnDestroy(){this.sub.unsubscribe()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(Cc),d.Y36(zi))},p.\u0275dir=d.lG2({type:p,selectors:[["mgl-map"]]}),p})();const wo=function(){return[15.5]},ns=function(p){return[p,40.7135]},is=function(){return[45]},Ts=function(p){return[p]},ia=function(){return["==","extrude","true"]},rs=function(){return["linear"]},Ql=function(){return["zoom"]},Sd=function(){return["get","height"]},Ad=function(p,y,o){return["interpolate",p,y,15,0,15.05,o]},yh=function(){return["get","min_height"]},jy=function(p,y){return{"fill-extrusion-color":"#aaa","fill-extrusion-height":p,"fill-extrusion-base":y,"fill-extrusion-opacity":.6}};let v_=(()=>{class p{onLoad(o){const _=o.getStyle().layers;!_||(this.labelLayerId=this.getLabelLayerId(_))}getLabelLayerId(o){for(const _ of o)if("symbol"===_.type&&_.layout?.["text-field"])return _.id}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:34,consts:[[3,"zoom","center","pitch","bearing","mapLoad"],["id","3d-buildings","source","composite","sourceLayer","building","type","fill-extrusion",3,"filter","minzoom","paint","before"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.NdJ("mapLoad",function(z){return _.onLoad(z)}),d._UZ(1,"mgl-layer",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("zoom",d.DdM(10,wo))("center",d.VKq(11,ns,-74.0066))("pitch",d.DdM(13,is))("bearing",d.VKq(14,Ts,-17.6)),d.xp6(1),d.Q6J("filter",d.DdM(16,ia))("minzoom",15)("paint",d.WLB(31,jy,d.kEZ(20,Ad,d.DdM(17,rs),d.DdM(18,Ql),d.DdM(19,Sd)),d.kEZ(27,Ad,d.DdM(24,rs),d.DdM(25,Ql),d.DdM(26,yh))))("before",_.labelLayerId))},dependencies:[zi,bo,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const b_=function(p){return{width:64,height:64,data:p}},lf=function(){return{}},Bm=function(){return[0,0]},oo=function(p){return{type:"Point",coordinates:p}},zm=function(p,y){return{type:"Feature",properties:p,geometry:y}},Id=function(p){return[p]},Nm=function(p){return{type:"FeatureCollection",features:p}},cf=function(p){return{type:"geojson",data:p}},ku=function(){return{"icon-image":"gradient"}};let uf=(()=>{class p{ngOnInit(){this.imageData=this.generateImage()}generateImage(){const A=new Uint8Array(16384);for(let z=0;z<64;z++)for(let ue=0;ue<64;ue++){const _e=4*(64*ue+z);A[_e+0]=ue/64*255,A[_e+1]=z/64*255,A[_e+2]=128,A[_e+3]=255}return A}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:21,consts:[["id","gradient",3,"data"],["id","points","type","symbol",3,"source","layout"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map"),d._UZ(1,"mgl-image",0)(2,"mgl-layer",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.xp6(1),d.Q6J("data",d.VKq(5,b_,_.imageData)),d.xp6(1),d.Q6J("source",d.VKq(18,cf,d.VKq(16,Nm,d.VKq(14,Id,d.WLB(11,zm,d.DdM(7,lf),d.VKq(9,oo,d.DdM(8,Bm)))))))("layout",d.DdM(20,ku)))},dependencies:[zi,bo,kl,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function x_(p,y){if(1&p&&d._UZ(0,"mgl-image",3),2&p){const o=y.$implicit;d.Q6J("id",o.id)("data",o)}}const Ss=function(){return[0,0]},va=function(p){return{type:"Point",coordinates:p}},op=function(){return{color:"255,0,0"}},vh=function(p,y){return{type:"Feature",geometry:p,properties:y}},w_=function(){return[50,0]},Ru=function(){return{color:"255,209,28"}},d1=function(p){return[p,0]},Gy=function(){return{color:"242,127,32"}},Hy=function(p,y,o){return[p,y,o]},Jc=function(p){return{type:"FeatureCollection",features:p}},Bb=function(p){return{type:"geojson",data:p}},Iv=function(){return["get","color"]},Lu=function(p){return["concat","square-rgb-",p]},eu=function(p){return{"icon-image":p}};let tu=(()=>{class p{constructor(){this.imagesData=[]}generateImage({id:o}){const _="square-rgb-";if(0!==o.indexOf(_))return;const A=o.replace(_,"").split(",").map(Number),_e=new Uint8Array(16384);for(let Lt=0;Lt<64;Lt++)for(let ln=0;ln<64;ln++){const un=4*(64*ln+Lt);_e[un+0]=A[0],_e[un+1]=A[1],_e[un+2]=A[2],_e[un+3]=255}this.imagesData=[...this.imagesData,{id:o,width:64,height:64,data:_e}]}trackByImage(o,_){return _.id}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:41,consts:[[3,"styleImageMissing"],[3,"id","data",4,"ngFor","ngForOf","ngForTrackBy"],["id","points","type","symbol",3,"source","layout"],[3,"id","data"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.NdJ("styleImageMissing",function(z){return _.generateImage(z)}),d.YNc(1,x_,1,2,"mgl-image",1),d._UZ(2,"mgl-layer",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.xp6(1),d.Q6J("ngForOf",_.imagesData)("ngForTrackBy",_.trackByImage),d.xp6(1),d.Q6J("source",d.VKq(34,Bb,d.VKq(32,Jc,d.kEZ(28,Hy,d.WLB(10,vh,d.VKq(7,va,d.DdM(6,Ss)),d.DdM(9,op)),d.WLB(17,vh,d.VKq(14,va,d.DdM(13,w_)),d.DdM(16,Ru)),d.WLB(25,vh,d.VKq(22,va,d.VKq(20,d1,-50)),d.DdM(24,Gy))))))("layout",d.VKq(39,eu,d.VKq(37,Lu,d.DdM(36,Iv)))))},dependencies:[me.sg,zi,bo,kl,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Pv=function(){return{}},Ov=function(){return[0,0]},zb=function(p){return{type:"Point",coordinates:p}},Nb=function(p,y){return{type:"Feature",properties:p,geometry:y}},Vb=function(p){return[p]},Ub=function(p){return{type:"FeatureCollection",features:p}},$y=function(p){return{type:"geojson",data:p}},Vm=function(){return{"icon-image":"cat","icon-size":.25}};function jb(p,y){1&p&&d._UZ(0,"mgl-layer",2),2&p&&d.Q6J("source",d.VKq(13,$y,d.VKq(11,Ub,d.VKq(9,Vb,d.WLB(6,Nb,d.DdM(2,Pv),d.VKq(4,zb,d.DdM(3,Ov)))))))("layout",d.DdM(15,Vm))}let kv=(()=>{class p{constructor(){this.imageLoaded=!1}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:3,consts:[["id","cat","url","https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Cat_silhouette.svg/400px-Cat_silhouette.svg.png",3,"imageLoaded"],["id","points","type","symbol",3,"source","layout",4,"ngIf"],["id","points","type","symbol",3,"source","layout"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map")(1,"mgl-image",0),d.NdJ("imageLoaded",function(){return _.imageLoaded=!0}),d.qZA(),d.YNc(2,jb,1,16,"mgl-layer",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.xp6(2),d.Q6J("ngIf",_.imageLoaded))},dependencies:[me.O5,zi,bo,kl,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Gb=function(p){return[p,38.907]},Rv=function(){return[11.15]};let Lv=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:8,consts:[[3,"center","zoom","attributionControl"],["mglAttribution","","position","top-left"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-control",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("center",d.VKq(5,Gb,-77.04))("zoom",d.DdM(7,Rv))("attributionControl",!1))},dependencies:[zi,zo,ll,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function C_(p,y){1&p&&d._UZ(0,"mgl-feature",4),2&p&&d.Q6J("geometry",y.$implicit)}const Hb=function(){return[8]},Fv=function(){return{"icon-image":"rocket-15"}};let Bv=(()=>{class p{constructor(){this.center=[-90.96,-.47],this.geometries=[{type:"Point",coordinates:[-91.395263671875,-.9145729757782163]},{type:"Point",coordinates:[-90.32958984375,-.6344474832838974]},{type:"Point",coordinates:[-91.34033203125,.01647949196029245]}]}centerMapTo(o){this.center=o.features[0].geometry.coordinates}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:4,vars:9,consts:[[3,"zoom","center","cursorStyle","mapLoad"],["id","symbols-source"],[3,"geometry",4,"ngFor","ngForOf"],["id","symbols","type","symbol","source","symbols-source",3,"layout","layerClick","layerMouseEnter","layerMouseLeave"],[3,"geometry"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.NdJ("mapLoad",function(z){return _.map=z}),d.TgZ(1,"mgl-geojson-source",1),d.YNc(2,C_,1,1,"mgl-feature",2),d.qZA(),d.TgZ(3,"mgl-layer",3),d.NdJ("layerClick",function(z){return _.centerMapTo(z)})("layerMouseEnter",function(){return _.cursorStyle="pointer"})("layerMouseLeave",function(){return _.cursorStyle=""}),d.qZA()()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("zoom",d.DdM(7,Hb))("center",_.center)("cursorStyle",_.cursorStyle),d.xp6(2),d.Q6J("ngForOf",_.geometries),d.xp6(1),d.Q6J("layout",d.DdM(8,Fv)))},dependencies:[me.sg,zi,bo,qs,vl,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function Zy(p,y){1&p&&d._UZ(0,"showcase-cluster-point",6),2&p&&d.Q6J("properties",y.$implicit.properties)}const E_=function(){return[.3]},zv=function(){return[0,20]},Wy=function(){return["!=","cluster",!0]},Nv=function(p){return{fill:p}};function Vv(p,y){if(1&p&&(d.O4$(),d._UZ(0,"path",4)),2&p){const o=y.$implicit;d.Q6J("ngStyle",d.VKq(2,Nv,o.fill)),d.uIk("d",o.d)}}const Uv=function(p){return{font:p}},sp=["#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c"];let jv=(()=>{class p{constructor(){const o=["<",["get","mag"],2],_=["all",[">=",["get","mag"],2],["<",["get","mag"],3]],A=["all",[">=",["get","mag"],3],["<",["get","mag"],4]],z=["all",[">=",["get","mag"],4],["<",["get","mag"],5]];this.clusterProperties={mag1:["+",["case",o,1,0]],mag2:["+",["case",_,1,0]],mag3:["+",["case",A,1,0]],mag4:["+",["case",z,1,0]],mag5:["+",["case",[">=",["get","mag"],5],1,0]]},this.circlePaint={"circle-color":["case",o,sp[0],_,sp[1],A,sp[2],z,sp[3],sp[4]],"circle-opacity":.6,"circle-radius":12},this.labelLayout={"text-field":["number-format",["get","mag"],{"min-fraction-digits":1,"max-fraction-digits":1}],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":10},this.labelPaint={"text-color":["case",["<",["get","mag"],3],"black","white"]}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:6,vars:16,consts:[[3,"zoom","center"],["id","earthquakes","data","https://docs.mapbox.com/mapbox-gl-js/assets/earthquakes.geojson",3,"cluster","clusterRadius","clusterProperties"],["source","earthquakes"],["mglClusterPoint",""],["id","earthquake_circle","type","circle","source","earthquakes",3,"filter","paint"],["id","earthquake_label","type","symbol","source","earthquakes",3,"filter","layout","paint"],[3,"properties"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-geojson-source",1),d.TgZ(2,"mgl-markers-for-clusters",2),d.YNc(3,Zy,1,1,"ng-template",3),d.qZA(),d._UZ(4,"mgl-layer",4)(5,"mgl-layer",5),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v10"),d.Q6J("zoom",d.DdM(12,E_))("center",d.DdM(13,zv)),d.xp6(1),d.Q6J("cluster",!0)("clusterRadius",80)("clusterProperties",_.clusterProperties),d.xp6(3),d.Q6J("filter",d.DdM(14,Wy))("paint",_.circlePaint),d.xp6(1),d.Q6J("filter",d.DdM(15,Wy))("layout",_.labelLayout)("paint",_.labelPaint))},dependencies:function(){return[zi,bo,qs,Ga,kc,_i,Gv]},styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})(),Gv=(()=>{class p{ngOnInit(){const o=[],_=[this.properties.mag1,this.properties.mag2,this.properties.mag3,this.properties.mag4,this.properties.mag5];let A=0;for(const ue of _)o.push(A),A+=ue;this.font=(A>=1e3?22:A>=100?20:A>=10?18:16)+"px sans-serif",this.r=A>=1e3?50:A>=100?32:A>=10?24:18,this.r0=Math.round(.6*this.r),this.w=2*this.r,this.viewbox=`0 0 ${this.w} ${this.w}`,this.textTransform=`translate(${this.r}, ${this.r})`,this.segments=[];for(let ue=0;ue<_.length;ue++)this.segments.push(this.donutSegment(o[ue]/A,(o[ue]+_[ue])/A,sp[ue]));this.totalString=A.toLocaleString()}donutSegment(o,_,A){_-o==1&&(_-=1e-5);const z=2*Math.PI*(o-.25),ue=2*Math.PI*(_-.25),_e=Math.cos(z),rt=Math.sin(z),Lt=Math.cos(ue),ln=Math.sin(ue),un=_-o>.5?1:0;return{d:`M ${this.r+this.r0*_e} ${this.r+this.r0*rt} L ${this.r+this.r*_e} ${this.r+this.r*rt} A ${this.r} ${this.r} 0 ${un} 1 ${this.r+this.r*Lt} ${this.r+this.r*ln} L ${this.r+this.r0*Lt} ${this.r+this.r0*ln} A ${this.r0} ${this.r0} 0 ${un} 0 ${this.r+this.r0*_e} ${this.r+this.r0*rt}`,fill:A}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-cluster-point"]],inputs:{properties:"properties"},decls:5,vars:12,consts:[["text-anchor","middle",3,"ngStyle"],[3,"ngStyle",4,"ngFor","ngForOf"],["fill","white"],["dominant-baseline","central"],[3,"ngStyle"]],template:function(o,_){1&o&&(d.O4$(),d.TgZ(0,"svg",0),d.YNc(1,Vv,1,4,"path",1),d._UZ(2,"circle",2),d.TgZ(3,"text",3),d._uU(4),d.qZA()()),2&o&&(d.Q6J("ngStyle",d.VKq(10,Uv,_.font)),d.uIk("width",_.w)("height",_.w)("viewbox",_.viewbox),d.xp6(1),d.Q6J("ngForOf",_.segments),d.xp6(1),d.uIk("cx",_.r)("cy",_.r)("r",_.r0),d.xp6(1),d.uIk("transform",_.textTransform),d.xp6(1),d.hij(" ",_.totalString," "))},dependencies:[me.sg,me.PC],encapsulation:2}),p})();const qy=function(){return["has","point_count"]},$b=function(){return[0,"#51bbd6"]},Zb=function(){return[100,"#f1f075"]},Wb=function(){return[750,"#f28cb1"]},Hv=function(p,y,o){return[p,y,o]},$v=function(p){return{property:"point_count",type:"interval",stops:p}},qb=function(){return[0,20]},Yb=function(){return[100,30]},Kb=function(){return[750,40]},Xb=function(p,y){return{"circle-color":p,"circle-radius":y}},Qb=function(){return["DIN Offc Pro Medium","Arial Unicode MS Bold"]},Jb=function(p){return{"text-field":"{point_count_abbreviated}","text-font":p,"text-size":12}},ex=function(){return["!has","point_count"]},tx=function(){return{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"}};function nx(p,y){if(1&p&&(d.ynx(0),d._UZ(1,"mgl-geojson-source",2)(2,"mgl-layer",3)(3,"mgl-layer",4)(4,"mgl-layer",5),d.BQk()),2&p){const o=d.oxw();d.xp6(1),d.Q6J("data",o.earthquakes)("cluster",!0)("clusterMaxZoom",14)("clusterRadius",50),d.xp6(1),d.Q6J("filter",d.DdM(10,qy))("paint",d.WLB(29,Xb,d.VKq(18,$v,d.kEZ(14,Hv,d.DdM(11,$b),d.DdM(12,Zb),d.DdM(13,Wb))),d.VKq(27,$v,d.kEZ(23,Hv,d.DdM(20,qb),d.DdM(21,Yb),d.DdM(22,Kb))))),d.xp6(1),d.Q6J("filter",d.DdM(32,qy))("layout",d.VKq(34,Jb,d.DdM(33,Qb))),d.xp6(1),d.Q6J("filter",d.DdM(36,ex))("paint",d.DdM(37,tx))}}const ix=function(){return[3]},rx=function(p){return[p,40.66995747013945]};let ox=(()=>{class p{ngOnInit(){var o=this;return fo(function*(){o.earthquakes=yield j.e(841).then(j.t.bind(j,6841,19))})()}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:8,consts:[[3,"zoom","center"],[4,"ngIf"],["id","earthquakes",3,"data","cluster","clusterMaxZoom","clusterRadius"],["id","clusters","type","circle","source","earthquakes",3,"filter","paint"],["id","cluster-count","type","symbol","source","earthquakes",3,"filter","layout"],["id","unclustered-point","type","circle","source","earthquakes",3,"filter","paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.YNc(1,nx,5,38,"ng-container",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/dark-v9"),d.Q6J("zoom",d.DdM(5,ix))("center",d.VKq(6,rx,-103.59179687498357)),d.xp6(1),d.Q6J("ngIf",_.earthquakes))},dependencies:[me.O5,zi,bo,qs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Zv=function(p){return[p,38.907]},Wv=function(){return[11.15]},Yv=function(){return['<a href="https://github.com/Wykks/ngx-mapbox-gl" target="_blank">Maps made awesome in Angular</a>',"Hello World"]};let Kv=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:10,consts:[[3,"center","zoom","attributionControl"],["mglAttribution","","position","bottom-right",3,"customAttribution"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-control",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("center",d.VKq(6,Zv,-77.04))("zoom",d.DdM(8,Wv))("attributionControl",!1),d.xp6(1),d.Q6J("customAttribution",d.DdM(9,Yv)))},dependencies:[zi,zo,ll,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Xv=function(){return[36.235656,50.00387]},Qv=function(){return[11.15]};let Jv=(()=>{class p{constructor(){this.locale={"FullscreenControl.Enter":"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u043e\u0432\u043d\u043e\u0435\u043a\u0440\u0430\u043d\u043d\u0438\u0439 \u0440\u0435\u0436\u0438\u043c","FullscreenControl.Exit":"\u0412\u0438\u0439\u0442\u0438 \u0437 \u043f\u043e\u0432\u043d\u043e\u0435\u043a\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u0436\u0438\u043c\u0443","GeolocateControl.FindMyLocation":"\u0417\u043d\u0430\u0439\u0442\u0438 \u043c\u043e\u0454 \u043c\u0456\u0441\u0446\u0435\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u043d\u044f","GeolocateControl.LocationNotAvailable":"\u041c\u0456\u0441\u0446\u0435\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u043d\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0435","LogoControl.Title":"\u041b\u043e\u0433\u043e Mapbox","NavigationControl.ResetBearing":"C\u043a\u0438\u043d\u0443\u0442\u0438 \u043a\u043e\u043c\u043f\u0430\u0441","NavigationControl.ZoomIn":"\u041d\u0430\u0431\u043b\u0438\u0437\u0438\u0442\u0438","NavigationControl.ZoomOut":"\u0412\u0456\u0434\u0434\u0430\u043b\u0438\u0442\u0438","ScaleControl.Feet":"\u0444","ScaleControl.Meters":"\u043c","ScaleControl.Kilometers":"\u043a\u043c","ScaleControl.Miles":"\u043c\u0438","ScaleControl.NauticalMiles":"\u043d\u043c"}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:5,vars:7,consts:[[3,"center","zoom","locale"],["mglFullscreen","","position","top-left"],["mglGeolocate","","position","top-left"],["mglNavigation","","position","top-left"],["mglScale",""]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-control",1)(2,"mgl-control",2)(3,"mgl-control",3)(4,"mgl-control",4),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("center",d.DdM(5,Xv))("zoom",d.DdM(6,Qv))("locale",_.locale))},dependencies:[zi,zo,Va,Ea,Ol,Ma,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const e0=function(p,y,o){return{"background-image":p,width:y,height:o}};function Yy(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"mgl-marker",2)(1,"div",3),d.NdJ("click",function(){const z=d.CHM(o).$implicit,ue=d.oxw();return d.KtG(ue.alert(z.properties.message))}),d.qZA()()}if(2&p){const o=y.$implicit;d.Q6J("feature",o),d.xp6(1),d.Q6J("ngStyle",d.kEZ(2,e0,"url(https://placekitten.com/g/"+o.properties.iconSize.join("/")+"/)",o.properties.iconSize[0]+"px",o.properties.iconSize[1]+"px"))}}const Ky=function(){return[5]},ap=function(p,y){return[p,y]};let sx=(()=>{class p{constructor(){this.geojson={type:"FeatureCollection",features:[{type:"Feature",properties:{message:"Foo",iconSize:[60,60]},geometry:{type:"Point",coordinates:[-66.324462890625,-16.024695711685304]}},{type:"Feature",properties:{message:"Bar",iconSize:[50,50]},geometry:{type:"Point",coordinates:[-61.2158203125,-15.97189158092897]}},{type:"Feature",properties:{message:"Baz",iconSize:[40,40]},geometry:{type:"Point",coordinates:[-63.29223632812499,-18.28151823530889]}}]}}alert(o){alert(o)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:9,consts:[[3,"zoom","center"],[3,"feature",4,"ngFor","ngForOf"],[3,"feature"],[1,"marker",3,"ngStyle","click"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.YNc(1,Yy,2,6,"mgl-marker",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(5,Ky))("center",d.WLB(6,ap,-65.017,-16.457)),d.xp6(1),d.Q6J("ngForOf",_.geojson.features))},dependencies:[me.sg,me.PC,zi,hs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".marker[_ngcontent-%COMP%]{border:none;border-radius:50%;cursor:pointer;padding:0}"]}),p})();const ax=function(){return[3]},df=function(p){return[p,39]};let h1=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:1,vars:7,consts:[[3,"zoom","center"]],template:function(o,_){1&o&&d._UZ(0,"mgl-map",0),2&o&&(d.Akn("mapbox://styles/mapbox/dark-v9"),d.Q6J("zoom",d.DdM(4,ax))("center",d.VKq(5,df,-77.38)))},dependencies:[zi,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Xy=function(){return[9]},p1=function(p){return[p,40]};let t0=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:1,vars:7,consts:[[3,"zoom","center"]],template:function(o,_){1&o&&d._UZ(0,"mgl-map",0),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(4,Xy))("center",d.VKq(5,p1,-74.5)))},dependencies:[zi,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const n0=["*",[["mat-card-footer"]]],f1=["*","mat-card-footer"];let ev=(()=>{class p{constructor(o){this._animationMode=o}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.QbO,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(o,_){2&o&&d.ekj("_mat-animation-noopable","NoopAnimations"===_._animationMode)},exportAs:["matCard"],ngContentSelectors:f1,decls:2,vars:0,template:function(o,_){1&o&&(d.F$t(n0),d.Hsn(0),d.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),p})(),px=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.BQ,Ai.BQ]}),p})();function fx(p,y){if(1&p&&(d.TgZ(0,"mgl-control",3)(1,"mat-card")(2,"div"),d._uU(3),d.qZA(),d.TgZ(4,"div"),d._uU(5),d.qZA()()()),2&p){const o=d.oxw();d.xp6(3),d.hij("Longitude:\xa0",o.coordinates[0],""),d.xp6(2),d.hij("Latitude:\xa0",o.coordinates[1],"")}}const jm=function(){return[2]},r0=function(){return[0,0]};let mx=(()=>{class p{constructor(){this.color="#3887be"}onDragEnd(o){this.coordinates=o.getLngLat().toArray()}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:10,consts:[[3,"zoom","center"],[3,"lngLat","draggable","markerDragEnd"],["position","bottom-left",4,"ngIf"],["position","bottom-left"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-marker",1),d.NdJ("markerDragEnd",function(z){return _.onDragEnd(z)}),d.qZA(),d.YNc(2,fx,6,2,"mgl-control",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,jm))("center",d.DdM(8,r0)),d.xp6(1),d.Q6J("lngLat",d.DdM(9,r0))("draggable",!0),d.xp6(1),d.Q6J("ngIf",_.coordinates))},dependencies:[me.O5,zi,hs,zo,ev,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const gx=function(){return[13]},M_=function(){return[11.255,43.77]};let o0=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:6,consts:[[3,"zoom","center"],["mglFullscreen",""]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-control",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/outdoors-v9"),d.Q6J("zoom",d.DdM(4,gx))("center",d.DdM(5,M_)))},dependencies:[zi,zo,Va,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const s0=function(){return[15]},a0=function(p){return[p,37.830348]},_x=function(){return{}},Gm=function(p){return[p,37.83381888486939]},Hm=function(p){return[p,37.83317489144141]},yx=function(p){return[p,37.83270036637107]},vx=function(p){return[p,37.832056363179625]},bx=function(p){return[p,37.83114119107971]},l0=function(p){return[p,37.83049717427869]},c0=function(p){return[p,37.829920943955045]},u0=function(p){return[p,37.82954808664175]},xx=function(p){return[p,37.82944639795659]},d0=function(p){return[p,37.82880236636284]},wx=function(p){return[p,37.82931081282506]},Cx=function(p){return[p,37.83080223556934]},x1=function(p){return[p,37.83168351665737]},w1=function(p){return[p,37.832158048267786]},C1=function(p){return[p,37.83297152392784]},E1=function(p){return[p,37.83263257682617]},h0=function(p){return[p,37.832937629287755]},D_=function(p){return[p,37.832429207817725]},Ex=function(p){return[p,37.832564787218985]},Mx=function(p){return[p,37.83337825839438]},p0=function(p){return[p,37.83368330777276]},$m=function(p,y,o,_,A,z,ue,_e,rt,Lt,ln,un,ei,yi,si,hi,Fi,Ki,Vr,Ro,_o){return[p,y,o,_,A,z,ue,_e,rt,Lt,ln,un,ei,yi,si,hi,Fi,Ki,Vr,Ro,_o]},Dx=function(p){return{type:"LineString",coordinates:p}},Tx=function(p,y){return{type:"Feature",properties:p,geometry:y}},Sx=function(p){return{type:"geojson",data:p}},Ax=function(){return{"line-join":"round","line-cap":"round"}},Ix=function(){return{"line-color":"#888","line-width":8}};let f0=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:84,consts:[[3,"zoom","center"],["id","route","type","line",3,"source","layout","paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-layer",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,s0))("center",d.VKq(8,a0,-122.486052)),d.xp6(1),d.Q6J("source",d.VKq(80,Sx,d.WLB(77,Tx,d.DdM(10,_x),d.VKq(75,Dx,d.rFY(53,$m,[d.VKq(11,Gm,-122.48369693756104),d.VKq(13,Hm,-122.48348236083984),d.VKq(15,yx,-122.48339653015138),d.VKq(17,vx,-122.48356819152832),d.VKq(19,bx,-122.48404026031496),d.VKq(21,l0,-122.48404026031496),d.VKq(23,c0,-122.48348236083984),d.VKq(25,u0,-122.48356819152832),d.VKq(27,xx,-122.48507022857666),d.VKq(29,d0,-122.48610019683838),d.VKq(31,wx,-122.48695850372314),d.VKq(33,Cx,-122.48700141906738),d.VKq(35,x1,-122.48751640319824),d.VKq(37,w1,-122.48803138732912),d.VKq(39,C1,-122.48888969421387),d.VKq(41,E1,-122.48987674713133),d.VKq(43,h0,-122.49043464660643),d.VKq(45,D_,-122.49125003814696),d.VKq(47,Ex,-122.49163627624512),d.VKq(49,Mx,-122.49223709106445),d.VKq(51,p0,-122.49378204345702)])))))("layout",d.DdM(82,Ax))("paint",d.DdM(83,Ix)))},dependencies:[zi,bo,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function Px(p,y){if(1&p&&d._UZ(0,"mgl-layer",5),2&p){const o=y.$implicit;d.Q6J("id",o.id)("type",o.type)("filter",o.filter)("paint",o.paint)}}const Ox=function(){return["!=","cluster",!0]},hf=function(){return{"circle-color":"rgba(0,255,0,0.5)","circle-radius":20,"circle-blur":1}};function kx(p,y){if(1&p&&(d.ynx(0),d._UZ(1,"mgl-geojson-source",2),d.YNc(2,Px,1,4,"mgl-layer",3),d._UZ(3,"mgl-layer",4),d.BQk()),2&p){const o=d.oxw();d.xp6(1),d.Q6J("data",o.earthquakes)("cluster",!0)("clusterMaxZoom",15)("clusterRadius",20),d.xp6(1),d.Q6J("ngForOf",o.clusterLayers),d.xp6(1),d.Q6J("filter",d.DdM(7,Ox))("paint",d.DdM(8,hf))}}const m0=function(){return[3]},Rx=function(p){return[p,40.66995747013945]};let g0=(()=>{class p{ngOnInit(){var o=this;return fo(function*(){o.earthquakes=yield j.e(841).then(j.t.bind(j,6841,19));const _=[[0,"green"],[20,"orange"],[200,"red"]];o.clusterLayers=_.map((A,z)=>({type:"circle",id:`cluster-${z}`,paint:{"circle-color":A[1],"circle-radius":70,"circle-blur":1},filter:z===_.length-1?[">=","point_count",A[0]]:["all",[">=","point_count",A[0]],["<","point_count",_[z+1][0]]]}))})()}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:8,consts:[[3,"zoom","center"],[4,"ngIf"],["id","earthquakes",3,"data","cluster","clusterMaxZoom","clusterRadius"],["source","earthquakes","before","waterway-label",3,"id","type","filter","paint",4,"ngFor","ngForOf"],["id","unclustered-point","type","circle","source","earthquakes","before","waterway-label",3,"filter","paint"],["source","earthquakes","before","waterway-label",3,"id","type","filter","paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.YNc(1,kx,4,9,"ng-container",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/dark-v9"),d.Q6J("zoom",d.DdM(5,m0))("center",d.VKq(6,Rx,-103.59179687498357)),d.xp6(1),d.Q6J("ngIf",_.earthquakes))},dependencies:[me.sg,me.O5,zi,bo,qs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Lx=function(){return[2]},_0=function(p){return[p,37.830348]},Fx=function(){return{"fill-color":"#627BC1","fill-opacity":.5}},tv=function(){return{"line-color":"#627BC1","line-width":2}},Bx=function(){return{"fill-color":"#627BC1","fill-opacity":1}};let y0=(()=>{class p{constructor(){this.hoverFilter=["==","name",""]}activateHoverOn(o){this.hoverFilter=["==","name",o.features[0].properties.name]}disableHover(){this.hoverFilter=["==","name",""]}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:5,vars:14,consts:[[3,"zoom","center"],["id","states","data","https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_110m_admin_1_states_provinces.geojson"],["id","state-fills","type","fill","source","states",3,"paint","layerMouseMove","layerMouseLeave"],["id","state-borders","type","line","source","states",3,"paint"],["id","state-fills-hover","type","fill","source","states",3,"paint","filter"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-geojson-source",1),d.TgZ(2,"mgl-layer",2),d.NdJ("layerMouseMove",function(z){return _.activateHoverOn(z)})("layerMouseLeave",function(){return _.disableHover()}),d.qZA(),d._UZ(3,"mgl-layer",3)(4,"mgl-layer",4),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(8,Lx))("center",d.VKq(9,_0,-100.486052)),d.xp6(2),d.Q6J("paint",d.DdM(11,Fx)),d.xp6(1),d.Q6J("paint",d.DdM(12,tv)),d.xp6(1),d.Q6J("paint",d.DdM(13,Bx))("filter",_.hoverFilter))},dependencies:[zi,bo,qs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const v0=function(){return[9]},zx=function(p){return[p,40]};let Nx=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:1,vars:8,consts:[[3,"zoom","center","interactive"]],template:function(o,_){1&o&&d._UZ(0,"mgl-map",0),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(5,v0))("center",d.VKq(6,zx,-74.5))("interactive",!1))},dependencies:[zi,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Vx=function(){return[2.9]},nv=function(){return[16.05,48]};let Ux=(()=>{class p{changeLangTo(o){this.map.setLayoutProperty("country-label-lg","text-field","{name_"+o+"}")}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:10,vars:6,consts:[[3,"zoom","center","mapLoad"],["mat-raised-button","",1,"lang-button",3,"click"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.NdJ("mapLoad",function(z){return _.map=z}),d.TgZ(1,"mgl-control")(2,"button",1),d.NdJ("click",function(){return _.changeLangTo("fr")}),d._uU(3," French "),d.qZA(),d.TgZ(4,"button",1),d.NdJ("click",function(){return _.changeLangTo("ru")}),d._uU(5," Russian "),d.qZA(),d.TgZ(6,"button",1),d.NdJ("click",function(){return _.changeLangTo("de")}),d._uU(7," German "),d.qZA(),d.TgZ(8,"button",1),d.NdJ("click",function(){return _.changeLangTo("es")}),d._uU(9," Spanish "),d.qZA()()()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("zoom",d.DdM(4,Vx))("center",d.DdM(5,nv)))},dependencies:[zi,zo,Qa.lW,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function b0(p,y){if(1&p&&d._UZ(0,"mgl-geojson-source",3),2&p){const o=d.oxw();d.Q6J("data",o.data)}}const jx=function(){return{"line-color":"yellow","line-opacity":.75,"line-width":5}};function Gx(p,y){1&p&&d._UZ(0,"mgl-layer",4),2&p&&d.Q6J("paint",d.DdM(1,jx))}const Hx=function(p){return[p]};let $x=(()=>{class p{constructor(){this.zoom=[0]}ngOnInit(){var o=this;return fo(function*(){const _=yield j.e(731).then(j.t.bind(j,9731,19)),A=_.features[0].geometry.coordinates;_.features[0].geometry.coordinates=[A[0]],o.data=_,o.center=A[0],o.zoom=[14],o.pitch=30;let z=0;o.timer=window.setInterval(()=>{z<A.length?(o.center=A[z],_.features[0].geometry.coordinates.push(A[z]),o.data={...o.data},z++):window.clearInterval(o.timer)},10)})()}ngOnDestroy(){window.clearInterval(this.timer)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:10,consts:[["movingMethod","jumpTo",3,"zoom","center","centerWithPanTo","pitch"],["id","trace",3,"data",4,"ngIf"],["id","trace","type","line","source","trace",3,"paint",4,"ngIf"],["id","trace",3,"data"],["id","trace","type","line","source","trace",3,"paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.YNc(1,b0,1,1,"mgl-geojson-source",1),d.YNc(2,Gx,1,2,"mgl-layer",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/satellite-v9"),d.Q6J("zoom",_.zoom)("center",_.center)("centerWithPanTo",!0)("pitch",d.VKq(8,Hx,_.pitch)),d.xp6(1),d.Q6J("ngIf",_.data),d.xp6(1),d.Q6J("ngIf",_.data))},dependencies:[me.O5,zi,bo,qs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();var Zx=j(4986),Wx=j(5963);const Yx=function(){return[14]},x0=function(){return{"raster-fade-duration":0}};let w0=(()=>{class p{constructor(){this.size=.001,this.url="assets/red.png"}ngOnInit(){var o=this;return fo(function*(){const A=(yield j.e(731).then(j.t.bind(j,9731,19))).features[0].geometry?.coordinates,z=A.map(_e=>o.makeRectangle(_e));o.center=A[0],o.coordinates=z[0];let ue=0;o.sub=function qx(p=0,y=Zx.z){return p<0&&(p=0),(0,Wx.H)(p,p,y)}(250).subscribe(()=>{o.url=Math.random()<.5?"assets/red.png":"assets/blue.png",o.coordinates=z[ue],ue=(ue+1)%z.length})})()}ngOnDestroy(){void 0!==this.sub&&this.sub.unsubscribe()}makeRectangle([o,_]){return[[o,_],[o+this.size,_],[o+this.size,_-this.size],[o,_-this.size]]}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:9,consts:[["movingMethod","jumpTo",3,"center","zoom"],["id","test_source",3,"url","coordinates"],["id","test_layer","source","test_source","type","raster",3,"paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-image-source",1)(2,"mgl-layer",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/satellite-v9"),d.Q6J("center",_.center)("zoom",d.DdM(7,Yx)),d.xp6(1),d.Q6J("url",_.url)("coordinates",_.coordinates),d.xp6(1),d.Q6J("paint",d.DdM(8,x0)))},dependencies:[zi,bo,Do,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Kx=function(){return{enableHighAccuracy:!0}};let Xx=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:6,consts:[["mglGeolocate","",3,"positionOptions","trackUserLocation","showUserHeading"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map"),d._UZ(1,"mgl-control",0),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.xp6(1),d.Q6J("positionOptions",d.DdM(5,Kx))("trackUserLocation",!0)("showUserHeading",!0))},dependencies:[zi,zo,Ol,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const C0=function(){return[.6]},Qx=function(){return[0,0]},Jx=function(){return{name:"naturalEarth"}};let ew=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:1,vars:8,consts:[[3,"zoom","center","projection"]],template:function(o,_){1&o&&d._UZ(0,"mgl-map",0),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v11"),d.Q6J("zoom",d.DdM(5,C0))("center",d.DdM(6,Qx))("projection",d.DdM(7,Jx)))},dependencies:[zi,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const T_=function(p){return[p]},iv=function(){return[17]},E0=function(){return[4.577979,51.038189]},rv=function(){return[4.577979,51.03816]};let tw=(()=>{class p{constructor(){this.pitch=50,this.bearing=-97}ngOnInit(){let o=0;setInterval(()=>{o+=.01,1===o&&(o=0),this.pitch=45+15*Math.cos(o),this.bearing=20*Math.sin(o)-103},20)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:7,vars:15,consts:[["movingMethod","jumpTo",3,"interactive","pitch","bearing","zoom","center"],["rotationAlignment","map","pitchAlignment","map",3,"lngLat"],[1,"arrow"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 434 437"],["points","37.5 437.18 218 350.75 217.49 -0.37 37.5 437.18",2,"fill","#579120"],["points","397.55 437.13 218 350.75 217.49 -0.37 397.55 437.13",2,"fill","#6fad2d"],["points","217.22 391.46 397.55 437.13 218 350.75 37.5 437.18 217.22 391.46",2,"fill","#315112"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-marker",1)(2,"div",2),d.O4$(),d.TgZ(3,"svg",3),d._UZ(4,"polygon",4)(5,"polygon",5)(6,"polygon",6),d.qZA()()()()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("interactive",!1)("pitch",d.VKq(8,T_,_.pitch))("bearing",d.VKq(10,T_,_.bearing))("zoom",d.DdM(12,iv))("center",d.DdM(13,E0)),d.xp6(1),d.Q6J("lngLat",d.DdM(14,rv)))},dependencies:[zi,hs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".arrow[_ngcontent-%COMP%]{width:50px;height:50px;transform:rotate(-97deg)}"]}),p})();const nw=function(){return[9]},ov=function(p){return[p,40]};let iw=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:7,consts:[[3,"zoom","center"],["mglNavigation",""]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-control",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(4,nw))("center",d.VKq(5,ov,-74.5)))},dependencies:[zi,zo,Ea,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();var sv=j(4385),bh=j(8184),av=j(2289),rw=j(4080);const M1=["tooltip"],T0="tooltip-panel",S_=(0,Dc.i$)({passive:!0}),A_=new d.OlP("mat-tooltip-scroll-strategy"),A0={provide:A_,deps:[bh.aV],useFactory:function S0(p){return()=>p.scrollStrategies.reposition({scrollThrottle:20})}},I0=new d.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function P0(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let sw=(()=>{class p{constructor(o,_,A,z,ue,_e,rt,Lt,ln,un,ei,yi){this._overlay=o,this._elementRef=_,this._scrollDispatcher=A,this._viewContainerRef=z,this._ngZone=ue,this._platform=_e,this._ariaDescriber=rt,this._focusMonitor=Lt,this._dir=un,this._defaultOptions=ei,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new to.x,this._scrollStrategy=ln,this._document=yi,ei&&(ei.position&&(this.position=ei.position),ei.touchGestures&&(this.touchGestures=ei.touchGestures)),un.change.pipe((0,Rr.R)(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(o){o!==this._position&&(this._position=o,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(o){this._disabled=(0,Ji.Ig)(o),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(o){this._showDelay=(0,Ji.su)(o)}get hideDelay(){return this._hideDelay}set hideDelay(o){this._hideDelay=(0,Ji.su)(o),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(o){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=o?String(o).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(o){this._tooltipClass=o,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe((0,Rr.R)(this._destroyed)).subscribe(o=>{o?"keyboard"===o&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const o=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([_,A])=>{o.removeEventListener(_,A,S_)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(o,this.message,"tooltip"),this._focusMonitor.stopMonitoring(o)}show(o=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const _=this._createOverlay();this._detach(),this._portal=this._portal||new rw.C5(this._tooltipComponent,this._viewContainerRef);const A=this._tooltipInstance=_.attach(this._portal).instance;A._triggerElement=this._elementRef.nativeElement,A._mouseLeaveHideDelay=this._hideDelay,A.afterHidden().pipe((0,Rr.R)(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),A.show(o)}hide(o=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(o)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const o=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),_=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(o);return _.positionChanges.pipe((0,Rr.R)(this._destroyed)).subscribe(A=>{this._updateCurrentPositionClass(A.connectionPair),this._tooltipInstance&&A.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:_,panelClass:`${this._cssClassPrefix}-${T0}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe((0,Rr.R)(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe((0,Rr.R)(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe((0,Rr.R)(this._destroyed)).subscribe(A=>{this._isTooltipVisible()&&A.keyCode===Aa.hY&&!(0,Aa.Vb)(A)&&(A.preventDefault(),A.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(o){const _=o.getConfig().positionStrategy,A=this._getOrigin(),z=this._getOverlayPosition();_.withPositions([this._addOffset({...A.main,...z.main}),this._addOffset({...A.fallback,...z.fallback})])}_addOffset(o){return o}_getOrigin(){const o=!this._dir||"ltr"==this._dir.value,_=this.position;let A;"above"==_||"below"==_?A={originX:"center",originY:"above"==_?"top":"bottom"}:"before"==_||"left"==_&&o||"right"==_&&!o?A={originX:"start",originY:"center"}:("after"==_||"right"==_&&o||"left"==_&&!o)&&(A={originX:"end",originY:"center"});const{x:z,y:ue}=this._invertPosition(A.originX,A.originY);return{main:A,fallback:{originX:z,originY:ue}}}_getOverlayPosition(){const o=!this._dir||"ltr"==this._dir.value,_=this.position;let A;"above"==_?A={overlayX:"center",overlayY:"bottom"}:"below"==_?A={overlayX:"center",overlayY:"top"}:"before"==_||"left"==_&&o||"right"==_&&!o?A={overlayX:"end",overlayY:"center"}:("after"==_||"right"==_&&o||"left"==_&&!o)&&(A={overlayX:"start",overlayY:"center"});const{x:z,y:ue}=this._invertPosition(A.overlayX,A.overlayY);return{main:A,fallback:{overlayX:z,overlayY:ue}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe((0,Pc.q)(1),(0,Rr.R)(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(o){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=o,this._tooltipInstance._markForCheck())}_invertPosition(o,_){return"above"===this.position||"below"===this.position?"top"===_?_="bottom":"bottom"===_&&(_="top"):"end"===o?o="start":"start"===o&&(o="end"),{x:o,y:_}}_updateCurrentPositionClass(o){const{overlayY:_,originX:A,originY:z}=o;let ue;if(ue="center"===_?this._dir&&"rtl"===this._dir.value?"end"===A?"left":"right":"start"===A?"left":"right":"bottom"===_&&"top"===z?"above":"below",ue!==this._currentPosition){const _e=this._overlayRef;if(_e){const rt=`${this._cssClassPrefix}-${T0}-`;_e.removePanelClass(rt+this._currentPosition),_e.addPanelClass(rt+ue)}this._currentPosition=ue}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const o=[];if(this._platformSupportsMouseEvents())o.push(["mouseleave",_=>{const A=_.relatedTarget;(!A||!this._overlayRef?.overlayElement.contains(A))&&this.hide()}],["wheel",_=>this._wheelListener(_)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const _=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};o.push(["touchend",_],["touchcancel",_])}this._addListeners(o),this._passiveListeners.push(...o)}_addListeners(o){o.forEach(([_,A])=>{this._elementRef.nativeElement.addEventListener(_,A,S_)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(o){if(this._isTooltipVisible()){const _=this._document.elementFromPoint(o.clientX,o.clientY),A=this._elementRef.nativeElement;_!==A&&!A.contains(_)&&this.hide()}}_disableNativeGesturesIfNecessary(){const o=this.touchGestures;if("off"!==o){const _=this._elementRef.nativeElement,A=_.style;("on"===o||"INPUT"!==_.nodeName&&"TEXTAREA"!==_.nodeName)&&(A.userSelect=A.msUserSelect=A.webkitUserSelect=A.MozUserSelect="none"),("on"===o||!_.draggable)&&(A.webkitUserDrag="none"),A.touchAction="none",A.webkitTapHighlightColor="transparent"}}}return p.\u0275fac=function(o){d.$Z()},p.\u0275dir=d.lG2({type:p,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),p})(),aw=(()=>{class p extends sw{constructor(o,_,A,z,ue,_e,rt,Lt,ln,un,ei,yi){super(o,_,A,z,ue,_e,rt,Lt,ln,un,ei,yi),this._tooltipComponent=cw}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(bh.aV),d.Y36(d.SBq),d.Y36(R.mF),d.Y36(d.s_b),d.Y36(d.R0b),d.Y36(Dc.t4),d.Y36(ml.$s),d.Y36(ml.tE),d.Y36(A_),d.Y36(V.Is,8),d.Y36(I0,8),d.Y36(me.K0))},p.\u0275dir=d.lG2({type:p,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[d.qOj]}),p})(),lw=(()=>{class p{constructor(o,_){this._changeDetectorRef=o,this._visibility="initial",this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new to.x,this._animationsDisabled="NoopAnimations"===_}show(o){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},o)}hide(o){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},o)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:o}){(!o||!this._triggerElement.contains(o))&&this.hide(this._mouseLeaveHideDelay)}_onShow(){}_handleAnimationEnd({animationName:o}){(o===this._showAnimation||o===this._hideAnimation)&&this._finalizeAnimation(o===this._showAnimation)}_finalizeAnimation(o){o?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(o){const _=this._tooltip.nativeElement,A=this._showAnimation,z=this._hideAnimation;if(_.classList.remove(o?z:A),_.classList.add(o?A:z),this._isVisible=o,o&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const ue=getComputedStyle(_);("0s"===ue.getPropertyValue("animation-duration")||"none"===ue.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}o&&this._onShow(),this._animationsDisabled&&(_.classList.add("_mat-animation-noopable"),this._finalizeAnimation(o))}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.sBO),d.Y36(d.QbO,8))},p.\u0275dir=d.lG2({type:p}),p})(),cw=(()=>{class p extends lw{constructor(o,_,A){super(o,A),this._breakpointObserver=_,this._isHandset=this._breakpointObserver.observe(av.u3.Handset),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.sBO),d.Y36(av.Yg),d.Y36(d.QbO,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-tooltip-component"]],viewQuery:function(o,_){if(1&o&&d.Gf(M1,7),2&o){let A;d.iGM(A=d.CRH())&&(_._tooltip=A.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(o,_){1&o&&d.NdJ("mouseleave",function(z){return _._handleMouseLeave(z)}),2&o&&d.Udp("zoom",_.isVisible()?1:null)},features:[d.qOj],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(o,_){if(1&o&&(d.TgZ(0,"div",0,1),d.NdJ("animationend",function(z){return _._handleAnimationEnd(z)}),d.ALo(2,"async"),d._uU(3),d.qZA()),2&o){let A;d.ekj("mat-tooltip-handset",null==(A=d.lcZ(2,4,_._isHandset))?null:A.matches),d.Q6J("ngClass",_.tooltipClass),d.xp6(3),d.Oqu(_.message)}},dependencies:[me.mk,me.Ov],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}"],encapsulation:2,changeDetection:0}),p})(),O0=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({providers:[A0],imports:[ml.rt,me.ez,bh.U8,Ai.BQ,Ai.BQ,R.ZD]}),p})();function k0(p,y){if(1&p&&(d.TgZ(0,"mat-option",19),d._uU(1),d.qZA()),2&p){const o=y.$implicit;d.Q6J("value",o),d.xp6(1),d.hij(" ",o," ")}}function uw(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"mat-form-field",16)(1,"mat-select",17),d.NdJ("selectionChange",function(A){d.CHM(o);const z=d.oxw(2);return d.KtG(z._changePageSize(A.value))}),d.YNc(2,k0,2,2,"mat-option",18),d.qZA()()}if(2&p){const o=d.oxw(2);d.Q6J("appearance",o._formFieldAppearance)("color",o.color),d.xp6(1),d.Q6J("value",o.pageSize)("disabled",o.disabled)("panelClass",o.selectConfig.panelClass||"")("disableOptionCentering",o.selectConfig.disableOptionCentering)("aria-label",o._intl.itemsPerPageLabel),d.xp6(1),d.Q6J("ngForOf",o._displayedPageSizeOptions)}}function dw(p,y){if(1&p&&(d.TgZ(0,"div",20),d._uU(1),d.qZA()),2&p){const o=d.oxw(2);d.xp6(1),d.Oqu(o.pageSize)}}function T1(p,y){if(1&p&&(d.TgZ(0,"div",12)(1,"div",13),d._uU(2),d.qZA(),d.YNc(3,uw,3,8,"mat-form-field",14),d.YNc(4,dw,2,1,"div",15),d.qZA()),2&p){const o=d.oxw();d.xp6(2),d.hij(" ",o._intl.itemsPerPageLabel," "),d.xp6(1),d.Q6J("ngIf",o._displayedPageSizeOptions.length>1),d.xp6(1),d.Q6J("ngIf",o._displayedPageSizeOptions.length<=1)}}function S1(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"button",21),d.NdJ("click",function(){d.CHM(o);const A=d.oxw();return d.KtG(A.firstPage())}),d.O4$(),d.TgZ(1,"svg",7),d._UZ(2,"path",22),d.qZA()()}if(2&p){const o=d.oxw();d.Q6J("matTooltip",o._intl.firstPageLabel)("matTooltipDisabled",o._previousButtonsDisabled())("matTooltipPosition","above")("disabled",o._previousButtonsDisabled()),d.uIk("aria-label",o._intl.firstPageLabel)}}function hw(p,y){if(1&p){const o=d.EpF();d.O4$(),d.kcU(),d.TgZ(0,"button",23),d.NdJ("click",function(){d.CHM(o);const A=d.oxw();return d.KtG(A.lastPage())}),d.O4$(),d.TgZ(1,"svg",7),d._UZ(2,"path",24),d.qZA()()}if(2&p){const o=d.oxw();d.Q6J("matTooltip",o._intl.lastPageLabel)("matTooltipDisabled",o._nextButtonsDisabled())("matTooltipPosition","above")("disabled",o._nextButtonsDisabled()),d.uIk("aria-label",o._intl.lastPageLabel)}}let I_=(()=>{class p{constructor(){this.changes=new to.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(o,_,A)=>{if(0==A||0==_)return`0 of ${A}`;const z=o*_;return`${z+1} \u2013 ${z<(A=Math.max(A,0))?Math.min(z+_,A):z+_} of ${A}`}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const L0={provide:I_,deps:[[new d.FiY,new d.tp0,I_]],useFactory:function R0(p){return p||new I_}},fw=new d.OlP("MAT_PAGINATOR_DEFAULT_OPTIONS"),mw=(0,Ai.Id)((0,Ai.dB)(class{}));let gw=(()=>{class p extends mw{constructor(o,_,A){if(super(),this._intl=o,this._changeDetectorRef=_,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.selectConfig={},this.page=new d.vpe,this._intlChanges=o.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),A){const{pageSize:z,pageSizeOptions:ue,hidePageSize:_e,showFirstLastButtons:rt}=A;null!=z&&(this._pageSize=z),null!=ue&&(this._pageSizeOptions=ue),null!=_e&&(this._hidePageSize=_e),null!=rt&&(this._showFirstLastButtons=rt)}}get pageIndex(){return this._pageIndex}set pageIndex(o){this._pageIndex=Math.max((0,Ji.su)(o),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(o){this._length=(0,Ji.su)(o),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(o){this._pageSize=Math.max((0,Ji.su)(o),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(o){this._pageSizeOptions=(o||[]).map(_=>(0,Ji.su)(_)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(o){this._hidePageSize=(0,Ji.Ig)(o)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(o){this._showFirstLastButtons=(0,Ji.Ig)(o)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const o=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(o)}previousPage(){if(!this.hasPreviousPage())return;const o=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(o)}firstPage(){if(!this.hasPreviousPage())return;const o=this.pageIndex;this.pageIndex=0,this._emitPageEvent(o)}lastPage(){if(!this.hasNextPage())return;const o=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(o)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const o=this.getNumberOfPages()-1;return this.pageIndex<o&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(o){const A=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/o)||0,this.pageSize=o,this._emitPageEvent(A)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){!this._initialized||(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((o,_)=>o-_),this._changeDetectorRef.markForCheck())}_emitPageEvent(o){this.page.emit({previousPageIndex:o,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return p.\u0275fac=function(o){d.$Z()},p.\u0275dir=d.lG2({type:p,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",selectConfig:"selectConfig"},outputs:{page:"page"},features:[d.qOj]}),p})(),B0=(()=>{class p extends gw{constructor(o,_,A){super(o,_,A),A&&null!=A.formFieldAppearance&&(this._formFieldAppearance=A.formFieldAppearance)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(I_),d.Y36(d.sBO),d.Y36(fw,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[d.qOj],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"appearance","color"],[3,"value","disabled","panelClass","disableOptionCentering","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(o,_){1&o&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,T1,5,3,"div",2),d.TgZ(3,"div",3)(4,"div",4),d._uU(5),d.qZA(),d.YNc(6,S1,3,5,"button",5),d.TgZ(7,"button",6),d.NdJ("click",function(){return _.previousPage()}),d.O4$(),d.TgZ(8,"svg",7),d._UZ(9,"path",8),d.qZA()(),d.kcU(),d.TgZ(10,"button",9),d.NdJ("click",function(){return _.nextPage()}),d.O4$(),d.TgZ(11,"svg",7),d._UZ(12,"path",10),d.qZA()(),d.YNc(13,hw,3,5,"button",11),d.qZA()()()),2&o&&(d.xp6(2),d.Q6J("ngIf",!_.hidePageSize),d.xp6(3),d.hij(" ",_._intl.getRangeLabel(_.pageIndex,_.pageSize,_.length)," "),d.xp6(1),d.Q6J("ngIf",_.showFirstLastButtons),d.xp6(1),d.Q6J("matTooltip",_._intl.previousPageLabel)("matTooltipDisabled",_._previousButtonsDisabled())("matTooltipPosition","above")("disabled",_._previousButtonsDisabled()),d.uIk("aria-label",_._intl.previousPageLabel),d.xp6(3),d.Q6J("matTooltip",_._intl.nextPageLabel)("matTooltipDisabled",_._nextButtonsDisabled())("matTooltipPosition","above")("disabled",_._nextButtonsDisabled()),d.uIk("aria-label",_._intl.nextPageLabel),d.xp6(3),d.Q6J("ngIf",_.showFirstLastButtons))},dependencies:[me.sg,me.O5,Qa.lW,Ou.KE,sv.gD,Ai.ey,aw],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{display:inline-block;width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-paginator-icon{fill:CanvasText}"],encapsulation:2,changeDetection:0}),p})(),_w=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({providers:[L0],imports:[me.ez,Qa.ot,sv.LD,O0,Ai.BQ]}),p})();function z0(p,y){if(1&p&&(d.TgZ(0,"div",8),d._uU(1),d.qZA()),2&p){const o=y.$implicit;d.Q6J("title",o.properties["Secondary ID"]),d.xp6(1),d.hij(" ",o.properties["Primary ID"]," ")}}function Zm(p,y){if(1&p){const o=d.EpF();d.TgZ(0,"div",9),d.NdJ("click",function(A){const ue=d.CHM(o).$implicit,_e=d.oxw(2);return d.KtG(_e.selectCluster(A,ue))}),d._uU(1),d.qZA()}if(2&p){const o=y.$implicit;d.xp6(1),d.hij(" ",null==o.properties?null:o.properties.point_count," ")}}function N0(p,y){if(1&p&&(d.TgZ(0,"mgl-popup",10),d._UZ(1,"showcase-cluster-popup",11),d.qZA()),2&p){d.oxw();const o=d.MAs(2),_=d.oxw();d.Q6J("feature",_.selectedCluster),d.xp6(1),d.Q6J("clusterComponent",o)("selectedCluster",_.selectedCluster)}}function V0(p,y){if(1&p&&(d.ynx(0),d._UZ(1,"mgl-geojson-source",2,3),d.TgZ(3,"mgl-markers-for-clusters",4),d.YNc(4,z0,2,2,"ng-template",5),d.YNc(5,Zm,2,1,"ng-template",6),d.qZA(),d.YNc(6,N0,2,3,"mgl-popup",7),d.BQk()),2&p){const o=d.oxw();d.xp6(1),d.Q6J("data",o.earthquakes)("cluster",!0)("clusterRadius",50)("clusterMaxZoom",14),d.xp6(5),d.Q6J("ngIf",o.selectedCluster)}}const U0=function(){return[3]},j0=function(p){return[p,40.66995747013945]};function G0(p,y){if(1&p&&(d.TgZ(0,"mat-list-item"),d._uU(1),d.qZA()),2&p){const o=y.$implicit;d.xp6(1),d.hij(" ",null==o.properties?null:o.properties["Primary ID"]," ")}}let H0=(()=>{class p{ngOnInit(){var o=this;return fo(function*(){const _=yield j.e(841).then(j.t.bind(j,6841,19));setInterval(()=>{_.features.length&&_.features.pop(),o.earthquakes={..._}},500)})()}selectCluster(o,_){o.stopPropagation(),this.selectedCluster=_}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:8,consts:[[3,"zoom","center"],[4,"ngIf"],["id","earthquakes",3,"data","cluster","clusterRadius","clusterMaxZoom"],["clusterComponent",""],["source","earthquakes"],["mglPoint",""],["mglClusterPoint",""],[3,"feature",4,"ngIf"],[1,"marker",3,"title"],[1,"marker-cluster",3,"click"],[3,"feature"],[3,"clusterComponent","selectedCluster"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.YNc(1,V0,7,5,"ng-container",1),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/dark-v9"),d.Q6J("zoom",d.DdM(5,U0))("center",d.VKq(6,j0,-103.59179687498357)),d.xp6(1),d.Q6J("ngIf",_.earthquakes))},dependencies:function(){return[me.O5,zi,qs,$a,Fl,Ga,kc,_i,yw]},styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".marker-cluster{width:30px;height:30px;border-radius:50%;background-color:#4f615a;display:flex;justify-content:center;align-items:center;color:#fff;border:2px solid #56c498;cursor:pointer}.marker[_ngcontent-%COMP%]{width:30px;height:30px;border-radius:50%;background-color:#7d7d7d;display:flex;justify-content:center;align-items:center;border:2px solid #c9c9c9}"]}),p})(),yw=(()=>{class p{ngOnChanges(o){this.changePage(),o.selectedCluster&&!o.selectedCluster.isFirstChange()&&this.paginator.firstPage()}changePage(o){var _=this;return fo(function*(){let A=0;o&&(A=5*o.pageIndex),_.leaves=yield _.clusterComponent.getClusterLeaves(_.selectedCluster.properties?.cluster_id??0,5,A)})()}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-cluster-popup"]],viewQuery:function(o,_){if(1&o&&d.Gf(B0,7),2&o){let A;d.iGM(A=d.CRH())&&(_.paginator=A.first)}},inputs:{selectedCluster:"selectedCluster",clusterComponent:"clusterComponent"},features:[d.TTD],decls:3,vars:3,consts:[[4,"ngFor","ngForOf"],[3,"length","pageSize","page"]],template:function(o,_){1&o&&(d.TgZ(0,"mat-list"),d.YNc(1,G0,2,1,"mat-list-item",0),d.qZA(),d.TgZ(2,"mat-paginator",1),d.NdJ("page",function(z){return _.changePage(z)}),d.qZA()),2&o&&(d.xp6(1),d.Q6J("ngForOf",_.leaves),d.xp6(1),d.Q6J("length",null==_.selectedCluster.properties?null:_.selectedCluster.properties.point_count)("pageSize",5))},dependencies:[me.sg,Ec,Xc,B0],encapsulation:2}),p})(),A1=(()=>{class p{alert(o){alert(o)}onGeolocate(o){console.log("geolocate",o)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:10,vars:2,consts:[["mat-fab","","color","primary",1,"custom-control",3,"click"],["mglAttribution","","position","top-right"],["mglFullscreen","","position","top-right"],["mglGeocoder","","position","top-right"],["mglGeolocate","","position","top-right",3,"geolocate"],["mglNavigation","","position","top-right"],["mglScale","","position","top-right"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map")(1,"mgl-control")(2,"button",0),d.NdJ("click",function(){return _.alert("Hello")}),d._uU(3," Hello "),d.qZA()(),d._UZ(4,"mgl-control",1)(5,"mgl-control",2)(6,"mgl-control",3),d.TgZ(7,"mgl-control",4),d.NdJ("geolocate",function(z){return _.onGeolocate(z)}),d.qZA(),d._UZ(8,"mgl-control",5)(9,"mgl-control",6),d.qZA()),2&o&&d.Akn("mapbox://styles/mapbox/streets-v9")},dependencies:[zi,zo,Va,Ea,Ol,ll,Ma,Qa.lW,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const $0=function(){return[5]},P_=function(p,y){return[p,y]};let vw=(()=>{class p{alert(o){alert(o)}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:7,vars:20,consts:[[3,"zoom","center"],[3,"lngLat"],[1,"marker",2,"background-image","url(https://placekitten.com/g/60/60/)","width","60px","height","60px",3,"click"],[1,"marker",2,"background-image","url(https://placekitten.com/g/50/50/)","width","50px","height","50px",3,"click"],[1,"marker",2,"background-image","url(https://placekitten.com/g/40/40/)","width","40px","height","40px",3,"click"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-marker",1)(2,"div",2),d.NdJ("click",function(){return _.alert("Foo")}),d.qZA()(),d.TgZ(3,"mgl-marker",1)(4,"div",3),d.NdJ("click",function(){return _.alert("Bar")}),d.qZA()(),d.TgZ(5,"mgl-marker",1)(6,"div",4),d.NdJ("click",function(){return _.alert("Baz")}),d.qZA()()()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,$0))("center",d.WLB(8,P_,-65.017,-16.457)),d.xp6(1),d.Q6J("lngLat",d.WLB(11,P_,-66.324462890625,-16.024695711685304)),d.xp6(2),d.Q6J("lngLat",d.WLB(14,P_,-61.2158203125,-15.97189158092897)),d.xp6(2),d.Q6J("lngLat",d.WLB(17,P_,-63.29223632812499,-18.28151823530889)))},dependencies:[zi,hs,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".marker[_ngcontent-%COMP%]{border:none;border-radius:50%;cursor:pointer;padding:0}"]}),p})();const bw=function(){return[2]},Z0=function(){return[0,0]},Wm=function(p){return{type:"Point",coordinates:p}};let xw=(()=>{class p{constructor(){this.layerPaint={"circle-radius":10,"circle-color":"#3887be"},this.coordinates=[0,0]}onDragStart(o){console.log("onDragStart",o)}onDragEnd(o){console.log("onDragEnd",o)}onDrag(o){console.log("onDrag",o),this.coordinates=o.lngLat.toArray()}changeColor(o){this.layerPaint={...this.layerPaint,"circle-color":o}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:11,vars:14,consts:[[3,"zoom","center"],["id","point"],[3,"properties","geometry","mglDraggable","featureDragStart","featureDragEnd","featureDrag"],["id","point","type","circle","source","point",3,"paint","layerMouseEnter","layerMouseLeave"],["targetLayer",""],["position","bottom-left"]],template:function(o,_){if(1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-geojson-source",1)(2,"mgl-feature",2),d.NdJ("featureDragStart",function(z){return _.onDragStart(z)})("featureDragEnd",function(z){return _.onDragEnd(z)})("featureDrag",function(z){return _.onDrag(z)}),d.qZA()(),d.TgZ(3,"mgl-layer",3,4),d.NdJ("layerMouseEnter",function(){return _.changeColor("#3bb2d0")})("layerMouseLeave",function(){return _.changeColor("#3887be")}),d.qZA(),d.TgZ(5,"mgl-control",5)(6,"mat-card")(7,"div"),d._uU(8),d.qZA(),d.TgZ(9,"div"),d._uU(10),d.qZA()()()()),2&o){const A=d.MAs(4);d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(9,bw))("center",d.DdM(10,Z0)),d.xp6(2),d.Q6J("geometry",d.VKq(12,Wm,d.DdM(11,Z0)))("mglDraggable",A),d.xp6(1),d.Q6J("paint",_.layerPaint),d.xp6(5),d.hij("Longitude:\xa0",_.coordinates[0],""),d.xp6(2),d.hij("Latitude:\xa0",_.coordinates[1],"")}},dependencies:[zi,bo,Ua,qs,vl,zo,ev,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const lv=function(){return[15]},Fu=function(p){return[p,37.830348]},ww=function(){return{"line-join":"round","line-cap":"round"}},O_=function(){return{"line-color":"#888","line-width":8}};let qm=(()=>{class p{constructor(){this.geometry={type:"LineString",coordinates:[[-122.48369693756104,37.83381888486939],[-122.48348236083984,37.83317489144141],[-122.48339653015138,37.83270036637107],[-122.48356819152832,37.832056363179625],[-122.48404026031496,37.83114119107971],[-122.48404026031496,37.83049717427869],[-122.48348236083984,37.829920943955045],[-122.48356819152832,37.82954808664175],[-122.48507022857666,37.82944639795659],[-122.48610019683838,37.82880236636284],[-122.48695850372314,37.82931081282506],[-122.48700141906738,37.83080223556934],[-122.48751640319824,37.83168351665737],[-122.48803138732912,37.832158048267786],[-122.48888969421387,37.83297152392784],[-122.48987674713133,37.83263257682617],[-122.49043464660643,37.832937629287755],[-122.49125003814696,37.832429207817725],[-122.49163627624512,37.832564787218985],[-122.49223709106445,37.83337825839438],[-122.49378204345702,37.83368330777276]]}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:4,vars:12,consts:[[3,"zoom","center"],["id","oneline"],[3,"geometry"],["id","route","type","line","source","oneline",3,"layout","paint"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-geojson-source",1),d._UZ(2,"mgl-feature",2),d.qZA(),d._UZ(3,"mgl-layer",3),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,lv))("center",d.VKq(8,Fu,-122.486052)),d.xp6(2),d.Q6J("geometry",_.geometry),d.xp6(1),d.Q6J("layout",d.DdM(10,ww))("paint",d.DdM(11,O_)))},dependencies:[zi,bo,qs,vl,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})(),Cw=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:2,vars:2,consts:[["mglScale","","unit","imperial","position","top-right"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map"),d._UZ(1,"mgl-control",0),d.qZA()),2&o&&d.Akn("mapbox://styles/mapbox/streets-v9")},dependencies:[zi,zo,Ma,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function Ew(p,y){if(1&p&&(d.TgZ(0,"mgl-popup",3),d._UZ(1,"span",4),d.qZA()),2&p){const o=d.oxw();d.Q6J("lngLat",o.selectedLngLat),d.xp6(1),d.Q6J("innerHTML",null==o.selectedElement?null:o.selectedElement.name,d.oJD)}}const Mw=function(){return[3]},k_=function(p){return[p,38.907]},Dw=function(){return{type:"geojson",data:"https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_110m_admin_1_states_provinces_shp.geojson"}},Tw=function(){return{"fill-color":"rgba(200, 100, 240, 0.4)","fill-outline-color":"rgba(200, 100, 240, 1)"}};let W0=(()=>{class p{onClick(o){this.selectedLngLat=o.lngLat,this.selectedElement=o.features?.[0].properties}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:3,vars:13,consts:[[3,"zoom","center","cursorStyle"],["id","states-layer","type","fill",3,"source","paint","layerMouseEnter","layerMouseLeave","layerClick"],[3,"lngLat",4,"ngIf"],[3,"lngLat"],[3,"innerHTML"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-layer",1),d.NdJ("layerMouseEnter",function(){return _.cursorStyle="pointer"})("layerMouseLeave",function(){return _.cursorStyle=""})("layerClick",function(z){return _.onClick(z)}),d.qZA(),d.YNc(2,Ew,2,2,"mgl-popup",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(8,Mw))("center",d.VKq(9,k_,-100.04))("cursorStyle",_.cursorStyle),d.xp6(1),d.Q6J("source",d.DdM(11,Dw))("paint",d.DdM(12,Tw)),d.xp6(1),d.Q6J("ngIf",_.selectedLngLat))},dependencies:[me.O5,zi,bo,$a,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();function q0(p,y){if(1&p&&(d.TgZ(0,"mgl-popup",4),d._UZ(1,"span",5),d.qZA()),2&p){const o=d.oxw();d.Q6J("feature",o.selectedPoint),d.xp6(1),d.Q6J("innerHTML",null==o.selectedPoint.properties?null:o.selectedPoint.properties.description,d.oJD)}}const cv=function(){return[11.15]},Y0=function(p){return[p,38.907]},Sw=function(){return{"icon-image":"{icon}-15","icon-allow-overlap":!0}};let Aw=(()=>{class p{constructor(){this.points={type:"FeatureCollection",features:[{type:"Feature",properties:{description:'<strong>Make it Mount Pleasant</strong><p><a href="http://www.mtpleasantdc.com/makeitmtpleasant" target="_blank" title="Opens in a new window">Make it Mount Pleasant</a> is a handmade and vintage market and afternoon of live entertainment and kids activities. 12:00-6:00 p.m.</p>',icon:"theatre"},geometry:{type:"Point",coordinates:[-77.038659,38.931567]}},{type:"Feature",properties:{description:'<strong>Mad Men Season Five Finale Watch Party</strong><p>Head to Lounge 201 (201 Massachusetts Avenue NE) Sunday for a <a href="http://madmens5finale.eventbrite.com/" target="_blank" title="Opens in a new window">Mad Men Season Five Finale Watch Party</a>, complete with 60s costume contest, Mad Men trivia, and retro food and drink. 8:00-11:00 p.m. $10 general admission, $20 admission and two hour open bar.</p>',icon:"theatre"},geometry:{type:"Point",coordinates:[-77.003168,38.894651]}},{type:"Feature",properties:{description:'<strong>Big Backyard Beach Bash and Wine Fest</strong><p>EatBar (2761 Washington Boulevard Arlington VA) is throwing a <a href="http://tallulaeatbar.ticketleap.com/2012beachblanket/" target="_blank" title="Opens in a new window">Big Backyard Beach Bash and Wine Fest</a> on Saturday, serving up conch fritters, fish tacos and crab sliders, and Red Apron hot dogs. 12:00-3:00 p.m. $25.grill hot dogs.</p>',icon:"bar"},geometry:{type:"Point",coordinates:[-77.090372,38.881189]}},{type:"Feature",properties:{description:'<strong>Ballston Arts & Crafts Market</strong><p>The <a href="http://ballstonarts-craftsmarket.blogspot.com/" target="_blank" title="Opens in a new window">Ballston Arts & Crafts Market</a> sets up shop next to the Ballston metro this Saturday for the first of five dates this summer. Nearly 35 artists and crafters will be on hand selling their wares. 10:00-4:00 p.m.</p>',icon:"art-gallery"},geometry:{type:"Point",coordinates:[-77.111561,38.882342]}},{type:"Feature",properties:{description:'<strong>Seersucker Bike Ride and Social</strong><p>Feeling dandy? Get fancy, grab your bike, and take part in this year\'s <a href="http://dandiesandquaintrelles.com/2012/04/the-seersucker-social-is-set-for-june-9th-save-the-date-and-start-planning-your-look/" target="_blank" title="Opens in a new window">Seersucker Social</a> bike ride from Dandies and Quaintrelles. After the ride enjoy a lawn party at Hillwood with jazz, cocktails, paper hat-making, and more. 11:00-7:00 p.m.</p>',icon:"bicycle"},geometry:{type:"Point",coordinates:[-77.052477,38.943951]}},{type:"Feature",properties:{description:'<strong>Capital Pride Parade</strong><p>The annual <a href="http://www.capitalpride.org/parade" target="_blank" title="Opens in a new window">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>',icon:"star"},geometry:{type:"Point",coordinates:[-77.043444,38.909664]}},{type:"Feature",properties:{description:'<strong>Muhsinah</strong><p>Jazz-influenced hip hop artist <a href="http://www.muhsinah.com" target="_blank" title="Opens in a new window">Muhsinah</a> plays the <a href="http://www.blackcatdc.com">Black Cat</a> (1811 14th Street NW) tonight with <a href="http://www.exitclov.com" target="_blank" title="Opens in a new window">Exit Clov</a> and <a href="http://godsilla.bandcamp.com" target="_blank" title="Opens in a new window">Gods\u2019illa</a>. 9:00 p.m. $12.</p>',icon:"music"},geometry:{type:"Point",coordinates:[-77.031706,38.914581]}},{type:"Feature",properties:{description:'<strong>A Little Night Music</strong><p>The Arlington Players\' production of Stephen Sondheim\'s  <a href="http://www.thearlingtonplayers.org/drupal-6.20/node/4661/show" target="_blank" title="Opens in a new window"><em>A Little Night Music</em></a> comes to the Kogod Cradle at The Mead Center for American Theater (1101 6th Street SW) this weekend and next. 8:00 p.m.</p>',icon:"music"},geometry:{type:"Point",coordinates:[-77.020945,38.878241]}},{type:"Feature",properties:{description:'<strong>Truckeroo</strong><p><a href="http://www.truckeroodc.com/www/" target="_blank">Truckeroo</a> brings dozens of food trucks, live music, and games to half and M Street SE (across from Navy Yard Metro Station) today from 11:00 a.m. to 11:00 p.m.</p>',icon:"music"},geometry:{type:"Point",coordinates:[-77.007481,38.876516]}}]}}onClick(o){this.selectedPoint=o.features?.[0]}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:4,vars:12,consts:[[3,"zoom","center","cursorStyle"],["id","points",3,"data"],["id","points","source","points","type","symbol",3,"layout","layerClick","layerMouseEnter","layerMouseLeave"],[3,"feature",4,"ngIf"],[3,"feature"],[3,"innerHTML"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-geojson-source",1),d.TgZ(2,"mgl-layer",2),d.NdJ("layerClick",function(z){return _.onClick(z)})("layerMouseEnter",function(){return _.cursorStyle="pointer"})("layerMouseLeave",function(){return _.cursorStyle=""}),d.qZA(),d.YNc(3,q0,2,2,"mgl-popup",3),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(8,cv))("center",d.VKq(9,Y0,-77.04))("cursorStyle",_.cursorStyle),d.xp6(1),d.Q6J("data",_.points),d.xp6(1),d.Q6J("layout",d.DdM(11,Sw)),d.xp6(1),d.Q6J("ngIf",_.selectedPoint))},dependencies:[me.O5,zi,bo,qs,$a,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const I1=function(){return[3]},L_=function(p){return[p,37.8]};let uv=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:4,vars:12,consts:[[3,"zoom","center"],[3,"lngLat","closeOnClick","className"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-popup",1)(2,"h1"),d._uU(3,"Hello world !"),d.qZA()()()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,I1))("center",d.VKq(8,L_,-96)),d.xp6(1),d.Q6J("lngLat",d.VKq(10,L_,-96))("closeOnClick",!1)("className","custom-popup-class1 custom-popup-class2"))},dependencies:[zi,$a,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".custom-popup-class1{color:purple;text-align:center}  .custom-popup-class2{width:300px}"]}),p})();const K0=function(){return[9]},dv=function(){return[137.9150899566626,36.25956997955441]};let hv=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:1,vars:6,consts:[[3,"zoom","center"]],template:function(o,_){1&o&&d._UZ(0,"mgl-map",0),2&o&&(d.Akn("mapbox://styles/mapbox/satellite-v9"),d.Q6J("zoom",d.DdM(4,K0))("center",d.DdM(5,dv)))},dependencies:[zi,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const Iw=function(){return[15]},X0=function(p){return[p,38.8895]},Ow=function(){return{"background-image":"url(https://www.mapbox.com/mapbox-gl-js/assets/washington-monument.jpg)","background-size":"cover",width:"50px",height:"50px","border-radius":"50%",cursor:"pointer"}};let Q0=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:6,vars:13,consts:[[3,"zoom","center"],[3,"lngLat"],["myMarker",""],[3,"ngStyle"],[3,"marker"]],template:function(o,_){if(1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-marker",1,2),d._UZ(3,"div",3),d.qZA(),d.TgZ(4,"mgl-popup",4),d._uU(5," Construction on the Washington Monument began in 1848. "),d.qZA()()),2&o){const A=d.MAs(2);d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("zoom",d.DdM(7,Iw))("center",d.VKq(8,X0,-77.0353)),d.xp6(1),d.Q6J("lngLat",d.VKq(10,X0,-77.0353)),d.xp6(2),d.Q6J("ngStyle",d.DdM(12,Ow)),d.xp6(1),d.Q6J("marker",A)}},dependencies:[me.PC,zi,hs,$a,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})();const pv=["input"],J0=function(p){return{enterDuration:p}},eb=["*"],tb=new d.OlP("mat-radio-default-options",{providedIn:"root",factory:function nb(){return{color:"accent"}}});let ib=0;const rb={provide:xo.JU,useExisting:(0,d.Gpc)(()=>ab),multi:!0};class fv{constructor(y,o){this.source=y,this.value=o}}const ob=new d.OlP("MatRadioGroup");let sb=(()=>{class p{constructor(o){this._changeDetector=o,this._value=null,this._name="mat-radio-group-"+ib++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new d.vpe}get name(){return this._name}set name(o){this._name=o,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(o){this._labelPosition="before"===o?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(o){this._value!==o&&(this._value=o,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(o){this._selected=o,this.value=o?o.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(o){this._disabled=(0,Ji.Ig)(o),this._markRadiosForCheck()}get required(){return this._required}set required(o){this._required=(0,Ji.Ig)(o),this._markRadiosForCheck()}ngAfterContentInit(){this._isInitialized=!0}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(o=>{o.name=this.name,o._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(_=>{_.checked=this.value===_.value,_.checked&&(this._selected=_)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new fv(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(o=>o._markForCheck())}writeValue(o){this.value=o,this._changeDetector.markForCheck()}registerOnChange(o){this._controlValueAccessorChangeFn=o}registerOnTouched(o){this.onTouched=o}setDisabledState(o){this.disabled=o,this._changeDetector.markForCheck()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.sBO))},p.\u0275dir=d.lG2({type:p,inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required"},outputs:{change:"change"}}),p})(),ab=(()=>{class p extends sb{}return p.\u0275fac=function(){let y;return function(_){return(y||(y=d.n5z(p)))(_||p)}}(),p.\u0275dir=d.lG2({type:p,selectors:[["mat-radio-group"]],contentQueries:function(o,_,A){if(1&o&&d.Suo(A,lb,5),2&o){let z;d.iGM(z=d.CRH())&&(_._radios=z)}},hostAttrs:["role","radiogroup",1,"mat-radio-group"],exportAs:["matRadioGroup"],features:[d._Bn([rb,{provide:ob,useExisting:p}]),d.qOj]}),p})();class gl{constructor(y){this._elementRef=y}}const pf=(0,Ai.Kr)((0,Ai.sb)(gl));let kw=(()=>{class p extends pf{constructor(o,_,A,z,ue,_e,rt,Lt){super(_),this._changeDetector=A,this._focusMonitor=z,this._radioDispatcher=ue,this._providerOverride=rt,this._uniqueId="mat-radio-"+ ++ib,this.id=this._uniqueId,this.change=new d.vpe,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=o,this._noopAnimations="NoopAnimations"===_e,Lt&&(this.tabIndex=(0,Ji.su)(Lt,0)),this._removeUniqueSelectionListener=ue.listen((ln,un)=>{ln!==this.id&&un===this.name&&(this.checked=!1)})}get checked(){return this._checked}set checked(o){const _=(0,Ji.Ig)(o);this._checked!==_&&(this._checked=_,_&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!_&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),_&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(o){this._value!==o&&(this._value=o,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===o),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(o){this._labelPosition=o}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(o){this._setDisabled((0,Ji.Ig)(o))}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(o){this._required=(0,Ji.Ig)(o)}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(o){this._color=o}get inputId(){return`${this.id||this._uniqueId}-input`}focus(o,_){_?this._focusMonitor.focusVia(this._inputElement,_,o):this._inputElement.nativeElement.focus(o)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name)}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(o=>{!o&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new fv(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(o){o.stopPropagation()}_onInputInteraction(o){if(o.stopPropagation(),!this.checked&&!this.disabled){const _=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),_&&this.radioGroup._emitChangeEvent())}}_setDisabled(o){this._disabled!==o&&(this._disabled=o,this._changeDetector.markForCheck())}_updateTabIndex(){const o=this.radioGroup;let _;if(_=o&&o.selected&&!this.disabled?o.selected===this?this.tabIndex:-1:this.tabIndex,_!==this._previousTabIndex){const A=this._inputElement?.nativeElement;A&&(A.setAttribute("tabindex",_+""),this._previousTabIndex=_)}}}return p.\u0275fac=function(o){d.$Z()},p.\u0275dir=d.lG2({type:p,viewQuery:function(o,_){if(1&o&&d.Gf(pv,5),2&o){let A;d.iGM(A=d.CRH())&&(_._inputElement=A.first)}},inputs:{id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"},features:[d.qOj]}),p})(),lb=(()=>{class p extends kw{constructor(o,_,A,z,ue,_e,rt,Lt){super(o,_,A,z,ue,_e,rt,Lt)}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(ob,8),d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(ml.tE),d.Y36(mh.A8),d.Y36(d.QbO,8),d.Y36(tb,8),d.$8M("tabindex"))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-radio-button"],hostVars:17,hostBindings:function(o,_){1&o&&d.NdJ("focus",function(){return _._inputElement.nativeElement.focus()}),2&o&&(d.uIk("tabindex",null)("id",_.id)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),d.ekj("mat-radio-checked",_.checked)("mat-radio-disabled",_.disabled)("_mat-animation-noopable",_._noopAnimations)("mat-primary","primary"===_.color)("mat-accent","accent"===_.color)("mat-warn","warn"===_.color))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[d.qOj],ngContentSelectors:eb,decls:13,vars:19,consts:[[1,"mat-radio-label"],["label",""],[1,"mat-radio-container"],[1,"mat-radio-outer-circle"],[1,"mat-radio-inner-circle"],["type","radio",1,"mat-radio-input",3,"id","checked","disabled","required","change","click"],["input",""],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mat-radio-label-content"],[2,"display","none"]],template:function(o,_){if(1&o&&(d.F$t(),d.TgZ(0,"label",0,1)(2,"span",2),d._UZ(3,"span",3)(4,"span",4),d.TgZ(5,"input",5,6),d.NdJ("change",function(z){return _._onInputInteraction(z)})("click",function(z){return _._onInputClick(z)}),d.qZA(),d.TgZ(7,"span",7),d._UZ(8,"span",8),d.qZA()(),d.TgZ(9,"span",9)(10,"span",10),d._uU(11,"\xa0"),d.qZA(),d.Hsn(12),d.qZA()()),2&o){const A=d.MAs(1);d.uIk("for",_.inputId),d.xp6(5),d.Q6J("id",_.inputId)("checked",_.checked)("disabled",_.disabled)("required",_.required),d.uIk("name",_.name)("value",_.value)("aria-label",_.ariaLabel)("aria-labelledby",_.ariaLabelledby)("aria-describedby",_.ariaDescribedby),d.xp6(2),d.Q6J("matRippleTrigger",A)("matRippleDisabled",_._isRippleDisabled())("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",d.VKq(17,J0,_._noopAnimations?0:150)),d.xp6(2),d.ekj("mat-radio-label-before","before"==_.labelPosition)}},dependencies:[Ai.wG],styles:['.mat-radio-button{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-radio-label{-webkit-user-select:none;user-select:none;cursor:pointer;display:inline-flex;align-items:center;white-space:nowrap;vertical-align:middle;width:100%}.mat-radio-container{box-sizing:border-box;display:inline-block;position:relative;width:20px;height:20px;flex-shrink:0}.mat-radio-outer-circle{box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;transition:border-color ease 280ms;width:20px;border-width:2px;border-style:solid;border-radius:50%}._mat-animation-noopable .mat-radio-outer-circle{transition:none}.mat-radio-inner-circle{border-radius:50%;box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;opacity:0;transition:transform ease 280ms,background-color ease 280ms,opacity linear 1ms 280ms;width:20px;transform:scale(0.001);-webkit-print-color-adjust:exact;color-adjust:exact}.mat-radio-checked .mat-radio-inner-circle{transform:scale(0.5);opacity:1;transition:transform ease 280ms,background-color ease 280ms}.cdk-high-contrast-active .mat-radio-checked .mat-radio-inner-circle{border:solid 10px}._mat-animation-noopable .mat-radio-inner-circle{transition:none}.mat-radio-label-content{-webkit-user-select:auto;user-select:auto;display:inline-block;order:0;line-height:inherit;padding-left:8px;padding-right:0}[dir=rtl] .mat-radio-label-content{padding-right:8px;padding-left:0}.mat-radio-label-content.mat-radio-label-before{order:-1;padding-left:0;padding-right:8px}[dir=rtl] .mat-radio-label-content.mat-radio-label-before{padding-right:0;padding-left:8px}.mat-radio-disabled,.mat-radio-disabled .mat-radio-label{cursor:default}.mat-radio-button .mat-radio-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-radio-button .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple){opacity:.16}.mat-radio-persistent-ripple{width:100%;height:100%;transform:none;top:0;left:0}.mat-radio-container:hover .mat-radio-persistent-ripple{opacity:.04}.mat-radio-button:not(.mat-radio-disabled).cdk-keyboard-focused .mat-radio-persistent-ripple,.mat-radio-button:not(.mat-radio-disabled).cdk-program-focused .mat-radio-persistent-ripple{opacity:.12}.mat-radio-persistent-ripple,.mat-radio-disabled .mat-radio-container:hover .mat-radio-persistent-ripple{opacity:0}@media(hover: none){.mat-radio-container:hover .mat-radio-persistent-ripple{display:none}}.mat-radio-input{opacity:0;position:absolute;top:0;left:0;margin:0;width:100%;height:100%;cursor:inherit;z-index:-1}.mat-radio-input:focus~.mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-radio-disabled{opacity:.5}'],encapsulation:2,changeDetection:0}),p})(),P1=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.si,Ai.BQ,Ai.BQ]}),p})();const O1=function(){return[13]},cb=function(){return[4.899,52.372]};let ub=(()=>{class p{constructor(){this.layerId="basic"}ngOnInit(){this.changeStyle(this.layerId)}changeStyle(o){this.style=`mapbox://styles/mapbox/${o}-v9`}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:14,vars:7,consts:[[3,"zoom","center"],[3,"ngModel","ngModelChange"],["value","basic"],["value","streets"],["value","bright"],["value","light"],["value","dark"],["value","satellite"]],template:function(o,_){1&o&&(d._UZ(0,"mgl-map",0),d.TgZ(1,"mat-radio-group",1),d.NdJ("ngModelChange",function(z){return _.changeStyle(z)}),d.TgZ(2,"mat-radio-button",2),d._uU(3,"basic"),d.qZA(),d.TgZ(4,"mat-radio-button",3),d._uU(5,"streets"),d.qZA(),d.TgZ(6,"mat-radio-button",4),d._uU(7,"bright"),d.qZA(),d.TgZ(8,"mat-radio-button",5),d._uU(9,"light"),d.qZA(),d.TgZ(10,"mat-radio-button",6),d._uU(11,"dark"),d.qZA(),d.TgZ(12,"mat-radio-button",7),d._uU(13,"satellite"),d.qZA()()),2&o&&(d.Akn(_.style),d.Q6J("zoom",d.DdM(5,O1))("center",d.DdM(6,cb)),d.xp6(1),d.Q6J("ngModel",_.layerId))},dependencies:[xo.JJ,xo.On,zi,ab,lb,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}","mat-radio-group[_ngcontent-%COMP%]{position:absolute;padding:8px;background:#fff}"]}),p})();const Ym=["button"],Rw=["*"],F_=new d.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),db=new d.OlP("MatButtonToggleGroup");let pb=0;class fb{constructor(y,o){this.source=y,this.value=o}}const Lw=(0,Ai.Kr)(class{});let B_=(()=>{class p extends Lw{constructor(o,_,A,z,ue,_e){super(),this._changeDetectorRef=_,this._elementRef=A,this._focusMonitor=z,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new d.vpe;const rt=Number(ue);this.tabIndex=rt||0===rt?rt:null,this.buttonToggleGroup=o,this.appearance=_e&&_e.appearance?_e.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(o){this._appearance=o}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(o){const _=(0,Ji.Ig)(o);_!==this._checked&&(this._checked=_,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(o){this._disabled=(0,Ji.Ig)(o)}ngOnInit(){const o=this.buttonToggleGroup;this._isSingleSelector=o&&!o.multiple,this.id=this.id||"mat-button-toggle-"+pb++,this._isSingleSelector&&(this.name=o.name),o&&(o._isPrechecked(this)?this.checked=!0:o._isSelected(this)!==this._checked&&o._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const o=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),o&&o._isSelected(this)&&o._syncButtonToggle(this,!1,!1,!0)}focus(o){this._buttonElement.nativeElement.focus(o)}_onButtonClick(){const o=!!this._isSingleSelector||!this._checked;o!==this._checked&&(this._checked=o,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new fb(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(db,8),d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(ml.tE),d.$8M("tabindex"),d.Y36(F_,8))},p.\u0275cmp=d.Xpm({type:p,selectors:[["mat-button-toggle"]],viewQuery:function(o,_){if(1&o&&d.Gf(Ym,5),2&o){let A;d.iGM(A=d.CRH())&&(_._buttonElement=A.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(o,_){1&o&&d.NdJ("focus",function(){return _.focus()}),2&o&&(d.uIk("aria-label",null)("aria-labelledby",null)("id",_.id)("name",null),d.ekj("mat-button-toggle-standalone",!_.buttonToggleGroup)("mat-button-toggle-checked",_.checked)("mat-button-toggle-disabled",_.disabled)("mat-button-toggle-appearance-standard","standard"===_.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[d.qOj],ngContentSelectors:Rw,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(o,_){if(1&o&&(d.F$t(),d.TgZ(0,"button",0,1),d.NdJ("click",function(){return _._onButtonClick()}),d.TgZ(2,"span",2),d.Hsn(3),d.qZA()(),d._UZ(4,"span",3)(5,"span",4)),2&o){const A=d.MAs(1);d.Q6J("id",_.buttonId)("disabled",_.disabled||null),d.uIk("tabindex",_.disabled?-1:_.tabIndex)("aria-pressed",_.checked)("name",_.name||null)("aria-label",_.ariaLabel)("aria-labelledby",_.ariaLabelledby),d.xp6(5),d.Q6J("matRippleTrigger",A)("matRippleDisabled",_.disableRipple||_.disabled)}},dependencies:[Ai.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}"],encapsulation:2,changeDetection:0}),p})(),mb=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.BQ,Ai.si,Ai.BQ]}),p})();const gb=function(){return[15]},z_=function(p,y){return[p,y]},mv=function(){return{"circle-radius":8,"circle-color":"rgba(55,148,179,1)"}},k1=function(){return{"line-color":"#877b59","line-width":1}};let _b=(()=>{class p{constructor(){this.layouts={contours:{visibility:"visible","line-join":"round","line-cap":"round"},museums:{visibility:"visible"}}}toggleLayer(o){this.layouts[o.value]={...this.layouts[o.value],visibility:"visible"===this.layouts[o.value].visibility?"none":"visible"}}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:10,vars:16,consts:[[3,"zoom","center"],["id","museums","url","mapbox://mapbox.2opop9hr"],["id","contours","url","mapbox://mapbox.mapbox-terrain-v2"],["id","museums","type","circle","source","museums","sourceLayer","museum-cusco",3,"layout","paint"],["id","contours","type","line","source","contours","sourceLayer","contour",3,"layout","paint"],[1,"menu"],["value","contours",3,"checked","change"],["value","museums",3,"checked","change"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d._UZ(1,"mgl-vector-source",1)(2,"mgl-vector-source",2)(3,"mgl-layer",3)(4,"mgl-layer",4),d.qZA(),d.TgZ(5,"div",5)(6,"mat-button-toggle",6),d.NdJ("change",function(z){return _.toggleLayer(z)}),d._uU(7,"contours"),d.qZA(),d.TgZ(8,"mat-button-toggle",7),d.NdJ("change",function(z){return _.toggleLayer(z)}),d._uU(9,"museums"),d.qZA()()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(10,gb))("center",d.WLB(11,z_,-71.97722138410576,-13.517379300798098)),d.xp6(3),d.Q6J("layout",_.layouts.museums)("paint",d.DdM(14,mv)),d.xp6(1),d.Q6J("layout",_.layouts.contours)("paint",d.DdM(15,k1)),d.xp6(2),d.Q6J("checked",!0),d.xp6(2),d.Q6J("checked",!0))},dependencies:[zi,bo,Za,B_,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}",".menu[_ngcontent-%COMP%]{position:absolute;padding:8px}"]}),p})();const Fw=function(){return[12]},yb=function(p){return[p,38.897]},mf=function(){return{padding:20}},Bw=function(){return{"line-color":"#BF93E4","line-width":5}},vb=function(){return{"line-join":"round","line-cap":"round"}};let gv=(()=>{class p{constructor(){this.source={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",properties:{},coordinates:[[-77.0366048812866,38.89873175227713],[-77.03364372253417,38.89876515143842],[-77.03364372253417,38.89549195896866],[-77.02982425689697,38.89549195896866],[-77.02400922775269,38.89387200688839],[-77.01519012451172,38.891416957534204],[-77.01521158218382,38.892068305429156],[-77.00813055038452,38.892051604275686],[-77.00832366943358,38.89143365883688],[-77.00818419456482,38.89082405874451],[-77.00815200805664,38.88989712255097]]}}]}}}zoomToBounds(){const o=this.source.data.features[0].geometry.coordinates;this.bounds=o.reduce((_,A)=>_.extend(A),new ds.LngLatBounds(o[0],o[0]))}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["showcase-demo"]],decls:5,vars:15,consts:[[3,"zoom","center","fitBounds","fitBoundsOptions"],["mat-raised-button","",1,"zoom-button",3,"click"],["id","LineString","type","line",3,"source","paint","layout"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0)(1,"mgl-control")(2,"button",1),d.NdJ("click",function(){return _.zoomToBounds()}),d._uU(3," Zoom to bounds "),d.qZA()(),d._UZ(4,"mgl-layer",2),d.qZA()),2&o&&(d.Akn("mapbox://styles/mapbox/light-v9"),d.Q6J("zoom",d.DdM(9,Fw))("center",d.VKq(10,yb,-77.0214))("fitBounds",_.bounds)("fitBoundsOptions",d.DdM(12,mf)),d.xp6(4),d.Q6J("source",_.source)("paint",d.DdM(13,Bw))("layout",d.DdM(14,vb)))},dependencies:[zi,bo,zo,Qa.lW,_i],styles:["[_nghost-%COMP%]{display:flex;flex:1}mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),p})(),zw=(()=>{class p{constructor(o){this.router=o}canActivate(o){return!!xv[0].children?.some(_=>_.path===o.params.demoUrl)||(this.router.navigate(["/demo"]),!1)}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(W.F0))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function Vw(){return Math.random().toString(36).substring(7)}function gf(p){var y="";return p?(p.forceEmbedLayout&&(y+="embed=1"),p.clickToLoad&&(y+=(y.length?"&":"")+"ctl=1"),p.openFile&&(y+=(y.length?"&":"")+"file="+p.openFile),!p.view||"preview"!==p.view&&"editor"!==p.view||(y+=(y.length?"&":"")+"view="+p.view),p.hideExplorer&&(y+=(y.length?"&":"")+"hideExplorer=1"),p.hideNavigation&&(y+=(y.length?"&":"")+"hideNavigation=1;"),p.hideDevTools&&(y+=(y.length?"&":"")+"hidedevtools=1"),"number"==typeof p.devToolsHeight&&p.devToolsHeight>0&&p.devToolsHeight<100&&(y+=(y.length?"&":"")+"devtoolsheight="+p.devToolsHeight),y.length?"?"+y:y):y}function _v(p,y,o){if(null===p.parentNode)throw new Error("Invalid Element");y.id=p.id,function bb(p,y){y&&(y.hasOwnProperty("height")&&(p.height=""+y.height),y.hasOwnProperty("width")&&(p.width=""+y.width)),p.height||(p.height="300"),p.width||p.setAttribute("style","width:100%;")}(y,o),p.parentNode.replaceChild(y,p)}function yv(p){if("string"==typeof p){var y=document.getElementById(p);if(null!==y)return y}else if(p instanceof HTMLElement)return p;throw new Error("Invalid Element")}function N_(p){return p&&!1===p.newWindow?"_self":"_blank"}var xb=function(p){var y=this;this.pending={},this.port=p,this.port.onmessage=function(o){if(o.data.payload.__reqid){var _=o.data.payload.__reqid,A=o.data.payload.__success;if(y.pending[_]){if(delete o.data.payload.__reqid,delete o.data.payload.__success,A){var z=0===Object.keys(o.data.payload).length&&o.data.payload.constructor===Object?null:o.data.payload;y.pending[_].resolve(z)}else y.pending[_].reject(o.data.payload.error?o.data.type+": "+o.data.payload.error:o.data.type);delete y.pending[_]}}}};xb.prototype.request=function(p){var y=this,o=Vw();return new Promise(function(_,A){y.pending[o]={resolve:_,reject:A},p.payload.__reqid=o,y.port.postMessage(p)})};var Km=function(p,y){var o=this;this.rdc=new xb(p),this.preview={},Object.defineProperty(this.preview,"origin",{value:y.previewOrigin,writable:!1}),this.editor={openFile:function(_){return o.rdc.request({type:"SDK_OPEN_FILE",payload:{path:_}})}}};Km.prototype.applyFsDiff=function(p){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:p})},Km.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},Km.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var Xm=[],Uw=function(p){var y=this;this.id=Vw(),this.element=p,this.pending=new Promise(function(o,_){var A=function(Lt){Lt.data.action&&"SDK_INIT_SUCCESS"===Lt.data.action&&Lt.data.id===y.id&&(y.vm=new Km(Lt.ports[0],Lt.data.payload),o(y.vm),ue())},z=function(){y.element.contentWindow&&y.element.contentWindow.postMessage({action:"SDK_INIT",id:y.id},"*")};function ue(){window.clearInterval(rt),window.removeEventListener("message",A)}window.addEventListener("message",A),z();var _e=0,rt=window.setInterval(function(){if(y.vm)ue();else{if(_e>=20)return ue(),_("Timeout: Unable to establish a connection with the StackBlitz VM"),void Xm.forEach(function(Lt,ln){Lt.id===y.id&&Xm.splice(ln,1)});_e++,z()}},500)}),Xm.push(this)},vv=["typescript","create-react-app","angular-cli","javascript","polymer"],wb="https://stackblitz.com/run";function xh(p,y){var o=document.createElement("input");return o.type="hidden",o.name=p,o.value=y,o}function bv(p){-1===vv.indexOf(p.template)&&console.warn("Unsupported project template, must be one of: "+vv.join(", "));var y=document.createElement("form");return y.method="POST",y.setAttribute("style","display:none;"),y.appendChild(xh("project[title]",p.title)),y.appendChild(xh("project[description]",p.description)),y.appendChild(xh("project[template]",p.template)),p.tags&&p.tags.forEach(function(o){y.appendChild(xh("project[tags][]",o))}),p.dependencies&&y.appendChild(xh("project[dependencies]",JSON.stringify(p.dependencies))),p.settings&&y.appendChild(xh("project[settings]",JSON.stringify(p.settings))),Object.keys(p.files).forEach(function(o){y.appendChild(xh("project[files]["+o+"]",p.files[o]))}),y}var V_={connect:function(p){if(!p||!p.contentWindow)return Promise.reject("Provided element is not an iframe.");var y=function(p){var y=p instanceof Element?"element":"id";return Xm.find(function(_){return _[y]===p})||null}(p);return y?y.pending:new Uw(p).pending},openGithubProject:function(p,y){window.open("https://stackblitz.com/github/"+p+gf(y),N_(y))},openProject:function(p,y){!function Eb(p,y){var o=bv(p);o.action=wb+gf(y),o.target=N_(y),document.body.appendChild(o),o.submit(),document.body.removeChild(o)}(p,y)},openProjectId:function(p,y){window.open("https://stackblitz.com/edit/"+p+gf(y),N_(y))},embedGithubProject:function(p,y,o){var _=yv(p),A=document.createElement("iframe");return A.src="https://stackblitz.com/github/"+y+gf(o),_v(_,A,o),V_.connect(A)},embedProject:function(p,y,o){var _=yv(p),A=function Cb(p,y){var o=bv(p);return o.action=wb+gf(y),o.id="sb","<html><head><title></title></head><body>"+o.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"}(y,o),z=document.createElement("iframe");return _v(_,z,o),z.contentDocument&&z.contentDocument.write(A),V_.connect(z)},embedProjectId:function(p,y,o){var _=yv(p),A=document.createElement("iframe");return A.src="https://stackblitz.com/edit/"+y+gf(o),_v(_,A,o),V_.connect(A)}};const Gw=V_;var Mb=j(4128),Db=j(2076),Tb=j(3151),R1=j(8746),F1=j(9646),Sb=j(529);const Hw="app/demo/examples/";let B1=(()=>{class p{constructor(o){this.http=o,this.fileCache=new Map,this.loadFile("example.css")}getDemoFiles(o){let _=this.fileCache.get(o);return _||(_=this.http.get(`${Hw}${o}.component.ts`,{responseType:"text"}).pipe((0,Mo.w)(A=>this.loadAdditionnalFilesIfNecessary(A)),(0,Tb.d)(1)),this.fileCache.set(o,_),_)}loadAdditionnalFilesIfNecessary(o){const _=/'\.\/([\w-.]+\.\w+)'/g;let A;const z=[],ue={"src/demo.ts":o};for(;A=_.exec(o);)z.push(this.loadFile(A[1]));return z.length?(0,Mb.D)(z).pipe((0,U.U)(_e=>({...Object.assign({},..._e),...ue}))):(0,F1.of)(ue)}loadFile(o){let _=this.fileCache.get(o);return _||(_=this.http.get(`${Hw}${o}`,{responseType:"text"}).pipe((0,U.U)(A=>({[`src/${o}`]:A})),(0,Tb.d)(1)),this.fileCache.set(o,_),_)}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(Sb.eN))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();function z1(p,y){if(1&p&&(d.O4$(),d._UZ(0,"circle",4)),2&p){const o=d.oxw(),_=d.MAs(1);d.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+o._spinnerAnimationLabel)("stroke-dashoffset",o._getStrokeDashOffset(),"px")("stroke-dasharray",o._getStrokeCircumference(),"px")("stroke-width",o._getCircleStrokeWidth(),"%")("transform-origin",o._getCircleTransformOrigin(_)),d.uIk("r",o._getCircleRadius())}}function U_(p,y){if(1&p&&(d.O4$(),d._UZ(0,"circle",4)),2&p){const o=d.oxw(),_=d.MAs(1);d.Udp("stroke-dashoffset",o._getStrokeDashOffset(),"px")("stroke-dasharray",o._getStrokeCircumference(),"px")("stroke-width",o._getCircleStrokeWidth(),"%")("transform-origin",o._getCircleTransformOrigin(_)),d.uIk("r",o._getCircleRadius())}}const j_=(0,Ai.pj)(class{constructor(p){this._elementRef=p}},"primary"),Pb=new d.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function Ob(){return{diameter:100}}});class nu extends j_{constructor(y,o,_,A,z,ue,_e,rt){super(y),this._document=_,this._diameter=100,this._value=0,this._resizeSubscription=Na.w0.EMPTY,this.mode="determinate";const Lt=nu._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),Lt.has(_.head)||Lt.set(_.head,new Set([100])),this._noopAnimations="NoopAnimations"===A&&!!z&&!z._forceAnimations,"mat-spinner"===y.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),z&&(z.color&&(this.color=this.defaultColor=z.color),z.diameter&&(this.diameter=z.diameter),z.strokeWidth&&(this.strokeWidth=z.strokeWidth)),o.isBrowser&&o.SAFARI&&_e&&ue&&rt&&(this._resizeSubscription=_e.change(150).subscribe(()=>{"indeterminate"===this.mode&&rt.run(()=>ue.markForCheck())}))}get diameter(){return this._diameter}set diameter(y){this._diameter=(0,Ji.su)(y),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(y){this._strokeWidth=(0,Ji.su)(y)}get value(){return"determinate"===this.mode?this._value:0}set value(y){this._value=Math.max(0,Math.min(100,(0,Ji.su)(y)))}ngOnInit(){const y=this._elementRef.nativeElement;this._styleRoot=(0,Dc.kV)(y)||this._document.head,this._attachStyleNode(),y.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const y=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${y} ${y}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(y){const o=50*(y.currentScale??1);return`${o}% ${o}%`}_attachStyleNode(){const y=this._styleRoot,o=this._diameter,_=nu._diameters;let A=_.get(y);if(!A||!A.has(o)){const z=this._document.createElement("style");z.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),z.textContent=this._getAnimationText(),y.appendChild(z),A||(A=new Set,_.set(y,A)),A.add(o)}}_getAnimationText(){const y=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*y).replace(/END_VALUE/g,""+.2*y).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}nu._diameters=new WeakMap,nu.\u0275fac=function(y){return new(y||nu)(d.Y36(d.SBq),d.Y36(Dc.t4),d.Y36(me.K0,8),d.Y36(d.QbO,8),d.Y36(Pb),d.Y36(d.sBO),d.Y36(R.rL),d.Y36(d.R0b))},nu.\u0275cmp=d.Xpm({type:nu,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(y,o){2&y&&(d.uIk("aria-valuemin","determinate"===o.mode?0:null)("aria-valuemax","determinate"===o.mode?100:null)("aria-valuenow","determinate"===o.mode?o.value:null)("mode",o.mode),d.Udp("width",o.diameter,"px")("height",o.diameter,"px"),d.ekj("_mat-animation-noopable",o._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[d.qOj],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(y,o){1&y&&(d.O4$(),d.TgZ(0,"svg",0,1),d.YNc(2,z1,1,11,"circle",2),d.YNc(3,U_,1,9,"circle",3),d.qZA()),2&y&&(d.Udp("width",o.diameter,"px")("height",o.diameter,"px"),d.Q6J("ngSwitch","indeterminate"===o.mode),d.uIk("viewBox",o._getViewBox()),d.xp6(2),d.Q6J("ngSwitchCase",!0),d.xp6(1),d.Q6J("ngSwitchCase",!1))},dependencies:[me.RF,me.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:rgba(0,0,0,0);transition:stroke-dashoffset 225ms linear}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}.mat-progress-spinner[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}.mat-progress-spinner._mat-animation-noopable svg,.mat-progress-spinner._mat-animation-noopable circle{animation:none;transition:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}"],encapsulation:2,changeDetection:0});let kb=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ai.BQ,me.ez,Ai.BQ]}),p})();const Rb=["container"];function U1(p,y){1&p&&(d.TgZ(0,"div",2),d._UZ(1,"mat-spinner")(2,"div"),d.qZA())}let $w=(()=>{class p{constructor(o,_,A,z,ue){this.zone=o,this.activatedRoute=_,this.demoFileLoaderService=A,this.http=z,this.ChangeDetectorRef=ue,this.loading=!0,this.projectbase$=(0,Mb.D)([this.http.get("assets/stackblitz/main.notts",{responseType:"text"}),this.http.get("assets/stackblitz/angular.json",{responseType:"text"})]).pipe((0,Tb.d)(1))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}ngAfterViewInit(){this.sub=this.activatedRoute.params.pipe((0,cr.b)(()=>{this.loading=!0,this.ChangeDetectorRef.markForCheck()}),(0,Mo.w)(o=>(0,Mb.D)([this.projectbase$,this.demoFileLoaderService.getDemoFiles(o.demoUrl)])),(0,Mo.w)(([o,_])=>(0,Db.D)(this.openExample(o,_)).pipe((0,R1.x)(()=>{this.loading=!1,this.ChangeDetectorRef.markForCheck()})))).subscribe()}openExample(o,_){var A=this;return fo(function*(){if(A.vm)return void(yield A.vm.applyFsDiff({create:_,destroy:[]}));const z=((p,y)=>({files:{"src/main.ts":p[0],"angular.json":p[1],"src/index.html":"<showcase-demo></showcase-demo>","src/styles.css":"\nhtml, body {\n  display: flex;\n  flex: 1;\n  min-height: 100vh;\n  margin: 0;\n}\n","src/polyfills.ts":"\nimport 'zone.js';\n(window as any).global = window;\n",...y},title:"",description:"",template:"angular-cli",dependencies:{tslib:"*","mapbox-gl":"*","ngx-mapbox-gl":"*","@angular/cdk":"*","@angular/material":"*","@angular/animations":"*","@angular/forms":"*",url:"*",querystring:"*",events:"*","@types/mapbox-gl":"*","@types/supercluster":"*","@types/geojson":"*"}}))(o,_);yield A.zone.runOutsideAngular(fo(function*(){A.vm=yield Gw.embedProject(A.stackblitzContainer.nativeElement,z,{hideExplorer:!0,hideNavigation:!0,forceEmbedLayout:!0,openFile:"src/demo.ts"})}))})()}}return p.\u0275fac=function(o){return new(o||p)(d.Y36(d.R0b),d.Y36(W.gz),d.Y36(B1),d.Y36(Sb.eN),d.Y36(d.sBO))},p.\u0275cmp=d.Xpm({type:p,selectors:[["ng-component"]],viewQuery:function(o,_){if(1&o&&d.Gf(Rb,5),2&o){let A;d.iGM(A=d.CRH())&&(_.stackblitzContainer=A.first)}},decls:3,vars:1,consts:[["container",""],["class","loader",4,"ngIf"],[1,"loader"]],template:function(o,_){1&o&&(d._UZ(0,"div",null,0),d.YNc(2,U1,3,0,"div",1)),2&o&&(d.xp6(2),d.Q6J("ngIf",_.loading))},dependencies:[me.O5,nu],styles:["[_nghost-%COMP%]{display:flex;flex:1;position:relative}[_nghost-%COMP%]     iframe{height:100%;width:100%;border:0}.loader[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}"],changeDetection:0}),p})();var hr=(()=>(function(p){p.STYLES="Styles",p.LAYERS="Layers",p.SOURCES="Sources",p.USER_INTERACTION="User interaction",p.CAMERA="Camera",p.CONTROLS_AND_OVERLAYS="Controls and overlays",p.PROJECTIONS="Projections"}(hr||(hr={})),hr))();const xv=[{path:"",component:na,children:[{path:"edit/:demoUrl",component:$w,canActivate:[zw]},{path:"display-map",component:t0,data:{label:"Display a map",cat:hr.STYLES}},{path:"custom-style-id",component:h1,data:{label:"Display a map with a custom style",cat:hr.STYLES}},{path:"set-style",component:ub,data:{label:"Change a map's style",cat:hr.STYLES}},{path:"satellite-map",component:hv,data:{label:"Display a satellite map",cat:hr.STYLES}},{path:"add-image-generated",component:uf,data:{label:"Add a generated icon to the map",cat:hr.LAYERS}},{path:"add-image",component:kv,data:{label:"Add an icon to the map",cat:hr.LAYERS}},{path:"toggle-layers",component:_b,data:{label:"Show and hide layers",cat:hr.LAYERS}},{path:"3d-buildings",component:v_,data:{label:"Display 3d buildings",cat:hr.LAYERS}},{path:"cluster",component:ox,data:{label:"Create and style clusters",cat:hr.LAYERS}},{path:"heatmap",component:g0,data:{label:"Create a heatmap layer",cat:hr.LAYERS}},{path:"geojson-line",component:f0,data:{label:"Add a GeoJSON line",cat:hr.LAYERS}},{path:"ngx-geojson-line",component:qm,data:{label:"[NGX] Add a GeoJSON line",cat:hr.LAYERS}},{path:"custom-marker-icons",component:sx,data:{label:"Add custom icons with Markers",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"ngx-custom-marker-icons",component:vw,data:{label:"[NGX] Add custom icons with Markers",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"live-update-feature",component:$x,data:{label:"Update a feature in realtime",cat:hr.SOURCES}},{path:"live-update-image-source",component:w0,data:{label:"Update an image source in realtime",cat:hr.SOURCES}},{path:"popup",component:uv,data:{label:"Display a popup",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"set-popup",component:Q0,data:{label:"Attach a popup to a marker instance",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"fullscreen",component:o0,data:{label:"View a fullscreen map",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"navigation",component:iw,data:{label:"Display map navigation controls",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"locate-user",component:Xx,data:{label:"Locate the user",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"attribution-position",component:Lv,data:{label:"Change the default position for attribution",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"ngx-scale-control",component:Cw,data:{label:"[NGX] Show scale information",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"ngx-custom-control",component:A1,data:{label:"[NGX] Add a custom control",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"interactive-false",component:Nx,data:{label:"Display a non-interactive map",cat:hr.USER_INTERACTION}},{path:"language-switch",component:Ux,data:{label:"Change a map's language",cat:hr.USER_INTERACTION}},{path:"center-on-symbol",component:Bv,data:{label:"Center the map on a clicked symbol",cat:hr.USER_INTERACTION}},{path:"ngx-drag-a-point",component:xw,data:{label:"[NGX] Create a draggable point",cat:hr.USER_INTERACTION}},{path:"drag-a-marker",component:mx,data:{label:"Create a draggable marker",cat:hr.USER_INTERACTION}},{path:"hover-styles",component:y0,data:{label:"Create a hover effect",cat:hr.USER_INTERACTION}},{path:"popup-on-click",component:Aw,data:{label:"Display a popup on click",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"zoomto-linestring",component:gv,data:{label:"Fit to the bounds of a LineString",cat:hr.USER_INTERACTION}},{path:"cluster-html",component:jv,data:{label:"Display HTML clusters with custom properties",cat:hr.LAYERS}},{path:"ngx-cluster-html",component:H0,data:{label:"[NGX] Display HTML clusters with custom properties",cat:hr.LAYERS}},{path:"polygon-popup-on-click",component:W0,data:{label:"Show polygon information on click",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"add-image-missing-generated",component:tu,data:{label:"Generate and add a missing icon to the map",cat:hr.STYLES}},{path:"custom-attribution",component:Kv,data:{label:"Add custom attributions",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"custom-locale",component:Jv,data:{label:"Add custom localization for controls",cat:hr.CONTROLS_AND_OVERLAYS}},{path:"marker-alignment",component:tw,data:{label:"Marker alignment options",cat:hr.CAMERA}},{path:"map-projection",component:ew,data:{label:"Display a web map using an alternate projection",cat:hr.PROJECTIONS}},{path:"**",redirectTo:"display-map"}]}],G_=function(){return[2]},G1=[{path:"",component:(()=>{class p{constructor(){this.center=[0,0],this.panToOptions={duration:1e4,easing:o=>o}}moveCenter(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;const o=this.center[0];0===o?this.center=[90,0]:90===o?this.center=[180,0]:180===o?this.center=[-90,0]:-90===o&&(this.center=[0,0])}}return p.\u0275fac=function(o){return new(o||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["ng-component"]],decls:5,vars:8,consts:[[3,"zoom","center","centerWithPanTo","panToOptions","interactive","mapLoad","moveEnd"],[1,"main"],["svgIcon","ngx-mapbox-gl-red",1,"logo"]],template:function(o,_){1&o&&(d.TgZ(0,"mgl-map",0),d.NdJ("mapLoad",function(){return _.moveCenter()})("moveEnd",function(){return _.moveCenter()}),d.qZA(),d.TgZ(1,"div",1),d._UZ(2,"mat-icon",2),d.TgZ(3,"h1"),d._uU(4,"Angular binding of mapbox-gl-js"),d.qZA()()),2&o&&(d.Akn("mapbox://styles/mapbox/streets-v9"),d.Q6J("zoom",d.DdM(7,G_))("center",_.center)("centerWithPanTo",!0)("panToOptions",_.panToOptions)("interactive",!1))},dependencies:[zi,Ce.Hw],styles:["[_nghost-%COMP%]{display:flex;flex:1;position:relative}.main[_ngcontent-%COMP%]{position:absolute;top:0px;height:100%;width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;pointer-events:none}.logo[_ngcontent-%COMP%]{width:150px;height:150px}mgl-map[_ngcontent-%COMP%]{flex:1}"]}),p})(),pathMatch:"full"}],$1=[{path:"",component:j(7360).$,children:[{path:"demo",children:xv},...G1,{path:"doc",loadChildren:()=>j.e(387).then(j.bind(j,6387)).then(p=>p.DocModule)}]},{path:"**",redirectTo:""}];let Zw=(()=>{class p{constructor(o,_){o.addSvgIcon("ngx-mapbox-gl",_.bypassSecurityTrustResourceUrl("assets/ngx-mapbox-gl.svg")),o.addSvgIcon("ngx-mapbox-gl-red",_.bypassSecurityTrustResourceUrl("assets/ngx-mapbox-gl-red.svg")),o.addSvgIcon("github",_.bypassSecurityTrustResourceUrl("assets/github.svg"))}}return p.\u0275fac=function(o){return new(o||p)(d.LFG(Ce.jv),d.LFG(T.H7))},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[T.b2,yl,Ce.Ps,W.Bz.forRoot($1,{useHash:!0}),Ha.withConfig({accessToken:"pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA"}),zl.x]}),p})(),Ww=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({providers:[zw],imports:[W.Bz,Sb.JF,me.ez,xo.u5,Ha,zl.x,P1,mb,Qa.ot,Vy,px,kb,S,Ce.Ps,gi,_w,ts]}),p})(),qw=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p}),p.\u0275inj=d.cJS({imports:[Ha,Ce.Ps]}),p})(),Z1=(()=>{class p{}return p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=d.oAB({type:p,bootstrap:[c]}),p.\u0275inj=d.cJS({imports:[W.Bz,Zw,qw,Ww]}),p})();(0,d.G48)(),T.q6().bootstrapModule(Z1).catch(p=>console.error(p))},9898:function(Bn){Bn.exports=function(){"use strict";var kt,j,T;function d(c,Ce){if(kt)if(j){var Ve="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+kt+")(sharedChunk); ("+j+")(sharedChunk); self.onerror = null;",Je={};kt(Je),T=Ce(Je),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(T.workerUrl=window.URL.createObjectURL(new Blob([Ve],{type:"text/javascript"})))}else j=Ce;else kt=Ce}return d(0,function(c){var Ce=typeof self<"u"?self:{},Ve=Je;function Je(n,e,i,a){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=i,this.p2y=a}Je.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n},Je.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n},Je.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},Je.prototype.solveCurveX=function(n,e){var i,a,h,g,b;for(void 0===e&&(e=1e-6),h=n,b=0;b<8;b++){if(g=this.sampleCurveX(h)-n,Math.abs(g)<e)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=g/C}if((h=n)<(i=0))return i;if(h>(a=1))return a;for(;i<a;){if(g=this.sampleCurveX(h),Math.abs(g-n)<e)return h;n>g?i=h:a=h,h=.5*(a-i)+i}return h},Je.prototype.solve=function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))};var ye=Me;function Me(n,e){this.x=n,this.y=e}Me.prototype={clone:function(){return new Me(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(n,e){var i=Math.cos(n),a=Math.sin(n),h=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Me.convert=function(n){return n instanceof Me?n:Array.isArray(n)?new Me(n[0],n[1]):n};const Ye=Math.PI/180,ft=180/Math.PI;function Pe(n){return n*Ye}function ut(n){return n*ft}const gt=[[0,0],[1,0],[1,1],[0,1]];function et(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function Ut(n,e,i,a){const h=new Ve(n,e,i,a);return function(g){return h.solve(g)}}const Ft=Ut(.25,.1,.25,1);function St(n,e,i){return Math.min(i,Math.max(e,n))}function Pn(n,e,i){return(i=St((i-n)/(e-n),0,1))*i*(3-2*i)}function Xn(n,e,i){const a=i-e,h=((n-e)%a+a)%a+e;return h===e?i:h}function Xt(n,e,i){if(!n.length)return i(null,[]);let a=n.length;const h=new Array(n.length);let g=null;n.forEach((b,C)=>{e(b,(D,S)=>{D&&(g=D),h[C]=S,0==--a&&i(g,h)})})}function Fe(n){const e=[];for(const i in n)e.push(n[i]);return e}function Qe(n,...e){for(const i of e)for(const a in i)n[a]=i[a];return n}let fn=1;function Jt(){return fn++}function rn(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function vn(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function xt(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Tt(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Gt(n,e){return-1!==n.indexOf(e,n.length-e.length)}function Bt(n,e,i){const a={};for(const h in n)a[h]=e.call(i||this,n[h],h,n);return a}function Cn(n,e,i){const a={};for(const h in n)e.call(i||this,n[h],h,n)&&(a[h]=n[h]);return a}function mn(n){return Array.isArray(n)?n.map(mn):"object"==typeof n&&n?Bt(n,mn):n}const oi={};function Yn(n){oi[n]||(typeof console<"u"&&console.warn(n),oi[n]=!0)}function fi(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function On(n){let e=0;for(let i,a,h=0,g=n.length,b=g-1;h<g;b=h++)i=n[h],a=n[b],e+=(a.x-i.x)*(i.y+a.y);return e}function Di(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ui(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,h,g)=>{const b=h||g;return e[a]=!b||b.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Pi=null;function Ln(n){if(null==Pi){const e=n.navigator?n.navigator.userAgent:null;Pi=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Pi}function Zn(n){try{const e=Ce[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Rt(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const Kt=Ce.performance;function kn(n){const e=n?n.url.toString():void 0;return Kt.getEntriesByName(e)}let gn,wi,Ei,Ii;const or={now:()=>void 0!==Ei?Ei:Ce.performance.now(),setNow(n){Ei=n},restoreNow(){Ei=void 0},frame(n){const e=Ce.requestAnimationFrame(n);return{cancel:()=>Ce.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:i,height:a}=n;Ii||(Ii=Ce.document.createElement("canvas"));const h=Ii.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return(i>Ii.width||a>Ii.height)&&(Ii.width=i,Ii.height=a),h.clearRect(-e,-e,i+2*e,a+2*e),h.drawImage(n,0,0,i,a),h.getImageData(-e,-e,i+2*e,a+2*e)},resolveURL:n=>(gn||(gn=Ce.document.createElement("a")),gn.href=n,gn.href),get devicePixelRatio(){return Ce.devicePixelRatio},get prefersReducedMotion(){return!!Ce.matchMedia&&(null==wi&&(wi=Ce.matchMedia("(prefers-reduced-motion: reduce)")),wi.matches)}};let Oi;const En={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Oi){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Oi=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{Oi=n}}return Oi},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Wi={supported:!1,testSupport:function(n){!K&&ct&&(ie?De(n):li=n)}};let li,ct,K=!1,ie=!1;function De(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,ct),n.isContextLost())return;Wi.supported=!0}catch{}n.deleteTexture(e),K=!0}Ce.document&&(ct=Ce.document.createElement("img"),ct.onload=function(){li&&De(li),li=null,ie=!0},ct.onerror=function(){K=!0,li=null},ct.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const dt="01",ze="NO_ACCESS_TOKEN";function he(n){return 0===n.indexOf("mapbox:")}function ce(n){return En.API_URL_REGEX.test(n)}const de=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function We(n){const e=n.match(de);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ht(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function Qt(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Ce.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class _n{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Qt(En.ACCESS_TOKEN);let a="";return a=i&&i.u?Ce.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,g)=>String.fromCharCode(Number("0x"+g)))):En.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${a}`:`mapbox.eventData:${a}`}fetchEventData(){const e=Zn("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const h=Ce.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const g=Ce.localStorage.getItem(a);g&&(this.anonId=g)}catch{Yn("Unable to read from LocalStorage")}}saveEventData(){const e=Zn("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{Ce.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&Ce.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Yn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,a,h){if(!En.EVENTS_URL)return;const g=We(En.EVENTS_URL);g.params.push(`access_token=${h||En.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.9.2",skuId:dt,userId:this.anonId},C=i?Qe(b,i):b,D={url:ht(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=Ot(D,S=>{this.pendingRequest=null,a(S),this.saveEventData(),this.processRequests(h)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const An=new class extends _n{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){En.EVENTS_URL&&En.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>he(i)||ce(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Qt(En.ACCESS_TOKEN),i=e?e.u:En.ACCESS_TOKEN;let a=i!==this.eventData.tokenU;xt(this.anonId)||(this.anonId=rn(),a=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),b=new Date(h),C=(h-this.eventData.lastSuccess)/864e5;a=a||C>=1||C<-1||g.getDate()!==b.getDate()}else a=!0;a?this.postEvent(h,{"enabled.telemetry":!1},g=>{g||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},n):this.processRequests()}},ii=An.postTurnstileEvent.bind(An),qn=new class extends _n{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,a){this.skuToken=e,this.errorCb=a,En.EVENTS_URL&&(i||En.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(ze)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),xt(this.anonId)||(this.anonId=rn()),this.postEvent(i,{skuToken:this.skuToken},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},n))}},gr=qn.postMapLoadEvent.bind(qn),mi=new class extends _n{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,a){if(!En.API_URL||!En.SESSION_PATH)return;const h=We(En.API_URL+En.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${a||En.ACCESS_TOKEN||""}`);const g={url:ht(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Et(g,b=>{this.pendingRequest=null,i(b),this.saveEventData(),this.processRequests(a)})}getSessionAPI(n,e,i,a){this.skuToken=e,this.errorCb=a,En.SESSION_PATH&&En.API_URL&&(i||En.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(ze)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},n)}},zt=mi.getSessionAPI.bind(mi),mt=new Set;let _t,Ke=500,nt=50,Be={};function Dt(n){const e=Y(n);let i,a;e&&e.forEach(g=>{const b=g.split("=");"language"===b[0]?i=b[1]:"worldview"===b[0]&&(a=b[1])});let h="mapbox-tiles";return i&&(h+=`-${i}`),a&&(h+=`-${a}`),h}function ae(n){Ce.caches&&!Be[n]&&(Be[n]=Ce.caches.open(n))}function Y(n){const e=n.indexOf("?");return e>0?n.slice(e+1).split("&"):[]}function le(n){const e=n.indexOf("?");if(e<0)return n;const i=Y(n).filter(a=>{const h=a.split("=");return"language"===h[0]||"worldview"===h[0]});return i.length?`${n.slice(0,e)}?${i.join("&")}`:n.slice(0,e)}let Te=1/0;const He={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(He);class Xe extends Error{constructor(e,i,a){401===i&&ce(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Mt=Di()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Ce.location.protocol?Ce.parent:Ce).location.href,Ct=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(Mt())&&!/^\w+:/.test(i))){if(Ce.fetch&&Ce.Request&&Ce.AbortController&&Ce.Request.prototype.hasOwnProperty("signal"))return function(a,h){const g=new Ce.AbortController,b=new Ce.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Mt(),signal:g.signal});let C=!1,D=!1;const S=(R=b.url).indexOf("sku=")>0&&ce(R);var R;"json"===a.type&&b.headers.set("Accept","application/json");const V=(ee,oe,pe)=>{if(D)return;if(ee&&"SecurityError"!==ee.message&&Yn(ee),oe&&pe)return U(oe);const Ie=Date.now();Ce.fetch(b).then(Ne=>{if(Ne.ok){const at=S?Ne.clone():null;return U(Ne,at,Ie)}return h(new Xe(Ne.statusText,Ne.status,a.url))}).catch(Ne=>{20!==Ne.code&&h(new Error(Ne.message))})},U=(ee,oe,pe)=>{("arrayBuffer"===a.type?ee.arrayBuffer():"json"===a.type?ee.json():ee.text()).then(Ie=>{D||(oe&&pe&&function(Ne,at,ot){const yt=Dt(Ne.url);if(ae(yt),!Be[yt])return;const wt={status:at.status,statusText:at.statusText,headers:new Ce.Headers};at.headers.forEach((Yt,dn)=>wt.headers.set(dn,Yt));const It=Ui(at.headers.get("Cache-Control")||"");if(It["no-store"])return;It["max-age"]&&wt.headers.set("Expires",new Date(ot+1e3*It["max-age"]).toUTCString());const Wt=wt.headers.get("Expires");Wt&&(new Date(Wt).getTime()-ot<42e4||function(Yt,dn){if(void 0===_t)try{new Response(new ReadableStream),_t=!0}catch{_t=!1}_t?dn(Yt.body):Yt.blob().then(dn)}(at,Yt=>{const dn=new Ce.Response(Yt,wt);ae(yt),Be[yt]&&Be[yt].then(Tn=>Tn.put(le(Ne.url),dn)).catch(Tn=>Yn(Tn.message))}))}(b,oe,pe),C=!0,h(null,Ie,ee.headers.get("Cache-Control"),ee.headers.get("Expires")))}).catch(Ie=>{D||h(new Error(Ie.message))})};return S?function(ee,oe){const pe=Dt(ee.url);if(ae(pe),!Be[pe])return oe(null);const Ie=le(ee.url);Be[pe].then(Ne=>{Ne.match(Ie).then(at=>{const ot=function(yt){if(!yt)return!1;const wt=new Date(yt.headers.get("Expires")||0),It=Ui(yt.headers.get("Cache-Control")||"");return wt>Date.now()&&!It["no-cache"]}(at);Ne.delete(Ie),ot&&Ne.put(Ie,at.clone()),oe(null,at,ot)}).catch(oe)}).catch(oe)}(b,V):V(null,null),{cancel:()=>{D=!0,C||g.abort()}}}(n,e);if(Di()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(a,h){const g=new Ce.XMLHttpRequest;g.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(g.responseType="arraybuffer");for(const b in a.headers)g.setRequestHeader(b,a.headers[b]);return"json"===a.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===a.credentials,g.onerror=()=>{h(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){let b=g.response;if("json"===a.type)try{b=JSON.parse(g.response)}catch(C){return h(C)}h(null,b,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else h(new Xe(g.statusText,g.status,a.url))},g.send(a.body),{cancel:()=>g.abort()}}(n,e)},lt=function(n,e){return Ct(Qe(n,{type:"arrayBuffer"}),e)},Ot=function(n,e){return Ct(Qe(n,{method:"POST"}),e)},Et=function(n,e){return Ct(Qe(n,{method:"GET"}),e)};function en(n){const e=Ce.document.createElement("a");return e.href=n,e.protocol===Ce.document.location.protocol&&e.host===Ce.document.location.host}const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ge,Oe;Ge=[],Oe=0;const tt=function(n,e){if(Wi.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),Oe>=En.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ge.push(g),g}Oe++;let i=!1;const a=()=>{if(!i)for(i=!0,Oe--;Ge.length&&Oe<En.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Ge.shift(),{requestParameters:b,callback:C,cancelled:D}=g;D||(g.cancel=tt(b,C).cancel)}},h=lt(n,(g,b,C,D)=>{a(),g?e(g):b&&(Ce.createImageBitmap?function(S,R){const V=new Ce.Blob([new Uint8Array(S)],{type:"image/png"});Ce.createImageBitmap(V).then(U=>{R(null,U)}).catch(U=>{R(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(S,R)=>e(S,R,C,D)):function(S,R){const V=new Ce.Image,U=Ce.URL;V.onload=()=>{R(null,V),U.revokeObjectURL(V.src),V.onload=null,Ce.requestAnimationFrame(()=>{V.src=Le})},V.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ee=new Ce.Blob([new Uint8Array(S)],{type:"image/png"});V.src=S.byteLength?U.createObjectURL(ee):Le}(b,(S,R)=>e(S,R,C,D)))});return{cancel:()=>{h.cancel(),a()}}};function Nt(n,e,i){i[n]&&-1!==i[n].indexOf(e)||(i[n]=i[n]||[],i[n].push(e))}function bn(n,e,i){if(i&&i[n]){const a=i[n].indexOf(e);-1!==a&&i[n].splice(a,1)}}class ti{constructor(e,i={}){Qe(this,i),this.type=e}}class Ri extends ti{constructor(e,i={}){super("error",Qe({error:e},i))}}class jn{on(e,i){return this._listeners=this._listeners||{},Nt(e,i,this._listeners),this}off(e,i){return bn(e,i,this._listeners),bn(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Nt(e,i,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,i){"string"==typeof e&&(e=new ti(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const C of h)C.call(this,e);const g=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const C of g)bn(a,C,this._oneTimeListeners),C.call(this,e);const b=this._eventedParent;b&&(Qe(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),b.fire(e))}else e instanceof Ri&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var At=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function nr(n,...e){for(const i of e)for(const a in i)n[a]=i[a];return n}function br(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function jr(n){if(Array.isArray(n))return n.map(jr);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=jr(n[i]);return e}return br(n)}class Zr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var Br=Zr;class Uo{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,h]of i)this.bindings[a]=h}concat(e){return new Uo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var jo=Uo;const as={kind:"null"},Gn={kind:"number"},ri={kind:"string"},ki={kind:"boolean"},ls={kind:"color"},po={kind:"object"},vi={kind:"value"},so={kind:"collator"},Go={kind:"formatted"},zr={kind:"resolvedImage"};function yr(n,e){return{kind:"array",itemType:n,N:e}}function Xi(n){if("array"===n.kind){const e=Xi(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const Gr=[as,Gn,ri,ki,ls,Go,po,yr(vi),zr];function ao(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ao(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const i of Gr)if(!ao(i,e))return null}return`Expected ${Xi(n)} but found ${Xi(e)} instead.`}function xa(n,e){return e.some(i=>i.kind===n.kind)}function ys(n,e){return e.some(i=>"null"===i?null===n:"array"===i?Array.isArray(n):"object"===i?n&&!Array.isArray(n)&&"object"==typeof n:i===typeof n)}function Vs(n){var e={exports:{}};return n(e,e.exports),e.exports}var Ko=Vs(function(n,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(C){return(C=Math.round(C))<0?0:C>255?255:C}function h(C){return a("%"===C[C.length-1]?parseFloat(C)/100*255:parseInt(C))}function g(C){return(D="%"===C[C.length-1]?parseFloat(C)/100:parseFloat(C))<0?0:D>1?1:D;var D}function b(C,D,S){return S<0?S+=1:S>1&&(S-=1),6*S<1?C+(D-C)*S*6:2*S<1?D:3*S<2?C+(D-C)*(2/3-S)*6:C}try{e.parseCSSColor=function(C){var D,S=C.replace(/ /g,"").toLowerCase();if(S in i)return i[S].slice();if("#"===S[0])return 4===S.length?(D=parseInt(S.substr(1),16))>=0&&D<=4095?[(3840&D)>>4|(3840&D)>>8,240&D|(240&D)>>4,15&D|(15&D)<<4,1]:null:7===S.length&&(D=parseInt(S.substr(1),16))>=0&&D<=16777215?[(16711680&D)>>16,(65280&D)>>8,255&D,1]:null;var R=S.indexOf("("),V=S.indexOf(")");if(-1!==R&&V+1===S.length){var U=S.substr(0,R),ee=S.substr(R+1,V-(R+1)).split(","),oe=1;switch(U){case"rgba":if(4!==ee.length)return null;oe=g(ee.pop());case"rgb":return 3!==ee.length?null:[h(ee[0]),h(ee[1]),h(ee[2]),oe];case"hsla":if(4!==ee.length)return null;oe=g(ee.pop());case"hsl":if(3!==ee.length)return null;var pe=(parseFloat(ee[0])%360+360)%360/360,Ie=g(ee[1]),Ne=g(ee[2]),at=Ne<=.5?Ne*(Ie+1):Ne+Ie-Ne*Ie,ot=2*Ne-at;return[a(255*b(ot,at,pe+1/3)),a(255*b(ot,at,pe)),a(255*b(ot,at,pe-1/3)),oe];default:return null}}return null}}catch{}});class Jr{constructor(e,i,a,h=1){this.r=e,this.g=i,this.b=a,this.a=h}static parse(e){if(!e)return;if(e instanceof Jr)return e;if("string"!=typeof e)return;const i=Ko.parseCSSColor(e);return i?new Jr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${h})`}toArray(){const{r:e,g:i,b:a,a:h}=this;return 0===h?[0,0,0,0]:[255*e/h,255*i/h,255*a/h,h]}toArray01(){const{r:e,g:i,b:a,a:h}=this;return 0===h?[0,0,0,0]:[e/h,i/h,a/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:a,a:h}=this;return[e,i,a,h]}}Jr.black=new Jr(0,0,0,1),Jr.white=new Jr(1,1,1,1),Jr.transparent=new Jr(0,0,0,0),Jr.red=new Jr(1,0,0,1),Jr.blue=new Jr(0,0,1,1);var xr=Jr;class Lo{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ra{constructor(e,i,a,h,g){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=a,this.fontStack=h,this.textColor=g}}class lo{constructor(e){this.sections=e}static fromString(e){return new lo([new ra(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof lo?e:lo.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e}}class Ps{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ps({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ho(n,e,i,a){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:`Invalid rgba value [${[n,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof a?[n,e,i,a]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function el(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof xr||n instanceof Lo||n instanceof lo||n instanceof Ps)return!0;if(Array.isArray(n)){for(const e of n)if(!el(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!el(n[e]))return!1;return!0}return!1}function Wr(n){if(null===n)return as;if("string"==typeof n)return ri;if("boolean"==typeof n)return ki;if("number"==typeof n)return Gn;if(n instanceof xr)return ls;if(n instanceof Lo)return so;if(n instanceof lo)return Go;if(n instanceof Ps)return zr;if(Array.isArray(n)){const e=n.length;let i;for(const a of n){const h=Wr(a);if(i){if(i===h)continue;i=vi;break}i=h}return yr(i||vi,e)}return po}function oa(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof xr||n instanceof lo||n instanceof Ps?n.toString():JSON.stringify(n)}class Oa{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!el(e[1]))return i.error("invalid value");const a=e[1];let h=Wr(a);const g=i.expectedType;return"array"!==h.kind||0!==h.N||!g||"array"!==g.kind||"number"==typeof g.N&&0!==g.N||(h=g),new Oa(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof xr?["rgba"].concat(this.value.toArray()):this.value instanceof lo?this.value.serialize():this.value}}var sa=Oa,Sr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const vs={string:ri,number:Gn,boolean:ki,object:po};class Us{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,h=1;const g=e[0];if("array"===g){let C,D;if(e.length>2){const S=e[1];if("string"!=typeof S||!(S in vs)||"object"===S)return i.error('The item type argument of "array" must be one of string, number, boolean',1);C=vs[S],h++}else C=vi;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);D=e[2],h++}a=yr(C,D)}else a=vs[g];const b=[];for(;h<e.length;h++){const C=i.parse(e[h],h,vi);if(!C)return null;b.push(C)}return new Us(a,b)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!ao(this.type,Wr(a)))return a;if(i===this.args.length-1)throw new Sr(`Expected value to be of type ${Xi(this.type)}, but found ${Xi(Wr(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const a=e.itemType;if("string"===a.kind||"number"===a.kind||"boolean"===a.kind){i.push(a.kind);const h=e.N;("number"==typeof h||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(a=>a.serialize()))}}var js=Us;class Gs{constructor(e){this.type=Go,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&"object"==typeof a)return i.error("First argument must be an image or text section.");const h=[];let g=!1;for(let b=1;b<=e.length-1;++b){const C=e[b];if(g&&"object"==typeof C&&!Array.isArray(C)){g=!1;let D=null;if(C["font-scale"]&&(D=i.parse(C["font-scale"],1,Gn),!D))return null;let S=null;if(C["text-font"]&&(S=i.parse(C["text-font"],1,yr(ri)),!S))return null;let R=null;if(C["text-color"]&&(R=i.parse(C["text-color"],1,ls),!R))return null;const V=h[h.length-1];V.scale=D,V.font=S,V.textColor=R}else{const D=i.parse(e[b],1,vi);if(!D)return null;const S=D.type.kind;if("string"!==S&&"value"!==S&&"null"!==S&&"resolvedImage"!==S)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:D,scale:null,font:null,textColor:null})}}return new Gs(h)}evaluate(e){return new lo(this.sections.map(i=>{const a=i.content.evaluate(e);return Wr(a)===zr?new ra("",a,null,null,null):new ra(oa(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e}}class Hs{constructor(e){this.type=zr,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,ri);return a?new Hs(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=Ps.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const tl={"to-boolean":ki,"to-color":ls,"to-number":Gn,"to-string":ri};class wa{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(("to-boolean"===a||"to-string"===a)&&2!==e.length)return i.error("Expected one argument.");const h=tl[a],g=[];for(let b=1;b<e.length;b++){const C=i.parse(e[b],b,vi);if(!C)return null;g.push(C)}return new wa(h,g)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let i,a;for(const h of this.args){if(i=h.evaluate(e),a=null,i instanceof xr)return i;if("string"==typeof i){const g=e.parseColor(i);if(g)return g}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Ho(i[0],i[1],i[2],i[3]),!a))return new xr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Sr(a||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const a of this.args){if(i=a.evaluate(e),null===i)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Sr(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?lo.fromString(oa(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Ps.fromString(oa(this.args[0].evaluate(e))):oa(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Gs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Hs(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var $s=wa;const Sc=["Unknown","Point","LineString","Polygon"];var nl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Sc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-n[0])+this.featureDistanceData.bearing[1]*(a*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=xr.parse(n)),e}};class Fo{constructor(e,i,a,h){this.name=e,this.type=i,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const a=e[0],h=Fo.definitions[a];if(!h)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,b=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,C=b.filter(([S])=>!Array.isArray(S)||S.length===e.length-1);let D=null;for(const[S,R]of C){D=new J(i.registry,i.path,null,i.scope);const V=[];let U=!1;for(let ee=1;ee<e.length;ee++){const oe=e[ee],pe=Array.isArray(S)?S[ee-1]:S.type,Ie=D.parse(oe,1+V.length,pe);if(!Ie){U=!0;break}V.push(Ie)}if(!U)if(Array.isArray(S)&&S.length!==V.length)D.error(`Expected ${S.length} arguments, but found ${V.length} instead.`);else{for(let ee=0;ee<V.length;ee++){const oe=Array.isArray(S)?S[ee]:S.type,pe=V[ee];D.concat(ee+1).checkSubtype(oe,pe.type)}if(0===D.errors.length)return new Fo(a,g,R,V)}}if(1===C.length)i.errors.push(...D.errors);else{const S=(C.length?C:b).map(([V])=>{return U=V,Array.isArray(U)?`(${U.map(Xi).join(", ")})`:`(${Xi(U.type)}...)`;var U}).join(" | "),R=[];for(let V=1;V<e.length;V++){const U=i.parse(e[V],1+R.length);if(!U)return null;R.push(Xi(U.type))}i.error(`Expected arguments of type ${S}, but found (${R.join(", ")}) instead.`)}return null}static register(e,i){Fo.definitions=i;for(const a in i)e[a]=Fo}}var $o=Fo;class Xo{constructor(e,i,a){this.type=so,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const a=e[1];if("object"!=typeof a||Array.isArray(a))return i.error("Collator options argument must be an object.");const h=i.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,ki);if(!h)return null;const g=i.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,ki);if(!g)return null;let b=null;return a.locale&&(b=i.parse(a.locale,1,ri),!b)?null:new Xo(h,g,b)}evaluate(e){return new Lo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const aa=8192;function la(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function ka(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Ra(n,e){const i=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*aa),Math.round(a*h*aa)]}function _l(n,e,i){const a=n[0]-e[0],h=n[1]-e[1],g=n[0]-i[0],b=n[1]-i[1];return a*b-g*h==0&&a*g<=0&&h*b<=0}function Al(n,e){let i=!1;for(let b=0,C=e.length;b<C;b++){const D=e[b];for(let S=0,R=D.length;S<R-1;S++){if(_l(n,D[S],D[S+1]))return!1;(h=D[S])[1]>(a=n)[1]!=(g=D[S+1])[1]>a[1]&&a[0]<(g[0]-h[0])*(a[1]-h[1])/(g[1]-h[1])+h[0]&&(i=!i)}}var a,h,g;return i}function La(n,e){for(let i=0;i<e.length;i++)if(Al(n,e[i]))return!0;return!1}function ca(n,e,i,a){const h=a[0]-i[0],g=a[1]-i[1],b=(n[0]-i[0])*g-h*(n[1]-i[1]),C=(e[0]-i[0])*g-h*(e[1]-i[1]);return b>0&&C<0||b<0&&C>0}function cs(n,e,i){for(const S of i)for(let R=0;R<S.length-1;++R)if((C=[(b=S[R+1])[0]-(g=S[R])[0],b[1]-g[1]])[0]*(D=[(h=e)[0]-(a=n)[0],h[1]-a[1]])[1]-C[1]*D[0]!=0&&ca(a,h,g,b)&&ca(g,b,a,h))return!0;var a,h,g,b,C,D;return!1}function Fa(n,e){for(let i=0;i<n.length;++i)if(!Al(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(cs(n[i],n[i+1],e))return!1;return!0}function Ba(n,e){for(let i=0;i<e.length;i++)if(Fa(n,e[i]))return!0;return!1}function Zs(n,e,i){const a=[];for(let h=0;h<n.length;h++){const g=[];for(let b=0;b<n[h].length;b++){const C=Ra(n[h][b],i);la(e,C),g.push(C)}a.push(g)}return a}function Bo(n,e,i){const a=[];for(let h=0;h<n.length;h++){const g=Zs(n[h],e,i);a.push(g)}return a}function Ca(n,e,i,a){if(n[0]<i[0]||n[0]>i[2]){const h=.5*a;let g=n[0]-i[0]>h?-a:i[0]-n[0]>h?a:0;0===g&&(g=n[0]-i[2]>h?-a:i[2]-n[0]>h?a:0),n[0]+=g}la(e,n)}function Qr(n,e,i,a){const h=Math.pow(2,a.z)*aa,g=[a.x*aa,a.y*aa],b=[];if(!n)return b;for(const C of n)for(const D of C){const S=[D.x+g[0],D.y+g[1]];Ca(S,e,i,h),b.push(S)}return b}function za(n,e,i,a){const h=Math.pow(2,a.z)*aa,g=[a.x*aa,a.y*aa],b=[];if(!n)return b;for(const D of n){const S=[];for(const R of D){const V=[R.x+g[0],R.y+g[1]];la(e,V),S.push(V)}b.push(S)}if(e[2]-e[0]<=h/2){(C=e)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const D of b)for(const S of D)Ca(S,e,i,h)}var C;return b}class Ws{constructor(e,i){this.type=ki,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(el(e[1])){const a=e[1];if("FeatureCollection"===a.type)for(let h=0;h<a.features.length;++h){const g=a.features[h].geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new Ws(a,a.features[h].geometry)}else if("Feature"===a.type){const h=a.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new Ws(a,a.geometry)}else if("Polygon"===a.type||"MultiPolygon"===a.type)return new Ws(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=i.canonicalID();if(!b)return!1;if("Polygon"===a.type){const C=Zs(a.coordinates,g,b),D=Qr(i.geometry(),h,g,b);if(!ka(h,g))return!1;for(const S of D)if(!Al(S,C))return!1}if("MultiPolygon"===a.type){const C=Bo(a.coordinates,g,b),D=Qr(i.geometry(),h,g,b);if(!ka(h,g))return!1;for(const S of D)if(!La(S,C))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=i.canonicalID();if(!b)return!1;if("Polygon"===a.type){const C=Zs(a.coordinates,g,b),D=za(i.geometry(),h,g,b);if(!ka(h,g))return!1;for(const S of D)if(!Fa(S,C))return!1}if("MultiPolygon"===a.type){const C=Bo(a.coordinates,g,b),D=za(i.geometry(),h,g,b);if(!ka(h,g))return!1;for(const S of D)if(!Ba(S,C))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ua=Ws;function vo(n){if(n instanceof $o&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof ua)return!1;let e=!0;return n.eachChild(i=>{e&&!vo(i)&&(e=!1)}),e}function Co(n){if(n instanceof $o&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(i=>{e&&!Co(i)&&(e=!1)}),e}function da(n,e){if(n instanceof $o&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(a=>{i&&!da(a,e)&&(i=!1)}),i}class Li{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new Li(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var X=Li;class be{constructor(e,i=[],a,h=new jo,g=[]){this.registry=e,this.path=i,this.key=i.map(b=>`[${b}]`).join(""),this.scope=h,this.errors=g,this.expectedType=a}parse(e,i,a,h,g={}){return i?this.concat(i,a,h)._parse(e,g):this._parse(e,g)}_parse(e,i){function a(h,g,b){return"assert"===b?new js(g,[h]):"coerce"===b?new $s(g,[h]):h}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[h];if(g){let b=g.parse(e,this);if(!b)return null;if(this.expectedType){const C=this.expectedType,D=b.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==D.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==D.kind&&"string"!==D.kind){if(this.checkSubtype(C,D))return null}else b=a(b,C,i.typeAnnotation||"coerce");else b=a(b,C,i.typeAnnotation||"assert")}if(!(b instanceof sa)&&"resolvedImage"!==b.type.kind&&Ae(b)){const C=new nl;try{b=new sa(b.type,b.evaluate(C))}catch(D){return this.error(D.message),null}}return b}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const h="number"==typeof e?this.path.concat(e):this.path,g=a?this.scope.concat(a):this.scope;return new be(this.registry,h,i||null,g,this.errors)}error(e,...i){const a=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new Br(a,e))}checkSubtype(e,i){const a=ao(e,i);return a&&this.error(a),a}}var J=be;function Ae(n){if(n instanceof X)return Ae(n.boundExpression);if(n instanceof $o&&"error"===n.name||n instanceof Xo||n instanceof ua)return!1;const e=n instanceof $s||n instanceof js;let i=!0;return n.eachChild(a=>{i=e?i&&Ae(a):i&&a instanceof sa}),!!i&&vo(n)&&da(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function vt(n,e){const i=n.length-1;let a,h,g=0,b=i,C=0;for(;g<=b;)if(C=Math.floor((g+b)/2),a=n[C],h=n[C+1],a<=e){if(C===i||e<h)return C;g=C+1}else{if(!(a>e))throw new Sr("Input is not a number.");b=C-1}return 0}class sn{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[h,g]of a)this.labels.push(h),this.outputs.push(g)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,Gn);if(!a)return null;const h=[];let g=null;i.expectedType&&"value"!==i.expectedType.kind&&(g=i.expectedType);for(let b=1;b<e.length;b+=2){const C=1===b?-1/0:e[b],D=e[b+1],S=b,R=b+1;if("number"!=typeof C)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(h.length&&h[h.length-1][0]>=C)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const V=i.parse(D,R,g);if(!V)return null;g=g||V.type,h.push([C,V])}return new sn(g,a,h)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return a[0].evaluate(e);const g=i.length;return h>=i[g-1]?a[g-1].evaluate(e):a[vt(i,h)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var xn=sn;function nn(n,e,i){return n*(1-i)+e*i}var wr=Object.freeze({__proto__:null,number:nn,color:function(n,e,i){return new xr(nn(n.r,e.r,i),nn(n.g,e.g,i),nn(n.b,e.b,i),nn(n.a,e.a,i))},array:function(n,e,i){return n.map((a,h)=>nn(a,e[h],i))}});const Vi=4/29,kr=6/29,Dr=3*kr*kr,co=Math.PI/180,il=180/Math.PI;function yn(n){return n>.008856451679035631?Math.pow(n,1/3):n/Dr+Vi}function ji(n){return n>kr?n*n*n:Dr*(n-Vi)}function Eo(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function rl(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function qr(n){const e=rl(n.r),i=rl(n.g),a=rl(n.b),h=yn((.4124564*e+.3575761*i+.1804375*a)/.95047),g=yn((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*g-16,a:500*(h-g),b:200*(g-yn((.0193339*e+.119192*i+.9503041*a)/1.08883)),alpha:n.a}}function ol(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,a=isNaN(n.b)?e:e-n.b/200;return e=1*ji(e),i=.95047*ji(i),a=1.08883*ji(a),new xr(Eo(3.2404542*i-1.5371385*e-.4985314*a),Eo(-.969266*i+1.8760108*e+.041556*a),Eo(.0556434*i-.2040259*e+1.0572252*a),n.alpha)}function ne(n,e,i){const a=e-n;return n+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const q={forward:qr,reverse:ol,interpolate:function(n,e,i){return{l:nn(n.l,e.l,i),a:nn(n.a,e.a,i),b:nn(n.b,e.b,i),alpha:nn(n.alpha,e.alpha,i)}}},$={forward:function(n){const{l:e,a:i,b:a}=qr(n),h=Math.atan2(a,i)*il;return{h:h<0?h+360:h,c:Math.sqrt(i*i+a*a),l:e,alpha:n.a}},reverse:function(n){const e=n.h*co,i=n.c;return ol({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:ne(n.h,e.h,i),c:nn(n.c,e.c,i),l:nn(n.l,e.l,i),alpha:nn(n.alpha,e.alpha,i)}}};var me=Object.freeze({__proto__:null,lab:q,hcl:$});class cn{constructor(e,i,a,h,g){this.type=e,this.operator=i,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[b,C]of g)this.labels.push(b),this.outputs.push(C)}static interpolationFactor(e,i,a,h){let g=0;if("exponential"===e.name)g=Ci(i,e.base,a,h);else if("linear"===e.name)g=Ci(i,1,a,h);else if("cubic-bezier"===e.name){const b=e.controlPoints;g=new Ve(b[0],b[1],b[2],b[3]).solve(Ci(i,1,a,h))}return g}static parse(e,i){let[a,h,g,...b]=e;if(!Array.isArray(h)||0===h.length)return i.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const S=h[1];if("number"!=typeof S)return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:S}}else{if("cubic-bezier"!==h[0])return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const S=h.slice(1);if(4!==S.length||S.some(R=>"number"!=typeof R||R<0||R>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:S}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(g=i.parse(g,2,Gn),!g)return null;const C=[];let D=null;"interpolate-hcl"===a||"interpolate-lab"===a?D=ls:i.expectedType&&"value"!==i.expectedType.kind&&(D=i.expectedType);for(let S=0;S<b.length;S+=2){const R=b[S],V=b[S+1],U=S+3,ee=S+4;if("number"!=typeof R)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(C.length&&C[C.length-1][0]>=R)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const oe=i.parse(V,ee,D);if(!oe)return null;D=D||oe.type,C.push([R,oe])}return"number"===D.kind||"color"===D.kind||"array"===D.kind&&"number"===D.itemType.kind&&"number"==typeof D.N?new cn(D,a,h,g,C):i.error(`Type ${Xi(D)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return a[0].evaluate(e);const g=i.length;if(h>=i[g-1])return a[g-1].evaluate(e);const b=vt(i,h),C=cn.interpolationFactor(this.interpolation,h,i[b],i[b+1]),D=a[b].evaluate(e),S=a[b+1].evaluate(e);return"interpolate"===this.operator?wr[this.type.kind.toLowerCase()](D,S,C):"interpolate-hcl"===this.operator?$.reverse($.interpolate($.forward(D),$.forward(S),C)):q.reverse(q.interpolate(q.forward(D),q.forward(S),C))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)i.push(this.labels[a],this.outputs[a].serialize());return i}}function Ci(n,e,i,a){const h=a-i,g=n-i;return 0===h?0:1===e?g/h:(Math.pow(e,g)-1)/(Math.pow(e,h)-1)}var Ar=cn;class bs{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const h=i.expectedType;h&&"value"!==h.kind&&(a=h);const g=[];for(const C of e.slice(1)){const D=i.parse(C,1+g.length,a,void 0,{typeAnnotation:"omit"});if(!D)return null;a=a||D.type,g.push(D)}const b=h&&g.some(C=>ao(h,C.type));return new bs(b?vi:a,g)}evaluate(e){let i,a=null,h=0;for(const g of this.args){if(h++,a=g.evaluate(e),a&&a instanceof Ps&&!a.available&&(i||(i=a),a=null,h===this.args.length))return i;if(null!==a)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var eo=bs;class us{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let g=1;g<e.length-1;g+=2){const b=e[g];if("string"!=typeof b)return i.error(`Expected string, but found ${typeof b} instead.`,g);if(/[^a-zA-Z0-9_]/.test(b))return i.error("Variable names must contain only alphanumeric characters or '_'.",g);const C=i.parse(e[g+1],g+1);if(!C)return null;a.push([b,C])}const h=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return h?new us(a,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,a]of this.bindings)e.push(i,a.serialize());return e.push(this.result.serialize()),e}}var ru=us;class sl{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Gn),h=i.parse(e[2],2,yr(i.expectedType||vi));return a&&h?new sl(h.type.itemType,a,h):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new Sr(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Sr(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Sr(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var al=sl;class zu{constructor(e,i){this.type=ki,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,vi),h=i.parse(e[2],2,vi);return a&&h?xa(a.type,[ki,ri,Gn,as,vi])?new zu(a,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(null==a)return!1;if(!ys(i,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(Wr(i))} instead.`);if(!ys(a,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${Xi(Wr(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Pd=zu;class Ac{constructor(e,i,a){this.type=Gn,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,vi),h=i.parse(e[2],2,vi);if(!a||!h)return null;if(!xa(a.type,[ki,ri,Gn,as,vi]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(a.type)} instead`);if(4===e.length){const g=i.parse(e[3],3,Gn);return g?new Ac(a,h,g):null}return new Ac(a,h)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!ys(i,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(Wr(i))} instead.`);if(!ys(a,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${Xi(Wr(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(i,h)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Nu=Ac;class tc{constructor(e,i,a,h,g,b){this.inputType=e,this.type=i,this.input=a,this.cases=h,this.outputs=g,this.otherwise=b}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,h;i.expectedType&&"value"!==i.expectedType.kind&&(h=i.expectedType);const g={},b=[];for(let S=2;S<e.length-1;S+=2){let R=e[S];const V=e[S+1];Array.isArray(R)||(R=[R]);const U=i.concat(S);if(0===R.length)return U.error("Expected at least one branch label.");for(const oe of R){if("number"!=typeof oe&&"string"!=typeof oe)return U.error("Branch labels must be numbers or strings.");if("number"==typeof oe&&Math.abs(oe)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof oe&&Math.floor(oe)!==oe)return U.error("Numeric branch labels must be integer values.");if(a){if(U.checkSubtype(a,Wr(oe)))return null}else a=Wr(oe);if(void 0!==g[String(oe)])return U.error("Branch labels must be unique.");g[String(oe)]=b.length}const ee=i.parse(V,S,h);if(!ee)return null;h=h||ee.type,b.push(ee)}const C=i.parse(e[1],1,vi);if(!C)return null;const D=i.parse(e[e.length-1],e.length-1,h);return D?"value"!==C.type.kind&&i.concat(1).checkSubtype(a,C.type)?null:new tc(a,h,C,g,b,D):null}evaluate(e){const i=this.input.evaluate(e);return(Wr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),a=[],h={};for(const b of i){const C=h[this.cases[b]];void 0===C?(h[this.cases[b]]=a.length,a.push([this.cases[b],[b]])):a[C][1].push(b)}const g=b=>"number"===this.inputType.kind?Number(b):b;for(const[b,C]of a)e.push(1===C.length?g(C[0]):C.map(g)),e.push(this.outputs[b].serialize());return e.push(this.otherwise.serialize()),e}}var nc=tc;class Il{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);const h=[];for(let b=1;b<e.length-1;b+=2){const C=i.parse(e[b],b,ki);if(!C)return null;const D=i.parse(e[b+1],b+1,a);if(!D)return null;h.push([C,D]),a=a||D.type}const g=i.parse(e[e.length-1],e.length-1,a);return g?new Il(a,h,g):null}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Pl=Il;class yl{constructor(e,i,a,h){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=h}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,vi),h=i.parse(e[2],2,Gn);if(!a||!h)return null;if(!xa(a.type,[yr(vi),ri,vi]))return i.error(`Expected first argument to be of type array or string, but found ${Xi(a.type)} instead`);if(4===e.length){const g=i.parse(e[3],3,Gn);return g?new yl(a.type,a,h,g):null}return new yl(a.type,a,h)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!ys(i,["string","array"]))throw new Sr(`Expected first argument to be of type array or string, but found ${Xi(Wr(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return i.slice(a,h)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Od=yl;function Vu(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function kd(n,e,i,a){return 0===a.compare(e,i)}function ds(n,e,i){const a="=="!==n&&"!="!==n;return class oC{constructor(g,b,C){this.type=ki,this.lhs=g,this.rhs=b,this.collator=C,this.hasUntypedArgument="value"===g.type.kind||"value"===b.type.kind}static parse(g,b){if(3!==g.length&&4!==g.length)return b.error("Expected two or three arguments.");const C=g[0];let D=b.parse(g[1],1,vi);if(!D)return null;if(!Vu(C,D.type))return b.concat(1).error(`"${C}" comparisons are not supported for type '${Xi(D.type)}'.`);let S=b.parse(g[2],2,vi);if(!S)return null;if(!Vu(C,S.type))return b.concat(2).error(`"${C}" comparisons are not supported for type '${Xi(S.type)}'.`);if(D.type.kind!==S.type.kind&&"value"!==D.type.kind&&"value"!==S.type.kind)return b.error(`Cannot compare types '${Xi(D.type)}' and '${Xi(S.type)}'.`);a&&("value"===D.type.kind&&"value"!==S.type.kind?D=new js(S.type,[D]):"value"!==D.type.kind&&"value"===S.type.kind&&(S=new js(D.type,[S])));let R=null;if(4===g.length){if("string"!==D.type.kind&&"string"!==S.type.kind&&"value"!==D.type.kind&&"value"!==S.type.kind)return b.error("Cannot use collator to compare non-string types.");if(R=b.parse(g[3],3,so),!R)return null}return new oC(D,S,R)}evaluate(g){const b=this.lhs.evaluate(g),C=this.rhs.evaluate(g);if(a&&this.hasUntypedArgument){const D=Wr(b),S=Wr(C);if(D.kind!==S.kind||"string"!==D.kind&&"number"!==D.kind)throw new Sr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${D.kind}, ${S.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const D=Wr(b),S=Wr(C);if("string"!==D.kind||"string"!==S.kind)return e(g,b,C)}return this.collator?i(g,b,C,this.collator.evaluate(g)):e(g,b,C)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[n];return this.eachChild(b=>{g.push(b.serialize())}),g}}}const ic=ds("==",function(n,e,i){return e===i},kd),fo=ds("!=",function(n,e,i){return e!==i},function(n,e,i,a){return!kd(0,e,i,a)}),to=ds("<",function(n,e,i){return e<i},function(n,e,i,a){return a.compare(e,i)<0}),rc=ds(">",function(n,e,i){return e>i},function(n,e,i,a){return a.compare(e,i)>0}),Na=ds("<=",function(n,e,i){return e<=i},function(n,e,i,a){return a.compare(e,i)<=0}),Qo=ds(">=",function(n,e,i){return e>=i},function(n,e,i,a){return a.compare(e,i)>=0});class xs{constructor(e,i,a,h,g){this.type=ri,this.number=e,this.locale=i,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Gn);if(!a)return null;const h=e[2];if("object"!=typeof h||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=i.parse(h.locale,1,ri),!g))return null;let b=null;if(h.currency&&(b=i.parse(h.currency,1,ri),!b))return null;let C=null;if(h["min-fraction-digits"]&&(C=i.parse(h["min-fraction-digits"],1,Gn),!C))return null;let D=null;return h["max-fraction-digits"]&&(D=i.parse(h["max-fraction-digits"],1,Gn),!D)?null:new xs(a,g,b,C,D)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ir{constructor(e){this.type=Gn,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?i.error(`Expected argument of type string or array, but found ${Xi(a.type)} instead.`):new ir(a):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new Sr(`Expected value to be of type string or array, but found ${Xi(Wr(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const ou={"==":ic,"!=":fo,">":rc,"<":to,">=":Qo,"<=":Na,array:js,at:al,boolean:js,case:Pl,coalesce:eo,collator:Xo,format:Gs,image:Hs,in:Pd,"index-of":Nu,interpolate:Ar,"interpolate-hcl":Ar,"interpolate-lab":Ar,length:ir,let:ru,literal:sa,match:nc,number:js,"number-format":xs,object:js,slice:Od,step:xn,string:js,"to-boolean":$s,"to-color":$s,"to-number":$s,"to-string":$s,var:X,within:ua};function Uu(n,[e,i,a,h]){e=e.evaluate(n),i=i.evaluate(n),a=a.evaluate(n);const g=h?h.evaluate(n):1,b=Ho(e,i,a,g);if(b)throw new Sr(b);return new xr(e/255*g,i/255*g,a/255*g,g)}function Ic(n,e){return n in e}function zo(n,e){const i=e[n];return void 0===i?null:i}function ll(n){return{type:n}}$o.register(ou,{error:[{kind:"error"},[ri],(n,[e])=>{throw new Sr(e.evaluate(n))}],typeof:[ri,[vi],(n,[e])=>Xi(Wr(e.evaluate(n)))],"to-rgba":[yr(Gn,4),[ls],(n,[e])=>e.evaluate(n).toArray()],rgb:[ls,[Gn,Gn,Gn],Uu],rgba:[ls,[Gn,Gn,Gn,Gn],Uu],has:{type:ki,overloads:[[[ri],(n,[e])=>Ic(e.evaluate(n),n.properties())],[[ri,po],(n,[e,i])=>Ic(e.evaluate(n),i.evaluate(n))]]},get:{type:vi,overloads:[[[ri],(n,[e])=>zo(e.evaluate(n),n.properties())],[[ri,po],(n,[e,i])=>zo(e.evaluate(n),i.evaluate(n))]]},"feature-state":[vi,[ri],(n,[e])=>zo(e.evaluate(n),n.featureState||{})],properties:[po,[],n=>n.properties()],"geometry-type":[ri,[],n=>n.geometryType()],id:[vi,[],n=>n.id()],zoom:[Gn,[],n=>n.globals.zoom],pitch:[Gn,[],n=>n.globals.pitch||0],"distance-from-center":[Gn,[],n=>n.distanceFromCenter()],"heatmap-density":[Gn,[],n=>n.globals.heatmapDensity||0],"line-progress":[Gn,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Gn,[],n=>n.globals.skyRadialProgress||0],accumulated:[vi,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[Gn,ll(Gn),(n,e)=>{let i=0;for(const a of e)i+=a.evaluate(n);return i}],"*":[Gn,ll(Gn),(n,e)=>{let i=1;for(const a of e)i*=a.evaluate(n);return i}],"-":{type:Gn,overloads:[[[Gn,Gn],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[Gn],(n,[e])=>-e.evaluate(n)]]},"/":[Gn,[Gn,Gn],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[Gn,[Gn,Gn],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[Gn,[],()=>Math.LN2],pi:[Gn,[],()=>Math.PI],e:[Gn,[],()=>Math.E],"^":[Gn,[Gn,Gn],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[Gn,[Gn],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Gn,[Gn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Gn,[Gn],(n,[e])=>Math.log(e.evaluate(n))],log2:[Gn,[Gn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Gn,[Gn],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Gn,[Gn],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Gn,[Gn],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Gn,[Gn],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Gn,[Gn],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Gn,[Gn],(n,[e])=>Math.atan(e.evaluate(n))],min:[Gn,ll(Gn),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[Gn,ll(Gn),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[Gn,[Gn],(n,[e])=>Math.abs(e.evaluate(n))],round:[Gn,[Gn],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Gn,[Gn],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Gn,[Gn],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[ki,[ri,vi],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[ki,[vi],(n,[e])=>n.id()===e.value],"filter-type-==":[ki,[ri],(n,[e])=>n.geometryType()===e.value],"filter-<":[ki,[ri,vi],(n,[e,i])=>{const a=n.properties()[e.value],h=i.value;return typeof a==typeof h&&a<h}],"filter-id-<":[ki,[vi],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[ki,[ri,vi],(n,[e,i])=>{const a=n.properties()[e.value],h=i.value;return typeof a==typeof h&&a>h}],"filter-id->":[ki,[vi],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[ki,[ri,vi],(n,[e,i])=>{const a=n.properties()[e.value],h=i.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[ki,[vi],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[ki,[ri,vi],(n,[e,i])=>{const a=n.properties()[e.value],h=i.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[ki,[vi],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[ki,[vi],(n,[e])=>e.value in n.properties()],"filter-has-id":[ki,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[ki,[yr(ri)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[ki,[yr(vi)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[ki,[ri,yr(vi)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[ki,[ri,yr(vi)],(n,[e,i])=>function(a,h,g,b){for(;g<=b;){const C=g+b>>1;if(h[C]===a)return!0;h[C]>a?b=C-1:g=C+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:ki,overloads:[[[ki,ki],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[ll(ki),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:ki,overloads:[[[ki,ki],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[ll(ki),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[ki,[ki],(n,[e])=>!e.evaluate(n)],"is-supported-script":[ki,[ri],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[ri,[ri],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[ri,[ri],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[ri,ll(vi),(n,e)=>e.map(i=>oa(i.evaluate(n))).join("")],"resolved-locale":[ri,[so],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Va=ou;function Ol(n){return{result:"success",value:n}}function Ea(n){return{result:"error",value:n}}function Ma(n){return"data-driven"===n["property-type"]||"cross-faded-data-driven"===n["property-type"]}function ws(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Zo(n){return!!n.expression&&n.expression.interpolated}function cr(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function Mo(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function Rr(n){return n}function Pc(n,e){const i="color"===e.type,a=n.stops&&"object"==typeof n.stops[0][0],h=a||!(a||void 0!==n.property),g=n.type||(Zo(e)?"exponential":"interval");if(i&&((n=nr({},n)).stops&&(n.stops=n.stops.map(S=>[S[0],xr.parse(S[1])])),n.default=xr.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!me[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let b,C,D;if("exponential"===g)b=bo;else if("interval"===g)b=Os;else if("categorical"===g){b=ha,C=Object.create(null);for(const S of n.stops)C[S[0]]=S[1];D=typeof n.stops[0][0]}else{if("identity"!==g)throw new Error(`Unknown function type "${g}"`);b=ju}if(a){const S={},R=[];for(let ee=0;ee<n.stops.length;ee++){const oe=n.stops[ee],pe=oe[0].zoom;void 0===S[pe]&&(S[pe]={zoom:pe,type:n.type,property:n.property,default:n.default,stops:[]},R.push(pe)),S[pe].stops.push([oe[0].value,oe[1]])}const V=[];for(const ee of R)V.push([S[ee].zoom,Pc(S[ee],e)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Ar.interpolationFactor.bind(void 0,U),zoomStops:V.map(ee=>ee[0]),evaluate:({zoom:ee},oe)=>bo({stops:V,base:n.base},e,ee).evaluate(ee,oe)}}if(h){const S="exponential"===g?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:Ar.interpolationFactor.bind(void 0,S),zoomStops:n.stops.map(R=>R[0]),evaluate:({zoom:R})=>b(n,e,R,C,D)}}return{kind:"source",evaluate(S,R){const V=R&&R.properties?R.properties[n.property]:void 0;return void 0===V?Cs(n.default,e.default):b(n,e,V,C,D)}}}function Cs(n,e,i){return void 0!==n?n:void 0!==e?e:void 0!==i?i:void 0}function ha(n,e,i,a,h){return Cs(typeof i===h?a[i]:void 0,n.default,e.default)}function Os(n,e,i){if("number"!==cr(i))return Cs(n.default,e.default);const a=n.stops.length;if(1===a||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[a-1][0])return n.stops[a-1][1];const h=vt(n.stops.map(g=>g[0]),i);return n.stops[h][1]}function bo(n,e,i){const a=void 0!==n.base?n.base:1;if("number"!==cr(i))return Cs(n.default,e.default);const h=n.stops.length;if(1===h||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[h-1][0])return n.stops[h-1][1];const g=vt(n.stops.map(R=>R[0]),i),b=function(R,V,U,ee){const oe=ee-U,pe=R-U;return 0===oe?0:1===V?pe/oe:(Math.pow(V,pe)-1)/(Math.pow(V,oe)-1)}(i,a,n.stops[g][0],n.stops[g+1][0]),C=n.stops[g][1],D=n.stops[g+1][1];let S=wr[e.type]||Rr;if(n.colorSpace&&"rgb"!==n.colorSpace){const R=me[n.colorSpace];S=(V,U)=>R.reverse(R.interpolate(R.forward(V),R.forward(U),b))}return"function"==typeof C.evaluate?{evaluate(...R){const V=C.evaluate.apply(void 0,R),U=D.evaluate.apply(void 0,R);if(void 0!==V&&void 0!==U)return S(V,U,b)}}:S(C,D,b)}function ju(n,e,i){return"color"===e.type?i=xr.parse(i):"formatted"===e.type?i=lo.fromString(i.toString()):"resolvedImage"===e.type?i=Ps.fromString(i.toString()):cr(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),Cs(i,n.default,e.default)}class qs{constructor(e,i){var a;this.expression=e,this._warningHistory={},this._evaluator=new nl,this._defaultValue=i?"color"===(a=i).type&&(Mo(a.default)||Array.isArray(a.default))?new xr(0,0,0,0):"color"===a.type?xr.parse(a.default)||null:void 0===a.default?null:a.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,a,h,g,b,C,D){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=h||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=D||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,h,g,b,C,D){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=D||null;try{const S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Sr(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function vl(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in Va}function Ua(n,e){const i=new J(Va,[],e?function(h){const g={color:ls,string:ri,number:Gn,enum:ri,boolean:ki,formatted:Go,resolvedImage:zr};return"array"===h.type?yr(g[h.value]||vi,h.length):g[h.type]}(e):void 0),a=i.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return a?Ol(new qs(a,e)):Ea(i.errors)}class kl{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!Co(i.expression)}evaluateWithoutErrorHandling(e,i,a,h,g,b){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,h,g,b)}evaluate(e,i,a,h,g,b){return this._styleExpression.evaluate(e,i,a,h,g,b)}}class oc{constructor(e,i,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent="camera"!==e&&!Co(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,i,a,h,g,b){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,h,g,b)}evaluate(e,i,a,h,g,b){return this._styleExpression.evaluate(e,i,a,h,g,b)}interpolationFactor(e,i,a){return this.interpolationType?Ar.interpolationFactor(this.interpolationType,e,i,a):0}}function Rl(n,e){if("error"===(n=Ua(n,e)).result)return n;const i=n.value.expression,a=vo(i);if(!a&&!Ma(e))return Ea([new Br("","data expressions not supported")]);const h=da(i,["zoom","pitch","distance-from-center"]);if(!h&&!ws(e))return Ea([new Br("","zoom expressions not supported")]);const g=zi(i);return g||h?g instanceof Br?Ea([g]):g instanceof Ar&&!Zo(e)?Ea([new Br("",'"interpolate" expressions cannot be used with this property')]):Ol(g?new oc(a?"camera":"composite",n.value,g.labels,g instanceof Ar?g.interpolation:void 0):new kl(a?"constant":"source",n.value)):Ea([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class sc{constructor(e,i){this._parameters=e,this._specification=i,nr(this,Pc(this._parameters,this._specification))}static deserialize(e){return new sc(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function zi(n){let e=null;if(n instanceof ru)e=zi(n.result);else if(n instanceof eo){for(const i of n.args)if(e=zi(i),e)break}else(n instanceof xn||n instanceof Ar)&&n.input instanceof $o&&"zoom"===n.input.name&&(e=n);return e instanceof Br||n.eachChild(i=>{const a=zi(i);a instanceof Br?e=a:!e&&a?e=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Hn{constructor(e,i,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),null!=i&&i.__line__&&(this.line=i.__line__)}}function Ys(n){const e=n.key,i=n.value,a=n.valueSpec||{},h=n.objectElementValidators||{},g=n.style,b=n.styleSpec;let C=[];const D=cr(i);if("object"!==D)return[new Hn(e,i,`object expected, ${D} found`)];for(const S in i){const R=S.split(".")[0],V=a[R]||a["*"];let U;h[R]?U=h[R]:a[R]?U=uo:h["*"]?U=h["*"]:a["*"]&&(U=uo),U?C=C.concat(U({key:(e&&`${e}.`)+S,value:i[S],valueSpec:V,style:g,styleSpec:b,object:i,objectKey:S},i)):C.push(new Hn(e,i[S],`unknown property "${S}"`))}for(const S in a)h[S]||a[S].required&&void 0===a[S].default&&void 0===i[S]&&C.push(new Hn(e,i,`missing required property "${S}"`));return C}function hs(n){const e=n.value,i=n.valueSpec,a=n.style,h=n.styleSpec,g=n.key,b=n.arrayElementValidator||uo;if("array"!==cr(e))return[new Hn(g,e,`array expected, ${cr(e)} found`)];if(i.length&&e.length!==i.length)return[new Hn(g,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Hn(g,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let C={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};h.$version<7&&(C.function=i.function),"object"===cr(i.value)&&(C=i.value);let D=[];for(let S=0;S<e.length;S++)D=D.concat(b({array:e,arrayIndex:S,value:e[S],valueSpec:C,style:a,styleSpec:h,key:`${g}[${S}]`}));return D}function ja(n){const e=n.key,i=n.value,a=n.valueSpec;let h=cr(i);if("number"===h&&i!=i&&(h="NaN"),"number"!==h)return[new Hn(e,i,`number expected, ${h} found`)];if("minimum"in a){let g=a.minimum;if("array"===cr(a.minimum)&&(g=a.minimum[n.arrayIndex]),i<g)return[new Hn(e,i,`${i} is less than the minimum value ${g}`)]}if("maximum"in a){let g=a.maximum;if("array"===cr(a.maximum)&&(g=a.maximum[n.arrayIndex]),i>g)return[new Hn(e,i,`${i} is greater than the maximum value ${g}`)]}return[]}function ac(n){const e=n.valueSpec,i=br(n.value.type);let a,h,g,b={};const C="categorical"!==i&&void 0===n.value.property,D=!C,S="array"===cr(n.value.stops)&&"array"===cr(n.value.stops[0])&&"object"===cr(n.value.stops[0][0]),R=Ys({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(ee){if("identity"===i)return[new Hn(ee.key,ee.value,'identity function may not have a "stops" property')];let oe=[];const pe=ee.value;return oe=oe.concat(hs({key:ee.key,value:pe,valueSpec:ee.valueSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:V})),"array"===cr(pe)&&0===pe.length&&oe.push(new Hn(ee.key,pe,"array must have at least one stop")),oe},default:function(ee){return uo({key:ee.key,value:ee.value,valueSpec:e,style:ee.style,styleSpec:ee.styleSpec})}}});return"identity"===i&&C&&R.push(new Hn(n.key,n.value,'missing required property "property"')),"identity"===i||n.value.stops||R.push(new Hn(n.key,n.value,'missing required property "stops"')),"exponential"===i&&n.valueSpec.expression&&!Zo(n.valueSpec)&&R.push(new Hn(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(D&&!Ma(n.valueSpec)?R.push(new Hn(n.key,n.value,"property functions not supported")):C&&!ws(n.valueSpec)&&R.push(new Hn(n.key,n.value,"zoom functions not supported"))),"categorical"!==i&&!S||void 0!==n.value.property||R.push(new Hn(n.key,n.value,'"property" property is required')),R;function V(ee){let oe=[];const pe=ee.value,Ie=ee.key;if("array"!==cr(pe))return[new Hn(Ie,pe,`array expected, ${cr(pe)} found`)];if(2!==pe.length)return[new Hn(Ie,pe,`array length 2 expected, length ${pe.length} found`)];if(S){if("object"!==cr(pe[0]))return[new Hn(Ie,pe,`object expected, ${cr(pe[0])} found`)];if(void 0===pe[0].zoom)return[new Hn(Ie,pe,"object stop key must have zoom")];if(void 0===pe[0].value)return[new Hn(Ie,pe,"object stop key must have value")];const Ne=br(pe[0].zoom);if("number"!=typeof Ne)return[new Hn(Ie,pe[0].zoom,"stop zoom values must be numbers")];if(g&&g>Ne)return[new Hn(Ie,pe[0].zoom,"stop zoom values must appear in ascending order")];Ne!==g&&(g=Ne,h=void 0,b={}),oe=oe.concat(Ys({key:`${Ie}[0]`,value:pe[0],valueSpec:{zoom:{}},style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:ja,value:U}}))}else oe=oe.concat(U({key:`${Ie}[0]`,value:pe[0],valueSpec:{},style:ee.style,styleSpec:ee.styleSpec},pe));return vl(jr(pe[1]))?oe.concat([new Hn(`${Ie}[1]`,pe[1],"expressions are not allowed in function stops.")]):oe.concat(uo({key:`${Ie}[1]`,value:pe[1],valueSpec:e,style:ee.style,styleSpec:ee.styleSpec}))}function U(ee,oe){const pe=cr(ee.value),Ie=br(ee.value),Ne=null!==ee.value?ee.value:oe;if(a){if(pe!==a)return[new Hn(ee.key,Ne,`${pe} stop domain type must match previous stop domain type ${a}`)]}else a=pe;if("number"!==pe&&"string"!==pe&&"boolean"!==pe&&"number"!=typeof Ie&&"string"!=typeof Ie&&"boolean"!=typeof Ie)return[new Hn(ee.key,Ne,"stop domain value must be a number, string, or boolean")];if("number"!==pe&&"categorical"!==i){let at=`number expected, ${pe} found`;return Ma(e)&&void 0===i&&(at+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Hn(ee.key,Ne,at)]}return"categorical"!==i||"number"!==pe||"number"==typeof Ie&&isFinite(Ie)&&Math.floor(Ie)===Ie?"categorical"!==i&&"number"===pe&&"number"==typeof Ie&&"number"==typeof h&&void 0!==h&&Ie<h?[new Hn(ee.key,Ne,"stop domain values must appear in ascending order")]:(h=Ie,"categorical"===i&&Ie in b?[new Hn(ee.key,Ne,"stop domain values must be unique")]:(b[Ie]=!0,[])):[new Hn(ee.key,Ne,`integer expected, found ${String(Ie)}`)]}}function Ll(n){const e=("property"===n.expressionContext?Rl:Ua)(jr(n.value),n.valueSpec);if("error"===e.result)return e.value.map(a=>new Hn(`${n.key}${a.key}`,n.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!i.outputDefined())return[new Hn(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!Co(i))return[new Hn(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return Oc(i,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!da(i,["zoom","feature-state"]))return[new Hn(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!vo(i))return[new Hn(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oc(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)i.delete(h);if(0===i.size)return[];const a=[];return n instanceof $o&&i.has(n.name)?[new Hn(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(h=>{a.push(...Oc(h,e))}),a)}function bl(n){const e=n.key,i=n.value,a=n.valueSpec,h=[];return Array.isArray(a.values)?-1===a.values.indexOf(br(i))&&h.push(new Hn(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(a.values).indexOf(br(i))&&h.push(new Hn(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function su(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!su(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Wo(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};su(n)||(n=Bl(n));const i=n;let a=!0;try{a=function(S){if(!Ga(S))return S;let R=jr(S);return Fl(R),R=au(R),R}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const h=At[`filter_${e}`],g=Ua(a,h);let b=null;if("error"===g.result)throw new Error(g.value.map(S=>`${S.key}: ${S.message}`).join(", "));b=(S,R,V)=>g.value.evaluate(S,R,{},V);let C=null,D=null;if(a!==i){const S=Ua(i,h);if("error"===S.result)throw new Error(S.value.map(R=>`${R.key}: ${R.message}`).join(", "));C=(R,V,U,ee,oe)=>S.value.evaluate(R,V,{},U,void 0,void 0,ee,oe),D=!vo(S.value.expression)}return{filter:b,dynamicFilter:C||void 0,needGeometry:Ha(a),needFeature:!!D}}function au(n){if(!Array.isArray(n))return n;const e=function(i){if(lc.has(i[0]))for(let a=1;a<i.length;a++)if(Ga(i[a]))return!0;return i}(n);return!0===e?e:e.map(i=>au(i))}function Fl(n){let e=!1;const i=[];if("case"===n[0]){for(let a=1;a<n.length-1;a+=2)e=e||Ga(n[a]),i.push(n[a+1]);i.push(n[n.length-1])}else if("match"===n[0]){e=e||Ga(n[1]);for(let a=2;a<n.length-1;a+=2)i.push(n[a+1]);i.push(n[n.length-1])}else if("step"===n[0]){e=e||Ga(n[1]);for(let a=1;a<n.length-1;a+=2)i.push(n[a+1])}e&&(n.length=0,n.push("any",...i));for(let a=1;a<n.length;a++)Fl(n[a])}function Ga(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<n.length;i++)if(Ga(n[i]))return!0;return!1}const lc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function kc(n,e){return n<e?-1:n>e?1:0}function Ha(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(Ha(n[e]))return!0;return!1}function Bl(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?ps(n[1],n[2],"=="):"!="===e?Do(ps(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?ps(n[1],n[2],e):"any"===e?(i=n.slice(1),["any"].concat(i.map(Bl))):"all"===e?["all"].concat(n.slice(1).map(Bl)):"none"===e?["all"].concat(n.slice(1).map(Bl).map(Do)):"in"===e?$a(n[1],n.slice(2)):"!in"===e?Do($a(n[1],n.slice(2))):"has"===e?Gu(n[1]):"!has"===e?Do(Gu(n[1])):"within"!==e||n;var i}function ps(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function $a(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(kc)]]:["filter-in-small",n,["literal",e]]}}function Gu(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Do(n){return["!",n]}function Rd(n){return su(jr(n.value))?Ll(nr({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):Rc(n)}function Rc(n){const e=n.value,i=n.key;if("array"!==cr(e))return[new Hn(i,e,`array expected, ${cr(e)} found`)];const a=n.styleSpec;let h,g=[];if(e.length<1)return[new Hn(i,e,"filter array must have at least 1 element")];switch(g=g.concat(bl({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),br(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===br(e[1])&&g.push(new Hn(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&g.push(new Hn(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=cr(e[1]),"string"!==h&&g.push(new Hn(`${i}[1]`,e[1],`string expected, ${h} found`)));for(let b=2;b<e.length;b++)h=cr(e[b]),"$type"===br(e[1])?g=g.concat(bl({key:`${i}[${b}]`,value:e[b],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&g.push(new Hn(`${i}[${b}]`,e[b],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let b=1;b<e.length;b++)g=g.concat(Rc({key:`${i}[${b}]`,value:e[b],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=cr(e[1]),2!==e.length?g.push(new Hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==h&&g.push(new Hn(`${i}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=cr(e[1]),2!==e.length?g.push(new Hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==h&&g.push(new Hn(`${i}[1]`,e[1],`object expected, ${h} found`))}return g}function Za(n,e){const i=n.key,a=n.style,h=n.styleSpec,g=n.value,b=n.objectKey,C=h[`${e}_${n.layerType}`];if(!C)return[];const D=b.match(/^(.*)-transition$/);if("paint"===e&&D&&C[D[1]]&&C[D[1]].transition)return uo({key:i,value:g,valueSpec:h.transition,style:a,styleSpec:h});const S=n.valueSpec||C[b];if(!S)return[new Hn(i,g,`unknown property "${b}"`)];let R;if("string"===cr(g)&&Ma(S)&&!S.tokens&&(R=/^{([^}]+)}$/.exec(g)))return[new Hn(i,g,`"${b}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const V=[];return"symbol"===n.layerType&&("text-field"===b&&a&&!a.glyphs&&V.push(new Hn(i,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===b&&Mo(jr(g))&&"identity"===br(g.type)&&V.push(new Hn(i,g,'"text-font" does not support identity functions'))),V.concat(uo({key:n.key,value:g,valueSpec:S,style:a,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:b}))}function lu(n){return Za(n,"paint")}function zl(n){return Za(n,"layout")}function Hu(n){let e=[];const i=n.value,a=n.key,h=n.style,g=n.styleSpec;i.type||i.ref||e.push(new Hn(a,i,'either "type" or "ref" is required'));let b=br(i.type);const C=br(i.ref);if(i.id){const D=br(i.id);for(let S=0;S<n.arrayIndex;S++){const R=h.layers[S];br(R.id)===D&&e.push(new Hn(a,i.id,`duplicate layer id "${i.id}", previously used at line ${R.id.__line__}`))}}if("ref"in i){let D;["type","source","source-layer","filter","layout"].forEach(S=>{S in i&&e.push(new Hn(a,i[S],`"${S}" is prohibited for ref layers`))}),h.layers.forEach(S=>{br(S.id)===C&&(D=S)}),D?D.ref?e.push(new Hn(a,i.ref,"ref cannot reference another ref layer")):b=br(D.type):"string"==typeof C&&e.push(new Hn(a,i.ref,`ref layer "${C}" not found`))}else if("background"!==b&&"sky"!==b)if(i.source){const D=h.sources&&h.sources[i.source],S=D&&br(D.type);D?"vector"===S&&"raster"===b?e.push(new Hn(a,i.source,`layer "${i.id}" requires a raster source`)):"raster"===S&&"raster"!==b?e.push(new Hn(a,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==S||i["source-layer"]?"raster-dem"===S&&"hillshade"!==b?e.push(new Hn(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==b||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===S&&D.lineMetrics||e.push(new Hn(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Hn(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Hn(a,i.source,`source "${i.source}" not found`))}else e.push(new Hn(a,i,'missing required property "source"'));return e=e.concat(Ys({key:a,value:i,valueSpec:g.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>uo({key:`${a}.type`,value:i.type,valueSpec:g.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:D=>Rd(nr({layerType:b},D)),layout:D=>Ys({layer:i,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":S=>zl(nr({layerType:b},S))}}),paint:D=>Ys({layer:i,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":S=>lu(nr({layerType:b},S))}})}})),e}function Ks(n){const e=n.value,i=n.key,a=cr(e);return"string"!==a?[new Hn(i,e,`string expected, ${a} found`)]:[]}const $u={promoteId:function({key:n,value:e}){if("string"===cr(e))return Ks({key:n,value:e});{const i=[];for(const a in e)i.push(...Ks({key:`${n}.${a}`,value:e[a]}));return i}}};function Ld(n){const e=n.value,i=n.key,a=n.styleSpec,h=n.style;if(!e.type)return[new Hn(i,e,'"type" is required')];const g=br(e.type);let b;switch(g){case"vector":case"raster":case"raster-dem":return b=Ys({key:i,value:e,valueSpec:a[`source_${g.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:$u}),b;case"geojson":if(b=Ys({key:i,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,objectElementValidators:$u}),e.cluster)for(const C in e.clusterProperties){const[D,S]=e.clusterProperties[C],R="string"==typeof D?[D,["accumulated"],["get",C]]:D;b.push(...Ll({key:`${i}.${C}.map`,value:S,expressionContext:"cluster-map"})),b.push(...Ll({key:`${i}.${C}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return b;case"video":return Ys({key:i,value:e,valueSpec:a.source_video,style:h,styleSpec:a});case"image":return Ys({key:i,value:e,valueSpec:a.source_image,style:h,styleSpec:a});case"canvas":return[new Hn(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bl({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:a})}}function Es(n){const e=n.value,i=n.styleSpec,a=i.light,h=n.style;let g=[];const b=cr(e);if(void 0===e)return g;if("object"!==b)return g=g.concat([new Hn("light",e,`object expected, ${b} found`)]),g;for(const C in e){const D=C.match(/^(.*)-transition$/);g=g.concat(D&&a[D[1]]&&a[D[1]].transition?uo({key:C,value:e[C],valueSpec:i.transition,style:h,styleSpec:i}):a[C]?uo({key:C,value:e[C],valueSpec:a[C],style:h,styleSpec:i}):[new Hn(C,e[C],`unknown property "${C}"`)])}return g}function cu(n){const e=n.value,i=n.key,a=n.style,h=n.styleSpec,g=h.terrain;let b=[];const C=cr(e);if(void 0===e)return b;if("object"!==C)return b=b.concat([new Hn("terrain",e,`object expected, ${C} found`)]),b;for(const D in e){const S=D.match(/^(.*)-transition$/);b=b.concat(S&&g[S[1]]&&g[S[1]].transition?uo({key:D,value:e[D],valueSpec:h.transition,style:a,styleSpec:h}):g[D]?uo({key:D,value:e[D],valueSpec:g[D],style:a,styleSpec:h}):[new Hn(D,e[D],`unknown property "${D}"`)])}if(e.source){const D=a.sources&&a.sources[e.source],S=D&&br(D.type);D?"raster-dem"!==S&&b.push(new Hn(i,e.source,`terrain cannot be used with a source of type ${String(S)}, it only be used with a "raster-dem" source type`)):b.push(new Hn(i,e.source,`source "${e.source}" not found`))}else b.push(new Hn(i,e,'terrain is missing required property "source"'));return b}function pa(n){const e=n.value,i=n.style,a=n.styleSpec,h=a.fog;let g=[];const b=cr(e);if(void 0===e)return g;if("object"!==b)return g=g.concat([new Hn("fog",e,`object expected, ${b} found`)]),g;for(const C in e){const D=C.match(/^(.*)-transition$/);g=g.concat(D&&h[D[1]]&&h[D[1]].transition?uo({key:C,value:e[C],valueSpec:a.transition,style:i,styleSpec:a}):h[C]?uo({key:C,value:e[C],valueSpec:h[C],style:i,styleSpec:a}):[new Hn(C,e[C],`unknown property "${C}"`)])}return g}const ks={"*":()=>[],array:hs,boolean:function(n){const e=n.value,i=n.key,a=cr(e);return"boolean"!==a?[new Hn(i,e,`boolean expected, ${a} found`)]:[]},number:ja,color:function(n){const e=n.key,i=n.value,a=cr(i);return"string"!==a?[new Hn(e,i,`color expected, ${a} found`)]:null===Ko.parseCSSColor(i)?[new Hn(e,i,`color expected, "${i}" found`)]:[]},enum:bl,filter:Rd,function:ac,layer:Hu,object:Ys,source:Ld,light:Es,terrain:cu,fog:pa,string:Ks,formatted:function(n){return 0===Ks(n).length?[]:Ll(n)},resolvedImage:function(n){return 0===Ks(n).length?[]:Ll(n)},projection:function(n){const e=n.value,i=n.styleSpec,a=i.projection,h=n.style;let g=[];const b=cr(e);if("object"===b)for(const C in e)g=g.concat(uo({key:C,value:e[C],valueSpec:a[C],style:h,styleSpec:i}));else"string"!==b&&(g=g.concat([new Hn("projection",e,`object or string expected, ${b} found`)]));return g}};function uo(n){const e=n.value,i=n.valueSpec,a=n.styleSpec;return i.expression&&Mo(br(e))?ac(n):i.expression&&vl(jr(e))?Ll(n):i.type&&ks[i.type]?ks[i.type](n):Ys(nr({},n,{valueSpec:i.type?a[i.type]:i}))}function xl(n){const e=n.value,i=n.key,a=Ks(n);return a.length||(-1===e.indexOf("{fontstack}")&&a.push(new Hn(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&a.push(new Hn(i,e,'"glyphs" url must include a "{range}" token'))),a}function fa(n,e=At){return fs(uo({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:xl,"*":()=>[]}}))}const Zu=n=>fs(lu(n)),Wu=n=>fs(zl(n));function fs(n){return n.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function wh(n,e){let i=!1;if(e&&e.length)for(const a of e)n.fire(new Ri(new Error(a.message))),i=!0;return i}var cc=fr;function fr(n,e,i){var a=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var h=new Int32Array(this.arrayBuffer);n=h[0],this.d=(e=h[1])+2*(i=h[2]);for(var g=0;g<this.d*this.d;g++){var b=h[3+g],C=h[3+g+1];a.push(b===C?null:h.subarray(b,C))}var D=h[3+a.length+1];this.keys=h.subarray(h[3+a.length],D),this.bboxes=h.subarray(D),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var S=0;S<this.d*this.d;S++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var R=i/e*n;this.min=-R,this.max=n+R}fr.prototype.insert=function(n,e,i,a,h){this._forEachCell(e,i,a,h,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(h)},fr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fr.prototype._insertCell=function(n,e,i,a,h,g){this.cells[h].push(g)},fr.prototype.query=function(n,e,i,a,h){var g=this.min,b=this.max;if(n<=g&&e<=g&&b<=i&&b<=a&&!h)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(n,e,i,a,this._queryCell,C,{},h),C},fr.prototype._queryCell=function(n,e,i,a,h,g,b,C){var D=this.cells[h];if(null!==D)for(var S=this.keys,R=this.bboxes,V=0;V<D.length;V++){var U=D[V];if(void 0===b[U]){var ee=4*U;(C?C(R[ee+0],R[ee+1],R[ee+2],R[ee+3]):n<=R[ee+2]&&e<=R[ee+3]&&i>=R[ee+0]&&a>=R[ee+1])?(b[U]=!0,g.push(S[U])):b[U]=!1}}},fr.prototype._forEachCell=function(n,e,i,a,h,g,b,C){for(var D=this._convertToCellCoord(n),S=this._convertToCellCoord(e),R=this._convertToCellCoord(i),V=this._convertToCellCoord(a),U=D;U<=R;U++)for(var ee=S;ee<=V;ee++){var oe=this.d*ee+U;if((!C||C(this._convertFromCellCoord(U),this._convertFromCellCoord(ee),this._convertFromCellCoord(U+1),this._convertFromCellCoord(ee+1)))&&h.call(this,n,e,i,a,oe,g,b,C))return}},fr.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},fr.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},fr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var h=new Int32Array(e+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var g=e,b=0;b<n.length;b++){var C=n[b];h[3+b]=g,h.set(C,g),g+=C.length}return h[3+n.length]=g,h.set(this.keys,g),h[3+n.length+1]=g+=this.keys.length,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer};const qu={};function Jn(n,e,i={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),qu[e]={klass:n,omit:i.omit||[]}}Jn(Object,"Object"),cc.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},cc.deserialize=function(n){return new cc(n.buffer)},Object.defineProperty(cc,"name",{value:"Grid"}),Jn(cc,"Grid"),Jn(xr,"Color"),Jn(Error,"Error"),Jn(Xe,"AJAXError"),Jn(Ps,"ResolvedImage"),Jn(sc,"StylePropertyFunction"),Jn(qs,"StyleExpression",{omit:["_evaluator"]}),Jn(oc,"ZoomDependentExpression"),Jn(kl,"ZoomConstantExpression"),Jn($o,"CompoundExpression",{omit:["_evaluate"]});for(const n in Va)qu[Va[n]._classRegistryKey]||Jn(Va[n],`Expression${n}`);function Yu(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function Ch(n){return Ce.ImageBitmap&&n instanceof Ce.ImageBitmap}function Wa(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Yu(n)||Ch(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof Ce.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const a of n)i.push(Wa(a,e));return i}if("object"==typeof n){const i=n.constructor,a=i._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const h=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const g in n)n.hasOwnProperty(g)&&(qu[a].omit.indexOf(g)>=0||(h[g]=Wa(n[g],e)));n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==a&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof n)}function uu(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Yu(n)||Ch(n)||ArrayBuffer.isView(n)||n instanceof Ce.ImageData)return n;if(Array.isArray(n))return n.map(uu);if("object"==typeof n){const e=n.$name||"Object",{klass:i}=qu[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const a=Object.create(i.prototype);for(const h of Object.keys(n))"$name"!==h&&(a[h]=uu(n[h]));return a}throw new Error("can't deserialize object of type "+typeof n)}class uc{constructor(){this.first=!0}update(e,i){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Nl=n=>n>=1536&&n<=1791,Eh=n=>n>=1872&&n<=1919,dc=n=>n>=2208&&n<=2303,To=n=>n>=11904&&n<=12031,du=n=>n>=12032&&n<=12255,qa=n=>n>=12272&&n<=12287,Fd=n=>n>=12288&&n<=12351,F=n=>n>=12352&&n<=12447,L=n=>n>=12448&&n<=12543,O=n=>n>=12544&&n<=12591,H=n=>n>=12704&&n<=12735,Q=n=>n>=12736&&n<=12783,ge=n=>n>=12784&&n<=12799,qe=n=>n>=12800&&n<=13055,pt=n=>n>=13056&&n<=13311,an=n=>n>=13312&&n<=19903,ni=n=>n>=19968&&n<=40959,ur=n=>n>=40960&&n<=42127,di=n=>n>=42128&&n<=42191,rr=n=>n>=44032&&n<=55215,Jo=n=>n>=63744&&n<=64255,ms=n=>n>=64336&&n<=65023,Vl=n=>n>=65040&&n<=65055,Rs=n=>n>=65072&&n<=65103,hu=n=>n>=65104&&n<=65135,Ul=n=>n>=65136&&n<=65279,Ku=n=>n>=65280&&n<=65519;function wl(n){for(const e of n)if(t(e.charCodeAt(0)))return!0;return!1}function Bd(n){for(const e of n)if(!f(e.charCodeAt(0)))return!1;return!0}function f(n){return!(Nl(n)||Eh(n)||dc(n)||ms(n)||Ul(n))}function t(n){return!(746!==n&&747!==n&&(n<4352||!(H(n)||O(n)||Rs(n)&&!(n>=65097&&n<=65103)||Jo(n)||pt(n)||To(n)||Q(n)||!(!Fd(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||an(n)||ni(n)||qe(n)||(e=n,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||rr(n)||F(n)||qa(n)||(e=>e>=12688&&e<=12703)(n)||du(n)||ge(n)||L(n)&&12540!==n||!(!Ku(n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!hu(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||Vl(n)||(e=>e>=19904&&e<=19967)(n)||ur(n)||di(n))));var e}function u(n){return!(t(n)||(e=n,(i=e)>=128&&i<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(i=>i>=8192&&i<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&9251!==e||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Fd(e)||L(e)||(i=>i>=57344&&i<=63743)(e)||Rs(e)||hu(e)||Ku(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,i}function v(n){return n>=1424&&n<=2303||ms(n)||Ul(n)}function w(n,e){return!(!e&&v(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=n,i>=6016&&i<=6143));var i}function E(n){for(const e of n)if(v(e.charCodeAt(0)))return!0;return!1}const I="deferred",k="loading",B="loaded";let Z=null,te="unavailable",se=null;const fe=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(te="error"),Z&&Z(n)};function Se(){we.fire(new ti("pluginStateChange",{pluginStatus:te,pluginURL:se}))}const we=new jn,xe=function(){return te},$e=function(){if(te!==I||!se)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");te=k,Se(),se&&lt({url:se},n=>{n?fe(n):(te=B,Se())})},Ee={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>te===B||null!=Ee.applyArabicShaping,isLoading:()=>te===k,setState(n){te=n.pluginStatus,se=n.pluginURL},isParsed:()=>null!=Ee.applyArabicShaping&&null!=Ee.processBidirectionalText&&null!=Ee.processStyledBidirectionalText,getPluginURL:()=>se};class ke{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new uc,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,a){for(const h of i)if(!w(h.charCodeAt(0),a))return!1;return!0}(e,Ee.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class Re{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,h){if(Mo(a))return new sc(a,h);if(vl(a)){const g=Rl(a,h);if("error"===g.result)throw new Error(g.value.map(b=>`${b.key}: ${b.message}`).join(", "));return g.value}{let g=a;return"string"==typeof a&&"color"===h.type&&(g=xr.parse(a)),{kind:"constant",evaluate:()=>g}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class st{constructor(e){this.property=e,this.value=new Re(e,void 0)}transitioned(e,i){return new je(this.property,this.value,i,Qe({},e.transition,this.transition),e.now)}untransitioned(){return new je(this.property,this.value,null,{},0)}}class Ue{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return mn(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new st(this._values[e].property)),this._values[e].value=new Re(this._values[e].property,null===i?void 0:mn(i))}getTransition(e){return mn(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new st(this._values[e].property)),this._values[e].transition=mn(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a);const h=this.getTransition(i);void 0!==h&&(e[`${i}-transition`]=h)}return e}transitioned(e,i){const a=new bt(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,i._values[h]);return a}untransitioned(){const e=new bt(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class je{constructor(e,i,a,h,g){const b=h.delay||0,C=h.duration||0;g=g||0,this.property=e,this.value=i,this.begin=g+b,this.end=this.begin+C,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const h=e.now||0,g=this.value.possiblyEvaluate(e,i,a),b=this.prior;if(b){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return b.possiblyEvaluate(e,i,a);{const C=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(e,i,a),g,et(C))}}return g}}class bt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const h=new $t(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,i,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ht{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return mn(this._values[e].value)}setValue(e,i){this._values[e]=new Re(this._values[e].property,null===i?void 0:mn(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const h=new $t(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,i,a);return h}}class Zt{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,a,h){return this.property.evaluate(this.value,this.parameters,e,i,a,h)}}class $t{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class jt{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,a){const h=wr[this.specification.type];return h?h(e,i,a):e}}class it{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,h){return new Zt(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},a,h)}:e.expression,i)}interpolate(e,i,a){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new Zt(this,{kind:"constant",value:void 0},e.parameters);const h=wr[this.specification.type];return h?new Zt(this,{kind:"constant",value:h(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,h,g,b){return"constant"===e.kind?e.value:e.evaluate(i,a,h,g,b)}}class pn extends it{possiblyEvaluate(e,i,a,h){if(void 0===e.value)return new Zt(this,{kind:"constant",value:void 0},i);if("constant"===e.expression.kind){const g=e.expression.evaluate(i,null,{},a,h),b="resolvedImage"===e.property.specification.type&&"string"!=typeof g?g.name:g,C=this._calculate(b,b,b,i);return new Zt(this,{kind:"constant",value:C},i)}if("camera"===e.expression.kind){const g=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new Zt(this,{kind:"constant",value:g},i)}return new Zt(this,e.expression,i)}evaluate(e,i,a,h,g,b){if("source"===e.kind){const C=e.evaluate(i,a,h,g,b);return this._calculate(C,C,C,i)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},a,h),e.evaluate({zoom:Math.floor(i.zoom)},a,h),e.evaluate({zoom:Math.floor(i.zoom)+1},a,h),i):e.value}_calculate(e,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i,other:a}:{from:a,to:i,other:e}}interpolate(e){return e}}class hn{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,h){if(void 0!==e.value){if("constant"===e.expression.kind){const g=e.expression.evaluate(i,null,{},a,h);return this._calculate(g,g,g,i)}return this._calculate(e.expression.evaluate(new ke(Math.floor(i.zoom-1),i)),e.expression.evaluate(new ke(Math.floor(i.zoom),i)),e.expression.evaluate(new ke(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class Un{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,h){return!!e.expression.evaluate(i,null,{},a,h)}interpolate(){return!1}}class tn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new ke(0,{});for(const a in e){const h=e[a];h.specification.overridable&&this.overridableProperties.push(a);const g=this.defaultPropertyValues[a]=new Re(h,void 0),b=this.defaultTransitionablePropertyValues[a]=new st(h);this.defaultTransitioningPropertyValues[a]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=g.possiblyEvaluate(i)}}}function ci(n,e){return 256*(n=St(Math.floor(n),0,255))+St(Math.floor(e),0,255)}Jn(it,"DataDrivenProperty"),Jn(jt,"DataConstantProperty"),Jn(pn,"CrossFadedDataDrivenProperty"),Jn(hn,"CrossFadedProperty"),Jn(Un,"ColorRampProperty");const Fn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vn{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class In{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Nn(n,e=1){let i=0,a=0;return{members:n.map(h=>{const g=Fn[h.type].BYTES_PER_ELEMENT,b=i=Si(i,Math.max(e,g)),C=h.components||1;return a=Math.max(a,g),i+=g*C,{name:h.name,type:h.type,components:C,offset:b}}),size:Si(i,Math.max(a,e)),alignment:e}}function Si(n,e){return Math.ceil(n/e)*e}class bi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const h=2*e;return this.int16[h+0]=i,this.int16[h+1]=a,e}}bi.prototype.bytesPerElement=4,Jn(bi,"StructArrayLayout2i4");class Qi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,a)}emplace(e,i,a,h){const g=3*e;return this.int16[g+0]=i,this.int16[g+1]=a,this.int16[g+2]=h,e}}Qi.prototype.bytesPerElement=6,Jn(Qi,"StructArrayLayout3i6");class pi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,h)}emplace(e,i,a,h,g){const b=4*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=h,this.int16[b+3]=g,e}}pi.prototype.bytesPerElement=8,Jn(pi,"StructArrayLayout4i8");class Gi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,a,h,g,b,C)}emplace(e,i,a,h,g,b,C,D){const S=6*e,R=12*e,V=3*e;return this.int16[S+0]=i,this.int16[S+1]=a,this.uint8[R+4]=h,this.uint8[R+5]=g,this.uint8[R+6]=b,this.uint8[R+7]=C,this.float32[V+2]=D,e}}Gi.prototype.bytesPerElement=12,Jn(Gi,"StructArrayLayout2i4ub1f12");class mr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,h)}emplace(e,i,a,h,g){const b=4*e;return this.float32[b+0]=i,this.float32[b+1]=a,this.float32[b+2]=h,this.float32[b+3]=g,e}}mr.prototype.bytesPerElement=16,Jn(mr,"StructArrayLayout4f16");class Ir extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D,S,R){const V=this.length;return this.resize(V+1),this.emplace(V,e,i,a,h,g,b,C,D,S,R)}emplace(e,i,a,h,g,b,C,D,S,R,V){const U=10*e;return this.uint16[U+0]=i,this.uint16[U+1]=a,this.uint16[U+2]=h,this.uint16[U+3]=g,this.uint16[U+4]=b,this.uint16[U+5]=C,this.uint16[U+6]=D,this.uint16[U+7]=S,this.uint16[U+8]=R,this.uint16[U+9]=V,e}}Ir.prototype.bytesPerElement=20,Jn(Ir,"StructArrayLayout10ui20");class So extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D){const S=this.length;return this.resize(S+1),this.emplace(S,e,i,a,h,g,b,C,D)}emplace(e,i,a,h,g,b,C,D,S){const R=8*e;return this.uint16[R+0]=i,this.uint16[R+1]=a,this.uint16[R+2]=h,this.uint16[R+3]=g,this.uint16[R+4]=b,this.uint16[R+5]=C,this.uint16[R+6]=D,this.uint16[R+7]=S,e}}So.prototype.bytesPerElement=16,Jn(So,"StructArrayLayout8ui16");class Lr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,a,h,g,b)}emplace(e,i,a,h,g,b,C){const D=6*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.int16[D+2]=h,this.int16[D+3]=g,this.int16[D+4]=b,this.int16[D+5]=C,e}}Lr.prototype.bytesPerElement=12,Jn(Lr,"StructArrayLayout6i12");class Ya extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D,S,R,V,U){const ee=this.length;return this.resize(ee+1),this.emplace(ee,e,i,a,h,g,b,C,D,S,R,V,U)}emplace(e,i,a,h,g,b,C,D,S,R,V,U,ee){const oe=12*e;return this.int16[oe+0]=i,this.int16[oe+1]=a,this.int16[oe+2]=h,this.int16[oe+3]=g,this.uint16[oe+4]=b,this.uint16[oe+5]=C,this.uint16[oe+6]=D,this.uint16[oe+7]=S,this.int16[oe+8]=R,this.int16[oe+9]=V,this.int16[oe+10]=U,this.int16[oe+11]=ee,e}}Ya.prototype.bytesPerElement=24,Jn(Ya,"StructArrayLayout4i4ui4i24");class cl extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,a,h,g,b)}emplace(e,i,a,h,g,b,C){const D=10*e,S=5*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.int16[D+2]=h,this.float32[S+2]=g,this.float32[S+3]=b,this.float32[S+4]=C,e}}cl.prototype.bytesPerElement=20,Jn(cl,"StructArrayLayout3i3f20");class hc extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}hc.prototype.bytesPerElement=4,Jn(hc,"StructArrayLayout1ul4");class Hr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D,S,R,V,U,ee){const oe=this.length;return this.resize(oe+1),this.emplace(oe,e,i,a,h,g,b,C,D,S,R,V,U,ee)}emplace(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe){const pe=20*e,Ie=10*e;return this.int16[pe+0]=i,this.int16[pe+1]=a,this.int16[pe+2]=h,this.int16[pe+3]=g,this.int16[pe+4]=b,this.float32[Ie+3]=C,this.float32[Ie+4]=D,this.float32[Ie+5]=S,this.float32[Ie+6]=R,this.int16[pe+14]=V,this.uint32[Ie+8]=U,this.uint16[pe+18]=ee,this.uint16[pe+19]=oe,e}}Hr.prototype.bytesPerElement=40,Jn(Hr,"StructArrayLayout5i4f1i1ul2ui40");class no extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,a,h,g,b,C)}emplace(e,i,a,h,g,b,C,D){const S=8*e;return this.int16[S+0]=i,this.int16[S+1]=a,this.int16[S+2]=h,this.int16[S+4]=g,this.int16[S+5]=b,this.int16[S+6]=C,this.int16[S+7]=D,e}}no.prototype.bytesPerElement=16,Jn(no,"StructArrayLayout3i2i2i16");class Cr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,a,h,g)}emplace(e,i,a,h,g,b){const C=4*e,D=8*e;return this.float32[C+0]=i,this.float32[C+1]=a,this.float32[C+2]=h,this.int16[D+6]=g,this.int16[D+7]=b,e}}Cr.prototype.bytesPerElement=16,Jn(Cr,"StructArrayLayout2f1f2i16");class mo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,h)}emplace(e,i,a,h,g){const b=12*e,C=3*e;return this.uint8[b+0]=i,this.uint8[b+1]=a,this.float32[C+1]=h,this.float32[C+2]=g,e}}mo.prototype.bytesPerElement=12,Jn(mo,"StructArrayLayout2ub2f12");class es extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,a)}emplace(e,i,a,h){const g=3*e;return this.float32[g+0]=i,this.float32[g+1]=a,this.float32[g+2]=h,e}}es.prototype.bytesPerElement=12,Jn(es,"StructArrayLayout3f12");class sr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,a)}emplace(e,i,a,h){const g=3*e;return this.uint16[g+0]=i,this.uint16[g+1]=a,this.uint16[g+2]=h,e}}sr.prototype.bytesPerElement=6,Jn(sr,"StructArrayLayout3ui6");class ma extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt){const It=this.length;return this.resize(It+1),this.emplace(It,e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt)}emplace(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt,It){const Wt=30*e,Yt=15*e,dn=60*e;return this.int16[Wt+0]=i,this.int16[Wt+1]=a,this.int16[Wt+2]=h,this.float32[Yt+2]=g,this.float32[Yt+3]=b,this.uint16[Wt+8]=C,this.uint16[Wt+9]=D,this.uint32[Yt+5]=S,this.uint32[Yt+6]=R,this.uint32[Yt+7]=V,this.uint16[Wt+16]=U,this.uint16[Wt+17]=ee,this.uint16[Wt+18]=oe,this.float32[Yt+10]=pe,this.float32[Yt+11]=Ie,this.uint8[dn+48]=Ne,this.uint8[dn+49]=at,this.uint8[dn+50]=ot,this.uint32[Yt+13]=yt,this.int16[Wt+28]=wt,this.uint8[dn+58]=It,e}}ma.prototype.bytesPerElement=60,Jn(ma,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Lc extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt,It,Wt,Yt,dn,Tn,Vt,on,Sn,Dn){const Kn=this.length;return this.resize(Kn+1),this.emplace(Kn,e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt,It,Wt,Yt,dn,Tn,Vt,on,Sn,Dn)}emplace(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie,Ne,at,ot,yt,wt,It,Wt,Yt,dn,Tn,Vt,on,Sn,Dn,Kn){const wn=38*e,$n=19*e;return this.int16[wn+0]=i,this.int16[wn+1]=a,this.int16[wn+2]=h,this.float32[$n+2]=g,this.float32[$n+3]=b,this.int16[wn+8]=C,this.int16[wn+9]=D,this.int16[wn+10]=S,this.int16[wn+11]=R,this.int16[wn+12]=V,this.int16[wn+13]=U,this.uint16[wn+14]=ee,this.uint16[wn+15]=oe,this.uint16[wn+16]=pe,this.uint16[wn+17]=Ie,this.uint16[wn+18]=Ne,this.uint16[wn+19]=at,this.uint16[wn+20]=ot,this.uint16[wn+21]=yt,this.uint16[wn+22]=wt,this.uint16[wn+23]=It,this.uint16[wn+24]=Wt,this.uint16[wn+25]=Yt,this.uint16[wn+26]=dn,this.uint16[wn+27]=Tn,this.uint16[wn+28]=Vt,this.uint32[$n+15]=on,this.float32[$n+16]=Sn,this.float32[$n+17]=Dn,this.float32[$n+18]=Kn,e}}Lc.prototype.bytesPerElement=76,Jn(Lc,"StructArrayLayout3i2f6i15ui1ul3f76");class Cl extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Cl.prototype.bytesPerElement=4,Jn(Cl,"StructArrayLayout1f4");class jl extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g,b,C){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,a,h,g,b,C)}emplace(e,i,a,h,g,b,C,D){const S=7*e;return this.float32[S+0]=i,this.float32[S+1]=a,this.float32[S+2]=h,this.float32[S+3]=g,this.float32[S+4]=b,this.float32[S+5]=C,this.float32[S+6]=D,e}}jl.prototype.bytesPerElement=28,Jn(jl,"StructArrayLayout7f28");class pc extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,a,h,g)}emplace(e,i,a,h,g,b){const C=5*e;return this.float32[C+0]=i,this.float32[C+1]=a,this.float32[C+2]=h,this.float32[C+3]=g,this.float32[C+4]=b,e}}pc.prototype.bytesPerElement=20,Jn(pc,"StructArrayLayout5f20");class Gl extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,a,h)}emplace(e,i,a,h,g){const b=6*e;return this.uint32[3*e+0]=i,this.uint16[b+2]=a,this.uint16[b+3]=h,this.uint16[b+4]=g,e}}Gl.prototype.bytesPerElement=12,Jn(Gl,"StructArrayLayout1ul3ui12");class Ao extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const h=2*e;return this.uint16[h+0]=i,this.uint16[h+1]=a,e}}Ao.prototype.bytesPerElement=4,Jn(Ao,"StructArrayLayout2ui4");class Er extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Er.prototype.bytesPerElement=2,Jn(Er,"StructArrayLayout1ui2");class Xs extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const h=2*e;return this.float32[h+0]=i,this.float32[h+1]=a,e}}Xs.prototype.bytesPerElement=8,Jn(Xs,"StructArrayLayout2f8");class Xu extends Vn{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Xu.prototype.size=12;class eg extends Lr{get(e){return new Xu(this,e)}}Jn(eg,"FillExtrusionExtArray");class dp extends Vn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}dp.prototype.size=40;class hp extends Hr{get(e){return new dp(this,e)}}Jn(hp,"CollisionBoxArray");class zd extends Vn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}zd.prototype.size=60;class fc extends ma{get(e){return new zd(this,e)}}Jn(fc,"PlacedSymbolArray");class Fc extends Vn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Fc.prototype.size=76;class tg extends Lc{get(e){return new Fc(this,e)}}Jn(tg,"SymbolInstanceArray");class Qu extends Cl{getoffsetX(e){return this.float32[1*e+0]}}Jn(Qu,"GlyphOffsetArray");class yf extends Qi{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Jn(yf,"SymbolLineVertexArray");class ng extends Vn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ng.prototype.size=12;class vf extends Gl{get(e){return new ng(this,e)}}Jn(vf,"FeatureIndexArray");class ig extends Vn{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}ig.prototype.size=4;class bf extends Ao{get(e){return new ig(this,e)}}Jn(bf,"FillExtrusionCentroidArray");class rg extends Vn{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}rg.prototype.size=12;class xf extends Lr{get(e){return new rg(this,e)}}Jn(xf,"CircleGlobeExtArray");const H_=Nn([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),$_=Nn([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var wf=Vs(function(n){n.exports=function(e,i){var a,h,g,b,C,D,S,R;for(h=e.length-(a=3&e.length),g=i,C=3432918353,D=461845907,R=0;R<h;)S=255&e.charCodeAt(R)|(255&e.charCodeAt(++R))<<8|(255&e.charCodeAt(++R))<<16|(255&e.charCodeAt(++R))<<24,++R,g=27492+(65535&(b=5*(65535&(g=(g^=S=(65535&(S=(S=(65535&S)*C+(((S>>>16)*C&65535)<<16)&4294967295)<<15|S>>>17))*D+(((S>>>16)*D&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(S=0,a){case 3:S^=(255&e.charCodeAt(R+2))<<16;case 2:S^=(255&e.charCodeAt(R+1))<<8;case 1:g^=S=(65535&(S=(S=(65535&(S^=255&e.charCodeAt(R)))*C+(((S>>>16)*C&65535)<<16)&4294967295)<<15|S>>>17))*D+(((S>>>16)*D&65535)<<16)&4294967295}return g^=e.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Z_=Vs(function(n){n.exports=function(e,i){for(var a,h=e.length,g=i^h,b=0;h>=4;)a=1540483477*(65535&(a=255&e.charCodeAt(b)|(255&e.charCodeAt(++b))<<8|(255&e.charCodeAt(++b))<<16|(255&e.charCodeAt(++b))<<24))+((1540483477*(a>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:g^=(255&e.charCodeAt(b+2))<<16;case 2:g^=(255&e.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&e.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),mc=wf,og=Z_;mc.murmur3=wf,mc.murmur2=og;class ul{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,h){this.ids.push(Nd(e)),this.positions.push(i,a,h)}getPositions(e){const i=Nd(e);let a=0,h=this.ids.length-1;for(;a<h;){const b=a+h>>1;this.ids[b]>=i?h=b:a=b+1}const g=[];for(;this.ids[a]===i;)g.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return g}static serialize(e,i){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return pp(a,h,0,a.length-1),i&&i.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const i=new ul;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Nd(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:mc(String(n))}function pp(n,e,i,a){for(;i<a;){const h=n[i+a>>1];let g=i-1,b=a+1;for(;;){do{g++}while(n[g]<h);do{b--}while(n[b]>h);if(g>=b)break;Mh(n,g,b),Mh(e,3*g,3*b),Mh(e,3*g+1,3*b+1),Mh(e,3*g+2,3*b+2)}b-i<a-b?(pp(n,e,i,b),i=b+1):(pp(n,e,b+1,a),a=b)}}function Mh(n,e,i){const a=n[e];n[e]=n[i],n[i]=a}Jn(ul,"FeaturePositionMap");class gc{constructor(e,i){this.gl=e.gl,this.location=i}}class Cf extends gc{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ef extends gc{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class W_ extends gc{constructor(e,i){super(e,i),this.current=xr.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Ju=new Float32Array(16),Mf=new Float32Array(9),Df=new Float32Array(4);function sg(n){return[ci(255*n.r,255*n.g),ci(255*n.b,255*n.a)]}class Tf{constructor(e,i,a){this.value=e,this.uniformNames=i.map(h=>`u_${h}`),this.type=a}setUniform(e,i,a){e.set(a.constantOr(this.value))}getBinding(e,i,a){return"color"===this.type?new W_(e,i):new Cf(e,i)}}class ed{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=i.tl.concat(i.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,i,a,h){const g="u_pattern_to"===h||"u_dash_to"===h?this.patternTo:"u_pattern_from"===h||"u_dash_from"===h?this.patternFrom:"u_pixel_ratio_to"===h?this.pixelRatioTo:"u_pixel_ratio_from"===h?this.pixelRatioFrom:null;g&&e.set(g)}getBinding(e,i,a){return"u_pattern_from"===a||"u_pattern_to"===a||"u_dash_from"===a||"u_dash_to"===a?new Ef(e,i):new Cf(e,i)}}class Bc{constructor(e,i,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===a?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,i,a,h,g,b){const C=this.paintVertexArray.length,D=this.expression.evaluate(new ke(0),i,{},g,h,b);this.paintVertexArray.resize(e),this._setPaintValue(C,e,D)}updatePaintArray(e,i,a,h,g){const b=this.expression.evaluate({zoom:0},a,h,void 0,g);this._setPaintValue(e,i,b)}_setPaintValue(e,i,a){if("color"===this.type){const h=sg(a);for(let g=e;g<i;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hl{constructor(e,i,a,h,g,b){this.expression=e,this.uniformNames=i.map(C=>`u_${C}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=i.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===a?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(e,i,a,h,g,b){const C=this.expression.evaluate(new ke(this.zoom),i,{},g,h,b),D=this.expression.evaluate(new ke(this.zoom+1),i,{},g,h,b),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,C,D)}updatePaintArray(e,i,a,h,g){const b=this.expression.evaluate({zoom:this.zoom},a,h,void 0,g),C=this.expression.evaluate({zoom:this.zoom+1},a,h,void 0,g);this._setPaintValue(e,i,b,C)}_setPaintValue(e,i,a,h){if("color"===this.type){const g=sg(a),b=sg(h);for(let C=e;C<i;C++)this.paintVertexArray.emplace(C,g[0],g[1],b[0],b[1])}else{for(let g=e;g<i;g++)this.paintVertexArray.emplace(g,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=St(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,i,a){return new Cf(e,i)}}class pu{constructor(e,i,a,h,g,b,C){this.expression=e,this.type=a,this.useIntegerZoom=h,this.zoom=g,this.layerId=C,this.paintVertexAttributes=("array"===a?$_:H_).members;for(let D=0;D<i.length;++D);this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(e,i,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,h,g,b){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],b)}_setPaintValues(e,i,a,h){if(!h||!a)return;const{min:g,mid:b,max:C}=a,D=h[g],S=h[b],R=h[C];if(D&&S&&R)for(let V=e;V<i;V++)this._setPaintValue(this.zoomInPaintVertexArray,V,S,D),this._setPaintValue(this.zoomOutPaintVertexArray,V,S,R)}_setPaintValue(e,i,a,h){e.emplace(i,a.tl[0],a.tl[1],a.br[0],a.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],a.pixelRatio,h.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class fu{constructor(e,i,a=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const g in e.paint._values){if(!a(g))continue;const b=e.paint.get(g);if(!(b instanceof Zt&&Ma(b.property.specification)))continue;const C=mp(g,e.type),D=b.value,S=b.property.specification.type,R=b.property.useIntegerZoom,V=b.property.specification["property-type"],U="cross-faded"===V||"cross-faded-data-driven"===V,ee="line-dasharray"===String(g)&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==D.kind||ee)if("source"===D.kind||ee||U){const oe=qo(g,S,"source");this.binders[g]=U?new pu(D,C,S,R,i,oe,e.id):new Bc(D,C,S,oe),h.push(`/a_${g}`)}else{const oe=qo(g,S,"composite");this.binders[g]=new Hl(D,C,S,R,i,oe),h.push(`/z_${g}`)}else this.binders[g]=U?new ed(D.value,C):new Tf(D.value,C,S),h.push(`/u_${g}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Bc||i instanceof Hl?i.maxValue:0}populatePaintArrays(e,i,a,h,g,b){for(const C in this.binders){const D=this.binders[C];(D instanceof Bc||D instanceof Hl||D instanceof pu)&&D.populatePaintArray(e,i,a,h,g,b)}}setConstantPatternPositions(e,i){for(const a in this.binders){const h=this.binders[a];h instanceof ed&&h.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,a,h,g,b){let C=!1;for(const D in e){const S=i.getPositions(D);for(const R of S){const V=a.feature(R.index);for(const U in this.binders){const ee=this.binders[U];if((ee instanceof Bc||ee instanceof Hl||ee instanceof pu)&&!0===ee.expression.isStateDependent){const oe=h.paint.get(U);ee.expression=oe.value,ee.updatePaintArray(R.start,R.end,V,e[D],g,b),C=!0}}}}return C}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof Tf||a instanceof ed)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Bc||a instanceof Hl||a instanceof pu)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Tf||a instanceof ed||a instanceof Hl)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const a=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof Tf||g instanceof ed||g instanceof Hl)for(const b of g.uniformNames)if(i[b]){const C=g.getBinding(e,i[b],b);a.push({name:b,property:h,binding:C})}}return a}setUniforms(e,i,a,h){for(const{name:g,property:b,binding:C}of i)this.binders[b].setUniform(C,h,a.get(b),g)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(e&&a instanceof pu){const h=2===e.fromScale?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof Bc||a instanceof Hl)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof Bc||a instanceof Hl||a instanceof pu)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Bc||i instanceof Hl||i instanceof pu)&&i.destroy()}}}class mu{constructor(e,i,a=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new fu(h,i,a);this.needsUpload=!1,this._featureMap=new ul,this._bufferOffset=0}populatePaintArrays(e,i,a,h,g,b,C){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(e,i,h,g,b,C);void 0!==i.id&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,h,g){for(const b of a)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(e,this._featureMap,i,b,h,g)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const fp={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function mp(n,e){return fp[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const Sf={"line-pattern":{source:Ir,composite:Ir},"fill-pattern":{source:Ir,composite:Ir},"fill-extrusion-pattern":{source:Ir,composite:Ir},"line-dasharray":{source:So,composite:So}},gp={color:{source:Xs,composite:mr},number:{source:Cl,composite:Xs}};function qo(n,e,i){const a=Sf[n];return a&&a[i]||gp[e][i]}Jn(Tf,"ConstantBinder"),Jn(ed,"CrossFadedConstantBinder"),Jn(Bc,"SourceExpressionBinder"),Jn(pu,"CrossFadedCompositeBinder"),Jn(Hl,"CompositeExpressionBinder"),Jn(fu,"ProgramConfiguration",{omit:["_buffers"]}),Jn(mu,"ProgramConfigurationSet");const Dh="-transition";class $l extends jn{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Ht(i.layout)),i.paint)){this._transitionablePaint=new Ue(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $t(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){null!=i&&this._validate(Wu,`layers.${this.id}.layout.${e}`,e,i,a)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return Gt(e,Dh)?this._transitionablePaint.getTransition(e.slice(0,-Dh.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(null!=i&&this._validate(Zu,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(Gt(e,Dh))return this._transitionablePaint.setTransition(e.slice(0,-Dh.length),i||void 0),!1;{const h=this._transitionablePaint._values[e],g="cross-faded-data-driven"===h.property.specification["property-type"],b=h.value.isDataDriven(),C=h.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const D=this._transitionablePaint._values[e].value;return D.isDataDriven()||b||g||this._handleOverridablePaintPropertyUpdate(e,C,D)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Cn(e,(i,a)=>!(void 0===i||"layout"===a&&!Object.keys(i).length||"paint"===a&&!Object.keys(i).length))}_validate(e,i,a,h,g={}){return(!g||!1!==g.validate)&&wh(this,e.call(fa,{key:i,layerType:this.type,objectKey:a,value:h,styleSpec:At,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Zt&&Ma(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Wo(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Af=Nn([{name:"a_pos",components:2,type:"Int16"}],4),ag=Nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Io{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,h){let g=this.segments[this.segments.length-1];return e>Io.MAX_VERTEX_ARRAY_LENGTH&&Yn(`Max vertices per segment is ${Io.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>Io.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h)&&(g={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},void 0!==h&&(g.sortKey=h),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,h){return new Io([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}Io.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jn(Io,"SegmentVector");var Ti=8192;class gu{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Fr?new Fr(e.lng,e.lat):Fr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Fr?new Fr(e.lng,e.lat):Fr.convert(e),this}extend(e){const i=this._sw,a=this._ne;let h,g;if(e instanceof Fr)h=e,g=e;else{if(!(e instanceof gu))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(gu.convert(e)):this.extend(Fr.convert(e)):this;if(h=e._sw,g=e._ne,!h||!g)return this}return i||a?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),a.lng=Math.max(g.lng,a.lng),a.lat=Math.max(g.lat,a.lat)):(this._sw=new Fr(h.lng,h.lat),this._ne=new Fr(g.lng,g.lat)),this}getCenter(){return new Fr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fr(this.getWest(),this.getNorth())}getSouthEast(){return new Fr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=Fr.convert(e);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&h}static convert(e){return!e||e instanceof gu?e:new gu(e)}}const If=6371008.8;class Fr{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fr(Xn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,h=e.lat*i,g=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*i);return If*Math.acos(Math.min(g,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new gu(new Fr(this.lng-a,this.lat-i),new Fr(this.lng+a,this.lat+i))}static convert(e){if(e instanceof Fr)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Fr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Fr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Vd=2*Math.PI*If;function Th(n){return Vd*Math.cos(n*Math.PI/180)}function Zl(n){return(180+n)/360}function zc(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function dl(n,e){return n/Th(e)}function Qs(n){return 360*n-180}function No(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function lg(n,e){return n*Th(No(e))}const Wl=85.051129;class td{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=Fr.convert(e);return new td(Zl(a.lng),zc(a.lat),dl(i,a.lat))}toLngLat(){return new Fr(Qs(this.x),No(this.y))}toAltitude(){return lg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vd*(e=No(this.y),1/Math.cos(e*Math.PI/180));var e}}function Sh(n,e,i,a,h,g,b,C,D){const S=(e+a)/2,R=(i+h)/2,V=new ye(S,R);C(V),function(U,ee,oe,pe,Ie,Ne){const at=oe-Ie,ot=pe-Ne;return Math.abs((pe-ee)*at-(oe-U)*ot)/Math.hypot(at,ot)}(V.x,V.y,g.x,g.y,b.x,b.y)>=D?(Sh(n,e,i,S,R,g,V,C,D),Sh(n,S,R,a,h,V,b,C,D)):n.push(b)}function Ah(n,e,i){let a=n[0],h=a.x,g=a.y;e(a);const b=[a];for(let C=1;C<n.length;C++){const D=n[C],{x:S,y:R}=D;e(D),Sh(b,h,g,S,R,a,D,e,i),h=S,g=R,a=D}return b}function Pf(n,e,i,a,h){if(h(e,i)){const g=e.add(i).mult(.5);a(g),Pf(n,e,g,a,h),Pf(n,g,i,a,h)}else n.push(i)}function nd(n,e,i){let a=n[0];e(a);const h=[a];for(let g=1;g<n.length;g++){const b=n[g];e(b),Pf(h,a,b,e,i),a=b}return h}const _p=Math.pow(2,14)-1,Of=-_p-1;function id(n,e){const i=Math.round(n.x*e),a=Math.round(n.y*e);return n.x=St(i,Of,_p),n.y=St(a,Of,_p),(i<n.x||i>n.x+1||a<n.y||a>n.y+1)&&Yn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function Nc(n,e,i){const a=n.loadGeometry(),h=n.extent,g=Ti/h;if(e&&i&&i.projection.isReprojectedInTileSpace){const b=1<<e.z,{scale:C,x:D,y:S,projection:R}=i,V=U=>{const ee=Qs((e.x+U.x/h)/b),oe=No((e.y+U.y/h)/b),pe=R.project(ee,oe);U.x=(pe.x*C-D)*h,U.y=(pe.y*C-S)*h};for(let U=0;U<a.length;U++)if(1!==n.type)a[U]=Ah(a[U],V,1);else{const ee=[];for(const oe of a[U])oe.x<0||oe.x>=h||oe.y<0||oe.y>=h||(V(oe),ee.push(oe));a[U]=ee}}for(const b of a)for(const C of b)id(C,g);return a}function Vc(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Nc(n):[]}}function rd(n,e,i,a,h){n.emplaceBack(2*e+(a+1)/2,2*i+(h+1)/2)}function yp(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Ih{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new bi,this.indexArray=new sr,this.segments=new Io,this.programConfigurations=new mu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,h){const g=this.layers[0],b=[];let C=null;"circle"===g.type&&(C=g.layout.get("circle-sort-key"));for(const{feature:S,id:R,index:V,sourceLayerIndex:U}of e){const ee=this.layers[0]._featureFilter.needGeometry,oe=Vc(S,ee);if(!this.layers[0]._featureFilter.filter(new ke(this.zoom),oe,a))continue;const pe=C?C.evaluate(oe,{},a):void 0,Ie={id:R,properties:S.properties,type:S.type,sourceLayerIndex:U,index:V,geometry:ee?oe.geometry:Nc(S,a,h),patterns:{},sortKey:pe};b.push(Ie)}C&&b.sort((S,R)=>S.sortKey-R.sortKey);let D=null;"globe"===h.projection.name&&(this.globeExtVertexArray=new xf,D=h.projection);for(const S of b){const{geometry:R,index:V,sourceLayerIndex:U}=S,ee=e[V].feature;this.addFeature(S,R,V,i.availableImages,a,D),i.featureIndex.insert(ee,R,V,U,this.index)}}update(e,i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Af.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,ag.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,a,h,g,b){for(const C of i)for(const D of C){const S=D.x,R=D.y;if(S<0||S>=Ti||R<0||R>=Ti)continue;if(b){const ee=b.projectTilePoint(S,R,g),oe=b.upVector(g,S,R),pe=this.globeExtVertexArray;yp(pe,ee,oe),yp(pe,ee,oe),yp(pe,ee,oe),yp(pe,ee,oe)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=V.vertexLength;rd(this.layoutVertexArray,S,R,-1,-1),rd(this.layoutVertexArray,S,R,1,-1),rd(this.layoutVertexArray,S,R,1,1),rd(this.layoutVertexArray,S,R,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h,g)}}function Ph(n,e){for(let i=0;i<n.length;i++)if(_u(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(_u(n,e[i]))return!0;return!!Lf(n,e)}function od(n,e,i){return!!_u(n,e)||!!vp(e,n,i)}function kf(n,e){if(1===n.length)return ad(e,n[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let h=0;h<a.length;h++)if(_u(n,a[h]))return!0}for(let i=0;i<n.length;i++)if(ad(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Lf(n,e[i]))return!0;return!1}function Rf(n,e,i){if(n.length>1){if(Lf(n,e))return!0;for(let a=0;a<e.length;a++)if(vp(e[a],n,i))return!0}for(let a=0;a<n.length;a++)if(vp(n[a],e,i))return!0;return!1}function Lf(n,e){if(0===n.length||0===e.length)return!1;for(let i=0;i<n.length-1;i++){const a=n[i],h=n[i+1];for(let g=0;g<e.length-1;g++)if(q_(a,h,e[g],e[g+1]))return!0}return!1}function q_(n,e,i,a){return fi(n,i,a)!==fi(e,i,a)&&fi(n,e,i)!==fi(n,e,a)}function vp(n,e,i){const a=i*i;if(1===e.length)return n.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(sd(n,e[h-1],e[h])<a)return!0;return!1}function sd(n,e,i){const a=e.distSqr(i);if(0===a)return n.distSqr(e);const h=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/a;return n.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function ad(n,e){let i,a,h,g=!1;for(let b=0;b<n.length;b++){i=n[b];for(let C=0,D=i.length-1;C<i.length;D=C++)a=i[C],h=i[D],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(g=!g)}return g}function _u(n,e){let i=!1;for(let a=0,h=n.length-1;a<n.length;h=a++){const g=n[a],b=n[h];g.y>e.y!=b.y>e.y&&e.x<(b.x-g.x)*(e.y-g.y)/(b.y-g.y)+g.x&&(i=!i)}return i}function cg(n,e,i,a,h){for(const b of n)if(e<=b.x&&i<=b.y&&a>=b.x&&h>=b.y)return!0;const g=[new ye(e,i),new ye(e,h),new ye(a,h),new ye(a,i)];if(n.length>2)for(const b of g)if(_u(n,b))return!0;for(let b=0;b<n.length-1;b++)if(Y_(n[b],n[b+1],g))return!0;return!1}function Y_(n,e,i){const a=i[0],h=i[2];if(n.x<a.x&&e.x<a.x||n.x>h.x&&e.x>h.x||n.y<a.y&&e.y<a.y||n.y>h.y&&e.y>h.y)return!1;const g=fi(n,e,i[0]);return g!==fi(n,e,i[1])||g!==fi(n,e,i[2])||g!==fi(n,e,i[3])}function yu(n,e,i){const a=e.paint.get(n).value;return"constant"===a.kind?a.value:i.programConfigurations.get(e.id).getMaxValue(n)}function bp(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Ff(n,e,i,a,h){if(!e[0]&&!e[1])return n;const g=ye.convert(e)._mult(h);"viewport"===i&&g._rotate(-a);const b=[];for(let C=0;C<n.length;C++)b.push(n[C].sub(g));return b}function Oh(n,e,i,a){const h=ye.convert(n)._mult(a);return"viewport"===e&&h._rotate(-i),h}Jn(Ih,"CircleBucket",{omit:["layers"]});const ug=new tn({"circle-sort-key":new it(At.layout_circle["circle-sort-key"])});var Cv={paint:new tn({"circle-radius":new it(At.paint_circle["circle-radius"]),"circle-color":new it(At.paint_circle["circle-color"]),"circle-blur":new it(At.paint_circle["circle-blur"]),"circle-opacity":new it(At.paint_circle["circle-opacity"]),"circle-translate":new jt(At.paint_circle["circle-translate"]),"circle-translate-anchor":new jt(At.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jt(At.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jt(At.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new it(At.paint_circle["circle-stroke-width"]),"circle-stroke-color":new it(At.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new it(At.paint_circle["circle-stroke-opacity"])}),layout:ug},xp=1e-6,Ls=typeof Float32Array<"u"?Float32Array:Array;function dg(){var n=new Ls(9);return Ls!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Ms(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function El(n,e,i){var a=e[0],h=e[1],g=e[2],b=e[3],C=e[4],D=e[5],S=e[6],R=e[7],V=e[8],U=e[9],ee=e[10],oe=e[11],pe=e[12],Ie=e[13],Ne=e[14],at=e[15],ot=i[0],yt=i[1],wt=i[2],It=i[3];return n[0]=ot*a+yt*C+wt*V+It*pe,n[1]=ot*h+yt*D+wt*U+It*Ie,n[2]=ot*g+yt*S+wt*ee+It*Ne,n[3]=ot*b+yt*R+wt*oe+It*at,n[4]=(ot=i[4])*a+(yt=i[5])*C+(wt=i[6])*V+(It=i[7])*pe,n[5]=ot*h+yt*D+wt*U+It*Ie,n[6]=ot*g+yt*S+wt*ee+It*Ne,n[7]=ot*b+yt*R+wt*oe+It*at,n[8]=(ot=i[8])*a+(yt=i[9])*C+(wt=i[10])*V+(It=i[11])*pe,n[9]=ot*h+yt*D+wt*U+It*Ie,n[10]=ot*g+yt*S+wt*ee+It*Ne,n[11]=ot*b+yt*R+wt*oe+It*at,n[12]=(ot=i[12])*a+(yt=i[13])*C+(wt=i[14])*V+(It=i[15])*pe,n[13]=ot*h+yt*D+wt*U+It*Ie,n[14]=ot*g+yt*S+wt*ee+It*Ne,n[15]=ot*b+yt*R+wt*oe+It*at,n}function ld(n,e,i){var a,h,g,b,C,D,S,R,V,U,ee,oe,pe=i[0],Ie=i[1],Ne=i[2];return e===n?(n[12]=e[0]*pe+e[4]*Ie+e[8]*Ne+e[12],n[13]=e[1]*pe+e[5]*Ie+e[9]*Ne+e[13],n[14]=e[2]*pe+e[6]*Ie+e[10]*Ne+e[14],n[15]=e[3]*pe+e[7]*Ie+e[11]*Ne+e[15]):(h=e[1],g=e[2],b=e[3],C=e[4],D=e[5],S=e[6],R=e[7],V=e[8],U=e[9],ee=e[10],oe=e[11],n[0]=a=e[0],n[1]=h,n[2]=g,n[3]=b,n[4]=C,n[5]=D,n[6]=S,n[7]=R,n[8]=V,n[9]=U,n[10]=ee,n[11]=oe,n[12]=a*pe+C*Ie+V*Ne+e[12],n[13]=h*pe+D*Ie+U*Ne+e[13],n[14]=g*pe+S*Ie+ee*Ne+e[14],n[15]=b*pe+R*Ie+oe*Ne+e[15]),n}function Ka(n,e,i){var a=i[0],h=i[1],g=i[2];return n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n[3]=e[3]*a,n[4]=e[4]*h,n[5]=e[5]*h,n[6]=e[6]*h,n[7]=e[7]*h,n[8]=e[8]*g,n[9]=e[9]*g,n[10]=e[10]*g,n[11]=e[11]*g,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function vu(n,e,i){var a=Math.sin(i),h=Math.cos(i),g=e[4],b=e[5],C=e[6],D=e[7],S=e[8],R=e[9],V=e[10],U=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=g*h+S*a,n[5]=b*h+R*a,n[6]=C*h+V*a,n[7]=D*h+U*a,n[8]=S*h-g*a,n[9]=R*h-b*a,n[10]=V*h-C*a,n[11]=U*h-D*a,n}function wp(n,e,i){var a=Math.sin(i),h=Math.cos(i),g=e[0],b=e[1],C=e[2],D=e[3],S=e[8],R=e[9],V=e[10],U=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=g*h-S*a,n[1]=b*h-R*a,n[2]=C*h-V*a,n[3]=D*h-U*a,n[8]=g*a+S*h,n[9]=b*a+R*h,n[10]=C*a+V*h,n[11]=D*a+U*h,n}function hg(n,e,i){var a,h,g,b=i[0],C=i[1],D=i[2],S=Math.hypot(b,C,D);return S<xp?null:(b*=S=1/S,C*=S,D*=S,a=Math.sin(e),h=Math.cos(e),n[0]=b*b*(g=1-h)+h,n[1]=C*b*g+D*a,n[2]=D*b*g-C*a,n[3]=0,n[4]=b*C*g-D*a,n[5]=C*C*g+h,n[6]=D*C*g+b*a,n[7]=0,n[8]=b*D*g+C*a,n[9]=C*D*g-b*a,n[10]=D*D*g+h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var K_=El;function Uc(){var n=new Ls(3);return Ls!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Ud(n){var e=new Ls(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function cd(n){return Math.hypot(n[0],n[1],n[2])}function jd(n,e,i){var a=new Ls(3);return a[0]=n,a[1]=e,a[2]=i,a}function bu(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function kh(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function X_(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function Gd(n,e,i){return n[0]=Math.min(e[0],i[0]),n[1]=Math.min(e[1],i[1]),n[2]=Math.min(e[2],i[2]),n}function Hd(n,e,i){return n[0]=Math.max(e[0],i[0]),n[1]=Math.max(e[1],i[1]),n[2]=Math.max(e[2],i[2]),n}function jc(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function Bf(n,e,i,a){return n[0]=e[0]+i[0]*a,n[1]=e[1]+i[1]*a,n[2]=e[2]+i[2]*a,n}function Da(n,e){var i=e[0],a=e[1],h=e[2],g=i*i+a*a+h*h;return g>0&&(g=1/Math.sqrt(g)),n[0]=e[0]*g,n[1]=e[1]*g,n[2]=e[2]*g,n}function ql(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function pg(n,e,i){var a=e[0],h=e[1],g=e[2],b=i[0],C=i[1],D=i[2];return n[0]=h*D-g*C,n[1]=g*b-a*D,n[2]=a*C-h*b,n}function Fs(n,e,i){var a=e[0],h=e[1],g=e[2],b=i[3]*a+i[7]*h+i[11]*g+i[15];return n[0]=(i[0]*a+i[4]*h+i[8]*g+i[12])/(b=b||1),n[1]=(i[1]*a+i[5]*h+i[9]*g+i[13])/b,n[2]=(i[2]*a+i[6]*h+i[10]*g+i[14])/b,n}function zf(n,e,i){var a=i[0],h=i[1],g=i[2],b=e[0],C=e[1],D=e[2],S=h*D-g*C,R=g*b-a*D,V=a*C-h*b,U=h*V-g*R,ee=g*S-a*V,oe=a*R-h*S,pe=2*i[3];return R*=pe,V*=pe,ee*=2,oe*=2,n[0]=b+(S*=pe)+(U*=2),n[1]=C+R+ee,n[2]=D+V+oe,n}var xu,hl=kh,Rh=X_,fg=cd;function Cp(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n}function ud(n,e,i){var a=e[0],h=e[1],g=e[2],b=e[3];return n[0]=i[0]*a+i[4]*h+i[8]*g+i[12]*b,n[1]=i[1]*a+i[5]*h+i[9]*g+i[13]*b,n[2]=i[2]*a+i[6]*h+i[10]*g+i[14]*b,n[3]=i[3]*a+i[7]*h+i[11]*g+i[15]*b,n}function Ep(){var n=new Ls(4);return Ls!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function $d(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function mg(n,e,i){i*=.5;var a=e[0],h=e[1],g=e[2],b=e[3],C=Math.sin(i),D=Math.cos(i);return n[0]=a*D+b*C,n[1]=h*D+g*C,n[2]=g*D-h*C,n[3]=b*D-a*C,n}function gg(n,e,i){i*=.5;var a=e[0],h=e[1],g=e[2],b=e[3],C=Math.sin(i),D=Math.cos(i);return n[0]=a*D-g*C,n[1]=h*D+b*C,n[2]=g*D+a*C,n[3]=b*D-h*C,n}Uc(),xu=new Ls(4),Ls!=Float32Array&&(xu[0]=0,xu[1]=0,xu[2]=0,xu[3]=0),Uc(),jd(1,0,0),jd(0,1,0),Ep(),Ep(),dg();class Nf{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,a){const h=ql(i,this.dir);if(Math.abs(h)<1e-6)return!1;const g=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/h;return a[0]=this.pos[0]+this.dir[0]*g,a[1]=this.pos[1]+this.dir[1]*g,a[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(e,i,a){if(pe=(ee=this.pos)[0],Ie=ee[1],Ne=ee[2],at=(oe=e)[0],ot=oe[1],yt=oe[2],Math.abs(pe-at)<=xp*Math.max(1,Math.abs(pe),Math.abs(at))&&Math.abs(Ie-ot)<=xp*Math.max(1,Math.abs(Ie),Math.abs(ot))&&Math.abs(Ne-yt)<=xp*Math.max(1,Math.abs(Ne),Math.abs(yt))||0===i)return a[0]=a[1]=a[2]=0,!1;var ee,oe,pe,Ie,Ne,at,ot,yt;const[h,g,b]=this.dir,C=this.pos[0]-e[0],D=this.pos[1]-e[1],S=this.pos[2]-e[2],R=h*h+g*g+b*b,V=2*(C*h+D*g+S*b),U=V*V-4*R*(C*C+D*D+S*S-i*i);if(U<0){const ee=Math.max(-V/2,0),oe=C+h*ee,pe=D+g*ee,Ie=S+b*ee,Ne=Math.hypot(oe,pe,Ie);return a[0]=oe*i/Ne,a[1]=pe*i/Ne,a[2]=Ie*i/Ne,!1}{const ee=(-V-Math.sqrt(U))/(2*R);if(ee<0){const oe=Math.hypot(C,D,S);return a[0]=C*i/oe,a[1]=D*i/oe,a[2]=S*i/oe,!1}return a[0]=C+h*ee,a[1]=D+g*ee,a[2]=S+b*ee,!0}}}class Mp{constructor(e,i,a,h,g){this.TL=e,this.TR=i,this.BR=a,this.BL=h,this.horizon=g}static fromInvProjectionMatrix(e,i,a){const h=[-1,1,1],g=[1,1,1],b=[1,-1,1],C=[-1,-1,1],D=Fs(h,h,e),S=Fs(g,g,e),R=Fs(b,b,e),V=Fs(C,C,e);return new Mp(D,S,R,V,i/a)}}class Vf{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,a,h){const g=Math.pow(2,a),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const S=ud([],D,e),R=1/S[3]/i*g;return(V=S)[0]=(U=S)[0]*(ee=[R,R,h?1/S[3]:R,R])[0],V[1]=U[1]*ee[1],V[2]=U[2]*ee[2],V[3]=U[3]*ee[3],V;var V,U,ee}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const S=Da([],pg([],hl([],b[D[0]],b[D[1]]),hl([],b[D[2]],b[D[1]]))),R=-ql(S,b[D[1]]);return S.concat(R)});return new Vf(b,C)}}class pl{constructor(e,i){this.min=e,this.max=i,this.center=jc([],bu([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],a=Ud(this.min),h=Ud(this.max);for(let g=0;g<i.length;g++)a[g]=i[g]?this.min[g]:this.center[g],h[g]=i[g]?this.center[g]:this.max[g];return h[2]=this.max[2],new pl(a,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let a=!0;for(let h=0;h<e.planes.length;h++){const g=e.planes[h];let b=0;for(let C=0;C<i.length;C++)b+=ql(g,i[C])+g[3]>=0;if(0===b)return 0;b!==i.length&&(a=!1)}if(a)return 2;for(let h=0;h<3;h++){let g=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let C=0;C<e.points.length;C++){const D=e.points[C][h]-this.min[h];g=Math.min(g,D),b=Math.max(b,D)}if(b<0||g>this.max[h]-this.min[h])return 0}return 1}}function _g(n,e,i,a,h,g,b,C,D){if(g&&n.queryGeometry.isAboveHorizon)return!1;g&&(D*=n.pixelToTileUnitsFactor);const S=n.tileID.canonical,R=i.projection.upVectorScale(S,i.center.lat,i.worldSize).metersToTile;for(const V of e)for(const U of V){const ee=U.add(C),oe=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(ee.x,ee.y,!0):0,pe=i.projection.projectTilePoint(ee.x,ee.y,S);if(oe>0){const ot=i.projection.upVector(S,ee.x,ee.y);pe.x+=ot[0]*R*oe,pe.y+=ot[1]*R*oe,pe.z+=ot[2]*R*oe}const Ie=g?ee:Q_(pe.x,pe.y,pe.z,a),Ne=g?n.tilespaceRays.map(ot=>ey(ot,oe)):n.queryGeometry.screenGeometry,at=ud([],[pe.x,pe.y,pe.z,1],a);if(!b&&g?D*=at[3]/i.cameraToCenterDistance:b&&!g&&(D*=i.cameraToCenterDistance/at[3]),g){const ot=No((U.y/Ti+S.y)/(1<<S.z));D/=i.projection.pixelsPerMeter(ot,1)/dl(1,ot)}if(od(Ne,Ie,D))return!0}return!1}function Q_(n,e,i,a){const h=ud([],[n,e,i,1],a);return new ye(h[0]/h[3],h[1]/h[3])}const Dp=jd(0,0,0),J_=jd(0,0,1);function ey(n,e){const i=Uc();return Dp[2]=e,n.intersectsPlane(Dp,J_,i),new ye(i[0],i[1])}class yg extends Ih{}function Tp(n,{width:e,height:i},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*i*a)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*i*a);return n.width=e,n.height=i,n.data=h,n}function Sp(n,e,i){const{width:a,height:h}=e;a===n.width&&h===n.height||(Uf(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,a),height:Math.min(n.height,h)},i),n.width=a,n.height=h,n.data=e.data)}function Uf(n,e,i,a,h,g){if(0===h.width||0===h.height)return e;if(h.width>n.width||h.height>n.height||i.x>n.width-h.width||i.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const b=n.data,C=e.data;for(let D=0;D<h.height;D++){const S=((i.y+D)*n.width+i.x)*g,R=((a.y+D)*e.width+a.x)*g;for(let V=0;V<h.width*g;V++)C[R+V]=b[S+V]}return e}Jn(yg,"HeatmapBucket",{omit:["layers"]});class Vo{constructor(e,i){Tp(this,e,1,i)}resize(e){Sp(this,new Vo(e),1)}clone(){return new Vo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,h,g){Uf(e,i,a,h,g,1)}}class ga{constructor(e,i){Tp(this,e,4,i)}resize(e){Sp(this,new ga(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,h,g){Uf(e,i,a,h,g,4)}}Jn(Vo,"AlphaImage"),Jn(ga,"RGBAImage");var jf={paint:new tn({"heatmap-radius":new it(At.paint_heatmap["heatmap-radius"]),"heatmap-weight":new it(At.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jt(At.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Un(At.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jt(At.paint_heatmap["heatmap-opacity"])})};function Lh(n){const e={},i=n.resolution||256,a=n.clips?n.clips.length:1,h=n.image||new ga({width:i,height:a}),g=(b,C,D)=>{e[n.evaluationKey]=D;const S=n.expression.evaluate(e);h.data[b+C+0]=Math.floor(255*S.r/S.a),h.data[b+C+1]=Math.floor(255*S.g/S.a),h.data[b+C+2]=Math.floor(255*S.b/S.a),h.data[b+C+3]=Math.floor(255*S.a)};if(n.clips)for(let b=0,C=0;b<a;++b,C+=4*i)for(let D=0,S=0;D<i;D++,S+=4){const R=D/(i-1),{start:V,end:U}=n.clips[b];g(C,S,V*(1-R)+U*R)}else for(let b=0,C=0;b<i;b++,C+=4)g(0,C,b/(i-1));return h}var Js={paint:new tn({"hillshade-illumination-direction":new jt(At.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new jt(At.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jt(At.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jt(At.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jt(At.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jt(At.paint_hillshade["hillshade-accent-color"])})};const Fh=Nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Gf}=Fh;var Ap=Bh,vg=Bh;function Bh(n,e,i){i=i||2;var a,h,g,b,C,D,S,R=e&&e.length,V=R?e[0]*i:n.length,U=bg(n,0,V,i,!0),ee=[];if(!U||U.next===U.prev)return ee;if(R&&(U=function(pe,Ie,Ne,at){var ot,yt,wt,It=[];for(ot=0,yt=Ie.length;ot<yt;ot++)(wt=bg(pe,Ie[ot]*at,ot<yt-1?Ie[ot+1]*at:pe.length,at,!1))===wt.next&&(wt.steiner=!0),It.push(Gc(wt));for(It.sort(xg),ot=0;ot<It.length;ot++)Ne=_c(Ne=iy(It[ot],Ne),Ne.next);return Ne}(n,e,U,i)),n.length>80*i){a=g=n[0],h=b=n[1];for(var oe=i;oe<V;oe+=i)(C=n[oe])<a&&(a=C),(D=n[oe+1])<h&&(h=D),C>g&&(g=C),D>b&&(b=D);S=0!==(S=Math.max(g-a,b-h))?1/S:0}return zh(U,ee,i,a,h,S),ee}function bg(n,e,i,a,h){var g,b;if(h===Mu(n,e,i,a)>0)for(g=e;g<i;g+=a)b=Wf(g,n[g],n[g+1],b);else for(g=i-a;g>=e;g-=a)b=Wf(g,n[g],n[g+1],b);return b&&$f(b,b.next)&&(dd(b),b=b.next),b}function _c(n,e){if(!n)return n;e||(e=n);var i,a=n;do{if(i=!1,a.steiner||!$f(a,a.next)&&0!==Po(a.prev,a,a.next))a=a.next;else{if(dd(a),(a=e=a.prev)===a.next)break;i=!0}}while(i||a!==e);return e}function zh(n,e,i,a,h,g,b){if(n){!b&&g&&function(R,V,U,ee){var oe=R;do{null===oe.z&&(oe.z=wu(oe.x,oe.y,V,U,ee)),oe.prevZ=oe.prev,oe.nextZ=oe.next,oe=oe.next}while(oe!==R);oe.prevZ.nextZ=null,oe.prevZ=null,function(pe){var Ie,Ne,at,ot,yt,wt,It,Wt,Yt=1;do{for(Ne=pe,pe=null,yt=null,wt=0;Ne;){for(wt++,at=Ne,It=0,Ie=0;Ie<Yt&&(It++,at=at.nextZ);Ie++);for(Wt=Yt;It>0||Wt>0&&at;)0!==It&&(0===Wt||!at||Ne.z<=at.z)?(ot=Ne,Ne=Ne.nextZ,It--):(ot=at,at=at.nextZ,Wt--),yt?yt.nextZ=ot:pe=ot,ot.prevZ=yt,yt=ot;Ne=at}yt.nextZ=null,Yt*=2}while(wt>1)}(oe)}(n,a,h,g);for(var C,D,S=n;n.prev!==n.next;)if(C=n.prev,D=n.next,g?ty(n,a,h,g):Ip(n))e.push(C.i/i),e.push(n.i/i),e.push(D.i/i),dd(n),n=D.next,S=D.next;else if((n=D)===S){b?1===b?zh(n=Hf(_c(n),e,i),e,i,a,h,g,2):2===b&&ny(n,e,i,a,h,g):zh(_c(n),e,i,a,h,g,1);break}}}function Ip(n){var e=n.prev,i=n,a=n.next;if(Po(e,i,a)>=0)return!1;for(var h=n.next.next;h!==n.prev;){if(Cu(e.x,e.y,i.x,i.y,a.x,a.y,h.x,h.y)&&Po(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function ty(n,e,i,a){var h=n.prev,g=n,b=n.next;if(Po(h,g,b)>=0)return!1;for(var C=h.x>g.x?h.x>b.x?h.x:b.x:g.x>b.x?g.x:b.x,D=h.y>g.y?h.y>b.y?h.y:b.y:g.y>b.y?g.y:b.y,S=wu(h.x<g.x?h.x<b.x?h.x:b.x:g.x<b.x?g.x:b.x,h.y<g.y?h.y<b.y?h.y:b.y:g.y<b.y?g.y:b.y,e,i,a),R=wu(C,D,e,i,a),V=n.prevZ,U=n.nextZ;V&&V.z>=S&&U&&U.z<=R;){if(V!==n.prev&&V!==n.next&&Cu(h.x,h.y,g.x,g.y,b.x,b.y,V.x,V.y)&&Po(V.prev,V,V.next)>=0||(V=V.prevZ,U!==n.prev&&U!==n.next&&Cu(h.x,h.y,g.x,g.y,b.x,b.y,U.x,U.y)&&Po(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;V&&V.z>=S;){if(V!==n.prev&&V!==n.next&&Cu(h.x,h.y,g.x,g.y,b.x,b.y,V.x,V.y)&&Po(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;U&&U.z<=R;){if(U!==n.prev&&U!==n.next&&Cu(h.x,h.y,g.x,g.y,b.x,b.y,U.x,U.y)&&Po(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Hf(n,e,i){var a=n;do{var h=a.prev,g=a.next.next;!$f(h,g)&&Nh(h,a,a.next,g)&&Eu(h,g)&&Eu(g,h)&&(e.push(h.i/i),e.push(a.i/i),e.push(g.i/i),dd(a),dd(a.next),a=n=g),a=a.next}while(a!==n);return _c(a)}function ny(n,e,i,a,h,g){var b=n;do{for(var C=b.next.next;C!==b.prev;){if(b.i!==C.i&&oy(b,C)){var D=Pp(b,C);return b=_c(b,b.next),D=_c(D,D.next),zh(b,e,i,a,h,g),void zh(D,e,i,a,h,g)}C=C.next}b=b.next}while(b!==n)}function xg(n,e){return n.x-e.x}function iy(n,e){var i=function(g,b){var C,D=b,S=g.x,R=g.y,V=-1/0;do{if(R<=D.y&&R>=D.next.y&&D.next.y!==D.y){var U=D.x+(R-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(U<=S&&U>V){if(V=U,U===S){if(R===D.y)return D;if(R===D.next.y)return D.next}C=D.x<D.next.x?D:D.next}}D=D.next}while(D!==b);if(!C)return null;if(S===V)return C;var ee,oe=C,pe=C.x,Ie=C.y,Ne=1/0;D=C;do{S>=D.x&&D.x>=pe&&S!==D.x&&Cu(R<Ie?S:V,R,pe,Ie,R<Ie?V:S,R,D.x,D.y)&&(ee=Math.abs(R-D.y)/(S-D.x),Eu(D,g)&&(ee<Ne||ee===Ne&&(D.x>C.x||D.x===C.x&&ry(C,D)))&&(C=D,Ne=ee)),D=D.next}while(D!==oe);return C}(n,e);if(!i)return e;var a=Pp(i,n),h=_c(i,i.next);return _c(a,a.next),e===i?h:e}function ry(n,e){return Po(n.prev,n,e.prev)<0&&Po(e.next,n,n.next)<0}function wu(n,e,i,a,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-i)*h)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*h)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Gc(n){var e=n,i=n;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==n);return i}function Cu(n,e,i,a,h,g,b,C){return(h-b)*(e-C)-(n-b)*(g-C)>=0&&(n-b)*(a-C)-(i-b)*(e-C)>=0&&(i-b)*(g-C)-(h-b)*(a-C)>=0}function oy(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,a){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==a.i&&h.next.i!==a.i&&Nh(h,h.next,i,a))return!0;h=h.next}while(h!==i);return!1}(n,e)&&(Eu(n,e)&&Eu(e,n)&&function(i,a){var h=i,g=!1,b=(i.x+a.x)/2,C=(i.y+a.y)/2;do{h.y>C!=h.next.y>C&&h.next.y!==h.y&&b<(h.next.x-h.x)*(C-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next}while(h!==i);return g}(n,e)&&(Po(n.prev,n,e.prev)||Po(n,e.prev,e))||$f(n,e)&&Po(n.prev,n,n.next)>0&&Po(e.prev,e,e.next)>0)}function Po(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function $f(n,e){return n.x===e.x&&n.y===e.y}function Nh(n,e,i,a){var h=Ta(Po(n,e,i)),g=Ta(Po(n,e,a)),b=Ta(Po(i,a,n)),C=Ta(Po(i,a,e));return h!==g&&b!==C||!(0!==h||!Zf(n,i,e))||!(0!==g||!Zf(n,a,e))||!(0!==b||!Zf(i,n,a))||!(0!==C||!Zf(i,e,a))}function Zf(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Ta(n){return n>0?1:n<0?-1:0}function Eu(n,e){return Po(n.prev,n,n.next)<0?Po(n,e,n.next)>=0&&Po(n,n.prev,e)>=0:Po(n,e,n.prev)<0||Po(n,n.next,e)<0}function Pp(n,e){var i=new Op(n.i,n.x,n.y),a=new Op(e.i,e.x,e.y),h=n.next,g=e.prev;return n.next=e,e.prev=n,i.next=h,h.prev=i,a.next=i,i.prev=a,g.next=a,a.prev=g,a}function Wf(n,e,i,a){var h=new Op(n,e,i);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function dd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Op(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mu(n,e,i,a){for(var h=0,g=e,b=i-a;g<i;g+=a)h+=(n[b]-n[g])*(n[g+1]+n[b+1]),b=g;return h}function sy(n,e,i,a,h){qf(n,e,i||0,a||n.length-1,h||Yf)}function qf(n,e,i,a,h){for(;a>i;){if(a-i>600){var g=a-i+1,b=e-i+1,C=Math.log(g),D=.5*Math.exp(2*C/3),S=.5*Math.sqrt(C*D*(g-D)/g)*(b-g/2<0?-1:1);qf(n,e,Math.max(i,Math.floor(e-b*D/g+S)),Math.min(a,Math.floor(e+(g-b)*D/g+S)),h)}var R=n[e],V=i,U=a;for(hd(n,i,e),h(n[a],R)>0&&hd(n,i,a);V<U;){for(hd(n,V,U),V++,U--;h(n[V],R)<0;)V++;for(;h(n[U],R)>0;)U--}0===h(n[i],R)?hd(n,i,U):hd(n,++U,a),U<=e&&(i=U+1),e<=U&&(a=U-1)}}function hd(n,e,i){var a=n[e];n[e]=n[i],n[i]=a}function Yf(n,e){return n<e?-1:n>e?1:0}function kp(n,e){const i=n.length;if(i<=1)return[n];const a=[];let h,g;for(let b=0;b<i;b++){const C=On(n[b]);0!==C&&(n[b].area=Math.abs(C),void 0===g&&(g=C<0),g===C<0?(h&&a.push(h),h=[n[b]]):h.push(n[b]))}if(h&&a.push(h),e>1)for(let b=0;b<a.length;b++)a[b].length<=e||(sy(a[b],e,1,a[b].length-1,Zd),a[b]=a[b].slice(0,e));return a}function Zd(n,e){return e.area-n.area}function Ml(n,e,i){const a=i.patternDependencies;let h=!1;for(const g of e){const b=g.paint.get(`${n}-pattern`);b.isConstant()||(h=!0);const C=b.constantOr(null);C&&(h=!0,a[C.to]=!0,a[C.from]=!0)}return h}function Vh(n,e,i,a,h){const g=h.patternDependencies;for(const b of e){const C=b.paint.get(`${n}-pattern`).value;if("constant"!==C.kind){let D=C.evaluate({zoom:a-1},i,{},h.availableImages),S=C.evaluate({zoom:a},i,{},h.availableImages),R=C.evaluate({zoom:a+1},i,{},h.availableImages);D=D&&D.name?D.name:D,S=S&&S.name?S.name:S,R=R&&R.name?R.name:R,g[D]=!0,g[S]=!0,g[R]=!0,i.patterns[b.id]={min:D,mid:S,max:R}}}return i}Bh.deviation=function(n,e,i,a){var h=e&&e.length,g=Math.abs(Mu(n,0,h?e[0]*i:n.length,i));if(h)for(var b=0,C=e.length;b<C;b++)g-=Math.abs(Mu(n,e[b]*i,b<C-1?e[b+1]*i:n.length,i));var D=0;for(b=0;b<a.length;b+=3){var S=a[b]*i,R=a[b+1]*i,V=a[b+2]*i;D+=Math.abs((n[S]-n[V])*(n[R+1]-n[S+1])-(n[S]-n[R])*(n[V+1]-n[S+1]))}return 0===g&&0===D?0:Math.abs((D-g)/g)},Bh.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,h=0;h<n.length;h++){for(var g=0;g<n[h].length;g++)for(var b=0;b<e;b++)i.vertices.push(n[h][g][b]);h>0&&i.holes.push(a+=n[h-1].length)}return i},Ap.default=vg;class Wd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bi,this.indexArray=new sr,this.indexArray2=new Ao,this.programConfigurations=new mu(e.layers,e.zoom),this.segments=new Io,this.segments2=new Io,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,a,h){this.hasPattern=Ml("fill",this.layers,i);const g=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:C,id:D,index:S,sourceLayerIndex:R}of e){const V=this.layers[0]._featureFilter.needGeometry,U=Vc(C,V);if(!this.layers[0]._featureFilter.filter(new ke(this.zoom),U,a))continue;const ee=g?g.evaluate(U,{},a,i.availableImages):void 0,oe={id:D,properties:C.properties,type:C.type,sourceLayerIndex:R,index:S,geometry:V?U.geometry:Nc(C,a,h),patterns:{},sortKey:ee};b.push(oe)}g&&b.sort((C,D)=>C.sortKey-D.sortKey);for(const C of b){const{geometry:D,index:S,sourceLayerIndex:R}=C;if(this.hasPattern){const V=Vh("fill",this.layers,C,this.zoom,i);this.patternFeatures.push(V)}else this.addFeature(C,D,S,a,{},i.availableImages);i.featureIndex.insert(e[S].feature,D,S,R,this.index)}}update(e,i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,h)}addFeatures(e,i,a,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,i,a,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,h,g,b=[]){for(const C of kp(i,500)){let D=0;for(const oe of C)D+=oe.length;const S=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),R=S.vertexLength,V=[],U=[];for(const oe of C){if(0===oe.length)continue;oe!==C[0]&&U.push(V.length/2);const pe=this.segments2.prepareSegment(oe.length,this.layoutVertexArray,this.indexArray2),Ie=pe.vertexLength;this.layoutVertexArray.emplaceBack(oe[0].x,oe[0].y),this.indexArray2.emplaceBack(Ie+oe.length-1,Ie),V.push(oe[0].x),V.push(oe[0].y);for(let Ne=1;Ne<oe.length;Ne++)this.layoutVertexArray.emplaceBack(oe[Ne].x,oe[Ne].y),this.indexArray2.emplaceBack(Ie+Ne-1,Ie+Ne),V.push(oe[Ne].x),V.push(oe[Ne].y);pe.vertexLength+=oe.length,pe.primitiveLength+=oe.length}const ee=Ap(V,U);for(let oe=0;oe<ee.length;oe+=3)this.indexArray.emplaceBack(R+ee[oe],R+ee[oe+1],R+ee[oe+2]);S.vertexLength+=D,S.primitiveLength+=ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,b,h)}}Jn(Wd,"FillBucket",{omit:["layers","patternFeatures"]});const wg=new tn({"fill-sort-key":new it(At.layout_fill["fill-sort-key"])});var qd={paint:new tn({"fill-antialias":new jt(At.paint_fill["fill-antialias"]),"fill-opacity":new it(At.paint_fill["fill-opacity"]),"fill-color":new it(At.paint_fill["fill-color"]),"fill-outline-color":new it(At.paint_fill["fill-outline-color"]),"fill-translate":new jt(At.paint_fill["fill-translate"]),"fill-translate-anchor":new jt(At.paint_fill["fill-translate-anchor"]),"fill-pattern":new pn(At.paint_fill["fill-pattern"])}),layout:wg};const ay=Nn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Cg=Nn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),ly=Nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:cy}=ay;var Kf=pd;function pd(n,e,i,a,h){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=a,this._values=h,n.readFields(Eg,this,e)}function Eg(n,e,i){1==n?e.id=i.readVarint():2==n?function(a,h){for(var g=a.readVarint()+a.pos;a.pos<g;){var b=h._keys[a.readVarint()],C=h._values[a.readVarint()];h.properties[b]=C}}(i,e):3==n?e.type=i.readVarint():4==n&&(e._geometry=i.pos)}function Xf(n){for(var e,i,a=0,h=0,g=n.length,b=g-1;h<g;b=h++)a+=((i=n[b]).x-(e=n[h]).x)*(e.y+i.y);return a}pd.types=["Unknown","Point","LineString","Polygon"],pd.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,a=1,h=0,g=0,b=0,C=[];n.pos<i;){if(h<=0){var D=n.readVarint();a=7&D,h=D>>3}if(h--,1===a||2===a)g+=n.readSVarint(),b+=n.readSVarint(),1===a&&(e&&C.push(e),e=[]),e.push(new ye(g,b));else{if(7!==a)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&C.push(e),C},pd.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,a=0,h=0,g=0,b=1/0,C=-1/0,D=1/0,S=-1/0;n.pos<e;){if(a<=0){var R=n.readVarint();i=7&R,a=R>>3}if(a--,1===i||2===i)(h+=n.readSVarint())<b&&(b=h),h>C&&(C=h),(g+=n.readSVarint())<D&&(D=g),g>S&&(S=g);else if(7!==i)throw new Error("unknown command "+i)}return[b,D,C,S]},pd.prototype.toGeoJSON=function(n,e,i){var a,h,g=this.extent*Math.pow(2,i),b=this.extent*n,C=this.extent*e,D=this.loadGeometry(),S=pd.types[this.type];function R(ee){for(var oe=0;oe<ee.length;oe++){var pe=ee[oe];ee[oe]=[360*(pe.x+b)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(pe.y+C)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(a=0;a<D.length;a++)V[a]=D[a][0];R(D=V);break;case 2:for(a=0;a<D.length;a++)R(D[a]);break;case 3:for(D=function(ee){var oe=ee.length;if(oe<=1)return[ee];for(var pe,Ie,Ne=[],at=0;at<oe;at++){var ot=Xf(ee[at]);0!==ot&&(void 0===Ie&&(Ie=ot<0),Ie===ot<0?(pe&&Ne.push(pe),pe=[ee[at]]):pe.push(ee[at]))}return pe&&Ne.push(pe),Ne}(D),a=0;a<D.length;a++)for(h=0;h<D[a].length;h++)R(D[a][h])}1===D.length?D=D[0]:S="Multi"+S;var U={type:"Feature",geometry:{type:S,coordinates:D},properties:this.properties};return"id"in this&&(U.id=this.id),U};var Qf=Rp;function Rp(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(uy,this,e),this.length=this._features.length}function uy(n,e,i){15===n?e.version=i.readVarint():1===n?e.name=i.readString():5===n?e.extent=i.readVarint():2===n?e._features.push(i.pos):3===n?e._keys.push(i.readString()):4===n&&e._values.push(function(a){for(var h=null,g=a.readVarint()+a.pos;a.pos<g;){var b=a.readVarint()>>3;h=1===b?a.readString():2===b?a.readFloat():3===b?a.readDouble():4===b?a.readVarint64():5===b?a.readVarint():6===b?a.readSVarint():7===b?a.readBoolean():null}return h}(i))}function Mg(n,e,i){if(3===n){var a=new Qf(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}Rp.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new Kf(this._pbf,e,this.extent,this._keys,this._values)};var Du={VectorTile:function(n,e){this.layers=n.readFields(Mg,{},e)},VectorTileFeature:Kf,VectorTileLayer:Qf};function Uh(n,e,i,a){const h=[],g=0===a?(b,C,D,S,R,V)=>{b.push(new ye(V,D+(V-C)/(S-C)*(R-D)))}:(b,C,D,S,R,V)=>{b.push(new ye(C+(V-D)/(R-D)*(S-C),V))};for(const b of n){const C=[];for(const D of b){if(D.length<=2)continue;const S=[];for(let U=0;U<D.length-1;U++){const ee=D[U].x,oe=D[U].y,pe=D[U+1].x,Ie=D[U+1].y,Ne=0===a?ee:oe,at=0===a?pe:Ie;Ne<e?at>e&&g(S,ee,oe,pe,Ie,e):Ne>i?at<i&&g(S,ee,oe,pe,Ie,i):S.push(D[U]),at<e&&Ne>=e&&g(S,ee,oe,pe,Ie,e),at>i&&Ne<=i&&g(S,ee,oe,pe,Ie,i)}let R=D[D.length-1];const V=0===a?R.x:R.y;V>=e&&V<=i&&S.push(R),S.length&&(R=S[S.length-1],S[0].x===R.x&&S[0].y===R.y||S.push(S[0]),C.push(S))}C.length&&h.push(C)}return h}const fd=Du.VectorTileFeature.types,Jf=Math.pow(2,13);function Yd(n,e,i,a,h,g,b,C){n.emplaceBack((e<<1)+b,(i<<1)+g,(Math.floor(a*Jf)<<1)+h,Math.round(C))}function jh(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class dy{constructor(){this.acc=new ye(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ye(e.x,e.y),this.max=new ye(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,h=this.max;e.x<a.x?a.x=e.x:e.x>h.x&&(h.x=e.x),e.y<a.y?a.y=e.y:e.y>h.y&&(h.y=e.y),((0===e.x||e.x===Ti)&&e.x===i.x)!=((0===e.y||e.y===Ti)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,nn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Ti!=e.x>Ti&&this.addBorderIntersection(1,nn(i.y,e.y,(Ti-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,nn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Ti!=e.y>Ti&&this.addBorderIntersection(3,nn(i.x,e.x,(Ti-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const a=0===e.x?0:1;this.addBorderIntersection(a,i.y),this.addBorderIntersection(a,e.y)}else{const a=0===e.y?2:3;this.addBorderIntersection(a,i.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((i,a)=>i+a.edges,0);return 0!==e?this.acc.div(e)._round():new ye(0,0)}span(){return new ye(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class Tu{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new pi,this.centroidVertexArray=new bf,this.indexArray=new sr,this.programConfigurations=new mu(e.layers,e.zoom),this.segments=new Io,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,a,h){this.features=[],this.hasPattern=Ml("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const b=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*b/(b*b+1)/Ti/(1<<g.z)}(a);for(const{feature:g,id:b,index:C,sourceLayerIndex:D}of e){const S=this.layers[0]._featureFilter.needGeometry,R=Vc(g,S);if(!this.layers[0]._featureFilter.filter(new ke(this.zoom),R,a))continue;const V={id:b,sourceLayerIndex:D,index:C,geometry:S?R.geometry:Nc(g,a,h),properties:g.properties,type:g.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(Vh("fill-extrusion",this.layers,V,this.zoom,i)):this.addFeature(V,V.geometry,C,a,{},i.availableImages,h),i.featureIndex.insert(g,V.geometry,C,D,this.index,U)}this.sortBorders()}addFeatures(e,i,a,h,g){for(const b of this.features){const{geometry:C}=b;this.addFeature(b,C,b.index,i,a,h,g)}this.sortBorders()}update(e,i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,ly.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Cg.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,h,g,b,C){const D=[new ye(0,0),new ye(Ti,Ti)],S=C.projection,R="globe"===S.name,V=this.enableTerrain&&!R?new dy:null;R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new eg);const U=kp(i,500);for(let pe=U.length-1;pe>=0;pe--){const Ie=U[pe];(0===Ie.length||(ee=Ie[0]).every(Ne=>Ne.x<=0)||ee.every(Ne=>Ne.x>=Ti)||ee.every(Ne=>Ne.y<=0)||ee.every(Ne=>Ne.y>=Ti))&&U.splice(pe,1)}var ee;let oe;if(R)oe=nm(U,D,h);else{oe=[];for(const pe of U)oe.push({polygon:pe,bounds:D})}for(const pe of oe){const Ie=pe.polygon;let Ne=0,at=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let Wt=0;Wt<Ie.length;Wt++){const Yt=Ie[Wt];if(0===Yt.length)continue;Ne+=Yt.length;let dn=0;V&&V.startRing(Yt[0]);for(let Tn=0;Tn<Yt.length;Tn++){const Vt=Yt[Tn];if(Tn>=1){const on=Yt[Tn-1];if(!em(Vt,on,pe.bounds)){V&&V.append(Vt,on),at.vertexLength+4>Io.MAX_VERTEX_ARRAY_LENGTH&&(at=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Sn=Vt.sub(on)._perp(),Dn=Sn.x/(Math.abs(Sn.x)+Math.abs(Sn.y)),Kn=Sn.y>0?1:0,wn=on.dist(Vt);dn+wn>32768&&(dn=0),Yd(this.layoutVertexArray,Vt.x,Vt.y,Dn,Kn,0,0,dn),Yd(this.layoutVertexArray,Vt.x,Vt.y,Dn,Kn,0,1,dn),dn+=wn,Yd(this.layoutVertexArray,on.x,on.y,Dn,Kn,0,0,dn),Yd(this.layoutVertexArray,on.x,on.y,Dn,Kn,0,1,dn);const $n=at.vertexLength;if(this.indexArray.emplaceBack($n,$n+2,$n+1),this.indexArray.emplaceBack($n+1,$n+2,$n+3),at.vertexLength+=4,at.primitiveLength+=2,R){const Hi=this.layoutVertexExtArray,qi=S.projectTilePoint(Vt.x,Vt.y,h),gi=S.projectTilePoint(on.x,on.y,h),Qn=S.upVector(h,Vt.x,Vt.y),lr=S.upVector(h,on.x,on.y);jh(Hi,qi,Qn),jh(Hi,qi,Qn),jh(Hi,gi,lr),jh(Hi,gi,lr)}}}}}if(at.vertexLength+Ne>Io.MAX_VERTEX_ARRAY_LENGTH&&(at=this.segments.prepareSegment(Ne,this.layoutVertexArray,this.indexArray)),"Polygon"!==fd[e.type])continue;const ot=[],yt=[],wt=at.vertexLength;for(let Wt=0;Wt<Ie.length;Wt++){const Yt=Ie[Wt];if(0!==Yt.length){Yt!==Ie[0]&&yt.push(ot.length/2);for(let dn=0;dn<Yt.length;dn++){const Tn=Yt[dn];Yd(this.layoutVertexArray,Tn.x,Tn.y,0,0,1,1,0),ot.push(Tn.x),ot.push(Tn.y),V&&V.currentPolyCount.top++,R&&jh(this.layoutVertexExtArray,S.projectTilePoint(Tn.x,Tn.y,h),S.upVector(h,Tn.x,Tn.y))}}}const It=Ap(ot,yt);for(let Wt=0;Wt<It.length;Wt+=3)this.indexArray.emplaceBack(wt+It[Wt],wt+It[Wt+2],wt+It[Wt+1]);at.primitiveLength+=It.length/3,at.vertexLength+=Ne}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const pe=V.borders,Ie=this.featuresOnBorder.push(V)-1;for(let Ne=0;Ne<4;Ne++)pe[Ne][0]!==Number.MAX_VALUE&&this.borders[Ne].push(Ie)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,b,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,a)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,i,a=!0){let h,g;if(e)if(0!==e.y){const C=i.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(C.x/10)),g=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else h=Math.ceil(7*(e.x+450)),g=0;else h=0,g=+a;let b=a?this.centroidVertexArray.length:i.vertexArrayOffset;for(const C of i.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let D=0;D<2*C.edges;D++)this.centroidVertexArray.emplace(b++,0,g),this.centroidVertexArray.emplace(b++,h,g);for(let D=0;D<C.top;D++)this.centroidVertexArray.emplace(b++,h,g)}}}function em(n,e,i){return n.x===e.x&&(n.x<i[0].x||n.x>i[1].x)||n.y===e.y&&(n.y<i[0].y||n.y>i[1].y)}function tm(){const n=Math.PI/32,e=Math.tan(n),i=If;return i*Math.sqrt(1+2*e*e)-i}function nm(n,e,i){const a=1<<i.z,h=Qs(i.x/a),g=Qs((i.x+1)/a),b=No(i.y/a),C=No((i.y+1)/a);return function(D,S,R,V,U=0,ee){const oe=[];if(!D.length||!R||!V)return oe;const pe=(It,Wt)=>{for(const Yt of It)oe.push({polygon:Yt,bounds:Wt})},Ie=Math.ceil(Math.log2(R)),Ne=Math.ceil(Math.log2(V)),at=Ie-Ne,ot=[];for(let It=0;It<Math.abs(at);It++)ot.push(at>0?0:1);for(let It=0;It<Math.min(Ie,Ne);It++)ot.push(0),ot.push(1);let yt=D;if(yt=Uh(yt,S[0].y-U,S[1].y+U,1),yt=Uh(yt,S[0].x-U,S[1].x+U,0),!yt.length)return oe;const wt=[];for(ot.length?wt.push({polygons:yt,bounds:S,depth:0}):pe(yt,S);wt.length;){const It=wt.pop(),Wt=It.depth,Yt=ot[Wt],dn=It.bounds[0],Tn=It.bounds[1],Vt=0===Yt?dn.x:dn.y,on=0===Yt?Tn.x:Tn.y,Sn=ee?ee(Yt,Vt,on):.5*(Vt+on),Dn=Uh(It.polygons,Vt-U,Sn+U,Yt),Kn=Uh(It.polygons,Sn-U,on+U,Yt);if(Dn.length){const wn=[dn,new ye(0===Yt?Sn:Tn.x,1===Yt?Sn:Tn.y)];ot.length>Wt+1?wt.push({polygons:Dn,bounds:wn,depth:Wt+1}):pe(Dn,wn)}if(Kn.length){const wn=[new ye(0===Yt?Sn:dn.x,1===Yt?Sn:dn.y),Tn];ot.length>Wt+1?wt.push({polygons:Kn,bounds:wn,depth:Wt+1}):pe(Kn,wn)}}return oe}(n,e,Math.ceil((g-h)/11.25),Math.ceil((b-C)/11.25),1,(D,S,R)=>{if(0===D)return.5*(S+R);{const V=No((i.y+S/Ti)/a);return(zc(.5*(No((i.y+R/Ti)/a)+V))*a-i.y)*Ti}})}Jn(Tu,"FillExtrusionBucket",{omit:["layers","features"]}),Jn(dy,"PartMetadata");var Dg={paint:new tn({"fill-extrusion-opacity":new jt(At["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new it(At["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jt(At["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jt(At["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new pn(At["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new it(At["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new it(At["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jt(At["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Kd(n,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[n*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Gh{constructor(e,i,a){this.z=e,this.x=i,this.y=a,this.key=Xd(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const a=(b=this.y,C=this.z,D=Kd(256*(g=this.x),256*(b=Math.pow(2,C)-b-1),C),S=Kd(256*(g+1),256*(b+1),C),D[0]+","+D[1]+","+S[0]+","+S[1]),h=function(g,b,C){let D,S="";for(let R=g;R>0;R--)D=1<<R-1,S+=(b&D?1:0)+(C&D?2:0);return S}(this.z,this.x,this.y);var g,b,C,D,S;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class md{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Xd(e,i.z,i.z,i.x,i.y)}}class Ds{constructor(e,i,a,h,g){this.overscaledZ=e,this.wrap=i,this.canonical=new Gh(a,+h,+g),this.key=0===i&&e===a?this.canonical.key:Xd(i,e,a,h,g)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Ds(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ds(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Xd(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Xd(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ds(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new Ds(i,this.wrap,i,a,h),new Ds(i,this.wrap,i,a+1,h),new Ds(i,this.wrap,i,a,h+1),new Ds(i,this.wrap,i,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ds(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ds(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new md(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Xd(n,e,i,a,h){const g=1<<Math.min(i,22);let b=g*(h%g)+a%g;return n&&i<22&&(b+=g*g*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*b+i)+(e-i)}function gd(n,e){return n.x*e.x+n.y*e.y}function im(n,e){if(1===n.length){let i=0;const a=e[i++];let h;for(;!h||a.equals(h);)if(h=e[i++],!h)return 1/0;for(;i<e.length;i++){const g=e[i],b=n[0],C=h.sub(a),D=g.sub(a),S=b.sub(a),R=gd(C,C),V=gd(C,D),U=gd(D,D),ee=gd(S,C),oe=gd(S,D),pe=R*U-V*V,Ie=(U*ee-V*oe)/pe,Ne=(R*oe-V*ee)/pe,at=a.z*(1-Ie-Ne)+h.z*Ie+g.z*Ne;if(isFinite(at))return at}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}function Qd(n){const e=new ye(n[0],n[1]);return e.z=n[2],e}function Jd(n,e,i,a,h,g,b,C){const D=b*h.getElevationAt(n,e,!0,!0),S=0!==g[0],R=S?0===g[1]?b*(g[0]/7-450):b*function(V,U,ee){const oe=Math.floor(U[0]/8),pe=Math.floor(U[1]/8),Ie=10*(U[0]-8*oe),Ne=10*(U[1]-8*pe),at=V.getElevationAt(oe,pe,!0,!0),ot=V.getMeterToDEM(ee),yt=Math.floor(.5*(Ie*ot-1)),wt=Math.floor(.5*(Ne*ot-1)),It=V.tileCoordToPixel(oe,pe),Wt=2*yt+1,Yt=2*wt+1,dn=(Hi=Wt,qi=Yt,[(Kn=V).getElevationAtPixel(wn=It.x-yt,$n=It.y-wt,!0),Kn.getElevationAtPixel(wn+qi,$n,!0),Kn.getElevationAtPixel(wn,$n+qi,!0),Kn.getElevationAtPixel(wn+Hi,$n+qi,!0)]),Tn=Math.abs(dn[0]-dn[1]),Vt=Math.abs(dn[2]-dn[3]),on=Math.abs(dn[0]-dn[2])+Math.abs(dn[1]-dn[3]),Sn=Math.min(.25,.5*ot*(Tn+Vt)/Wt),Dn=Math.min(.25,.5*ot*on/Yt);var Kn,wn,$n,Hi,qi;return at+Math.max(Sn*Ie,Dn*Ne)}(h,g,C):D;return{base:D+(0===i)?-1:i,top:S?Math.max(R+a,D+i+2):D+a}}Jn(Gh,"CanonicalTileID"),Jn(Ds,"OverscaledTileID",{omit:["projMatrix"]});const hy=Nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Tg}=hy,py=Nn([{name:"a_packed",components:4,type:"Float32"}]),{members:fy}=py,Sg=Du.VectorTileFeature.types,Lp=Math.cos(Math.PI/180*37.5);class eh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Gi,this.layoutVertexArray2=new mr,this.indexArray=new sr,this.programConfigurations=new mu(e.layers,e.zoom),this.segments=new Io,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,h){this.hasPattern=Ml("line",this.layers,i);const g=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:R,id:V,index:U,sourceLayerIndex:ee}of e){const oe=this.layers[0]._featureFilter.needGeometry,pe=Vc(R,oe);if(!this.layers[0]._featureFilter.filter(new ke(this.zoom),pe,a))continue;const Ie=g?g.evaluate(pe,{},a):void 0,Ne={id:V,properties:R.properties,type:R.type,sourceLayerIndex:ee,index:U,geometry:oe?pe.geometry:Nc(R,a,h),patterns:{},sortKey:Ie};b.push(Ne)}g&&b.sort((R,V)=>R.sortKey-V.sortKey);const{lineAtlas:C,featureIndex:D}=i,S=this.addConstantDashes(C);for(const R of b){const{geometry:V,index:U,sourceLayerIndex:ee}=R;if(S&&this.addFeatureDashes(R,C),this.hasPattern){const oe=Vh("line",this.layers,R,this.zoom,i);this.patternFeatures.push(oe)}else this.addFeature(R,V,U,a,C.positions,i.availableImages);D.insert(e[U].feature,V,U,ee,this.index)}}addConstantDashes(e){let i=!1;for(const a of this.layers){const h=a.paint.get("line-dasharray").value,g=a.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==g.kind)i=!0;else{const b=g.value,C=h.value;if(!C)continue;e.addDash(C.from,b),e.addDash(C.to,b),C.other&&e.addDash(C.other,b)}}return i}addFeatureDashes(e,i){const a=this.zoom;for(const h of this.layers){const g=h.paint.get("line-dasharray").value,b=h.layout.get("line-cap").value;if("constant"===g.kind&&"constant"===b.kind)continue;let C,D,S,R,V,U;if("constant"===g.kind){const Ie=g.value;if(!Ie)continue;C=Ie.other||Ie.to,D=Ie.to,S=Ie.from}else C=g.evaluate({zoom:a-1},e),D=g.evaluate({zoom:a},e),S=g.evaluate({zoom:a+1},e);"constant"===b.kind?R=V=U=b.value:(R=b.evaluate({zoom:a-1},e),V=b.evaluate({zoom:a},e),U=b.evaluate({zoom:a+1},e)),i.addDash(C,R),i.addDash(D,V),i.addDash(S,U);const ee=i.getKey(C,R),oe=i.getKey(D,V),pe=i.getKey(S,U);e.patterns[h.id]={min:ee,mid:oe,max:pe}}}update(e,i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,h)}addFeatures(e,i,a,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,i,a,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,fy)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,h,g,b){const C=this.layers[0].layout,D=C.get("line-join").evaluate(e,{}),S=C.get("line-cap").evaluate(e,{}),R=C.get("line-miter-limit"),V=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const U of i)this.addLine(U,e,D,S,R,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,b,h)}addLine(e,i,a,h,g,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ne=0;Ne<e.length-1;Ne++)this.totalDistance+=e[Ne].dist(e[Ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C="Polygon"===Sg[i.type];let D=e.length;for(;D>=2&&e[D-1].equals(e[D-2]);)D--;let S=0;for(;S<D-1&&e[S].equals(e[S+1]);)S++;if(D<(C?3:2))return;"bevel"===a&&(g=1.05);const R=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let U,ee,oe,pe,Ie;this.e1=this.e2=-1,C&&(U=e[D-2],Ie=e[S].sub(U)._unit()._perp());for(let Ne=S;Ne<D;Ne++){if(oe=Ne===D-1?C?e[S+1]:void 0:e[Ne+1],oe&&e[Ne].equals(oe))continue;Ie&&(pe=Ie),U&&(ee=U),U=e[Ne],Ie=oe?oe.sub(U)._unit()._perp():pe,pe=pe||Ie;let at=pe.add(Ie);0===at.x&&0===at.y||at._unit();const ot=pe.x*Ie.x+pe.y*Ie.y,yt=at.x*Ie.x+at.y*Ie.y,wt=0!==yt?1/yt:1/0,It=2*Math.sqrt(2-2*yt),Wt=yt<Lp&&ee&&oe,Yt=pe.x*Ie.y-pe.y*Ie.x>0;if(Wt&&Ne>S){const Vt=U.dist(ee);if(Vt>2*R){const on=U.sub(U.sub(ee)._mult(R/Vt)._round());this.updateDistance(ee,on),this.addCurrentVertex(on,pe,0,0,V),ee=on}}const dn=ee&&oe;let Tn=dn?a:C?"butt":h;if(dn&&"round"===Tn&&(wt<b?Tn="miter":wt<=2&&(Tn="fakeround")),"miter"===Tn&&wt>g&&(Tn="bevel"),"bevel"===Tn&&(wt>2&&(Tn="flipbevel"),wt<g&&(Tn="miter")),ee&&this.updateDistance(ee,U),"miter"===Tn)at._mult(wt),this.addCurrentVertex(U,at,0,0,V);else if("flipbevel"===Tn){if(wt>100)at=Ie.mult(-1);else{const Vt=wt*pe.add(Ie).mag()/pe.sub(Ie).mag();at._perp()._mult(Vt*(Yt?-1:1))}this.addCurrentVertex(U,at,0,0,V),this.addCurrentVertex(U,at.mult(-1),0,0,V)}else if("bevel"===Tn||"fakeround"===Tn){const Vt=-Math.sqrt(wt*wt-1),on=Yt?Vt:0,Sn=Yt?0:Vt;if(ee&&this.addCurrentVertex(U,pe,on,Sn,V),"fakeround"===Tn){const Dn=Math.round(180*It/Math.PI/20);for(let Kn=1;Kn<Dn;Kn++){let wn=Kn/Dn;if(.5!==wn){const Hi=wn-.5;wn+=wn*Hi*(wn-1)*((1.0904+ot*(ot*(3.55645-1.43519*ot)-3.2452))*Hi*Hi+(.848013+ot*(.215638*ot-1.06021)))}const $n=Ie.sub(pe)._mult(wn)._add(pe)._unit()._mult(Yt?-1:1);this.addHalfVertex(U,$n.x,$n.y,!1,Yt,0,V)}}oe&&this.addCurrentVertex(U,Ie,-on,-Sn,V)}else if("butt"===Tn)this.addCurrentVertex(U,at,0,0,V);else if("square"===Tn){const Vt=ee?1:-1;ee||this.addCurrentVertex(U,at,Vt,Vt,V),this.addCurrentVertex(U,at,0,0,V),ee&&this.addCurrentVertex(U,at,Vt,Vt,V)}else"round"===Tn&&(ee&&(this.addCurrentVertex(U,pe,0,0,V),this.addCurrentVertex(U,pe,1,1,V,!0)),oe&&(this.addCurrentVertex(U,Ie,-1,-1,V,!0),this.addCurrentVertex(U,Ie,0,0,V)));if(Wt&&Ne<D-1){const Vt=U.dist(oe);if(Vt>2*R){const on=U.add(oe.sub(U)._mult(R/Vt)._round());this.updateDistance(U,on),this.addCurrentVertex(on,Ie,0,0,V),U=on}}}}addCurrentVertex(e,i,a,h,g,b=!1){const C=i.y*h-i.x,D=-i.y-i.x*h;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,b,!1,a,g),this.addHalfVertex(e,C,D,b,!0,-h,g)}addHalfVertex({x:e,y:i},a,h,g,b,C,D){this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(i<<1)+(b?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(0===C?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const S=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,S),D.primitiveLength++),b?this.e2=S:this.e1=S}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}Jn(eh,"LineBucket",{omit:["layers","patternFeatures"]});const my=new tn({"line-cap":new it(At.layout_line["line-cap"]),"line-join":new it(At.layout_line["line-join"]),"line-miter-limit":new jt(At.layout_line["line-miter-limit"]),"line-round-limit":new jt(At.layout_line["line-round-limit"]),"line-sort-key":new it(At.layout_line["line-sort-key"])});var rm={paint:new tn({"line-opacity":new it(At.paint_line["line-opacity"]),"line-color":new it(At.paint_line["line-color"]),"line-translate":new jt(At.paint_line["line-translate"]),"line-translate-anchor":new jt(At.paint_line["line-translate-anchor"]),"line-width":new it(At.paint_line["line-width"]),"line-gap-width":new it(At.paint_line["line-gap-width"]),"line-offset":new it(At.paint_line["line-offset"]),"line-blur":new it(At.paint_line["line-blur"]),"line-dasharray":new pn(At.paint_line["line-dasharray"]),"line-pattern":new pn(At.paint_line["line-pattern"]),"line-gradient":new Un(At.paint_line["line-gradient"]),"line-trim-offset":new jt(At.paint_line["line-trim-offset"])}),layout:my};const Ag=new class extends it{possiblyEvaluate(n,e){return e=new ke(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,a){return e=Qe({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,a)}}(rm.paint.properties["line-width"].specification);function om(n,e){return e>0?e+2*n:n}Ag.useIntegerZoom=!0;const gy=Nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ig=Nn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Yl=Nn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _y=Nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Hh=Nn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Pg=Nn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Og=Nn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Nn([{name:"triangle",components:3,type:"Uint16"}]),Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Nn([{type:"Float32",name:"offsetX"}]),Nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const yc=128;function Fp(n,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ke(n+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:a,interpolationType:h}=i;let g=0;for(;g<a.length&&a[g]<=n;)g++;g=Math.max(0,g-1);let b=g;for(;b<a.length&&a[b]<n+1;)b++;b=Math.min(a.length-1,b);const C=a[g],D=a[b];return"composite"===i.kind?{kind:"composite",minZoom:C,maxZoom:D,interpolationType:h}:{kind:"camera",minZoom:C,maxZoom:D,minSize:i.evaluate(new ke(C)),maxSize:i.evaluate(new ke(D)),interpolationType:h}}}function Bp(n,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:h}){return"source"===n.kind?a/yc:"composite"===n.kind?nn(a/yc,h/yc,i):e}function th(n,e){let i=0,a=0;if("constant"===n.kind)a=n.layoutSize;else if("source"!==n.kind){const{interpolationType:h,minZoom:g,maxZoom:b}=n,C=h?St(Ar.interpolationFactor(h,e,g,b),0,1):0;"camera"===n.kind?a=nn(n.minSize,n.maxSize,C):i=C}return{uSizeT:i,uSize:a}}var yy=Object.freeze({__proto__:null,getSizeData:Fp,evaluateSizeForFeature:Bp,evaluateSizeForZoom:th,SIZE_PACK_FACTOR:yc});function ar(n,e,i){return n.sections.forEach(a=>{a.text=function(h,g,b){const C=g.layout.get("text-transform").evaluate(b,{});return"uppercase"===C?h=h.toLocaleUpperCase():"lowercase"===C&&(h=h.toLocaleLowerCase()),Ee.applyArabicShaping&&(h=Ee.applyArabicShaping(h)),h}(a.text,e,i)}),n}const nh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function kg(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function Rg(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var Lg=function(n,e,i,a,h){var g,b,C=8*h-a-1,D=(1<<C)-1,S=D>>1,R=-7,V=i?h-1:0,U=i?-1:1,ee=n[e+V];for(V+=U,g=ee&(1<<-R)-1,ee>>=-R,R+=C;R>0;g=256*g+n[e+V],V+=U,R-=8);for(b=g&(1<<-R)-1,g>>=-R,R+=a;R>0;b=256*b+n[e+V],V+=U,R-=8);if(0===g)g=1-S;else{if(g===D)return b?NaN:1/0*(ee?-1:1);b+=Math.pow(2,a),g-=S}return(ee?-1:1)*b*Math.pow(2,g-a)},Fg=function(n,e,i,a,h,g){var b,C,D,S=8*g-h-1,R=(1<<S)-1,V=R>>1,U=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,ee=a?0:g-1,oe=a?1:-1,pe=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(C=isNaN(e)?1:0,b=R):(b=Math.floor(Math.log(e)/Math.LN2),e*(D=Math.pow(2,-b))<1&&(b--,D*=2),(e+=b+V>=1?U/D:U*Math.pow(2,1-V))*D>=2&&(b++,D/=2),b+V>=R?(C=0,b=R):b+V>=1?(C=(e*D-1)*Math.pow(2,h),b+=V):(C=e*Math.pow(2,V-1)*Math.pow(2,h),b=0));h>=8;n[i+ee]=255&C,ee+=oe,C/=256,h-=8);for(b=b<<h|C,S+=h;S>0;n[i+ee]=255&b,ee+=oe,b/=256,S-=8);n[i+ee-oe]|=128*pe},ih=$r;function $r(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}$r.Varint=0,$r.Fixed64=1,$r.Bytes=2,$r.Fixed32=5;var zp=4294967296,Bg=1/zp,zg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Su(n){return n.type===$r.Bytes?n.readVarint()+n.pos:n.pos+1}function sm(n,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var h=i.pos-1;h>=n;h--)i.buf[h+a]=i.buf[h]}function yd(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function vy(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function am(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function lm(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function by(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function Ev(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function Mv(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function Dv(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function xy(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function $h(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Zh(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function Ng(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function rh(n,e,i){e.glyphs=[],1===n&&i.readMessage(Vg,e)}function Vg(n,e,i){if(3===n){const{id:a,bitmap:h,width:g,height:b,left:C,top:D,advance:S}=i.readMessage(Ug,{});e.glyphs.push({id:a,bitmap:new Vo({width:g+6,height:b+6},h),metrics:{width:g,height:b,left:C,top:D,advance:S}})}else 4===n?e.ascender=i.readSVarint():5===n&&(e.descender=i.readSVarint())}function Ug(n,e,i){1===n?e.id=i.readVarint():2===n?e.bitmap=i.readBytes():3===n?e.width=i.readVarint():4===n?e.height=i.readVarint():5===n?e.left=i.readSVarint():6===n?e.top=i.readSVarint():7===n&&(e.advance=i.readVarint())}function Hc(n){let e=0,i=0;for(const b of n)e+=b.w*b.h,i=Math.max(i,b.w);n.sort((b,C)=>C.h-b.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let h=0,g=0;for(const b of n)for(let C=a.length-1;C>=0;C--){const D=a[C];if(!(b.w>D.w||b.h>D.h)){if(b.x=D.x,b.y=D.y,g=Math.max(g,b.y+b.h),h=Math.max(h,b.x+b.w),b.w===D.w&&b.h===D.h){const S=a.pop();C<a.length&&(a[C]=S)}else b.h===D.h?(D.x+=b.w,D.w-=b.w):b.w===D.w?(D.y+=b.h,D.h-=b.h):(a.push({x:D.x+b.w,y:D.y,w:D.w-b.w,h:b.h}),D.y+=b.h,D.h-=b.h);break}}return{w:h,h:g,fill:e/(h*g)||0}}$r.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),h=a>>3,g=this.pos;this.type=7&a,n(h,e,this),this.pos===g&&this.skip(a)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=$h(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Ng(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=$h(this.buf,this.pos)+$h(this.buf,this.pos+4)*zp;return this.pos+=8,n},readSFixed64:function(){var n=$h(this.buf,this.pos)+Ng(this.buf,this.pos+4)*zp;return this.pos+=8,n},readFloat:function(){var n=Lg(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Lg(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(h,g,b){var C,D,S=b.buf;if(C=(112&(D=S[b.pos++]))>>4,D<128||(C|=(127&(D=S[b.pos++]))<<3,D<128)||(C|=(127&(D=S[b.pos++]))<<10,D<128)||(C|=(127&(D=S[b.pos++]))<<17,D<128)||(C|=(127&(D=S[b.pos++]))<<24,D<128)||(C|=(1&(D=S[b.pos++]))<<31,D<128))return function _d(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(h,C,g);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&zg?zg.decode(this.buf.subarray(e,n)):function(i,a,h){for(var g="",b=a;b<h;){var C,D,S,R=i[b],V=null,U=R>239?4:R>223?3:R>191?2:1;if(b+U>h)break;1===U?R<128&&(V=R):2===U?128==(192&(C=i[b+1]))&&(V=(31&R)<<6|63&C)<=127&&(V=null):3===U?(D=i[b+2],128==(192&(C=i[b+1]))&&128==(192&D)&&((V=(15&R)<<12|(63&C)<<6|63&D)<=2047||V>=55296&&V<=57343)&&(V=null)):4===U&&(D=i[b+2],S=i[b+3],128==(192&(C=i[b+1]))&&128==(192&D)&&128==(192&S)&&((V=(15&R)<<18|(63&C)<<12|(63&D)<<6|63&S)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,U=1):V>65535&&(V-=65536,g+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),g+=String.fromCharCode(V),b+=U}return g}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==$r.Bytes)return n.push(this.readVarint(e));var i=Su(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==$r.Bytes)return n.push(this.readSVarint());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==$r.Bytes)return n.push(this.readBoolean());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==$r.Bytes)return n.push(this.readFloat());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==$r.Bytes)return n.push(this.readDouble());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==$r.Bytes)return n.push(this.readFixed32());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==$r.Bytes)return n.push(this.readSFixed32());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==$r.Bytes)return n.push(this.readFixed64());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==$r.Bytes)return n.push(this.readSFixed64());var e=Su(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===$r.Varint)for(;this.buf[this.pos++]>127;);else if(e===$r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===$r.Fixed32)this.pos+=4;else{if(e!==$r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Zh(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Zh(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Zh(this.buf,-1&n,this.pos),Zh(this.buf,Math.floor(n*Bg),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Zh(this.buf,-1&n,this.pos),Zh(this.buf,Math.floor(n*Bg),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var a,h,g,C;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),g=a,(C=i).buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,C.buf[C.pos]=127&(g>>>=7),function(g,b){var C=(7&g)<<4;b.buf[b.pos++]|=C|((g>>>=3)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g)))))}(h,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(a,h,g){for(var b,C,D=0;D<h.length;D++){if((b=h.charCodeAt(D))>55295&&b<57344){if(!C){b>56319||D+1===h.length?(a[g++]=239,a[g++]=191,a[g++]=189):C=b;continue}if(b<56320){a[g++]=239,a[g++]=191,a[g++]=189,C=b;continue}b=C-55296<<10|b-56320|65536,C=null}else C&&(a[g++]=239,a[g++]=191,a[g++]=189,C=null);b<128?a[g++]=b:(b<2048?a[g++]=b>>6|192:(b<65536?a[g++]=b>>12|224:(a[g++]=b>>18|240,a[g++]=b>>12&63|128),a[g++]=b>>6&63|128),a[g++]=63&b|128)}return g}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&sm(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),Fg(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),Fg(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var a=this.pos-i;a>=128&&sm(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(n,e,i){this.writeTag(n,$r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,yd,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,vy,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,by,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,am,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,lm,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,Ev,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,Mv,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,Dv,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,xy,e)},writeBytesField:function(n,e){this.writeTag(n,$r.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,$r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,$r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,$r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,$r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,$r.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,$r.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,$r.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,$r.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,$r.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};class cm{constructor(e,{pixelRatio:i,version:a,stretchX:h,stretchY:g,content:b}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=g,this.content=b,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class um{constructor(e,i){const a={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,a,g),this.addImages(i,h,g);const{w:b,h:C}=Hc(g),D=new ga({width:b||1,height:C||1});for(const S in e){const R=e[S],V=a[S].paddedRect;ga.copy(R.data,D,{x:0,y:0},{x:V.x+1,y:V.y+1},R.data)}for(const S in i){const R=i[S],V=h[S].paddedRect,U=V.x+1,ee=V.y+1,oe=R.data.width,pe=R.data.height;ga.copy(R.data,D,{x:0,y:0},{x:U,y:ee},R.data),ga.copy(R.data,D,{x:0,y:pe-1},{x:U,y:ee-1},{width:oe,height:1}),ga.copy(R.data,D,{x:0,y:0},{x:U,y:ee+pe},{width:oe,height:1}),ga.copy(R.data,D,{x:oe-1,y:0},{x:U-1,y:ee},{width:1,height:pe}),ga.copy(R.data,D,{x:0,y:0},{x:U+oe,y:ee},{width:1,height:pe})}this.image=D,this.iconPositions=a,this.patternPositions=h}addImages(e,i,a){for(const h in e){const g=e[h],b={x:0,y:0,w:g.data.width+2,h:g.data.height+2};a.push(b),i[h]=new cm(b,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[h,g]=e.tl;a.update(i.data,void 0,{x:h,y:g})}}Jn(cm,"ImagePosition"),Jn(um,"ImageAtlas");const fl={horizontal:1,vertical:2,horizontalOnly:3};class Wh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new Wh;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new Wh;return i.imageName=e,i}}class oh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new oh;for(let h=0;h<e.sections.length;h++){const g=e.sections[h];g.image?a.addImageSection(g):a.addTextSection(g,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,a){let h="";for(let g=0;g<i.length;g++){const b=i.charCodeAt(g+1)||null,C=i.charCodeAt(g-1)||null;h+=!a&&(b&&u(b)&&!nh[i[g+1]]||C&&u(C)&&!nh[i[g-1]])||!nh[i[g]]?i[g]:nh[i[g]]}return h}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&Np[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Np[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new oh;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(Wh.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void Yn("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Wh.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Yn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function dm(n,e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe){const Ie=oh.fromFeature(n,h);let Ne;V===fl.vertical&&Ie.verticalizePunctuation(U);const{processBidirectionalText:at,processStyledBidirectionalText:ot}=Ee;if(at&&1===Ie.sections.length){Ne=[];const It=at(Ie.toString(),sh(Ie,S,g,e,a,ee,oe));for(const Wt of It){const Yt=new oh;Yt.text=Wt,Yt.sections=Ie.sections;for(let dn=0;dn<Wt.length;dn++)Yt.sectionIndex.push(0);Ne.push(Yt)}}else if(ot){Ne=[];const It=ot(Ie.text,Ie.sectionIndex,sh(Ie,S,g,e,a,ee,oe));for(const Wt of It){const Yt=new oh;Yt.text=Wt[0],Yt.sectionIndex=Wt[1],Yt.sections=Ie.sections,Ne.push(Yt)}}else Ne=function(It,Wt){const Yt=[],dn=It.text;let Tn=0;for(const Vt of Wt)Yt.push(It.substring(Tn,Vt)),Tn=Vt;return Tn<dn.length&&Yt.push(It.substring(Tn,dn.length)),Yt}(Ie,sh(Ie,S,g,e,a,ee,oe));const yt=[],wt={positionedLines:yt,text:Ie.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(It,Wt,Yt,dn,Tn,Vt,on,Sn,Dn,Kn,wn,$n){let Hi=0,qi=0,gi=0;const Qn="right"===Sn?1:"left"===Sn?0:.5;let lr=!1;for(const er of Tn){const pr=er.getSections();for(const Nr of pr){if(Nr.imageName)continue;const Pr=Wt[Nr.fontStack];if(Pr&&(lr=void 0!==Pr.ascender&&void 0!==Pr.descender,!lr))break}if(!lr)break}let $i=0;for(const er of Tn){er.trim();const pr=er.getMaxScale(),Nr=24*(pr-1),Pr={positionedGlyphs:[],lineOffset:0};It.positionedLines[$i]=Pr;const Or=Pr.positionedGlyphs;let Yr=0;if(!er.length()){qi+=Vt,++$i;continue}let Kr=0,ts=0;for(let dr=0;dr<er.length();dr++){const go=er.getSection(dr),zs=er.getSectionIndex(dr),Mr=er.getCharCode(dr);let ho=go.scale,na=null,_i=null,wo=null,ns=24,is=0;const Ts=!(Dn===fl.horizontal||!wn&&!t(Mr)||wn&&(Np[Mr]||(ai=Mr,Nl(ai)||Eh(ai)||dc(ai)||ms(ai)||Ul(ai))));if(go.imageName){const ia=dn[go.imageName];if(!ia)continue;wo=go.imageName,It.iconsInText=It.iconsInText||!0,_i=ia.paddedRect;const rs=ia.displaySize;ho=24*ho/$n,na={width:rs[0],height:rs[1],left:1,top:-3,advance:Ts?rs[1]:rs[0],localGlyph:!1},is=lr?-na.height*ho:24*pr-17-rs[1]*ho,ns=na.advance;const Ql=(Ts?rs[0]:rs[1])*ho-24*pr;Ql>0&&Ql>Yr&&(Yr=Ql)}else{const ia=Yt[go.fontStack];if(!ia)continue;ia[Mr]&&(_i=ia[Mr]);const rs=Wt[go.fontStack];if(!rs)continue;const Ql=rs.glyphs[Mr];if(!Ql)continue;if(na=Ql.metrics,ns=8203!==Mr?24:0,lr){const Sd=void 0!==rs.ascender?Math.abs(rs.ascender):0,Ad=void 0!==rs.descender?Math.abs(rs.descender):0,yh=(Sd+Ad)*ho;Kr<yh&&(Kr=yh,ts=(Sd-Ad)/2*ho),is=-Sd*ho}else is=24*(pr-ho)-17}Ts?(It.verticalizable=!0,Or.push({glyph:Mr,imageName:wo,x:Hi,y:qi+is,vertical:Ts,scale:ho,localGlyph:na.localGlyph,fontStack:go.fontStack,sectionIndex:zs,metrics:na,rect:_i}),Hi+=ns*ho+Kn):(Or.push({glyph:Mr,imageName:wo,x:Hi,y:qi+is,vertical:Ts,scale:ho,localGlyph:na.localGlyph,fontStack:go.fontStack,sectionIndex:zs,metrics:na,rect:_i}),Hi+=na.advance*ho+Kn)}0!==Or.length&&(gi=Math.max(Hi-Kn,gi),lr?Zg(Or,Qn,Yr,ts,Vt*pr/2):Zg(Or,Qn,Yr,0,Vt/2)),Hi=0;const Ia=Vt*pr+Yr;Pr.lineOffset=Math.max(Yr,Nr),qi+=Ia,++$i}var ai;const Oo=qi,{horizontalAlign:ko,verticalAlign:ro}=hm(on);(function(er,pr,Nr,Pr,Or,Yr){const Kr=(pr-Nr)*Or,ts=-Yr*Pr;for(const Ia of er)for(const dr of Ia.positionedGlyphs)dr.x+=Kr,dr.y+=ts})(It.positionedLines,Qn,ko,ro,gi,Oo),It.top+=-ro*Oo,It.bottom=It.top+Oo,It.left+=-ko*gi,It.right=It.left+gi,It.hasBaseline=lr}(wt,e,i,a,Ne,b,C,D,V,S,U,pe),!function(It){for(const Wt of It)if(0!==Wt.positionedGlyphs.length)return!1;return!0}(yt)&&wt}const Np={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jg={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Gg(n,e,i,a,h,g){if(e.imageName){const b=a[e.imageName];return b?b.displaySize[0]*e.scale*24/g+h:0}{const b=i[e.fontStack],C=b&&b.glyphs[n];return C?C.metrics.advance*e.scale+h:0}}function qh(n,e,i,a){const h=Math.pow(n-e,2);return a?n<e?h/2:2*h:h+Math.abs(i)*i}function Hg(n,e,i){let a=0;return 10===n&&(a-=1e4),i&&(a+=150),40!==n&&65288!==n||(a+=50),41!==e&&65289!==e||(a+=50),a}function Vp(n,e,i,a,h,g){let b=null,C=qh(e,i,h,g);for(const D of a){const S=qh(e-D.x,i,h,g)+D.badness;S<=C&&(b=D,C=S)}return{index:n,x:e,priorBreak:b,badness:C}}function $g(n){return n?$g(n.priorBreak).concat(n.index):[]}function sh(n,e,i,a,h,g,b){if("point"!==g)return[];if(!n)return[];const C=[],D=function(U,ee,oe,pe,Ie,Ne){let at=0;for(let ot=0;ot<U.length();ot++){const yt=U.getSection(ot);at+=Gg(U.getCharCode(ot),yt,pe,Ie,ee,Ne)}return at/Math.max(1,Math.ceil(at/oe))}(n,e,i,a,h,b),S=n.text.indexOf("\u200b")>=0;let R=0;for(let U=0;U<n.length();U++){const ee=n.getSection(U),oe=n.getCharCode(U);if(Np[oe]||(R+=Gg(oe,ee,a,h,e,b)),U<n.length()-1){const pe=!((V=oe)<11904||!(H(V)||O(V)||Rs(V)||Jo(V)||pt(V)||To(V)||Q(V)||Fd(V)||an(V)||ni(V)||qe(V)||Ku(V)||F(V)||qa(V)||du(V)||ge(V)||L(V)||Vl(V)||di(V)||ur(V)));(jg[oe]||pe||ee.imageName)&&C.push(Vp(U+1,R,D,C,Hg(oe,n.getCharCode(U+1),pe&&S),!1))}}var V;return $g(Vp(n.length(),R,D,C,0,!0))}function hm(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Zg(n,e,i,a,h){if(!(e||i||a||h))return;const g=n.length-1,b=n[g],C=(b.x+b.metrics.advance*b.scale)*e;for(let D=0;D<=g;D++)n[D].x-=C,n[D].y+=i+a+h}function vd(n,e,i){const{horizontalAlign:a,verticalAlign:h}=hm(i),g=e[0]-n.displaySize[0]*a,b=e[1]-n.displaySize[1]*h;return{image:n,top:b,bottom:b+n.displaySize[1],left:g,right:g+n.displaySize[0]}}function pm(n,e,i,a,h,g){const b=n.image;let C;if(b.content){const Ie=b.content,Ne=b.pixelRatio||1;C=[Ie[0]/Ne,Ie[1]/Ne,b.displaySize[0]-Ie[2]/Ne,b.displaySize[1]-Ie[3]/Ne]}const D=e.left*g,S=e.right*g;let R,V,U,ee;"width"===i||"both"===i?(ee=h[0]+D-a[3],V=h[0]+S+a[1]):(ee=h[0]+(D+S-b.displaySize[0])/2,V=ee+b.displaySize[0]);const oe=e.top*g,pe=e.bottom*g;return"height"===i||"both"===i?(R=h[1]+oe-a[0],U=h[1]+pe+a[2]):(R=h[1]+(oe+pe-b.displaySize[1])/2,U=R+b.displaySize[1]),{image:b,top:R,right:V,bottom:U,left:ee,collisionPadding:C}}class vc extends ye{constructor(e,i,a,h,g){super(e,i),this.angle=h,this.z=a,void 0!==g&&(this.segment=g)}clone(){return new vc(this.x,this.y,this.z,this.angle,this.segment)}}function Yh(n,e,i,a,h){if(void 0===e.segment)return!0;let g=e,b=e.segment+1,C=0;for(;C>-i/2;){if(b--,b<0)return!1;C-=n[b].dist(g),g=n[b]}C+=n[b].dist(n[b+1]),b++;const D=[];let S=0;for(;C<i/2;){const R=n[b],V=n[b+1];if(!V)return!1;let U=n[b-1].angleTo(R)-R.angleTo(V);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:C,angleDelta:U}),S+=U;C-D[0].distance>a;)S-=D.shift().angleDelta;if(S>h)return!1;b++,C+=R.dist(V)}return!0}function Dl(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function fm(n,e,i){return n?.6*e*i:0}function Wg(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function mm(n,e,i,a,h,g){const b=fm(i,h,g),C=Wg(i,a)*g;let D=0;const S=Dl(n)/2;for(let R=0;R<n.length-1;R++){const V=n[R],U=n[R+1],ee=V.dist(U);if(D+ee>S){const oe=(S-D)/ee,pe=nn(V.x,U.x,oe),Ie=nn(V.y,U.y,oe),Ne=new vc(pe,Ie,0,U.angleTo(V),R);return!b||Yh(n,Ne,C,b,e)?Ne:void 0}D+=ee}}function bc(n,e,i,a,h,g,b,C,D){const S=fm(a,g,b),R=Wg(a,h),V=R*b,U=0===n[0].x||n[0].x===D||0===n[0].y||n[0].y===D;return e-V<e/4&&(e=V+e/4),Up(n,U?e/2*C%e:(R/2+2*g)*b*C%e,e,S,i,V,U,!1,D)}function Up(n,e,i,a,h,g,b,C,D){const S=g/2,R=Dl(n);let V=0,U=e-i,ee=[];for(let oe=0;oe<n.length-1;oe++){const pe=n[oe],Ie=n[oe+1],Ne=pe.dist(Ie),at=Ie.angleTo(pe);for(;U+i<V+Ne;){U+=i;const ot=(U-V)/Ne,yt=nn(pe.x,Ie.x,ot),wt=nn(pe.y,Ie.y,ot);if(yt>=0&&yt<D&&wt>=0&&wt<D&&U-S>=0&&U+S<=R){const It=new vc(yt,wt,0,at,oe);It._round(),a&&!Yh(n,It,g,a,h)||ee.push(It)}}V+=Ne}return C||ee.length||b||(ee=Up(n,V/2,i,a,h,g,b,!0,D)),ee}function gm(n,e,i,a,h){const g=[];for(let b=0;b<n.length;b++){const C=n[b];let D;for(let S=0;S<C.length-1;S++){let R=C[S],V=C[S+1];R.x<e&&V.x<e||(R.x<e?R=new ye(e,R.y+(e-R.x)/(V.x-R.x)*(V.y-R.y))._round():V.x<e&&(V=new ye(e,R.y+(e-R.x)/(V.x-R.x)*(V.y-R.y))._round()),R.y<i&&V.y<i||(R.y<i?R=new ye(R.x+(i-R.y)/(V.y-R.y)*(V.x-R.x),i)._round():V.y<i&&(V=new ye(R.x+(i-R.y)/(V.y-R.y)*(V.x-R.x),i)._round()),R.x>=a&&V.x>=a||(R.x>=a?R=new ye(a,R.y+(a-R.x)/(V.x-R.x)*(V.y-R.y))._round():V.x>=a&&(V=new ye(a,R.y+(a-R.x)/(V.x-R.x)*(V.y-R.y))._round()),R.y>=h&&V.y>=h||(R.y>=h?R=new ye(R.x+(h-R.y)/(V.y-R.y)*(V.x-R.x),h)._round():V.y>=h&&(V=new ye(R.x+(h-R.y)/(V.y-R.y)*(V.x-R.x),h)._round()),D&&R.equals(D[D.length-1])||(D=[R],g.push(D)),D.push(V)))))}}return g}Jn(vc,"Anchor");const Au=1e20;function wy(n,e,i,a,h,g,b,C,D){for(let S=e;S<e+a;S++)_m(n,i*g+S,g,h,b,C,D);for(let S=i;S<i+h;S++)_m(n,S*g+e,1,a,b,C,D)}function _m(n,e,i,a,h,g,b){g[0]=0,b[0]=-Au,b[1]=Au,h[0]=n[e];for(let C=1,D=0,S=0;C<a;C++){h[C]=n[e+C*i];const R=C*C;do{const V=g[D];S=(h[C]-h[V]+R-V*V)/(C-V)/2}while(S<=b[D]&&--D>-1);D++,g[D]=C,b[D]=S,b[D+1]=Au}for(let C=0,D=0;C<a;C++){for(;b[D+1]<C;)D++;const S=g[D],R=C-S;n[e+C*i]=h[S]+R*R}}const qg={none:0,ideographs:1,all:2};class $c{constructor(e,i,a){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const a=[];for(const h in e)for(const g of e[h])a.push({stack:h,id:g});Xt(a,({stack:h,id:g},b)=>{let C=this.entries[h];C||(C=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=C.glyphs[g];if(void 0!==D)return void b(null,{stack:h,id:g,glyph:D});if(D=this._tinySDF(C,h,g),D)return C.glyphs[g]=D,void b(null,{stack:h,id:g,glyph:D});const S=Math.floor(g/256);if(256*S>65535)return void b(new Error("glyphs > 65535 not supported"));if(C.ranges[S])return void b(null,{stack:h,id:g,glyph:D});let R=C.requests[S];R||(R=C.requests[S]=[],$c.loadGlyphRange(h,S,this.url,this.requestManager,(V,U)=>{if(U){C.ascender=U.ascender,C.descender=U.descender;for(const ee in U.glyphs)this._doesCharSupportLocalGlyph(+ee)||(C.glyphs[+ee]=U.glyphs[+ee]);C.ranges[S]=!0}for(const ee of R)ee(V,U);delete C.requests[S]})),R.push((V,U)=>{V?b(V):U&&b(null,{stack:h,id:g,glyph:U.glyphs[g]||null})})},(h,g)=>{if(h)i(h);else if(g){const b={};for(const{stack:C,id:D,glyph:S}of g)void 0===b[C]&&(b[C]={}),void 0===b[C].glyphs&&(b[C].glyphs={}),b[C].glyphs[D]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},b[C].ascender=this.entries[C].ascender,b[C].descender=this.entries[C].descender;i(null,b)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==qg.none&&(this.localGlyphMode===qg.all?!!this.localFontFamily:!!this.localFontFamily&&(ni(e)||rr(e)||F(e)||L(e)||Fd(e)))}_tinySDF(e,i,a){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(a))return;let g=e.tinySDF;if(!g){let pe="400";/bold/i.test(i)?pe="900":/medium/i.test(i)?pe="500":/light/i.test(i)&&(pe="200"),g=e.tinySDF=new $c.TinySDF({fontFamily:h,fontWeight:pe,fontSize:48,buffer:6,radius:16}),g.fontWeight=pe}if(this.localGlyphs[g.fontWeight][a])return this.localGlyphs[g.fontWeight][a];const b=String.fromCharCode(a),{data:C,width:D,height:S,glyphWidth:R,glyphHeight:V,glyphLeft:U,glyphTop:ee,glyphAdvance:oe}=g.draw(b);return this.localGlyphs[g.fontWeight][a]={id:a,bitmap:new Vo({width:D,height:S},C),metrics:{width:R/2,height:V/2,left:U/2,top:ee/2-27,advance:oe/2,localGlyph:!0}}}}function Kh(n,e,i,a){const h=[],g=n.image,b=g.pixelRatio,C=g.paddedRect.w-2,D=g.paddedRect.h-2,S=n.right-n.left,R=n.bottom-n.top,V=g.stretchX||[[0,C]],U=g.stretchY||[[0,D]],ee=(Vt,on)=>Vt+on[1]-on[0],oe=V.reduce(ee,0),pe=U.reduce(ee,0),Ie=C-oe,Ne=D-pe;let at=0,ot=oe,yt=0,wt=pe,It=0,Wt=Ie,Yt=0,dn=Ne;if(g.content&&a){const Vt=g.content;at=ah(V,0,Vt[0]),yt=ah(U,0,Vt[1]),ot=ah(V,Vt[0],Vt[2]),wt=ah(U,Vt[1],Vt[3]),It=Vt[0]-at,Yt=Vt[1]-yt,Wt=Vt[2]-Vt[0]-ot,dn=Vt[3]-Vt[1]-wt}const Tn=(Vt,on,Sn,Dn)=>{const Kn=lh(Vt.stretch-at,ot,S,n.left),wn=ym(Vt.fixed-It,Wt,Vt.stretch,oe),$n=lh(on.stretch-yt,wt,R,n.top),Hi=ym(on.fixed-Yt,dn,on.stretch,pe),qi=lh(Sn.stretch-at,ot,S,n.left),gi=ym(Sn.fixed-It,Wt,Sn.stretch,oe),Qn=lh(Dn.stretch-yt,wt,R,n.top),lr=ym(Dn.fixed-Yt,dn,Dn.stretch,pe),$i=new ye(Kn,$n),ai=new ye(qi,$n),Oo=new ye(qi,Qn),ko=new ye(Kn,Qn),ro=new ye(wn/b,Hi/b),er=new ye(gi/b,lr/b),pr=e*Math.PI/180;if(pr){const Or=Math.sin(pr),Yr=Math.cos(pr),Kr=[Yr,-Or,Or,Yr];$i._matMult(Kr),ai._matMult(Kr),ko._matMult(Kr),Oo._matMult(Kr)}const Nr=Vt.stretch+Vt.fixed,Pr=on.stretch+on.fixed;return{tl:$i,tr:ai,bl:ko,br:Oo,tex:{x:g.paddedRect.x+1+Nr,y:g.paddedRect.y+1+Pr,w:Sn.stretch+Sn.fixed-Nr,h:Dn.stretch+Dn.fixed-Pr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ro,pixelOffsetBR:er,minFontScaleX:Wt/b/S,minFontScaleY:dn/b/R,isSDF:i}};if(a&&(g.stretchX||g.stretchY)){const Vt=jp(V,Ie,oe),on=jp(U,Ne,pe);for(let Sn=0;Sn<Vt.length-1;Sn++){const Dn=Vt[Sn],Kn=Vt[Sn+1];for(let wn=0;wn<on.length-1;wn++)h.push(Tn(Dn,on[wn],Kn,on[wn+1]))}}else h.push(Tn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:D+1}));return h}function ah(n,e,i){let a=0;for(const h of n)a+=Math.max(e,Math.min(i,h[1]))-Math.max(e,Math.min(i,h[0]));return a}function jp(n,e,i){const a=[{fixed:-1,stretch:0}];for(const[h,g]of n){const b=a[a.length-1];a.push({fixed:h-b.stretch,stretch:b.stretch}),a.push({fixed:h-b.stretch,stretch:b.stretch+(g-h)})}return a.push({fixed:e+1,stretch:i}),a}function lh(n,e,i,a){return n/e*i+a}function ym(n,e,i,a){return n-e*i/a}function vm(n,e,i,a){const h=e+n.positionedLines[a].lineOffset;return 0===a?i+h/2:i+(h+(e+n.positionedLines[a-1].lineOffset))/2}$c.loadGlyphRange=function(n,e,i,a,h){const g=256*e,b=g+255,C=a.transformRequest(a.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${g}-${b}`),He.Glyphs);lt(C,(D,S)=>{if(D)h(D);else if(S){const R={},V=new ih(S).readFields(rh,{});for(const U of V.glyphs)R[U.id]=U;h(null,{glyphs:R,ascender:V.ascender,descender:V.descender})}})},$c.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:a=.25,fontFamily:h="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=i;const C=this.size=n+4*e,D=this._createCanvas(C),S=this.ctx=D.getContext("2d",{willReadFrequently:!0});S.font=`${b} ${g} ${n}px ${h}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a,actualBoundingBoxLeft:h,actualBoundingBoxRight:g}=this.ctx.measureText(n),b=Math.ceil(i),C=Math.min(this.size-this.buffer,Math.ceil(g-h)),D=Math.min(this.size-this.buffer,b+Math.ceil(a)),S=C+2*this.buffer,R=D+2*this.buffer,V=Math.max(S*R,0),U=new Uint8ClampedArray(V),ee={data:U,width:S,height:R,glyphWidth:C,glyphHeight:D,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(0===C||0===D)return ee;const{ctx:oe,buffer:pe,gridInner:Ie,gridOuter:Ne}=this;oe.clearRect(pe,pe,C,D),oe.fillText(n,pe,pe+b);const at=oe.getImageData(pe,pe,C,D);Ne.fill(Au,0,V),Ie.fill(0,0,V);for(let ot=0;ot<D;ot++)for(let yt=0;yt<C;yt++){const wt=at.data[4*(ot*C+yt)+3]/255;if(0===wt)continue;const It=(ot+pe)*S+yt+pe;if(1===wt)Ne[It]=0,Ie[It]=Au;else{const Wt=.5-wt;Ne[It]=Wt>0?Wt*Wt:0,Ie[It]=Wt<0?Wt*Wt:0}}wy(Ne,0,0,S,R,S,this.f,this.v,this.z),wy(Ie,pe,pe,C,D,S,this.f,this.v,this.z);for(let ot=0;ot<V;ot++){const yt=Math.sqrt(Ne[ot])-Math.sqrt(Ie[ot]);U[ot]=Math.round(255-255*(yt/this.radius+this.cutoff))}return ee}};class Cy{constructor(e=[],i=Ey){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,h=i[e];for(;e>0;){const g=e-1>>1,b=i[g];if(a(h,b)>=0)break;i[e]=b,e=g}i[e]=h}_down(e){const{data:i,compare:a}=this,h=this.length>>1,g=i[e];for(;e<h;){let b=1+(e<<1),C=i[b];const D=b+1;if(D<this.length&&a(i[D],C)<0&&(b=D,C=i[D]),a(C,g)>=0)break;i[e]=C,e=b}i[e]=g}}function Ey(n,e){return n<e?-1:n>e?1:0}function My(n,e=1,i=!1){let a=1/0,h=1/0,g=-1/0,b=-1/0;const C=n[0];for(let ee=0;ee<C.length;ee++){const oe=C[ee];(!ee||oe.x<a)&&(a=oe.x),(!ee||oe.y<h)&&(h=oe.y),(!ee||oe.x>g)&&(g=oe.x),(!ee||oe.y>b)&&(b=oe.y)}const D=Math.min(g-a,b-h);let S=D/2;const R=new Cy([],Yg);if(0===D)return new ye(a,h);for(let ee=a;ee<g;ee+=D)for(let oe=h;oe<b;oe+=D)R.push(new Xh(ee+S,oe+S,S,n));let V=function(ee){let oe=0,pe=0,Ie=0;const Ne=ee[0];for(let at=0,ot=Ne.length,yt=ot-1;at<ot;yt=at++){const wt=Ne[at],It=Ne[yt],Wt=wt.x*It.y-It.x*wt.y;pe+=(wt.x+It.x)*Wt,Ie+=(wt.y+It.y)*Wt,oe+=3*Wt}return new Xh(pe/oe,Ie/oe,0,ee)}(n),U=R.length;for(;R.length;){const ee=R.pop();(ee.d>V.d||!V.d)&&(V=ee,i&&console.log("found best %d after %d probes",Math.round(1e4*ee.d)/1e4,U)),ee.max-V.d<=e||(S=ee.h/2,R.push(new Xh(ee.p.x-S,ee.p.y-S,S,n)),R.push(new Xh(ee.p.x+S,ee.p.y-S,S,n)),R.push(new Xh(ee.p.x-S,ee.p.y+S,S,n)),R.push(new Xh(ee.p.x+S,ee.p.y+S,S,n)),U+=4)}return i&&(console.log(`num probes: ${U}`),console.log(`best distance: ${V.d}`)),V.p}function Yg(n,e){return e.max-n.max}function Xh(n,e,i,a){this.p=new ye(n,e),this.h=i,this.d=function(h,g){let b=!1,C=1/0;for(let D=0;D<g.length;D++){const S=g[D];for(let R=0,V=S.length,U=V-1;R<V;U=R++){const ee=S[R],oe=S[U];ee.y>h.y!=oe.y>h.y&&h.x<(oe.x-ee.x)*(h.y-ee.y)/(oe.y-ee.y)+ee.x&&(b=!b),C=Math.min(C,sd(h,ee,oe))}}return(b?1:-1)*Math.sqrt(C)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const Gp=Number.POSITIVE_INFINITY,Dy=Math.sqrt(2);function bm(n,e){return e[1]!==Gp?function(i,a,h){let g=0,b=0;switch(a=Math.abs(a),h=Math.abs(h),i){case"top-right":case"top-left":case"top":b=h-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-h}switch(i){case"top-right":case"bottom-right":case"right":g=-a;break;case"top-left":case"bottom-left":case"left":g=a}return[g,b]}(n,e[0],e[1]):function(i,a){let h=0,g=0;a<0&&(a=0);const b=a/Dy;switch(i){case"top-right":case"top-left":g=b-7;break;case"bottom-right":case"bottom-left":g=7-b;break;case"bottom":g=7-a;break;case"top":g=a-7}switch(i){case"top-right":case"bottom-right":h=-b;break;case"top-left":case"bottom-left":h=b;break;case"left":h=a;break;case"right":h=-a}return[h,g]}(n,e[0])}function Kg(n,e,i,a,h,g,b,C,D,S){n.createArrays(),n.tilePixelRatio=Ti/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const R=n.layers[0].layout,V=n.layers[0]._unevaluatedLayout._values,U={};if("composite"===n.textSizeData.kind){const{minZoom:pe,maxZoom:Ie}=n.textSizeData;U.compositeTextSizes=[V["text-size"].possiblyEvaluate(new ke(pe),C),V["text-size"].possiblyEvaluate(new ke(Ie),C)]}if("composite"===n.iconSizeData.kind){const{minZoom:pe,maxZoom:Ie}=n.iconSizeData;U.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new ke(pe),C),V["icon-size"].possiblyEvaluate(new ke(Ie),C)]}U.layoutTextSize=V["text-size"].possiblyEvaluate(new ke(D+1),C),U.layoutIconSize=V["icon-size"].possiblyEvaluate(new ke(D+1),C),U.textMaxSize=V["text-size"].possiblyEvaluate(new ke(18),C);const ee="map"===R.get("text-rotation-alignment")&&"point"!==R.get("symbol-placement"),oe=R.get("text-size");for(const pe of n.features){const Ie=R.get("text-font").evaluate(pe,{},C).join(","),Ne=oe.evaluate(pe,{},C),at=U.layoutTextSize.evaluate(pe,{},C),ot=(U.layoutIconSize.evaluate(pe,{},C),{horizontal:{},vertical:void 0}),yt=pe.text;let wt,It=[0,0];if(yt){const dn=yt.toString(),Tn=24*R.get("text-letter-spacing").evaluate(pe,{},C),Vt=24*R.get("text-line-height").evaluate(pe,{},C),on=Bd(dn)?Tn:0,Sn=R.get("text-anchor").evaluate(pe,{},C),Dn=R.get("text-variable-anchor");if(!Dn){const gi=R.get("text-radial-offset").evaluate(pe,{},C);It=gi?bm(Sn,[24*gi,Gp]):R.get("text-offset").evaluate(pe,{},C).map(Qn=>24*Qn)}let Kn=ee?"center":R.get("text-justify").evaluate(pe,{},C);const wn=R.get("symbol-placement"),$n="point"===wn,Hi="point"===wn?24*R.get("text-max-width").evaluate(pe,{},C):0,qi=gi=>{n.allowVerticalPlacement&&wl(dn)&&(ot.vertical=dm(yt,e,i,h,Ie,Hi,Vt,Sn,gi,on,It,fl.vertical,!0,wn,at,Ne))};if(!ee&&Dn){const gi="auto"===Kn?Dn.map(lr=>xm(lr)):[Kn];let Qn=!1;for(let lr=0;lr<gi.length;lr++){const $i=gi[lr];if(!ot.horizontal[$i])if(Qn)ot.horizontal[$i]=ot.horizontal[0];else{const ai=dm(yt,e,i,h,Ie,Hi,Vt,"center",$i,on,It,fl.horizontal,!1,wn,at,Ne);ai&&(ot.horizontal[$i]=ai,Qn=1===ai.positionedLines.length)}}qi("left")}else{if("auto"===Kn&&(Kn=xm(Sn)),$n||R.get("text-writing-mode").indexOf("horizontal")>=0||!wl(dn)){const gi=dm(yt,e,i,h,Ie,Hi,Vt,Sn,Kn,on,It,fl.horizontal,!1,wn,at,Ne);gi&&(ot.horizontal[Kn]=gi)}qi("point"===wn?"left":Kn)}}let Wt=!1;if(pe.icon&&pe.icon.name){const dn=a[pe.icon.name];dn&&(wt=vd(h[pe.icon.name],R.get("icon-offset").evaluate(pe,{},C),R.get("icon-anchor").evaluate(pe,{},C)),Wt=dn.sdf,void 0===n.sdfIcons?n.sdfIcons=dn.sdf:n.sdfIcons!==dn.sdf&&Yn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(dn.pixelRatio!==n.pixelRatio||0!==R.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const Yt=Sy(ot.horizontal)||ot.vertical;n.iconsInText||(n.iconsInText=!!Yt&&Yt.iconsInText),(Yt||wt)&&wm(n,pe,ot,wt,a,U,at,0,It,Wt,b,C,S)}g&&n.generateCollisionDebugBuffers(D,n.collisionBoxArray)}function xm(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wm(n,e,i,a,h,g,b,C,D,S,R,V,U){let ee=g.textMaxSize.evaluate(e,{},V);void 0===ee&&(ee=b);const oe=n.layers[0].layout,pe=oe.get("icon-offset").evaluate(e,{},V),Ie=Sy(i.horizontal)||i.vertical,Ne="globe"===U.name,at=b/24,ot=n.tilePixelRatio*ee/24,yt=(on=n.overscaling,n.zoom>18&&on>2&&(on>>=1),Math.max(Ti/(512*on),1)*oe.get("symbol-spacing")),wt=oe.get("text-padding")*n.tilePixelRatio,It=oe.get("icon-padding")*n.tilePixelRatio,Wt=Pe(oe.get("text-max-angle")),Yt="map"===oe.get("text-rotation-alignment")&&"point"!==oe.get("symbol-placement"),dn="map"===oe.get("icon-rotation-alignment")&&"point"!==oe.get("symbol-placement"),Tn=oe.get("symbol-placement"),Vt=yt/2;var on;const Sn=oe.get("icon-text-fit");let Dn;a&&"none"!==Sn&&(n.allowVerticalPlacement&&i.vertical&&(Dn=pm(a,i.vertical,Sn,oe.get("icon-text-fit-padding"),pe,at)),Ie&&(a=pm(a,Ie,Sn,oe.get("icon-text-fit-padding"),pe,at)));const Kn=(wn,$n,Hi)=>{if($n.x<0||$n.x>=Ti||$n.y<0||$n.y>=Ti)return;let qi=null;if(Ne){const{x:gi,y:Qn,z:lr}=U.projectTilePoint($n.x,$n.y,Hi);qi={anchor:new vc(gi,Qn,lr,0,void 0),up:U.upVector(Hi,$n.x,$n.y)}}!function(gi,Qn,lr,$i,ai,Oo,ko,ro,er,pr,Nr,Pr,Or,Yr,Kr,ts,Ia,dr,go,zs,Mr,ho,na,_i,wo){const ns=gi.addToLineVertexArray(Qn,$i);let is,Ts,ia,rs,Ql,Sd,Ad,yh=0,jy=0,v_=0,b_=0,lf=-1,Bm=-1;const oo={};let zm=mc("");const Id=lr?lr.anchor:Qn;let Nm=0,cf=0;if(void 0===er._unevaluatedLayout.getValue("text-radial-offset")?[Nm,cf]=er.layout.get("text-offset").evaluate(Mr,{},wo).map(Ss=>24*Ss):(Nm=24*er.layout.get("text-radial-offset").evaluate(Mr,{},wo),cf=Gp),gi.allowVerticalPlacement&&ai.vertical){const Ss=ai.vertical;if(Kr)Sd=Xg(Ss),ro&&(Ad=Xg(ro));else{const va=er.layout.get("text-rotate").evaluate(Mr,{},wo)+90;ia=Cm(pr,Id,Qn,Nr,Pr,Or,Ss,Yr,va,ts),ro&&(rs=Cm(pr,Id,Qn,Nr,Pr,Or,ro,dr,va))}}if(Oo){const Ss=er.layout.get("icon-rotate").evaluate(Mr,{},wo),va="none"!==er.layout.get("icon-text-fit"),op=Kh(Oo,Ss,na,va),vh=ro?Kh(ro,Ss,na,va):void 0;Ts=Cm(pr,Id,Qn,Nr,Pr,Or,Oo,dr,Ss),yh=4*op.length;const w_=gi.iconSizeData;let Ru=null;"source"===w_.kind?(Ru=[yc*er.layout.get("icon-size").evaluate(Mr,{},wo)],Ru[0]>bd&&Yn(`${gi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===w_.kind&&(Ru=[yc*ho.compositeIconSizes[0].evaluate(Mr,{},wo),yc*ho.compositeIconSizes[1].evaluate(Mr,{},wo)],(Ru[0]>bd||Ru[1]>bd)&&Yn(`${gi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),gi.addSymbols(gi.icon,op,Ru,zs,go,Mr,!1,lr,Qn,ns.lineStartIndex,ns.lineLength,-1,_i,wo),lf=gi.icon.placedSymbolArray.length-1,vh&&(jy=4*vh.length,gi.addSymbols(gi.icon,vh,Ru,zs,go,Mr,fl.vertical,lr,Qn,ns.lineStartIndex,ns.lineLength,-1,_i,wo),Bm=gi.icon.placedSymbolArray.length-1)}for(const Ss in ai.horizontal){const va=ai.horizontal[Ss];is||(zm=mc(va.text),Kr?Ql=Xg(va):is=Cm(pr,Id,Qn,Nr,Pr,Or,va,Yr,er.layout.get("text-rotate").evaluate(Mr,{},wo),ts));const op=1===va.positionedLines.length;if(v_+=Ty(gi,lr,Qn,va,ko,er,Kr,Mr,ts,ns,ai.vertical?fl.horizontal:fl.horizontalOnly,op?Object.keys(ai.horizontal):[Ss],oo,lf,ho,_i,wo),op)break}ai.vertical&&(b_+=Ty(gi,lr,Qn,ai.vertical,ko,er,Kr,Mr,ts,ns,fl.vertical,["vertical"],oo,Bm,ho,_i,wo));let ku=-1;const uf=(Ss,va)=>Ss?Math.max(Ss,va):va;ku=uf(Ql,ku),ku=uf(Sd,ku),ku=uf(Ad,ku);const x_=ku>-1?1:0;gi.glyphOffsetArray.length>=ta.MAX_GLYPHS&&Yn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Mr.sortKey&&gi.addToSortKeyRanges(gi.symbolInstances.length,Mr.sortKey),gi.symbolInstances.emplaceBack(Id.x,Id.y,Id.z,Qn.x,Qn.y,oo.right>=0?oo.right:-1,oo.center>=0?oo.center:-1,oo.left>=0?oo.left:-1,oo.vertical>=0?oo.vertical:-1,lf,Bm,zm,void 0!==is?is:gi.collisionBoxArray.length,void 0!==is?is+1:gi.collisionBoxArray.length,void 0!==ia?ia:gi.collisionBoxArray.length,void 0!==ia?ia+1:gi.collisionBoxArray.length,void 0!==Ts?Ts:gi.collisionBoxArray.length,void 0!==Ts?Ts+1:gi.collisionBoxArray.length,rs||gi.collisionBoxArray.length,rs?rs+1:gi.collisionBoxArray.length,Nr,v_,b_,yh,jy,x_,0,Nm,cf,ku)}(n,$n,qi,wn,i,a,h,Dn,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,wt,Yt,D,0,It,dn,pe,e,g,S,R,V)};if("line"===Tn)for(const wn of gm(e.geometry,0,0,Ti,Ti)){const $n=bc(wn,yt,Wt,i.vertical||Ie,a,24,ot,n.overscaling,Ti);for(const Hi of $n){const qi=Ie;qi&&Tv(n,qi.text,Vt,Hi)||Kn(wn,Hi,V)}}else if("line-center"===Tn){for(const wn of e.geometry)if(wn.length>1){const $n=mm(wn,Wt,i.vertical||Ie,a,24,ot);$n&&Kn(wn,$n,V)}}else if("Polygon"===e.type)for(const wn of kp(e.geometry,0)){const $n=My(wn,16);Kn(wn[0],new vc($n.x,$n.y,0,0,void 0),V)}else if("LineString"===e.type)for(const wn of e.geometry)Kn(wn,new vc(wn[0].x,wn[0].y,0,0,void 0),V);else if("Point"===e.type)for(const wn of e.geometry)for(const $n of wn)Kn([$n],new vc($n.x,$n.y,0,0,void 0),V)}const bd=32640;function Ty(n,e,i,a,h,g,b,C,D,S,R,V,U,ee,oe,pe,Ie){const Ne=function(yt,wt,It,Wt,Yt,dn,Tn,Vt){const on=[];if(0===wt.positionedLines.length)return on;const Sn=Wt.layout.get("text-rotate").evaluate(dn,{})*Math.PI/180,Dn=function(qi){const gi=qi[0],Qn=qi[1],lr=gi*Qn;return lr>0?[gi,-Qn]:lr<0?[-gi,Qn]:0===gi?[Qn,gi]:[Qn,-gi]}(It);let Kn=Math.abs(wt.top-wt.bottom);for(const qi of wt.positionedLines)Kn-=qi.lineOffset;const wn=wt.positionedLines.length,$n=Kn/wn;let Hi=wt.top-It[1];for(let qi=0;qi<wn;++qi){const gi=wt.positionedLines[qi];Hi=vm(wt,$n,Hi,qi);for(const Qn of gi.positionedGlyphs){if(!Qn.rect)continue;const lr=Qn.rect||{};let $i=4,ai=!0,Oo=1,ko=0;if(Qn.imageName){const _i=Tn[Qn.imageName];if(!_i)continue;if(_i.sdf){Yn("SDF images are not supported in formatted text and will be ignored.");continue}ai=!1,Oo=_i.pixelRatio,$i=1/Oo}const ro=(Yt||Vt)&&Qn.vertical,er=Qn.metrics.advance*Qn.scale/2,pr=Qn.metrics,Nr=Qn.rect;if(null===Nr)continue;Vt&&wt.verticalizable&&(ko=Qn.imageName?er-Qn.metrics.width*Qn.scale/2:0);const Pr=Yt?[Qn.x+er,Qn.y]:[0,0];let Or=[0,0],Yr=[0,0],Kr=!1;Yt||(ro?(Yr=[Qn.x+er+Dn[0],Qn.y+Dn[1]-ko],Kr=!0):Or=[Qn.x+er+It[0],Qn.y+It[1]-ko]);const ts=Nr.w*Qn.scale/(Oo*(Qn.localGlyph?2:1)),Ia=Nr.h*Qn.scale/(Oo*(Qn.localGlyph?2:1));let dr,go,zs,Mr;if(ro){const _i=Qn.y-Hi,wo=new ye(-er,er-_i),ns=-Math.PI/2,is=new ye(...Yr);dr=new ye(-er+Or[0],Or[1]),dr._rotateAround(ns,wo)._add(is),dr.x+=-_i+er,dr.y-=(pr.left-$i)*Qn.scale;const Ts=Qn.imageName?pr.advance*Qn.scale:24*Qn.scale,ia=String.fromCharCode(Qn.glyph);kg(ia)?dr.x+=(1-$i)*Qn.scale:Rg(ia)?dr.x+=Ts-pr.height*Qn.scale+(-$i-1)*Qn.scale:dr.x+=Qn.imageName||pr.width+2*$i===Nr.w&&pr.height+2*$i===Nr.h?(Ts-Ia)/2:(Ts-(pr.height+2*$i)*Qn.scale)/2,go=new ye(dr.x,dr.y-ts),zs=new ye(dr.x+Ia,dr.y),Mr=new ye(dr.x+Ia,dr.y-ts)}else{const _i=(pr.left-$i)*Qn.scale-er+Or[0],wo=(-pr.top-$i)*Qn.scale+Or[1],ns=_i+ts,is=wo+Ia;dr=new ye(_i,wo),go=new ye(ns,wo),zs=new ye(_i,is),Mr=new ye(ns,is)}if(Sn){let _i;_i=Yt?new ye(0,0):Kr?new ye(Dn[0],Dn[1]):new ye(It[0],It[1]),dr._rotateAround(Sn,_i),go._rotateAround(Sn,_i),zs._rotateAround(Sn,_i),Mr._rotateAround(Sn,_i)}const ho=new ye(0,0),na=new ye(0,0);on.push({tl:dr,tr:go,bl:zs,br:Mr,tex:lr,writingMode:wt.writingMode,glyphOffset:Pr,sectionIndex:Qn.sectionIndex,isSDF:ai,pixelOffsetTL:ho,pixelOffsetBR:na,minFontScaleX:0,minFontScaleY:0})}}return on}(0,a,D,g,b,C,h,n.allowVerticalPlacement),at=n.textSizeData;let ot=null;"source"===at.kind?(ot=[yc*g.layout.get("text-size").evaluate(C,{},Ie)],ot[0]>bd&&Yn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===at.kind&&(ot=[yc*oe.compositeTextSizes[0].evaluate(C,{},Ie),yc*oe.compositeTextSizes[1].evaluate(C,{},Ie)],(ot[0]>bd||ot[1]>bd)&&Yn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,Ne,ot,D,b,C,R,e,i,S.lineStartIndex,S.lineLength,ee,pe,Ie);for(const yt of V)U[yt]=n.text.placedSymbolArray.length-1;return 4*Ne.length}function Sy(n){for(const e in n)return n[e];return null}function Cm(n,e,i,a,h,g,b,C,D,S){let R=b.top,V=b.bottom,U=b.left,ee=b.right;const oe=b.collisionPadding;if(oe&&(U-=oe[0],R-=oe[1],ee+=oe[2],V+=oe[3]),D){const pe=new ye(U,R),Ie=new ye(ee,R),Ne=new ye(U,V),at=new ye(ee,V),ot=Pe(D);let yt=new ye(0,0);S&&(yt=new ye(S[0],S[1])),pe._rotateAround(ot,yt),Ie._rotateAround(ot,yt),Ne._rotateAround(ot,yt),at._rotateAround(ot,yt),U=Math.min(pe.x,Ie.x,Ne.x,at.x),ee=Math.max(pe.x,Ie.x,Ne.x,at.x),R=Math.min(pe.y,Ie.y,Ne.y,at.y),V=Math.max(pe.y,Ie.y,Ne.y,at.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,U,R,ee,V,C,a,h,g),n.length-1}function Xg(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function Tv(n,e,i,a){const h=n.compareText;if(e in h){const g=h[e];for(let b=g.length-1;b>=0;b--)if(a.dist(g[b])<i)return!0}else h[e]=[];return h[e].push(a),!1}const Sv=Nn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),{members:Ay}=Sv,Iy=Nn([{name:"a_pos_3",components:3,type:"Int16"}]);var Hp=Nn([{name:"a_pos",type:"Int16",components:2}]);const Xa=Ti/Math.PI/2,Qh=2*dl(1,0)*Xa*Math.PI,ch=[64,32,16],Sa=-Xa,_a=Xa,Qg=[new pl([Sa,Sa,Sa],[_a,_a,_a]),new pl([Sa,Sa,Sa],[0,0,_a]),new pl([0,Sa,Sa],[_a,0,_a]),new pl([Sa,0,Sa],[0,_a,_a]),new pl([0,0,Sa],[_a,_a,_a])];function $p(n,e,i,a=!0){const h=jc([],n._camera.position,n.worldSize),g=[e,i,1,1];ud(g,g,n.pixelMatrixInverse),Cp(g,g,1/g[3]);const b=Da([],hl([],g,h)),C=n.globeMatrix,D=[C[12],C[13],C[14]],S=hl([],D,h),R=cd(S),V=Da([],S),U=n.worldSize/(2*Math.PI),ee=ql(V,b),oe=Math.asin(U/R);if(oe<Math.acos(ee)){if(!a)return null;const Tn=[],Vt=[];jc(Tn,b,R/ee),Da(Vt,hl(Vt,Tn,S)),Da(b,bu(b,S,jc(b,Vt,Math.tan(oe)*R)))}const pe=[];new Nf(h,b).closestPointOnSphere(D,U,pe);const Ie=Da([],Rt(C,0)),Ne=Da([],Rt(C,1)),at=Da([],Rt(C,2)),ot=ql(Ie,pe),yt=ql(Ne,pe),wt=ql(at,pe),It=ut(Math.asin(-yt/U));let Wt=ut(Math.atan2(ot,wt));Wt=n.center.lng+function(Tn,Vt){const on=(Vt-Tn+180)%360-180;return on<-180?on+360:on}(n.center.lng,Wt);const Yt=Zl(Wt),dn=St(zc(It),0,1);return new td(Yt,dn)}class Py{constructor(e,i,a){this.a=hl([],e,a),this.b=hl([],i,a),this.center=a;const h=Da([],this.a),g=Da([],this.b);this.angle=Math.acos(ql(h,g))}}function xc(n,e){if(0===n.angle)return null;let i;return i=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(a,h,g,b){const C=Math.sin(g);return a*(Math.sin((1-b)*g)/C)+h*(Math.sin(b*g)/C)}(n.a[e],n.b[e],n.angle,St(i,0,1))+n.center[e]}function Kl(n){if(n.z<=1)return Qg[n.z+2*n.y+n.x];const[e,i]=uh(n),a=[ea(e[0],e[1]),ea(e[0],i[1]),ea(i[0],e[1]),ea(i[0],i[1])],h=[_a,_a,_a],g=[Sa,Sa,Sa];for(const b of a)h[0]=Math.min(h[0],b[0]),h[1]=Math.min(h[1],b[1]),h[2]=Math.min(h[2],b[2]),g[0]=Math.max(g[0],b[0]),g[1]=Math.max(g[1],b[1]),g[2]=Math.max(g[2],b[2]);return new pl(h,g)}function uh(n){const e=1<<n.z,i=n.x/e,a=(n.x+1)/e,h=(n.y+1)/e;return[[No(n.y/e),Qs(i)],[No(h),Qs(a)]]}function Jg(n,e,i,a=Xa){return i=Pe(i),[n*Math.sin(i)*a,-e*a,n*Math.cos(i)*a]}function ea(n,e,i){return Jg(Math.cos(Pe(n)),Math.sin(Pe(n)),e,i)}function e_(n,e,i){const a=Math.pow(2,i.z),h=(n/Ti+i.x)/a;return ea(No((e/Ti+i.y)/a),Qs(h))}function Zp(n){return 16383/Math.max(...hl([],n.max,n.min))}function Iu(n){const e=Ms(new Float64Array(16)),i=Zp(n);var a,h;return Ka(e,e,[i,i,i]),ld(e,e,((a=[])[0]=-(h=n.min)[0],a[1]=-h[1],a[2]=-h[2],a)),e}function xd(n){const e=Ms(new Float64Array(16)),i=1/Zp(n);return ld(e,e,n.min),Ka(e,e,[i,i,i]),e}function Wp(n,e,i,a,h){const g=function(D){const S=Ti/(2*Math.PI);return D/(2*Math.PI)/S}(i),b=[n,e,-i/(2*Math.PI)],C=Ms(new Float64Array(16));return ld(C,C,b),Ka(C,C,[g,g,g]),vu(C,C,Pe(-h)),wp(C,C,Pe(-a)),C}function Zc(n){return Pn(5,6,n)}function Jh(n,e){const i=ea(e.lat,e.lng);return g=(a=kh([],function(ee){const oe=ea(ee._center.lat,ee._center.lng);let pe=pg([],jd(0,1,0),oe);const Ie=hg([],-ee.angle,oe);pe=Fs(pe,pe,Ie),hg(Ie,-ee._pitch,pe);const Ne=Da([],oe);return jc(Ne,Ne,ee.cameraToCenterDistance/ee.pixelsPerMeter*Qh),Fs(Ne,Ne,Ie),bu([],oe,Ne)}(n),i))[0],b=a[1],C=a[2],D=(h=i)[0],S=h[1],R=h[2],U=(V=Math.sqrt(g*g+b*b+C*C)*Math.sqrt(D*D+S*S+R*R))&&ql(a,h)/V,Math.acos(Math.min(Math.max(U,-1),1));var a,h,g,b,C,D,S,R,V,U}const dh=Pe(85),ky=Math.cos(dh),t_=Math.sin(dh);function Em(n,e){const i=n.fovAboveCenter,a=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,h=(n._camera.position[2]*n.worldSize-a)/Math.cos(n._pitch),g=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),b=Math.sin(n._pitch)*g+h;return Math.min(1.01*b,h*(1/n._horizonShift))}function wc(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const i=Math.pow(2,-n.z),a=n.x*i,h=(n.x+1)*i,g=n.y*i,b=(n.y+1)*i,C=Qs(a),D=Qs(h),S=No(g),R=No(b),V=e.project(C,S),U=e.project(D,S),ee=e.project(D,R),oe=e.project(C,R);let pe=Math.min(V.x,U.x,ee.x,oe.x),Ie=Math.min(V.y,U.y,ee.y,oe.y),Ne=Math.max(V.x,U.x,ee.x,oe.x),at=Math.max(V.y,U.y,ee.y,oe.y);const ot=i/16;function yt(It,Wt,Yt,dn,Tn,Vt){const on=(Yt+Tn)/2,Sn=(dn+Vt)/2,Dn=e.project(Qs(on),No(Sn)),Kn=Math.max(0,pe-Dn.x,Ie-Dn.y,Dn.x-Ne,Dn.y-at);pe=Math.min(pe,Dn.x),Ne=Math.max(Ne,Dn.x),Ie=Math.min(Ie,Dn.y),at=Math.max(at,Dn.y),Kn>ot&&(yt(It,Dn,Yt,dn,on,Sn),yt(Dn,Wt,on,Sn,Tn,Vt))}yt(V,U,a,g,h,g),yt(U,ee,h,g,h,b),yt(ee,oe,h,b,a,b),yt(oe,V,a,b,a,g),pe-=ot,Ie-=ot,Ne+=ot,at+=ot;const wt=1/Math.max(Ne-pe,at-Ie);return{scale:wt,x:pe*wt,y:Ie*wt,x2:Ne*wt,y2:at*wt,projection:e}}const Mm=Ms(new Float32Array(16));class Wc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Fr(0,0)}projectTilePoint(e,i,a){return{x:e,y:i,z:0}}locationPoint(e,i,a=!0){return e._coordinatePoint(e.locationCoordinate(i),a)}pixelsPerMeter(e,i){return dl(1,e)*i}pixelSpaceConversion(e,i,a){return 1}farthestPixelDistance(e){return Em(e,e.pixelsPerMeter)}pointCoordinate(e,i,a,h){const g=e.horizonLineFromTop(!1),b=new ye(i,Math.max(g,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(b,h))}pointCoordinate3D(e,i,a){const h=new ye(i,a);if(e.elevation)return e.elevation.pointCoordinate(h);{const g=this.pointCoordinate(e,h.x,h.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const a=e.horizonLineFromTop();return i.y<a}createInversionMatrix(e,i){return Mm}createTileMatrix(e,i,a){let h,g,b;const C=a.canonical,D=Ms(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=wc(C,this);h=1,g=S.x+a.wrap*S.scale,b=S.y,Ka(D,D,[h/S.scale,h/S.scale,e.pixelsPerMeter/i])}else h=i/e.zoomScale(C.z),g=(C.x+Math.pow(2,C.z)*a.wrap)*h,b=C.y*h;return ld(D,D,[g,b,0]),Ka(D,D,[h/Ti,h/Ti,1]),D}upVector(e,i,a){return[0,0,1]}upVectorScale(e,i,a){return{metersToTile:1}}}class Dm extends Wc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,a]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(Pe(i));this.n=(h+Math.sin(Pe(a)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:a,c:h,r0:g}=this,b=Pe(e-this.center[0]),C=Pe(i),D=Math.sqrt(h-2*a*Math.sin(C))/a;return{x:D*Math.sin(b*a),y:D*Math.cos(b*a)-g,z:0}}unproject(e,i){const{n:a,c:h,r0:g}=this,b=g+i;let C=Math.atan2(e,Math.abs(b))*Math.sign(b);b*a<0&&(C-=Math.PI*Math.sign(e)*Math.sign(b));const D=Pe(this.center[0])*a;C=Xn(C,-Math.PI-D,Math.PI-D);const S=ut(C/a)+this.center[0],R=Math.asin(St((h-(e*e+b*b)*a*a)/(2*a),-1,1)),V=St(ut(R),-85.051129,Wl);return new Fr(S,V)}}const ep=1.340264,qp=-.081106,hh=893e-6,ph=.003796,Yp=Math.sqrt(3)/2;class n_ extends Wc{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Yp*Math.sin(i)),h=a*a,g=h*h*h;return{x:.5*(e*Math.cos(a)/(Yp*(ep+3*qp*h+g*(7*hh+9*ph*h)))/Math.PI+.5),y:1-.5*(a*(ep+qp*h+g*(hh+ph*h))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,h=a*a,g=h*h*h;for(let R,V,U,ee=0;ee<12&&(V=a*(ep+qp*h+g*(hh+ph*h))-i,U=ep+3*qp*h+g*(7*hh+9*ph*h),R=V/U,a=St(a-R,-Math.PI/3,Math.PI/3),h=a*a,g=h*h*h,!(Math.abs(R)<1e-12));++ee);const b=Yp*e*(ep+3*qp*h+g*(7*hh+9*ph*h))/Math.cos(a),C=Math.asin(Math.sin(a)/Yp),D=St(180*b/Math.PI,-180,180),S=St(180*C/Math.PI,-85.051129,Wl);return new Fr(D,S)}}class i_ extends Wc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const a=360*(e-.5),h=St(360*(.5-i),-85.051129,Wl);return new Fr(a,h)}}const wd=Math.PI/2;function ya(n){return Math.tan((wd+n)/2)}class r_ extends Wc{constructor(e){super(e),this.center=e.center||[0,30];const[i,a]=this.parallels=e.parallels||[30,30],h=Pe(i),g=Pe(a),b=Math.cos(h);this.n=h===g?Math.sin(h):Math.log(b/Math.cos(g))/Math.log(ya(g)/ya(h)),this.f=b*Math.pow(ya(h),this.n)/this.n}project(e,i){i=Pe(i),e=Pe(e-this.center[0]);const a=1e-6,{n:h,f:g}=this;g>0?i<-wd+a&&(i=-wd+a):i>wd-a&&(i=wd-a);const b=g/Math.pow(ya(i),h),C=b*Math.sin(h*e),D=g-b*Math.cos(h*e);return{x:.5*(C/Math.PI+.5),y:1-.5*(D/Math.PI+.5),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,i=(2*(1-i)-.5)*Math.PI;const{n:a,f:h}=this,g=h-i,b=Math.sign(g),C=Math.sign(a)*Math.sqrt(e*e+g*g);let D=Math.atan2(e,Math.abs(g))*b;g*a<0&&(D-=Math.PI*Math.sign(e)*b);const S=St(ut(D/a)+this.center[0],-180,180),R=St(ut(2*Math.atan(Math.pow(h/C,1/a))-wd),-85.051129,Wl);return new Fr(S,R)}}class o_ extends Wc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:Zl(e),y:zc(i),z:0}}unproject(e,i){const a=Qs(e),h=No(i);return new Fr(a,h)}}const s_=Pe(Wl);class Ry extends Wc{project(e,i){const a=(i=Pe(i))*i,h=a*a;return{x:.5*((e=Pe(e))*(.8707-.131979*a+h*(h*(.003971*a-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+a*(.015085+h*(.028874*a-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,h=25,g=0,b=a*a;do{b=a*a;const S=b*b;g=(a*(1.007226+b*(.015085+S*(.028874*b-.044475-.005916*S)))-i)/(1.007226+b*(.045255+S*(.259866*b-.311325-.005916*11*S))),a=St(a-g,-s_,s_)}while(Math.abs(g)>1e-6&&--h>0);b=a*a;const C=St(ut(e/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),D=ut(a);return new Fr(C,D)}}const Kp=Pe(Wl);class a_ extends Wc{project(e,i){i=Pe(i),e=Pe(e);const a=Math.cos(i),h=2/Math.PI,g=Math.acos(a*Math.cos(e/2)),b=Math.sin(g)/g,C=.5*(e*h+2*a*Math.sin(e/2)/b)||0,D=.5*(i+Math.sin(i)/b)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(D/Math.PI+1),z:0}}unproject(e,i){let a=e=(2*e-.5)*Math.PI,h=i=(2*(1-i)-1)*Math.PI,g=25;const b=1e-6;let C=0,D=0;do{const S=Math.cos(h),R=Math.sin(h),V=2*R*S,U=R*R,ee=S*S,oe=Math.cos(a/2),pe=Math.sin(a/2),Ie=2*oe*pe,Ne=pe*pe,at=1-ee*oe*oe,ot=at?1/at:0,yt=at?Math.acos(S*oe)*Math.sqrt(1/at):0,wt=.5*(2*yt*S*pe+2*a/Math.PI)-e,It=.5*(yt*R+h)-i,Wt=.5*ot*(ee*Ne+yt*S*oe*U)+1/Math.PI,Yt=ot*(Ie*V/4-yt*R*pe),dn=.125*ot*(V*pe-yt*R*ee*Ie),Tn=.5*ot*(U*oe+yt*Ne*S)+.5,Vt=Yt*dn-Tn*Wt;C=(It*Yt-wt*Tn)/Vt,D=(wt*dn-It*Wt)/Vt,a=St(a-C,-Math.PI,Math.PI),h=St(h-D,-Kp,Kp)}while((Math.abs(C)>b||Math.abs(D)>b)&&--g>0);return new Fr(ut(a),ut(h))}}class l_ extends Wc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Pe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:a,cosPhi:h}=this;return{x:Pe(e)*h*a+.5,y:-Math.sin(Pe(i))/h*a+.5,z:0}}unproject(e,i){const{scale:a,cosPhi:h}=this,g=-(i-.5)/a,b=St(ut((e-.5)/a)/h,-180,180),C=Math.asin(St(g*h,-1,1)),D=St(ut(C),-85.051129,Wl);return new Fr(b,D)}}class Ly extends o_{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,i,a){const h=Math.pow(2,a.z),g=(e/Ti+a.x)/h,b=ea(No((i/Ti+a.y)/h),Qs(g));return Fs(b,b,Iu(Kl(a))),{x:b[0],y:b[1],z:b[2]}}locationPoint(e,i){const a=ea(i.lat,i.lng),h=Da([],a),g=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;Bf(a,a,h,dl(1,0)*Ti*g);const b=Ms(new Float64Array(16));return El(b,e.pixelMatrix,e.globeMatrix),Fs(a,a,b),new ye(a[0],a[1])}pixelsPerMeter(e,i){return dl(1,0)*i}pixelSpaceConversion(e,i,a){const h=nn(dl(1,45)*i,dl(1,e)*i,a);return this.pixelsPerMeter(e,i)/h}createTileMatrix(e,i,a){const h=xd(Kl(a.canonical));return El(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,i){const{center:a}=e,h=Ms(new Float64Array(16));return El(h,h,Iu(Kl(i))),wp(h,h,Pe(a.lng)),vu(h,h,Pe(a.lat)),Ka(h,h,[e._projectionScaler,e._projectionScaler,1]),Float32Array.from(h)}pointCoordinate(e,i,a,h){return $p(e,i,a,!0)||new td(0,0)}pointCoordinate3D(e,i,a){const h=this.pointCoordinate(e,i,a,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,i){return!$p(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(h,g){const b=h.cameraToCenterDistance,C=h._centerAltitude*g,D=h._camera,S=h._camera.forward(),R=bu([],jc([],S,-b),[0,0,C]),V=h.worldSize/(2*Math.PI),U=[0,0,-V],ee=h.width/h.height,oe=Math.tan(h.fovAboveCenter),pe=jc([],D.up(),oe),Ie=jc([],D.right(),oe*ee),Ne=Da([],bu([],bu([],S,pe),Ie)),at=[];let ot;if(new Nf(R,Ne).closestPointOnSphere(U,V,at)){const yt=bu([],at,U),wt=hl([],yt,R);ot=Math.cos(h.fovAboveCenter)*cd(wt)}else{const yt=hl([],R,U),wt=hl([],U,R);Da(wt,wt);const It=cd(yt)-V;ot=Math.sqrt(It*(It+2*V));const Wt=Math.acos(ot/(V+It))-Math.acos(ql(S,wt));ot*=Math.cos(Wt)}return 1.01*ot}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=Zc(e.zoom);if(a>0){const h=Em(e,dl(1,e.center.lat)*e.worldSize),g=e.worldSize/(2*Math.PI),b=Math.max(e.width,e.height)/e.worldSize*Math.PI;return nn(i,h+g*(1-Math.cos(b)),Math.pow(a,10))}return i}upVector(e,i,a){const h=1<<e.z,g=(i/Ti+e.x)/h;return ea(No((a/Ti+e.y)/h),Qs(g),1)}upVectorScale(e){return{metersToTile:Qh*Zp(Kl(e))}}}function c_(n){const e=n.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new o_(n);case"equirectangular":return new i_(n);case"naturalEarth":return new Ry(n);case"equalEarth":return new n_(n);case"winkelTripel":return new a_(n);case"albers":return i?new l_(n):new Dm(n);case"lambertConformalConic":return i?new l_(n):new r_(n);case"globe":return new Ly(n)}throw new Error(`Invalid projection name: ${n.name}`)}const u_=Du.VectorTileFeature.types,Fy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tp(n,e,i,a,h,g,b,C,D,S,R,V,U){const ee=C?Math.min(bd,Math.round(C[0])):0,oe=C?Math.min(bd,Math.round(C[1])):0;n.emplaceBack(e,i,Math.round(32*a),Math.round(32*h),g,b,(ee<<1)+(D?1:0),oe,16*S,16*R,256*V,256*U)}function Xp(n,e,i,a,h,g,b){n.emplaceBack(e,i,a,h,g,b)}function Qp(n,e,i,a,h){n.emplaceBack(e,i,a,h),n.emplaceBack(e,i,a,h),n.emplaceBack(e,i,a,h),n.emplaceBack(e,i,a,h)}function d_(n){for(const e of n.sections)if(E(e.text))return!0;return!1}class Jp{constructor(e){this.layoutVertexArray=new Ya,this.indexArray=new sr,this.programConfigurations=e,this.segments=new Io,this.dynamicLayoutVertexArray=new mr,this.opacityVertexArray=new hc,this.placedSymbolArray=new fc,this.globeExtVertexArray=new cl}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Yl.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Fy,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Ig.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Jn(Jp,"SymbolBuffers");class Tm{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new Io,this.collisionVertexArray=new mo,this.collisionVertexArrayExt=new es}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,_y.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Hh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Jn(Tm,"CollisionBuffers");class ta{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(b=>b.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ms([]),this.placementViewportMatrix=Ms([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fp(this.zoom,i["text-size"]),this.iconSizeData=Fp(this.zoom,i["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),g=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==g&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===g||"auto"===g&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(b=>fl[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Jp(new mu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Jp(new mu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Qu,this.lineVertexArray=new yf,this.symbolInstances=new tg}calculateGlyphDependencies(e,i,a,h,g){for(let b=0;b<e.length;b++)if(i[e.charCodeAt(b)]=!0,h&&g){const C=nh[e.charAt(b)];C&&(i[C.charCodeAt(0)]=!0)}}populate(e,i,a,h){const g=this.layers[0],b=g.layout,C="globe"===this.projection.name,D=b.get("text-font"),S=b.get("text-field"),R=b.get("icon-image"),V=("constant"!==S.value.kind||S.value.value instanceof lo&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==D.value.kind||D.value.value.length>0),U="constant"!==R.value.kind||!!R.value.value||Object.keys(R.parameters).length>0,ee=b.get("symbol-sort-key");if(this.features=[],!V&&!U)return;const oe=i.iconDependencies,pe=i.glyphDependencies,Ie=i.availableImages,Ne=new ke(this.zoom);for(const{feature:at,id:ot,index:yt,sourceLayerIndex:wt}of e){const It=g._featureFilter.needGeometry,Wt=Vc(at,It);if(!g._featureFilter.filter(Ne,Wt,a))continue;if(It||(Wt.geometry=Nc(at,a,h)),C&&1!==at.type&&a.z<=5){const Vt=Wt.geometry,on=1<<a.z,Sn=a.x,Dn=a.y,Kn=.98078528056;for(let wn=0;wn<Vt.length;wn++)Vt[wn]=nd(Vt[wn],$n=>$n,($n,Hi)=>ql(ea(No(($n.y/Ti+Dn)/on),Qs(($n.x/Ti+Sn)/on),1),ea(No((Hi.y/Ti+Dn)/on),Qs((Hi.x/Ti+Sn)/on),1))<Kn)}let Yt,dn;if(V){const Vt=g.getValueAndResolveTokens("text-field",Wt,a,Ie),on=lo.factory(Vt);d_(on)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===xe()||this.hasRTLText&&Ee.isParsed())&&(Yt=ar(on,g,Wt))}if(U){const Vt=g.getValueAndResolveTokens("icon-image",Wt,a,Ie);dn=Vt instanceof Ps?Vt:Ps.fromString(Vt)}if(!Yt&&!dn)continue;const Tn=this.sortFeaturesByKey?ee.evaluate(Wt,{},a):void 0;if(this.features.push({id:ot,text:Yt,icon:dn,index:yt,sourceLayerIndex:wt,geometry:Wt.geometry,properties:at.properties,type:u_[at.type],sortKey:Tn}),dn&&(oe[dn.name]=!0),Yt){const Vt=D.evaluate(Wt,{},a).join(","),on="map"===b.get("text-rotation-alignment")&&"point"!==b.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(fl.vertical)>=0;for(const Sn of Yt.sections)if(Sn.image)oe[Sn.image.name]=!0;else{const Dn=wl(Yt.toString()),Kn=Sn.fontStack||Vt,wn=pe[Kn]=pe[Kn]||{};this.calculateGlyphDependencies(Sn.text,wn,on,this.allowVerticalPlacement,Dn)}}}"line"===b.get("symbol-placement")&&(this.features=function(at){const ot={},yt={},wt=[];let It=0;function Wt(Vt){wt.push(at[Vt]),It++}function Yt(Vt,on,Sn){const Dn=yt[Vt];return delete yt[Vt],yt[on]=Dn,wt[Dn].geometry[0].pop(),wt[Dn].geometry[0]=wt[Dn].geometry[0].concat(Sn[0]),Dn}function dn(Vt,on,Sn){const Dn=ot[on];return delete ot[on],ot[Vt]=Dn,wt[Dn].geometry[0].shift(),wt[Dn].geometry[0]=Sn[0].concat(wt[Dn].geometry[0]),Dn}function Tn(Vt,on,Sn){const Dn=Sn?on[0][on[0].length-1]:on[0][0];return`${Vt}:${Dn.x}:${Dn.y}`}for(let Vt=0;Vt<at.length;Vt++){const on=at[Vt],Sn=on.geometry,Dn=on.text?on.text.toString():null;if(!Dn){Wt(Vt);continue}const Kn=Tn(Dn,Sn),wn=Tn(Dn,Sn,!0);if(Kn in yt&&wn in ot&&yt[Kn]!==ot[wn]){const $n=dn(Kn,wn,Sn),Hi=Yt(Kn,wn,wt[$n].geometry);delete ot[Kn],delete yt[wn],yt[Tn(Dn,wt[Hi].geometry,!0)]=Hi,wt[$n].geometry=null}else Kn in yt?Yt(Kn,wn,Sn):wn in ot?dn(Kn,wn,Sn):(Wt(Vt),ot[Kn]=It-1,yt[wn]=It-1)}return wt.filter(Vt=>Vt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((at,ot)=>at.sortKey-ot.sortKey)}update(e,i,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a,h),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=c_(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length,h=e.segment;if(void 0!==h){let g=e.dist(i[h+1]),b=e.dist(i[h]);const C={};for(let D=h+1;D<i.length;D++)C[D]={x:i[D].x,y:i[D].y,tileUnitDistanceFromAnchor:g},D<i.length-1&&(g+=i[D+1].dist(i[D]));for(let D=h||0;D>=0;D--)C[D]={x:i[D].x,y:i[D].y,tileUnitDistanceFromAnchor:b},D>0&&(b+=i[D-1].dist(i[D]));for(let D=0;D<i.length;D++){const S=C[D];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,h,g,b,C,D,S,R,V,U,ee,oe){const pe=e.indexArray,Ie=e.layoutVertexArray,Ne=e.globeExtVertexArray,at=e.segments.prepareSegment(4*i.length,Ie,pe,this.canOverlap?b.sortKey:void 0),ot=this.glyphOffsetArray.length,yt=at.vertexLength,wt=this.allowVerticalPlacement&&C===fl.vertical?Math.PI/2:0,It=b.text&&b.text.sections;for(let Yt=0;Yt<i.length;Yt++){const{tl:dn,tr:Tn,bl:Vt,br:on,tex:Sn,pixelOffsetTL:Dn,pixelOffsetBR:Kn,minFontScaleX:wn,minFontScaleY:$n,glyphOffset:Hi,isSDF:qi,sectionIndex:gi}=i[Yt],Qn=at.vertexLength,lr=Hi[1];if(tp(Ie,S.x,S.y,dn.x,lr+dn.y,Sn.x,Sn.y,a,qi,Dn.x,Dn.y,wn,$n),tp(Ie,S.x,S.y,Tn.x,lr+Tn.y,Sn.x+Sn.w,Sn.y,a,qi,Kn.x,Dn.y,wn,$n),tp(Ie,S.x,S.y,Vt.x,lr+Vt.y,Sn.x,Sn.y+Sn.h,a,qi,Dn.x,Kn.y,wn,$n),tp(Ie,S.x,S.y,on.x,lr+on.y,Sn.x+Sn.w,Sn.y+Sn.h,a,qi,Kn.x,Kn.y,wn,$n),D){const $i=D.anchor,ai=D.up;Xp(Ne,$i.x,$i.y,$i.z,ai[0],ai[1],ai[2]),Xp(Ne,$i.x,$i.y,$i.z,ai[0],ai[1],ai[2]),Xp(Ne,$i.x,$i.y,$i.z,ai[0],ai[1],ai[2]),Xp(Ne,$i.x,$i.y,$i.z,ai[0],ai[1],ai[2]),Qp(e.dynamicLayoutVertexArray,$i.x,$i.y,$i.z,wt)}else Qp(e.dynamicLayoutVertexArray,S.x,S.y,S.z,wt);pe.emplaceBack(Qn,Qn+1,Qn+2),pe.emplaceBack(Qn+1,Qn+2,Qn+3),at.vertexLength+=4,at.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Hi[0]),Yt!==i.length-1&&gi===i[Yt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Ie.length,b,b.index,{},ee,oe,It&&It[gi])}const Wt=D?D.anchor:S;e.placedSymbolArray.emplaceBack(Wt.x,Wt.y,Wt.z,S.x,S.y,ot,this.glyphOffsetArray.length-ot,yt,R,V,S.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],C,0,!1,0,U,0)}_commitLayoutVertex(e,i,a,h,g,b,C){e.emplaceBack(i,a,h,g,b,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(e,i,a,h,g,b,C){const D=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),S=D.vertexLength,R=C.tileAnchorX,V=C.tileAnchorY;for(let ee=0;ee<4;ee++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,h,g,b,R,V,new ye(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,g,b,R,V,new ye(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,h,g,b,R,V,new ye(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,h,g,b,R,V,new ye(e.x1,e.y2)),D.vertexLength+=4;const U=a.indexArray;U.emplaceBack(S,S+1),U.emplaceBack(S+1,S+2),U.emplaceBack(S+2,S+3),U.emplaceBack(S+3,S),D.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,a,h,g,b){for(let C=h;C<g;C++){const D=a.get(C),S=this.getSymbolInstanceTextSize(e,b,i,C);this._addCollisionDebugVertices(D,S,this.textCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(e,i,a,h,g,b){for(let C=h;C<g;C++){const D=a.get(C),S=this.getSymbolInstanceIconSize(e,i,C);this._addCollisionDebugVertices(D,S,this.iconCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,b)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tm(no,Pg.members,Ao),this.iconCollisionBox=new Tm(no,Pg.members,Ao);const a=th(this.iconSizeData,e),h=th(this.textSizeData,e);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(h,e,i,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(h,e,i,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(a,e,i,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(a,e,i,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(e,i,a,h){const g=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),b=Bp(this.textSizeData,e,g)/24;return this.tilePixelRatio*b}getSymbolInstanceIconSize(e,i,a){const h=this.icon.placedSymbolArray.get(a),g=Bp(this.iconSizeData,e,h);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(e,i,a){e.emplaceBack(i,-a,-a),e.emplaceBack(i,a,-a),e.emplaceBack(i,a,a),e.emplaceBack(i,-a,a)}_updateTextDebugCollisionBoxes(e,i,a,h,g,b){for(let C=h;C<g;C++){const D=a.get(C),S=this.getSymbolInstanceTextSize(e,b,i,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,D.padding)}}_updateIconDebugCollisionBoxes(e,i,a,h,g){for(let b=h;b<g;b++){const C=a.get(b),D=this.getSymbolInstanceIconSize(e,i,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,C.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=th(this.iconSizeData,e),h=th(this.textSizeData,e);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(h,e,i,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(h,e,i,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(a,e,i,b.iconBoxStartIndex,b.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(a,e,i,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,a,h,g,b,C,D,S){const R={};for(let V=i;V<a;V++){const U=e.get(V);R.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},R.textFeatureIndex=U.featureIndex;break}for(let V=h;V<g;V++){const U=e.get(V);R.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},R.verticalTextFeatureIndex=U.featureIndex;break}for(let V=b;V<C;V++){const U=e.get(V);R.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},R.iconFeatureIndex=U.featureIndex;break}for(let V=D;V<S;V++){const U=e.get(V);R.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},R.verticalIconFeatureIndex=U.featureIndex;break}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),h=a.vertexStartIndex+4*a.numGlyphs;for(let g=a.vertexStartIndex;g<h;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),h=[],g=[],b=[];for(let C=0;C<this.symbolInstances.length;++C){b.push(C);const D=this.symbolInstances.get(C);h.push(0|Math.round(i*D.tileAnchorX+a*D.tileAnchorY)),g.push(D.featureIndex)}return b.sort((C,D)=>h[C]-h[D]||g[D]-g[C]),b}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,g,b)=>{h>=0&&b.indexOf(h)===g&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Jn(ta,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ta.MAX_GLYPHS=65535,ta.addDynamicAttributes=Qp;const Sm=new tn({"symbol-placement":new jt(At.layout_symbol["symbol-placement"]),"symbol-spacing":new jt(At.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jt(At.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new it(At.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jt(At.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jt(At.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new jt(At.layout_symbol["icon-ignore-placement"]),"icon-optional":new jt(At.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jt(At.layout_symbol["icon-rotation-alignment"]),"icon-size":new it(At.layout_symbol["icon-size"]),"icon-text-fit":new jt(At.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt(At.layout_symbol["icon-text-fit-padding"]),"icon-image":new it(At.layout_symbol["icon-image"]),"icon-rotate":new it(At.layout_symbol["icon-rotate"]),"icon-padding":new jt(At.layout_symbol["icon-padding"]),"icon-keep-upright":new jt(At.layout_symbol["icon-keep-upright"]),"icon-offset":new it(At.layout_symbol["icon-offset"]),"icon-anchor":new it(At.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jt(At.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jt(At.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jt(At.layout_symbol["text-rotation-alignment"]),"text-field":new it(At.layout_symbol["text-field"]),"text-font":new it(At.layout_symbol["text-font"]),"text-size":new it(At.layout_symbol["text-size"]),"text-max-width":new it(At.layout_symbol["text-max-width"]),"text-line-height":new it(At.layout_symbol["text-line-height"]),"text-letter-spacing":new it(At.layout_symbol["text-letter-spacing"]),"text-justify":new it(At.layout_symbol["text-justify"]),"text-radial-offset":new it(At.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jt(At.layout_symbol["text-variable-anchor"]),"text-anchor":new it(At.layout_symbol["text-anchor"]),"text-max-angle":new jt(At.layout_symbol["text-max-angle"]),"text-writing-mode":new jt(At.layout_symbol["text-writing-mode"]),"text-rotate":new it(At.layout_symbol["text-rotate"]),"text-padding":new jt(At.layout_symbol["text-padding"]),"text-keep-upright":new jt(At.layout_symbol["text-keep-upright"]),"text-transform":new it(At.layout_symbol["text-transform"]),"text-offset":new it(At.layout_symbol["text-offset"]),"text-allow-overlap":new jt(At.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new jt(At.layout_symbol["text-ignore-placement"]),"text-optional":new jt(At.layout_symbol["text-optional"])});var io={paint:new tn({"icon-opacity":new it(At.paint_symbol["icon-opacity"]),"icon-color":new it(At.paint_symbol["icon-color"]),"icon-halo-color":new it(At.paint_symbol["icon-halo-color"]),"icon-halo-width":new it(At.paint_symbol["icon-halo-width"]),"icon-halo-blur":new it(At.paint_symbol["icon-halo-blur"]),"icon-translate":new jt(At.paint_symbol["icon-translate"]),"icon-translate-anchor":new jt(At.paint_symbol["icon-translate-anchor"]),"text-opacity":new it(At.paint_symbol["text-opacity"]),"text-color":new it(At.paint_symbol["text-color"],{runtimeType:ls,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new it(At.paint_symbol["text-halo-color"]),"text-halo-width":new it(At.paint_symbol["text-halo-width"]),"text-halo-blur":new it(At.paint_symbol["text-halo-blur"]),"text-translate":new jt(At.paint_symbol["text-translate"]),"text-translate-anchor":new jt(At.paint_symbol["text-translate-anchor"])}),layout:Sm};class np{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:as,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jn(np,"FormatSectionOverride",{omit:["defaultValue"]});class Am extends $l{constructor(e){super(e,io)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const g of a)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,h){const g=this.layout.get(e).evaluate(i,{},a,h),b=this._unevaluatedLayout._values[e];return b.isDataDriven()||vl(b.value)||!g?g:(C=i.properties,g.replace(/{([^{}]+)}/g,(S,R)=>R in C?String(C[R]):""));var C}createBucket(e){return new ta(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of io.paint.overridableProperties){if(!Am.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new np(i),h=new qs(a,i.property.specification);let g=null;g="constant"===i.value.kind||"source"===i.value.kind?new kl("source",h):new oc("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Zt(i.property,g,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&Am.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),h=io.paint.properties[i];let g=!1;const b=C=>{for(const D of C)if(h.overrides&&h.overrides.hasOverride(D))return void(g=!0)};if("constant"===a.value.kind&&a.value.value instanceof lo)b(a.value.value.sections);else if("source"===a.value.kind){const C=S=>{g||(S instanceof sa&&Wr(S.value)===Go?b(S.value.sections):S instanceof Gs?b(S.sections):S.eachChild(C))},D=a.value;D._styleExpression&&C(D._styleExpression.expression)}return g}getProgramConfiguration(e){return new fu(this,e)}}var h_={paint:new tn({"background-color":new jt(At.paint_background["background-color"]),"background-pattern":new hn(At.paint_background["background-pattern"]),"background-opacity":new jt(At.paint_background["background-opacity"])})},By={paint:new tn({"raster-opacity":new jt(At.paint_raster["raster-opacity"]),"raster-hue-rotate":new jt(At.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jt(At.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jt(At.paint_raster["raster-brightness-max"]),"raster-saturation":new jt(At.paint_raster["raster-saturation"]),"raster-contrast":new jt(At.paint_raster["raster-contrast"]),"raster-resampling":new jt(At.paint_raster["raster-resampling"]),"raster-fade-duration":new jt(At.paint_raster["raster-fade-duration"])})};class zy extends $l{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var Ny={paint:new tn({"sky-type":new jt(At.paint_sky["sky-type"]),"sky-atmosphere-sun":new jt(At.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new jt(At.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new jt(At.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new jt(At.paint_sky["sky-gradient-radius"]),"sky-gradient":new Un(At.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new jt(At.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new jt(At.paint_sky["sky-atmosphere-color"]),"sky-opacity":new jt(At.paint_sky["sky-opacity"])})};function fh(n,e,i){const a=[0,0,1],h=$d([]);return gg(h,h,i?-Pe(n)+Math.PI:Pe(n)),mg(h,h,-Pe(e)),zf(a,a,h),Da(a,a)}const p_={circle:class extends $l{constructor(n){super(n,Cv)}createBucket(n){return new Ih(n)}queryRadius(n){const e=n;return yu("circle-radius",this,e)+yu("circle-stroke-width",this,e)+bp(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,a,h,g,b,C){const D=Oh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,n.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return _g(n,a,g,b,C,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),D,S)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new fu(this,n)}},heatmap:class extends $l{createBucket(n){return new yg(n)}constructor(n){super(n,jf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Lh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return yu("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,a,h,g,b,C){const D=this.paint.get("heatmap-radius").evaluate(e,i);return _g(n,a,g,b,C,!0,!0,new ye(0,0),D)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new fu(this,n)}},hillshade:class extends $l{constructor(n){super(n,Js)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends $l{constructor(n){super(n,qd)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new fu(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Wd(n)}queryRadius(){return bp(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,a,h,g){return!n.queryGeometry.isAboveHorizon&&kf(Ff(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,n.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends $l{constructor(n){super(n,Dg)}createBucket(n){return new Tu(n)}queryRadius(){return bp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new fu(this,n)}queryIntersectsFeature(n,e,i,a,h,g,b,C,D){const S=Oh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,n.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(e,i),V=this.paint.get("fill-extrusion-base").evaluate(e,i),U=[0,0],ee=C&&g.elevation,oe=g.elevation?g.elevation.exaggeration():1,pe=n.tile.getBucket(this);if(ee&&pe instanceof Tu){const at=pe.centroidVertexArray,ot=D+1;if(ot<at.length){const yt=at.get(ot);U[0]=yt.a_centroid_pos0,U[1]=yt.a_centroid_pos1}}if(0===U[0]&&1===U[1])return!1;"globe"===g.projection.name&&(a=nm([a],[new ye(0,0),new ye(Ti,Ti)],n.tileID.canonical).map(at=>at.polygon).flat());const Ie=(ot=a,yt=V,wt=R,It=S,Wt=b,Yt=ee?C:null,dn=U,Tn=oe,Vt=g.center.lat,"globe"===(at=g).projection.name?function(Sn,Dn,Kn,wn,$n,Hi,qi,gi,Qn,lr,$i){const ai=[],Oo=[],ko=Sn.projection.upVectorScale($i,Sn.center.lat,Sn.worldSize).metersToTile,ro=[0,0,0,1],er=[0,0,0,1],pr=(Pr,Or,Yr,Kr)=>{Pr[0]=Or,Pr[1]=Yr,Pr[2]=Kr,Pr[3]=1},Nr=tm();Kn>0&&(Kn+=Nr),wn+=Nr;for(const Pr of Dn){const Or=[],Yr=[];for(const Kr of Pr){const ts=Kr.x+$n.x,Ia=Kr.y+$n.y,dr=Sn.projection.projectTilePoint(ts,Ia,$i),go=Sn.projection.upVector($i,Kr.x,Kr.y);let zs=Kn,Mr=wn;if(qi){const ho=Jd(ts,Ia,Kn,wn,qi,gi,Qn,lr);zs+=ho.base,Mr+=ho.top}0!==Kn?pr(ro,dr.x+go[0]*ko*zs,dr.y+go[1]*ko*zs,dr.z+go[2]*ko*zs):pr(ro,dr.x,dr.y,dr.z),pr(er,dr.x+go[0]*ko*Mr,dr.y+go[1]*ko*Mr,dr.z+go[2]*ko*Mr),Fs(ro,ro,Hi),Fs(er,er,Hi),Or.push(Qd(ro)),Yr.push(Qd(er))}ai.push(Or),Oo.push(Yr)}return[ai,Oo]}(at,ot,yt,wt,It,Wt,Yt,dn,Tn,Vt,n.tileID.canonical):Yt?function(Sn,Dn,Kn,wn,$n,Hi,qi,gi,Qn){const lr=[],$i=[],ai=[0,0,0,1];for(const Oo of Sn){const ko=[],ro=[];for(const er of Oo){const pr=er.x+wn.x,Nr=er.y+wn.y,Pr=Jd(pr,Nr,Dn,Kn,Hi,qi,gi,Qn);ai[0]=pr,ai[1]=Nr,ai[2]=Pr.base,ai[3]=1,ud(ai,ai,$n),ai[3]=Math.max(ai[3],1e-5);const Or=Qd([ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]]);ai[0]=pr,ai[1]=Nr,ai[2]=Pr.top,ai[3]=1,ud(ai,ai,$n),ai[3]=Math.max(ai[3],1e-5);const Yr=Qd([ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]]);ko.push(Or),ro.push(Yr)}lr.push(ko),$i.push(ro)}return[lr,$i]}(ot,yt,wt,It,Wt,Yt,dn,Tn,Vt):function(Sn,Dn,Kn,wn,$n){const Hi=[],qi=[],gi=$n[8]*Dn,Qn=$n[9]*Dn,lr=$n[10]*Dn,$i=$n[11]*Dn,ai=$n[8]*Kn,Oo=$n[9]*Kn,ko=$n[10]*Kn,ro=$n[11]*Kn;for(const er of Sn){const pr=[],Nr=[];for(const Pr of er){const Or=Pr.x+wn.x,Yr=Pr.y+wn.y,Kr=$n[0]*Or+$n[4]*Yr+$n[12],ts=$n[1]*Or+$n[5]*Yr+$n[13],Ia=$n[2]*Or+$n[6]*Yr+$n[14],dr=$n[3]*Or+$n[7]*Yr+$n[15],go=Kr+gi,zs=ts+Qn,Mr=Ia+lr,ho=Math.max(dr+$i,1e-5),na=Kr+ai,_i=ts+Oo,wo=Ia+ko,ns=Math.max(dr+ro,1e-5),is=new ye(go/ho,zs/ho);is.z=Mr/ho,pr.push(is);const Ts=new ye(na/ns,_i/ns);Ts.z=wo/ns,Nr.push(Ts)}Hi.push(pr),qi.push(Nr)}return[Hi,qi]}(ot,yt,wt,It,Wt)),Ne=n.queryGeometry;var at,ot,yt,wt,It,Wt,Yt,dn,Tn,Vt;return function(at,ot,yt){let wt=1/0;kf(yt,ot)&&(wt=im(yt,ot[0]));for(let It=0;It<ot.length;It++){const Wt=ot[It],Yt=at[It];for(let dn=0;dn<Wt.length-1;dn++){const Tn=Wt[dn],Vt=[Tn,Wt[dn+1],Yt[dn+1],Yt[dn],Tn];Ph(yt,Vt)&&(wt=Math.min(wt,im(yt,Vt)))}}return wt!==1/0&&wt}(Ie[0],Ie[1],Ne.isPointQuery()?Ne.screenBounds:Ne.screenGeometry)}},line:class extends $l{constructor(n){super(n,rm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof xn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=Ag.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new eh(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new fu(this,n)}queryRadius(n){const e=n,i=om(yu("line-width",this,e),yu("line-gap-width",this,e)),a=yu("line-offset",this,e);return i/2+Math.abs(a)+bp(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,a,h,g){if(n.queryGeometry.isAboveHorizon)return!1;const b=Ff(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,n.pixelToTileUnitsFactor),C=n.pixelToTileUnitsFactor/2*om(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),D=this.paint.get("line-offset").evaluate(e,i);return D&&(a=function(S,R){const V=[],U=new ye(0,0);for(let ee=0;ee<S.length;ee++){const oe=S[ee],pe=[];for(let Ie=0;Ie<oe.length;Ie++){const Ne=oe[Ie-1],at=oe[Ie],ot=oe[Ie+1],yt=0===Ie?U:at.sub(Ne)._unit()._perp(),wt=Ie===oe.length-1?U:ot.sub(at)._unit()._perp(),It=yt._add(wt)._unit();It._mult(1/(It.x*wt.x+It.y*wt.y)),pe.push(It._mult(R)._add(at))}V.push(pe)}return V}(a,D*n.pixelToTileUnitsFactor)),function(S,R,V){for(let U=0;U<R.length;U++){const ee=R[U];if(S.length>=3)for(let oe=0;oe<ee.length;oe++)if(_u(S,ee[oe]))return!0;if(Rf(S,ee,V))return!0}return!1}(b,a,C)}isTileClipped(){return!0}},symbol:Am,background:class extends $l{constructor(n){super(n,h_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends $l{constructor(n){super(n,By)}getProgramIds(){return["raster"]}},sky:class extends $l{constructor(n){super(n,Ny),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Lh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const a=this.paint.get("sky-atmosphere-sun"),h=!a,g=n.style.light,b=g.properties.get("position");return h&&"viewport"===g.properties.get("anchor")&&Yn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?fh(b.azimuthal,90-b.polar,e):fh(a[0],90-a[1],e)}const i=this.paint.get("sky-gradient-center");return fh(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class Cd{constructor(e,i,a,h){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(i,h)}update(e,i,a){const{width:h,height:g}=e,{context:b}=this,{gl:C}=b,{HTMLImageElement:D,HTMLCanvasElement:S,HTMLVideoElement:R,ImageData:V,ImageBitmap:U}=Ce;if(C.bindTexture(C.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!i||!1!==i.premultiply)),a||this.size&&this.size[0]===h&&this.size[1]===g){const{x:ee,y:oe}=a||{x:0,y:0};e instanceof D||e instanceof S||e instanceof R||e instanceof V||U&&e instanceof U?C.texSubImage2D(C.TEXTURE_2D,0,ee,oe,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,ee,oe,h,g,C.RGBA,C.UNSIGNED_BYTE,e.data)}else this.size=[h,g],e instanceof D||e instanceof S||e instanceof R||e instanceof V||U&&e instanceof U?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,h,g,0,this.format,C.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(e,i){const{context:a}=this,{gl:h}=a;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class qc{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Vo({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const a=this.getKey(e,i);return this.positions[a]}trim(){const e=this.width,i=this.height=vn(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,a){const h=[];let g=e.length%2==1?-e[e.length-1]*a:0,b=e[0]*a,C=!0;h.push({left:g,right:b,isDash:C,zeroLength:0===e[0]});let D=e[0];for(let S=1;S<e.length;S++){C=!C;const R=e[S];g=D*a,D+=R,b=D*a,h.push({left:g,right:b,isDash:C,zeroLength:0===R})}return h}addRoundDash(e,i,a){const h=i/2;for(let g=-a;g<=a;g++){const b=this.width*(this.nextRow+a+g);let C=0,D=e[C];for(let S=0;S<this.width;S++){S/D.right>1&&(D=e[++C]);const R=Math.abs(S-D.left),V=Math.abs(S-D.right),U=Math.min(R,V);let ee;const oe=g/a*(h+1);if(D.isDash){const pe=h-Math.abs(oe);ee=Math.sqrt(U*U+pe*pe)}else ee=h-Math.sqrt(U*U+oe*oe);this.image.data[b+S]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(e,i){for(let D=e.length-1;D>=0;--D){const S=e[D],R=e[D+1];S.zeroLength?e.splice(D,1):R&&R.isDash===S.isDash&&(R.left=S.left,e.splice(D,1))}const a=e[0],h=e[e.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const g=this.width*this.nextRow;let b=0,C=e[b];for(let D=0;D<this.width;D++){D/C.right>1&&(C=e[++b]);const S=Math.abs(D-C.left),R=Math.abs(D-C.right),V=Math.min(S,R);this.image.data[g+D]=Math.max(0,Math.min(255,(C.isDash?V:-V)+i+128))}}addDash(e,i){const a=this.getKey(e,i);if(this.positions[a])return this.positions[a];const h="round"===i,g=h?7:0,b=2*g+1;if(this.nextRow+b>this.height)return Yn("LineAtlas out of space"),null;0===e.length&&e.push(1);let C=0;for(let R=0;R<e.length;R++)e[R]<0&&(Yn("Negative value is found in line dasharray, replacing values with 0"),e[R]=0),C+=e[R];if(0!==C){const R=this.width/C,V=this.getDashRanges(e,this.width,R);h?this.addRoundDash(V,R,g):this.addRegularDash(V,"square"===i?.5*R:0)}const D=this.nextRow+g;this.nextRow+=b;const S={tl:[D,g],br:[C,0]};return this.positions[a]=S,S}}Jn(qc,"LineAtlas");class ef{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class f_{constructor(){this.tasks={},this.taskQueue=[],Tt(["process"],this),this.invoker=new ef(this.process),this.nextId=0}add(e,i){const a=this.nextId++,h=function({type:g,isSymbolTile:b,zoom:C}){return C=C||0,"message"===g?0:"maybePrepare"!==g||b?"parseTile"!==g||b?"parseTile"===g&&b?300-C:"maybePrepare"===g&&b?400-C:500:200-C:100-C}(i);if(0===h){Di();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:i,priority:h,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){Di();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const g=this.tasks[this.taskQueue[h]];g.priority<i&&(i=g.priority,e=h)}if(null===e)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class Im{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Pm=["tile","layer","source","sourceLayer","state"];class Om{constructor(e,i,a,h,g){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=a,this._y=h,this.properties=e.properties,this.id=g}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const i of Pm)void 0!==this[i]&&(e[i]=this[i]);return e}}const xo=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,a=0,h=0,g=0,b=0,C=0;for(1&e?h=g=b=32:i=a=C=32;(e>>=1)>1;){const S=i+h>>1,R=a+g>>1;1&e?(h=i,g=a,i=b,a=C):(i=h,a=g,h=b,g=C),b=S,C=R}const D=4*n;xo[D+0]=i,xo[D+1]=a,xo[D+2]=h,xo[D+3]=g}const Yc=new Uint16Array(2178),Qa=new Uint8Array(1089),Ai=new Uint16Array(1089);function Ji(n){return 0===n?-.03125:32===n?.03125:0}var ml=Nn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const mh={type:2,extent:Ti,loadGeometry:()=>[[new ye(0,0),new ye(8193,0),new ye(8193,8193),new ye(0,8193),new ye(0,0)]]};class Aa{constructor(e,i,a,h,g){this.tileID=e,this.uid=Jt(),this.uses=0,this.tileSize=i,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<or.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=wc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,g){const b={};if(!g)return b;for(const C of h){const D=C.layerIds.map(S=>g.getLayer(S)).filter(Boolean);if(0!==D.length){C.layers=D,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(S=>D.filter(R=>R.id===S)[0]));for(const S of D)b[S.id]=C}}return b}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const g=this.buckets[h];if(g instanceof ta){if(this.hasSymbolBuckets=!0,!a)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const g=this.buckets[h];if(g instanceof ta&&g.hasRTLText){this.hasRTLText=!0,Ee.isLoading()||Ee.isLoaded()||"deferred"!==xe()||$e();break}}this.queryPadding=0;for(const h in this.buckets){const g=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new hp}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const h=this.buckets[a];h.uploadPending()&&h.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Cd(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Cd(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Cd(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,a,h,g,b,C,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:C,transform:b,params:g,tileTransform:this.tileTransform},e,i,a):{}}querySourceFeatures(e,i){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const h=a.loadVTLayers(),g=i?i.sourceLayer:"",b=h._geojsonTileLayer||h[g];if(!b)return;const C=Wo(i&&i.filter),{z:D,x:S,y:R}=this.tileID.canonical,V={z:D,x:S,y:R};for(let U=0;U<b.length;U++){const ee=b.feature(U);if(C.needGeometry){const Ie=Vc(ee,!0);if(!C.filter(new ke(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!C.filter(new ke(this.tileID.overscaledZ),ee))continue;const oe=a.getId(ee,g),pe=new Om(ee,D,S,R,oe);pe.tile=V,e.push(pe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const a=Ui(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let h=!1;if(this.expirationTime>a)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const g=this.expirationTime-i;g?this.expirationTime=a+Math.max(g,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const a=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const g in this.buckets){if(!i.style.hasLayer(g))continue;const b=this.buckets[g],C=b.layers[0].sourceLayer||"_geojsonTileLayer",D=a[C],S=e[C];if(!D||!S||0===Object.keys(S).length)continue;if(b.update(S,D,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof eh||b instanceof Wd){const V=i.style._getSourceCache(b.layers[0].source);i._terrain&&i._terrain.enabled&&V&&b.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(V.id,this.tileID)}const R=i&&i.style&&i.style.getLayer(g);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(b)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<or.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=or.now()+e}setTexture(e,i){const a=i.context,h=a.gl;this.texture=i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Cd(a,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),a.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax))}setDependencies(e,i){const a={};for(const h of i)a[h]=!0;this.dependencies[e]=a}hasDependency(e,i){for(const a of e){const h=this.dependencies[a];if(h)for(const g of i)if(h[g])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const a=Nc(mh,this.tileID.canonical,this.tileTransform)[0],h=new bi,g=new Er;for(let b=0;b<a.length;b++){const{x:C,y:D}=a[b];h.emplaceBack(C,D),g.emplaceBack(b)}g.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(g),this._tileDebugBuffer=e.createVertexBuffer(h,Hp.members),this._tileDebugSegments=Io.simpleSegment(0,0,h.length,g.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const a=Nc(mh,this.tileID.canonical,this.tileTransform)[0];let h,g;if(this.isRaster){const b=function(C,D){const S=wc(C,D),R=Math.pow(2,C.z);for(let Ie=0;Ie<33;Ie++)for(let Ne=0;Ne<33;Ne++){const at=Qs((C.x+(Ne+Ji(Ne))/32)/R),ot=No((C.y+(Ie+Ji(Ie))/32)/R),yt=D.project(at,ot),wt=33*Ie+Ne;Yc[2*wt+0]=Math.round((yt.x*S.scale-S.x)*Ti),Yc[2*wt+1]=Math.round((yt.y*S.scale-S.y)*Ti)}Qa.fill(0),Ai.fill(0);for(let Ie=2045;Ie>=0;Ie--){const Ne=4*Ie,at=xo[Ne+0],ot=xo[Ne+1],yt=xo[Ne+2],wt=xo[Ne+3],It=at+yt>>1,Wt=ot+wt>>1,Yt=It+Wt-ot,dn=Wt+at-It,Tn=33*ot+at,Vt=33*wt+yt,on=33*Wt+It,Sn=Math.hypot((Yc[2*Tn+0]+Yc[2*Vt+0])/2-Yc[2*on+0],(Yc[2*Tn+1]+Yc[2*Vt+1])/2-Yc[2*on+1])>=16;if(Qa[on]=Qa[on]||(Sn?1:0),Ie<1022){const Dn=33*(ot+dn>>1)+(at+Yt>>1),Kn=33*(wt+dn>>1)+(yt+Yt>>1);Qa[on]=Qa[on]||Qa[Dn]||Qa[Kn]}}const V=new pi,U=new sr;let ee=0;function oe(Ie,Ne){const at=33*Ne+Ie;return 0===Ai[at]&&(V.emplaceBack(Yc[2*at+0],Yc[2*at+1],Ie*Ti/32,Ne*Ti/32),Ai[at]=++ee),Ai[at]-1}function pe(Ie,Ne,at,ot,yt,wt){const It=Ie+at>>1,Wt=Ne+ot>>1;if(Math.abs(Ie-yt)+Math.abs(Ne-wt)>1&&Qa[33*Wt+It])pe(yt,wt,Ie,Ne,It,Wt),pe(at,ot,yt,wt,It,Wt);else{const Yt=oe(Ie,Ne),dn=oe(at,ot),Tn=oe(yt,wt);U.emplaceBack(Yt,dn,Tn)}}return pe(0,0,32,32,32,0),pe(32,32,0,0,0,32),{vertices:V,indices:U}}(this.tileID.canonical,i);h=b.vertices,g=b.indices}else{h=new pi,g=new sr;for(const{x:C,y:D}of a)h.emplaceBack(C,D,0,0);const b=Ap(h.int16,void 0,4);for(let C=0;C<b.length;C+=3)g.emplaceBack(b[C],b[C+1],b[C+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,ml.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(g),this._tileBoundsSegments=Io.simpleSegment(0,0,h.length,g.length)}_makeGlobeTileDebugBuffers(e,i){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!i||"globe"!==i.name)return;const a=this.tileID.canonical,h=Iu(Kl(a));this._makeGlobeTileDebugBorderBuffer(e,a,h),this._makeGlobeTileDebugTextBuffer(e,a,h)}_makeGlobeTileDebugBorderBuffer(e,i,a){const h=new bi,g=new Er,b=new Qi,C=(S,R,V,U,ee)=>{const oe=(V-S)/(ee-1),pe=(U-R)/(ee-1),Ie=h.length;for(let Ne=0;Ne<ee;Ne++){const at=S+Ne*oe,ot=R+Ne*pe;h.emplaceBack(at,ot);const yt=e_(at,ot,i),wt=Fs(yt,yt,a);b.emplaceBack(wt[0],wt[1],wt[2]),g.emplaceBack(Ie+Ne)}},D=Ti;C(0,0,D,0,16),C(D,0,D,D,16),C(D,D,0,D,16),C(0,D,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(g),this._tileDebugBuffer=e.createVertexBuffer(h,Hp.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(b,Iy.members),this._tileDebugSegments=Io.simpleSegment(0,0,h.length,g.length)}_makeGlobeTileDebugTextBuffer(e,i,a){const h=new bi,g=new sr,b=new Qi,C=25;g.reserve(32),h.reserve(C),b.reserve(C);const D=(S,R)=>C*S+R;for(let S=0;S<C;S++){const R=2048*S;for(let V=0;V<C;V++){const U=2048*V;h.emplaceBack(U,R);const ee=e_(U,R,i),oe=Fs(ee,ee,a);b.emplaceBack(oe[0],oe[1],oe[2])}}for(let S=0;S<4;S++)for(let R=0;R<4;R++){const V=D(S,R),U=D(S,R+1),ee=D(S+1,R),oe=D(S+1,R+1);g.emplaceBack(V,U,ee),g.emplaceBack(ee,U,oe)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(g),this._tileDebugTextBuffer=e.createVertexBuffer(h,Hp.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(b,Iy.members),this._tileDebugTextSegments=Io.simpleSegment(0,0,C,32)}}class Kc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,a){const h=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},Qe(this.stateChanges[e][h],a),null===this.deletedStates[e]){this.deletedStates[e]={};for(const g in this.state[e])g!==h&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][h]){this.deletedStates[e][h]={};for(const g in this.state[e][h])a[g]||(this.deletedStates[e][h][g]=null)}else for(const g in a)this.deletedStates[e]&&this.deletedStates[e][h]&&null===this.deletedStates[e][h][g]&&delete this.deletedStates[e][h][g]}removeFeatureState(e,i,a){if(null===this.deletedStates[e])return;const h=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&void 0!==i)null!==this.deletedStates[e][h]&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][a]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][h])for(a in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][a]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,i){const a=String(i),h=Qe({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const g=this.deletedStates[e][i];if(null===g)return{};for(const b in g)delete h[b]}return h}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const a={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const g={};for(const b in this.stateChanges[h])this.state[h][b]||(this.state[h][b]={}),Qe(this.state[h][b],this.stateChanges[h][b]),g[b]=this.state[h][b];a[h]=g}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const g={};if(null===this.deletedStates[h])for(const b in this.state[h])g[b]={},this.state[h][b]={};else for(const b in this.deletedStates[h]){if(null===this.deletedStates[h][b])this.state[h][b]={};else for(const C of Object.keys(this.deletedStates[h][b]))delete this.state[h][b][C];g[b]=this.state[h][b]}a[h]=a[h]||{},Qe(a[h],g)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(a).length)for(const h in e)e[h].setFeatureState(a,i)}}class ip{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const a=this.toIdx(e,i);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Ed(n,e,i,a){let h=0,g=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(a[b])<1e-15){if(i[b]<n[b]||i[b]>e[b])return null}else{const C=1/a[b];let D=(n[b]-i[b])*C,S=(e[b]-i[b])*C;if(D>S){const R=D;D=S,S=R}if(D>h&&(h=D),S<g&&(g=S),h>g)return null}return h}function Md(n,e,i,a,h,g,b,C,D,S,R){const V=a-n,U=h-e,ee=g-i,oe=b-n,pe=C-e,Ie=D-i,Ne=R[1]*Ie-R[2]*pe,at=R[2]*oe-R[0]*Ie,ot=R[0]*pe-R[1]*oe,yt=V*Ne+U*at+ee*ot;if(Math.abs(yt)<1e-15)return null;const wt=1/yt,It=S[0]-n,Wt=S[1]-e,Yt=S[2]-i,dn=(It*Ne+Wt*at+Yt*ot)*wt;if(dn<0||dn>1)return null;const Tn=Wt*ee-Yt*U,Vt=Yt*V-It*ee,on=It*U-Wt*V,Sn=(R[0]*Tn+R[1]*Vt+R[2]*on)*wt;return Sn<0||dn+Sn>1?null:(oe*Tn+pe*Vt+Ie*on)*wt}function m_(n,e,i){return(n-e)/(i-e)}function tf(n,e,i,a,h,g,b,C,D){const S=1<<i,R=g-a,V=b-h,U=(n+1)/S*R+a,ee=(e+0)/S*V+h,oe=(e+1)/S*V+h;C[0]=(n+0)/S*R+a,C[1]=ee,D[0]=U,D[1]=oe}class km{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(g){const b=Math.ceil(Math.log2(g.dim/8)),C=[];let D=Math.ceil(Math.pow(2,b));const S=1/D,R=(ee,oe,pe,Ie,Ne)=>{const at=Ie?1:0,ot=(ee+1)*pe-at,yt=oe*pe,wt=(oe+1)*pe-at;Ne[0]=ee*pe,Ne[1]=yt,Ne[2]=ot,Ne[3]=wt};let V=new ip(D);const U=[];for(let ee=0;ee<D*D;ee++){R(ee%D,Math.floor(ee/D),S,!1,U);const oe=Pu(U[0],U[1],g),pe=Pu(U[2],U[1],g),Ie=Pu(U[2],U[3],g),Ne=Pu(U[0],U[3],g);V.minimums.push(Math.min(oe,pe,Ie,Ne)),V.maximums.push(Math.max(oe,pe,Ie,Ne)),V.leaves.push(1)}for(C.push(V),D/=2;D>=1;D/=2){const ee=C[C.length-1];V=new ip(D);for(let oe=0;oe<D*D;oe++){R(oe%D,Math.floor(oe/D),2,!0,U);const pe=ee.getElevation(U[0],U[1]),Ie=ee.getElevation(U[2],U[1]),Ne=ee.getElevation(U[2],U[3]),at=ee.getElevation(U[0],U[3]),ot=ee.isLeaf(U[0],U[1]),yt=ee.isLeaf(U[2],U[1]),wt=ee.isLeaf(U[2],U[3]),It=ee.isLeaf(U[0],U[3]),Wt=Math.min(pe.min,Ie.min,Ne.min,at.min),Yt=Math.max(pe.max,Ie.max,Ne.max,at.max),dn=ot&&yt&&wt&&It;V.maximums.push(Yt),V.minimums.push(Wt),V.leaves.push(Yt-Wt<=5&&dn?1:0)}C.push(V)}return C}(this.dem),a=i.length-1,h=i[a];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,a,0)}raycastRoot(e,i,a,h,g,b,C=1){return Ed([e,i,-100],[a,h,this.maximums[0]*C],g,b)}raycast(e,i,a,h,g,b,C=1){if(!this.nodeCount)return null;const D=this.raycastRoot(e,i,a,h,g,b,C);if(null==D)return null;const S=[],R=[],V=[],U=[],ee=[{idx:0,t:D,nodex:0,nodey:0,depth:0}];for(;ee.length>0;){const{idx:oe,t:pe,nodex:Ie,nodey:Ne,depth:at}=ee.pop();if(this.leaves[oe]){tf(Ie,Ne,at,e,i,a,h,V,U);const yt=1<<at,wt=(Ie+0)/yt,It=(Ie+1)/yt,Wt=(Ne+0)/yt,Yt=(Ne+1)/yt,dn=Pu(wt,Wt,this.dem)*C,Tn=Pu(It,Wt,this.dem)*C,Vt=Pu(It,Yt,this.dem)*C,on=Pu(wt,Yt,this.dem)*C,Sn=Md(V[0],V[1],dn,U[0],V[1],Tn,U[0],U[1],Vt,g,b),Dn=Md(U[0],U[1],Vt,V[0],U[1],on,V[0],V[1],dn,g,b),Kn=Math.min(null!==Sn?Sn:Number.MAX_VALUE,null!==Dn?Dn:Number.MAX_VALUE);if(Kn!==Number.MAX_VALUE)return Kn;{const wn=Bf([],g,b,pe);if(g_(dn,Tn,on,Vt,m_(wn[0],V[0],U[0]),m_(wn[1],V[1],U[1]))>=wn[2])return pe}continue}let ot=0;for(let yt=0;yt<this._siblingOffset.length;yt++){tf((Ie<<1)+this._siblingOffset[yt][0],(Ne<<1)+this._siblingOffset[yt][1],at+1,e,i,a,h,V,U),V[2]=-100,U[2]=this.maximums[this.childOffsets[oe]+yt]*C;const wt=Ed(V,U,g,b);if(null!=wt){const It=wt;S[yt]=It;let Wt=!1;for(let Yt=0;Yt<ot&&!Wt;Yt++)It>=S[R[Yt]]&&(R.splice(Yt,0,yt),Wt=!0);Wt||(R[ot]=yt),ot++}}for(let yt=0;yt<ot;yt++){const wt=R[yt];ee.push({idx:this.childOffsets[oe]+wt,t:S[wt],nodex:(Ie<<1)+this._siblingOffset[wt][0],nodey:(Ne<<1)+this._siblingOffset[wt][1],depth:at+1})}}return null}_addNode(e,i,a){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,a,h,g){if(1===e[h].isLeaf(i,a))return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const b=h-1,C=e[b];let D=0,S=0;for(let R=0;R<this._siblingOffset.length;R++){const V=2*i+this._siblingOffset[R][0],U=2*a+this._siblingOffset[R][1],ee=C.getElevation(V,U),oe=C.isLeaf(V,U),pe=this._addNode(ee.min,ee.max,oe);oe&&(D|=1<<R),S||(S=pe)}for(let R=0;R<this._siblingOffset.length;R++)D&1<<R||this._construct(e,2*i+this._siblingOffset[R][0],2*a+this._siblingOffset[R][1],b,S+R)}}function g_(n,e,i,a,h,g){return nn(nn(n,i,g),nn(e,a,g),h)}function Pu(n,e,i){const a=i.dim,h=St(n*a-.5,0,a-1),g=St(e*a-.5,0,a-1),b=Math.floor(h),C=Math.floor(g),D=Math.min(b+1,a-1),S=Math.min(C+1,a-1);return g_(i.get(b,C),i.get(D,C),i.get(b,S),i.get(D,S),h-b,g-C)}const gh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class rp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,a,h=!1,g=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&"mapbox"!==a&&"terrarium"!==a)return Yn(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const b=this.dim=i.height-2,C=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=a||"mapbox",this.borderReady=h,!h){for(let D=0;D<b;D++)C[this._idx(-1,D)]=C[this._idx(0,D)],C[this._idx(b,D)]=C[this._idx(b-1,D)],C[this._idx(D,-1)]=C[this._idx(D,0)],C[this._idx(D,b)]=C[this._idx(D,b-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(b,-1)]=C[this._idx(b-1,0)],C[this._idx(-1,b)]=C[this._idx(0,b-1)],C[this._idx(b,b)]=C[this._idx(b-1,b-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new km(this)}get(e,i,a=!1){a&&(e=St(e,-1,this.dim),i=St(i,-1,this.dim));const h=4*this._idx(e,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return gh[e]}get unpackVector(){return gh[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,a){return(256*e*256+256*i+a)/10-1e4}_unpackTerrarium(e,i,a){return 256*e+i+a/256-32768}static pack(e,i){const a=[0,0,0,0],h=rp.getUnpackVector(i);let g=Math.floor((e+h[3])/h[2]);return a[2]=g%256,g=Math.floor(g/256),a[1]=g%256,g=Math.floor(g/256),a[0]=g,a}getPixels(){return new ga({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,g=i*this.dim+this.dim,b=a*this.dim,C=a*this.dim+this.dim;switch(i){case-1:h=g-1;break;case 1:g=h+1}switch(a){case-1:b=C-1;break;case 1:C=b+1}const D=-i*this.dim,S=-a*this.dim;for(let R=b;R<C;R++)for(let V=h;V<g;V++){const U=4*this._idx(V,R),ee=4*this._idx(V+D,R+S);this.pixels[U+0]=e.pixels[ee+0],this.pixels[U+1]=e.pixels[ee+1],this.pixels[U+2]=e.pixels[ee+2],this.pixels[U+3]=e.pixels[ee+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Jn(rp,"DEMData"),Jn(km,"DemMinMaxQuadTree",{omit:["dem"]});class Av{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,a){const h=e.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const g={value:i,timeout:void 0};if(void 0!==a&&(g.timeout=setTimeout(()=>{this.remove(e,g)},a)),this.data[h].push(g),this.order.push(h),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const a=e.wrapped().key,h=void 0===i?0:this.data[a].indexOf(i),g=this.data[a][h];return this.data[a].splice(h,1),g.timeout&&clearTimeout(g.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(g.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const a in this.data)for(const h of this.data[a])e(h.value)||i.push(h);for(const a of i)this.remove(a.value.tileID,a)}}class Dd{constructor(e,i,a){this.func=e,this.mask=i,this.range=a}}Dd.ReadOnly=!1,Dd.ReadWrite=!0,Dd.disabled=new Dd(519,Dd.ReadOnly,[0,1]);class Lm{constructor(e,i,a,h,g,b){this.test=e,this.ref=i,this.mask=a,this.fail=h,this.depthFail=g,this.pass=b}}Lm.disabled=new Lm({func:519,mask:0},0,0,7680,7680,7680);class Ec{constructor(e,i,a){this.blendFunction=e,this.blendColor=i,this.mask=a}}Ec.Replace=[1,0],Ec.disabled=new Ec(Ec.Replace,xr.transparent,[!1,!1,!1,!1]),Ec.unblended=new Ec(Ec.Replace,xr.transparent,[!0,!0,!0,!0]),Ec.alphaBlended=new Ec([1,771],xr.transparent,[!0,!0,!0,!0]);class Mc{constructor(e,i,a){this.enable=e,this.mode=i,this.frontFace=a}}Mc.disabled=new Mc(!1,1029,2305),Mc.backCCW=new Mc(!0,1029,2305),Mc.backCW=new Mc(!0,1029,2304),Mc.frontCW=new Mc(!0,1028,2304),Mc.frontCCW=new Mc(!0,1028,2305);class Xc extends jn{constructor(e,i,a){super(),this.id=e,this._onlySymbols=a,i.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Av(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kc,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const i in this._tiles){const a=this._tiles[i];this._source.prepareTile(a)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,a.tileID),a.upload(e),a.prepare(this.map.style.imageManager)}else for(const i in this._tiles){const a=this._tiles[i];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return Fe(this._tiles).map(e=>e.tileID).sort(sf).map(e=>e.key)}getRenderableIds(e){const i=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&i.push(this._tiles[a]);return e?i.sort((a,h)=>{const g=a.tileID,b=h.tileID,C=new ye(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),D=new ye(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||D.y-C.y||D.x-C.x}).map(a=>a.tileID.key):i.map(a=>a.tileID).sort(sf).map(a=>a.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const a=this._tiles[e];a&&("loading"!==a.state&&(a.state=i),this._loadTile(a,this._tileLoaded.bind(this,a,e,i)))}_tileLoaded(e,i,a,h){if(h)if(e.state="errored",404!==h.status)this._source.fire(new Ri(h,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=or.now(),"expired"===a&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new ti("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const g=i[h];if(e.neighboringTiles&&e.neighboringTiles[g]){const b=this.getTileByID(g);a(e,b),a(b,e)}}function a(h,g){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let b=g.tileID.canonical.x-h.tileID.canonical.x;const C=g.tileID.canonical.y-h.tileID.canonical.y,D=Math.pow(2,h.tileID.canonical.z),S=g.tileID.key;0===b&&0===C||Math.abs(C)>1||(Math.abs(b)>1&&(1===Math.abs(b+D)?b+=D:1===Math.abs(b-D)&&(b-=D)),g.dem&&h.dem&&(h.dem.backfillBorder(g.dem,b,C),h.neighboringTiles&&h.neighboringTiles[S]&&(h.neighboringTiles[S].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,a,h){for(const g in this._tiles){let b=this._tiles[g];if(h[g]||!b.hasData()||b.tileID.overscaledZ<=i||b.tileID.overscaledZ>a)continue;let C=b.tileID;for(;b&&b.tileID.overscaledZ>i+1;){const S=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[S.key],b&&b.hasData()&&(C=S)}let D=C;for(;D.overscaledZ>i;)if(D=D.scaledTo(D.overscaledZ-1),e[D.key]){h[C.key]=C;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=i?a:null}for(let a=e.overscaledZ-1;a>=i;a--){const h=e.scaledTo(a),g=this._getLoadedTile(h);if(g)return g}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const a=Math.ceil(e.width/i)+1,h=Math.ceil(e.height/i)+1,g=Math.floor(a*h*5),b="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,g):g,C="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(C)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const a={};for(const h in this._tiles){const g=this._tiles[h];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+i),a[g.tileID.key]=g}this._tiles=a;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,i,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let h;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new Ds(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(h=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(C=>this._source.hasTile(C)))):h=[];const g=this._updateRetainedTiles(h);if(__(this._source.type)&&0!==h.length){const C={},D={},S=Object.keys(g);for(const V of S){const U=g[V],ee=this._tiles[V];if(!ee||ee.fadeEndTime&&ee.fadeEndTime<=or.now())continue;const oe=this.findLoadedParent(U,Math.max(U.overscaledZ-Xc.maxOverzooming,this._source.minzoom));oe&&(this._addTile(oe.tileID),C[oe.tileID.key]=oe.tileID),D[V]=U}const R=h[h.length-1].overscaledZ;for(const V in this._tiles){const U=this._tiles[V];if(g[V]||!U.hasData())continue;let ee=U.tileID;for(;ee.overscaledZ>R;){ee=ee.scaledTo(ee.overscaledZ-1);const oe=this._tiles[ee.key];if(oe&&oe.hasData()&&D[ee.key]){g[V]=U.tileID;break}}}for(const V in C)g[V]||(this._coveredTiles[V]=!0,g[V]=C[V])}for(const C in g)this._tiles[C].clearFadeHold();const b=function(C,D){const S=[];for(const R in C)R in D||S.push(R);return S}(this._tiles,g);for(const C of b){const D=this._tiles[C];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const a={},h=e.reduce((S,R)=>Math.min(S,R.overscaledZ),1/0),g=e[0].overscaledZ,b=Math.max(g-Xc.maxOverzooming,this._source.minzoom),C=Math.max(g+Xc.maxUnderzooming,this._source.minzoom),D={};for(const S of e){const R=this._addTile(S);i[S.key]=S,R.hasData()||h<this._source.maxzoom&&(D[S.key]=S)}this._retainLoadedChildren(D,h,C,i);for(const S of e){let R=this._tiles[S.key];if(R.hasData())continue;if(S.canonical.z>=this._source.maxzoom){const U=S.children(this._source.maxzoom)[0],ee=this.getTile(U);if(ee&&ee.hasData()){i[U.key]=U;continue}}else{const U=S.children(this._source.maxzoom);if(i[U[0].key]&&i[U[1].key]&&i[U[2].key]&&i[U[3].key])continue}let V=R.wasRequested();for(let U=S.overscaledZ-1;U>=b;--U){const ee=S.scaledTo(U);if(a[ee.key]||(a[ee.key]=!0,R=this.getTile(ee),!R&&V&&(R=this._addTile(ee)),R&&(i[ee.key]=ee,V=R.wasRequested(),R.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let a,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){a=this._loadedParentTiles[h.key];break}i.push(h.key);const g=h.scaledTo(h.overscaledZ-1);if(a=this._getLoadedTile(g),a)break;h=g}for(const g of i)this._loadedParentTiles[g]=a}}_addTile(e){let i=this._tiles[e.key];if(i)return this._source.prepareTile&&this._source.prepareTile(i),i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const a=Boolean(i);if(!a){const h=this.map?this.map.painter:null;i=new Aa(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._source.prepareTile&&this._source.prepareTile(i)||this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,a||this._source.fire(new ti("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=i.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,a){const h=[],g=this.transform;if(!g)return h;const b="globe"===g.projection.name,C=Zl(g.center.lng);for(const D in this._tiles){const S=this._tiles[D];if(a&&S.clearQueryDebugViz(),S.holdingForFade())continue;let R;if(b){const V=S.tileID.canonical;if(0===V.z){const U=[Math.abs(St(C,...Td(V,-1))-C),Math.abs(St(C,...Td(V,1))-C)];R=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(St(C,...Td(V,-1))-C),Math.abs(St(C,...Td(V,0))-C),Math.abs(St(C,...Td(V,1))-C)];R=[U.indexOf(Math.min(...U))-1]}}else R=[0];for(const V of R){const U=e.containsTile(S,g,i,V);U&&h.push(U)}}return h}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of i)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(__(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=or.now())return!0}return!1}setFeatureState(e,i,a){this._state.updateState(e=e||"_geojsonTileLayer",i,a)}removeFeatureState(e,i,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,a)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,a){const h=this._tiles[e];h&&h.setDependencies(i,a)}reloadTilesForDependencies(e,i){for(const a in this._tiles)this._tiles[a].hasDependency(e,i)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,i))}_preloadTiles(e,i){const a=new Map,h=Array.isArray(e)?e:[e],g=this.map.painter.terrain,b=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const C of h){const D=C.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const S of D)a.set(S.key,S);this.usedForTerrain&&C.updateElevation(!1)}Xt(Array.from(a.values()),(C,D)=>{const S=new Aa(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(S,R=>{"raster-dem"===this._source.type&&S.dem&&this._backfillDEM(S),D(R,S)})},i)}}function sf(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||a-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function __(n){return"raster"===n||"image"===n||"video"===n}function Td(n,e){const i=1<<n.z;return[n.x/i+e,(n.x+1)/i+e]}Xc.maxOverzooming=10,Xc.maxUnderzooming=3;class af{constructor(e,i,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=a}static create(e,i,a){const h=a||e.findDEMTileFor(i);if(!h||!h.dem)return;const g=h.dem,b=h.tileID,C=1<<i.canonical.z-b.canonical.z;return new af(h,h.tileSize/Ti/C,[(i.canonical.x/C-b.canonical.x)*g.dim,(i.canonical.y/C-b.canonical.y)*g.dim])}tileCoordToPixel(e,i){const a=i*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),g=Math.floor(a);return new ye(h,g)}getElevationAt(e,i,a,h){const g=e*this._scale+this._offset[0],b=i*this._scale+this._offset[1],C=Math.floor(g),D=Math.floor(b),S=this._dem;return h=!!h,a?nn(nn(S.get(C,D,h),S.get(C,D+1,h),b-D),nn(S.get(C+1,D,h),S.get(C+1,D+1,h),b-D),g-C):S.get(C,D,h)}getElevationAtPixel(e,i,a){return this._dem.get(e,i,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*dl(1,e)*this._dem.stride}}class y_{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new cc(Ti,16,0),this.featureIndexArray=new vf,this.promoteId=i}insert(e,i,a,h,g,b=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,g,b);const D=this.grid;for(let S=0;S<i.length;S++){const R=i[S],V=[1/0,1/0,-1/0,-1/0];for(let U=0;U<R.length;U++){const ee=R[U];V[0]=Math.min(V[0],ee.x),V[1]=Math.min(V[1],ee.y),V[2]=Math.max(V[2],ee.x),V[3]=Math.max(V[3],ee.y)}V[0]<Ti&&V[1]<Ti&&V[2]>=0&&V[3]>=0&&D.insert(C,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Du.VectorTile(new ih(this.rawTileData)).layers,this.sourceLayerCoder=new Im(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,a,h){this.loadVTLayers();const g=e.params||{},b=Wo(g.filter),C=e.tileResult,D=e.transform,S=C.bufferedTilespaceBounds,R=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,(oe,pe,Ie,Ne)=>cg(C.bufferedTilespaceGeometry,oe,pe,Ie,Ne));R.sort(Vy);let V=null;D.elevation&&R.length>0&&(V=af.create(D.elevation,this.tileID));const U={};let ee;for(let oe=0;oe<R.length;oe++){const pe=R[oe];if(pe===ee)continue;ee=pe;const Ie=this.featureIndexArray.get(pe);let Ne=null;this.loadMatchingFeature(U,Ie,b,g.layers,g.availableImages,i,a,h,(at,ot,yt,wt=0)=>(Ne||(Ne=Nc(at,this.tileID.canonical,e.tileTransform)),ot.queryIntersectsFeature(C,at,yt,Ne,this.z,e.transform,e.pixelPosMatrix,V,wt)))}return U}loadMatchingFeature(e,i,a,h,g,b,C,D,S){const{featureIndex:R,bucketIndex:V,sourceLayerIndex:U,layoutVertexArrayOffset:ee}=i,oe=this.bucketLayerIDs[V];if(h&&!function(at,ot){for(let yt=0;yt<at.length;yt++)if(ot.indexOf(at[yt])>=0)return!0;return!1}(h,oe))return;const pe=this.sourceLayerCoder.decode(U),Ie=this.vtLayers[pe].feature(R);if(a.needGeometry){const at=Vc(Ie,!0);if(!a.filter(new ke(this.tileID.overscaledZ),at,this.tileID.canonical))return}else if(!a.filter(new ke(this.tileID.overscaledZ),Ie))return;const Ne=this.getId(Ie,pe);for(let at=0;at<oe.length;at++){const ot=oe[at];if(h&&h.indexOf(ot)<0)continue;const yt=b[ot];if(!yt)continue;let wt={};void 0!==Ne&&D&&(wt=D.getState(yt.sourceLayer||"_geojsonTileLayer",Ne));const It=Qe({},C[ot]);It.paint=Fm(It.paint,yt.paint,Ie,wt,g),It.layout=Fm(It.layout,yt.layout,Ie,wt,g);const Wt=!S||S(Ie,yt,wt,ee);if(!Wt)continue;const Yt=new Om(Ie,this.z,this.x,this.y,Ne);Yt.layer=It;let dn=e[ot];void 0===dn&&(dn=e[ot]=[]),dn.push({featureIndex:R,feature:Yt,intersectionZ:Wt})}}lookupSymbolFeatures(e,i,a,h,g,b,C,D){const S={};this.loadVTLayers();const R=Wo(g);for(const V of e)this.loadMatchingFeature(S,{bucketIndex:a,sourceLayerIndex:h,featureIndex:V,layoutVertexArrayOffset:0},R,b,C,D,i);return S}loadFeature(e){const{featureIndex:i,sourceLayerIndex:a}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(a),g=this.vtFeatures[h];if(g[i])return g[i];const b=this.vtLayers[h].feature(i);return g[i]=b,b}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;return this.promoteId&&(a=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[i]],"boolean"==typeof a&&(a=Number(a))),a}}function Fm(n,e,i,a,h){return Bt(n,(g,b)=>{const C=e instanceof $t?e.get(b):null;return C&&C.evaluate?C.evaluate(i,a,h):C})}function Vy(n,e){return e-n}Jn(y_,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Ou{constructor(e){const i={},a=[];for(const C in e){const D=e[C],S=i[C]={};for(const R in D.glyphs){const V=D.glyphs[+R];if(!V||0===V.bitmap.width||0===V.bitmap.height)continue;const U=V.metrics.localGlyph?2:1,ee={x:0,y:0,w:V.bitmap.width+2*U,h:V.bitmap.height+2*U};a.push(ee),S[R]=ee}}const{w:h,h:g}=Hc(a),b=new Vo({width:h||1,height:g||1});for(const C in e){const D=e[C];for(const S in D.glyphs){const R=D.glyphs[+S];if(!R||0===R.bitmap.width||0===R.bitmap.height)continue;const V=i[C][S],U=R.metrics.localGlyph?2:1;Vo.copy(R.bitmap,b,{x:0,y:0},{x:V.x+U,y:V.y+U},R.bitmap)}}this.image=b,this.positions=i}}Jn(Ou,"GlyphAtlas");class Dc{constructor(e){this.tileID=new Ds(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=wc(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,a,h,g){this.status="parsing",this.data=e,this.collisionBoxArray=new hp;const b=new Im(Object.keys(e.layers).sort()),C=new y_(this.tileID,this.promoteId);C.bucketLayerIDs=[];const D={},S=new qc(256,256),R={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:S,availableImages:a},V=i.familiesBySource[this.source];for(const wt in V){const It=e.layers[wt];if(!It)continue;let Wt=!1,Yt=!1;for(const Vt of V[wt])"symbol"===Vt[0].type?Wt=!0:Yt=!0;if(!0===this.isSymbolTile&&!Wt||!1===this.isSymbolTile&&!Yt)continue;1===It.version&&Yn(`Vector tile source "${this.source}" layer "${wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dn=b.encode(wt),Tn=[];for(let Vt=0;Vt<It.length;Vt++){const on=It.feature(Vt),Sn=C.getId(on,wt);Tn.push({feature:on,id:Sn,index:Vt,sourceLayerIndex:dn})}for(const Vt of V[wt]){const on=Vt[0];void 0!==this.isSymbolTile&&"symbol"===on.type!==this.isSymbolTile||on.minzoom&&this.zoom<Math.floor(on.minzoom)||on.maxzoom&&this.zoom>=on.maxzoom||"none"!==on.visibility&&(_h(Vt,this.zoom,a),(D[on.id]=on.createBucket({index:C.bucketLayerIDs.length,layers:Vt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(Tn,R,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(Vt.map(Sn=>Sn.id)))}}let U,ee,oe,pe;S.trim();const Ie={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ne=Bt(R.glyphDependencies,wt=>Object.keys(wt).map(Number));Object.keys(Ne).length?h.send("getGlyphs",{uid:this.uid,stacks:Ne},(wt,It)=>{U||(U=wt,ee=It,yt.call(this))},void 0,!1,Ie):ee={};const at=Object.keys(R.iconDependencies);at.length?h.send("getImages",{icons:at,source:this.source,tileID:this.tileID,type:"icons"},(wt,It)=>{U||(U=wt,oe=It,yt.call(this))},void 0,!1,Ie):oe={};const ot=Object.keys(R.patternDependencies);function yt(){if(U)return g(U);if(ee&&oe&&pe){const wt=new Ou(ee),It=new um(oe,pe);for(const Wt in D){const Yt=D[Wt];Yt instanceof ta?(_h(Yt.layers,this.zoom,a),Kg(Yt,ee,wt.positions,oe,It.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):Yt.hasPattern&&(Yt instanceof eh||Yt instanceof Wd||Yt instanceof Tu)&&(_h(Yt.layers,this.zoom,a),Yt.addFeatures(R,this.tileID.canonical,It.patternPositions,a,this.tileTransform))}this.status="done",g(null,{buckets:Fe(D).filter(Wt=>!Wt.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wt.image,lineAtlas:S,imageAtlas:It,glyphMap:this.returnDependencies?ee:null,iconMap:this.returnDependencies?oe:null,glyphPositions:this.returnDependencies?wt.positions:null})}}ot.length?h.send("getImages",{icons:ot,source:this.source,tileID:this.tileID,type:"patterns"},(wt,It)=>{U||(U=wt,pe=It,yt.call(this))},void 0,!1,Ie):pe={},yt.call(this)}}function _h(n,e,i){const a=new ke(e);for(const h of n)h.recalculate(a,i)}class Qc{constructor(e){this.entries={},this.scheduler=e}request(e,i,a,h){const g=this.entries[e]=this.entries[e]||{callbacks:[]};if(g.result){const[b,C]=g.result;return this.scheduler?this.scheduler.add(()=>{h(b,C)},i):h(b,C),()=>{}}return g.callbacks.push(h),g.cancel||(g.cancel=a((b,C)=>{g.result=[b,C];for(const D of g.callbacks)this.scheduler?this.scheduler.add(()=>{D(b,C)},i):D(b,C);setTimeout(()=>delete this.entries[e],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(b=>b!==h),g.callbacks.length||(g.cancel(),delete this.entries[e]))}}}function Uy(n,e,i){const a=JSON.stringify(n.request);return n.data&&(this.deduped.entries[a]={result:[null,n.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},h=>{const g=lt(n.request,(b,C,D,S)=>{b?h(b):C&&h(null,{vectorTile:i?void 0:new Du.VectorTile(new ih(C)),rawData:C,cacheControl:D,expires:S})});return()=>{g.cancel(),h()}},e)}c.ARRAY_TYPE=Ls,c.AUTH_ERR_MSG=ze,c.Aabb=pl,c.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Tt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Di()?n:Ce,this.scheduler=new f_}send(n,e,i,a,h=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=g,this.callbacks[b]=i);const C=Ln(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:n,hasCallback:!!i,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:Wa(e,C)},C),{cancel:()=>{i&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(e.mustQueue||Di()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),a&&a.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if("<response>"===e.type){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(uu(e.error)):i(null,uu(e.data)))}else{const i=Ln(this.globalScope)?void 0:[],a=e.hasCallback?(g,b)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:g?Wa(g):null,data:Wa(b,i)},i)}:g=>{},h=uu(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,a);else if(this.parent.getWorkerSource){const g=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,g[0],h.source)[g[1]](h,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.CanonicalTileID=Gh,c.Color=xr,c.ColorMode=Ec,c.CullFaceMode=Mc,c.DEMData=rp,c.DataConstantProperty=jt,c.DedupedRequest=Qc,c.DepthMode=Dd,c.EXTENT=Ti,c.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(!e||n.y<0||n.y>1)return!1;const i=e.getSource().maxzoom,a=1<<i,h=Math.floor(n.x),g=Math.floor((n.x-h)*a),b=Math.floor(n.y*a),C=this.findDEMTileFor(new Ds(i,h,i,g,b));return!(!C||!C.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){null==e&&(e=null);const a=this._source();if(!a||n.y<0||n.y>1)return e;const h=a.getSource().maxzoom,g=1<<h,b=Math.floor(n.x),C=n.x-b,D=new Ds(h,b,h,Math.floor(C*g),Math.floor(n.y*g)),S=this.findDEMTileFor(D);if(!S||!S.dem)return e;const R=S.dem,V=1<<S.tileID.canonical.z,U=(C*V-S.tileID.canonical.x)*R.dim,ee=(n.y*V-S.tileID.canonical.y)*R.dim,oe=Math.floor(U),pe=Math.floor(ee);return(i?this.exaggeration():1)*nn(nn(R.get(oe,pe),R.get(oe,pe+1),ee-pe),nn(R.get(oe+1,pe),R.get(oe+1,pe+1),ee-pe),U-oe)}getAtTileOffset(n,e,i){const a=1<<n.canonical.z;return this.getAtPointOrZero(new td(n.wrap+(n.canonical.x+e/Ti)/a,(n.canonical.y+i/Ti)/a))}getAtTileOffsetFunc(n,e,i,a){return h=>{const g=this.getAtTileOffset(n,h.x,h.y),b=a.upVector(n.canonical,h.x,h.y);return jc(b,b,g*a.upVectorScale(n.canonical,e,i).metersToTile),b}}getForTilePoints(n,e,i,a){const h=af.create(this,n,a);return!!h&&(e.forEach(g=>{g[2]=this.exaggeration()*h.getElevationAt(g[0],g[1],i)}),!0)}getMinMaxForTile(n){const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,a=e.tileID,h=1<<n.canonical.z-a.canonical.z;let g=n.canonical.x/h-a.canonical.x,b=n.canonical.y/h-a.canonical.y,C=0;for(let D=0;D<n.canonical.z-a.canonical.z&&!i.leaves[C];D++){g*=2,b*=2;const S=2*Math.floor(b)+Math.floor(g);C=i.childOffsets[C]+S,g%=1,b%=1}return{min:this.exaggeration()*i.minimums[C],max:this.exaggeration()*i.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},c.ErrorEvent=Ri,c.EvaluationParameters=ke,c.Event=ti,c.Evented=jn,c.FillExtrusionBucket=Tu,c.Frustum=Vf,c.FrustumCorners=Mp,c.GLOBE_METERS_TO_ECEF=Qh,c.GLOBE_RADIUS=Xa,c.GLOBE_SCALE_MATCH_LATITUDE=45,c.GLOBE_ZOOM_THRESHOLD_MAX=6,c.GLOBE_ZOOM_THRESHOLD_MIN=5,c.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_createGrid(n){const e=new bi,i=new sr,a=65;for(let h=0;h<a;h++)for(let g=0;g<a;g++)e.emplaceBack(g,h);this._gridSegments=[];for(let h=0,g=0;h<ch.length;h++){const b=ch[h];for(let D=0;D<b;D++)for(let S=0;S<64;S++){const R=D*a+S;i.emplaceBack(R+1,R,R+a),i.emplaceBack(R+a,R+a+1,R+1)}const C=64*b*2;this._gridSegments.push(Io.simpleSegment(0,g,(b+1)*a,C)),g+=C}this._gridBuffer=n.createVertexBuffer(e,Hp.members),this._gridIndexBuffer=n.createIndexBuffer(i,!0)}_createPoles(n){const e=new sr;for(let h=0;h<=64;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const i=new jl,a=new jl;this._poleSegments=[];for(let h=0,g=0;h<5;h++){const b=1<<h,C=512*b/Math.PI/2,D=360/b;i.emplaceBack(0,-C,0,0,0,.5,0),a.emplaceBack(0,-C,0,0,0,.5,1);for(let S=0;S<=64;S++){const R=S/64,V=nn(0,D,R),[U,ee,oe]=Jg(ky,t_,V,C);i.emplaceBack(U,ee,oe,0,0,R,0),a.emplaceBack(U,ee,oe,0,0,R,1)}this._poleSegments.push(Io.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,Ay,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(a,Ay,!1)}getGridBuffers(n){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[n]]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const i=new Ao,a=64,h=a+1;this._wireframeSegments=[];for(let g=0,b=0;g<ch.length;g++){const C=ch[g];for(let S=0;S<C;S++)for(let R=0;R<a;R++){const V=S*h+R;i.emplaceBack(V,V+1),i.emplaceBack(V,V+h),i.emplaceBack(V,V+h+1)}const D=C*a*3;this._wireframeSegments.push(Io.simpleSegment(0,b,(C+1)*h,D)),b+=D}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},c.GlyphManager=$c,c.ImagePosition=cm,c.LineAtlas=qc,c.LngLat=Fr,c.LngLatBounds=gu,c.LocalGlyphMode=qg,c.MAX_MERCATOR_LATITUDE=Wl,c.MercatorCoordinate=td,c.ONE_EM=24,c.OverscaledTileID=Ds,c.Properties=tn,c.RGBAImage=ga,c.Ray=Nf,c.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",dt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!he(n))return n;const i=We(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!he(n))return n;const i=We(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e,i,a){if(!he(n))return n;const h=We(n);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),i&&h.params.push(`language=${i}`),a&&h.params.push(`worldview=${a}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,a){const h=We(n);return he(n)?(h.path=`/styles/v1${h.path}/sprite${e}${i}`,this._makeAPIURL(h,this._customAccessToken||a)):(h.path+=`${e}${i}`,ht(h))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!he(n))return n;const a=We(n);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==a.authority&&512===i?"@2x":""}${Wi.supported?".webp":"$1"}`),"raster"===a.authority?a.path=`/${En.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${En.TILE_URL_VERSION}${a.path}`);const h=this._customAccessToken||function(g){for(const b of g){const C=b.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(a.params)||En.ACCESS_TOKEN;return En.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,h)}canonicalizeTileURL(n,e){const i=We(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${En.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${En.TILE_URL_VERSION}/`,"")}`;let h=i.params;return e&&(h=h.filter(g=>!g.match(/^access_token=/))),h.length&&(a+=`?${h.join("&")}`),a}canonicalizeTileset(n,e){const i=!!e&&he(e),a=[];for(const h of n.tiles||[])ce(h)?a.push(this.canonicalizeTileURL(h,i)):a.push(h);return a}_makeAPIURL(n,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=We(En.API_URL);if(n.protocol=a.protocol,n.authority=a.authority,"http"===n.protocol){const h=n.params.indexOf("secure");h>=0&&n.params.splice(h,1)}if("/"!==a.path&&(n.path=`${a.path}${n.path}`),!En.REQUIRE_ACCESS_TOKEN)return ht(n);if(e=e||En.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(h=>-1===h.indexOf("access_token")),n.params.push(`access_token=${e||""}`),ht(n)}},c.ResourceType=He,c.SegmentVector=Io,c.SourceCache=Xc,c.StencilMode=Lm,c.StructArrayLayout1ui2=Er,c.StructArrayLayout2f1f2i16=Cr,c.StructArrayLayout2i4=bi,c.StructArrayLayout2ui4=Ao,c.StructArrayLayout3f12=es,c.StructArrayLayout3ui6=sr,c.StructArrayLayout4i8=pi,c.StructArrayLayout5f20=pc,c.Texture=Cd,c.Tile=Aa,c.Transitionable=Ue,c.Uniform1f=Cf,c.Uniform1i=class extends gc{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},c.Uniform2f=class extends gc{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},c.Uniform3f=class extends gc{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},c.Uniform4f=Ef,c.UniformColor=W_,c.UniformMatrix2f=class extends gc{constructor(n,e){super(n,e),this.current=Df}set(n){for(let e=0;e<4;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},c.UniformMatrix3f=class extends gc{constructor(n,e){super(n,e),this.current=Mf}set(n){for(let e=0;e<9;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},c.UniformMatrix4f=class extends gc{constructor(n,e){super(n,e),this.current=Ju}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},c.UnwrappedTileID=md,c.ValidationError=Hn,c.VectorTileWorkerSource=class extends jn{constructor(n,e,i,a,h){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=h||Uy,this.loading={},this.loaded={},this.deduped=new Qc(n.scheduler),this.isSpriteLoaded=a,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,a=n&&n.request,h=a&&a.collectResourceTiming,g=this.loading[i]=new Dc(n);g.abort=this.loadVectorData(n,(b,C)=>{const D=!this.loading[i];if(delete this.loading[i],D||b||!C)return g.status="done",D||(this.loaded[i]=g),e(b);const S=C.rawData,R={};C.expires&&(R.expires=C.expires),C.cacheControl&&(R.cacheControl=C.cacheControl),g.vectorTile=C.vectorTile||new Du.VectorTile(new ih(S));const V=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(U,ee)=>{if(U||!ee)return e(U);const oe={};if(h){const pe=kn(a);pe.length>0&&(oe.resourceTiming=JSON.parse(JSON.stringify(pe)))}e(null,Qe({rawTileData:S.slice(0)},ee,R,oe))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[i]=g})}reloadTile(n,e){const i=this.loaded,a=n.uid,h=this;if(i&&i[a]){const g=i[a];g.showCollisionBoxes=n.showCollisionBoxes,g.enableTerrain=!!n.enableTerrain,g.projection=n.projection,g.tileTransform=wc(n.tileID.canonical,n.projection);const b=(C,D)=>{const S=g.reloadCallback;S&&(delete g.reloadCallback,g.parse(g.vectorTile,h.layerIndex,this.availableImages,h.actor,S)),e(C,D)};"parsing"===g.status?g.reloadCallback=b:"done"===g.status&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(n,e){const i=n.uid,a=this.loading[i];a&&(a.abort&&a.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,a=n.uid;i&&i[a]&&delete i[a],e()}},c.WritingMode=fl,c.ZoomHistory=uc,c.add=bu,c.addDynamicAttributes=Qp,c.adjoint=function(n,e){var i=e[0],a=e[1],h=e[2],g=e[3],b=e[4],C=e[5],D=e[6],S=e[7],R=e[8];return n[0]=b*R-C*S,n[1]=h*S-a*R,n[2]=a*C-h*b,n[3]=C*D-g*R,n[4]=i*R-h*D,n[5]=h*g-i*C,n[6]=g*S-b*D,n[7]=a*D-i*S,n[8]=i*b-a*g,n},c.asyncAll=Xt,c.bezier=Ut,c.bindAll=Tt,c.boundsAttributes=ml,c.bufferConvexPolygon=function(n,e){const i=[];for(let a=0;a<n.length;a++){const h=Xn(a-1,-1,n.length-1),g=Xn(a+1,-1,n.length-1),b=n[a],C=n[g],D=n[h].sub(b).unit(),S=C.sub(b).unit(),R=S.angleWithSep(D.x,D.y),V=D.add(S).unit().mult(-1*e/Math.sin(R/2));i.push(b.add(V))}return i},c.cacheEntryPossiblyAdded=function(n){Te++,Te>nt&&(n.getActor().send("enforceCacheSizeLimit",Ke),Te=0)},c.calculateGlobeLabelMatrix=function(n,e){const{x:i,y:a}=n.point,h=Wp(i,a,n.worldSize/n._projectionScaler,0,0);return El(h,h,xd(Kl(e)))},c.calculateGlobeMatrix=function(n){const{x:e,y:i}=n.point,{lng:a,lat:h}=n._center;return Wp(e,i,n.worldSize,a,h)},c.calculateGlobeMercatorMatrix=function(n){const e=n.worldSize,i=n.point,a=dl(1,n.center.lat)*e,h=n.pixelsPerMeter,g=e/(a/n.pixelsPerMeter),b=Ms(new Float64Array(16));return ld(b,b,[i.x,i.y,0]),Ka(b,b,[g,g,h]),Float32Array.from(b)},c.circumferenceAtLatitude=Th,c.clamp=St,c.clearTileCache=function(n){const e=[];for(const i in Be)e.push(Ce.caches.delete(i)),delete Be[i];n&&Promise.all(e).catch(n).then(()=>n())},c.clipLine=gm,c.clone=function(n){var e=new Ls(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},c.clone$1=mn,c.collisionCircleLayout=Og,c.config=En,c.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},c.create=function(){var n=new Ls(16);return Ls!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},c.create$1=dg,c.createExpression=Ua,c.createLayout=Nn,c.createStyleLayer=function(n){return"custom"===n.type?new zy(n):new p_[n.type](n)},c.cross=pg,c.degToRad=Pe,c.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},c.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},c.dot=ql,c.ease=Ft,c.easeCubicInOut=et,c.emitValidationErrors=wh,c.endsWith=Gt,c.enforceCacheSizeLimit=function(n){for(const e in Be)ae(e),Be[e].then(i=>{i.keys().then(a=>{for(let h=0;h<a.length-n;h++)i.delete(a[h])})})},c.evaluateSizeForFeature=Bp,c.evaluateSizeForZoom=th,c.evaluateVariableOffset=bm,c.evented=we,c.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},c.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},c.exported=or,c.exported$1=Wi,c.extend=Qe,c.extend$1=nr,c.fillExtrusionHeightLift=tm,c.filterObject=Cn,c.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},c.fromQuat=function(n,e){var i=e[0],a=e[1],h=e[2],g=e[3],b=i+i,C=a+a,D=h+h,S=i*b,R=a*b,V=a*C,U=h*b,ee=h*C,oe=h*D,pe=g*b,Ie=g*C,Ne=g*D;return n[0]=1-V-oe,n[1]=R+Ne,n[2]=U-Ie,n[3]=0,n[4]=R-Ne,n[5]=1-S-oe,n[6]=ee+pe,n[7]=0,n[8]=U+Ie,n[9]=ee-pe,n[10]=1-S-V,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},c.fromRotation=function(n,e){var i=Math.sin(e),a=Math.cos(e);return n[0]=a,n[1]=i,n[2]=0,n[3]=-i,n[4]=a,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},c.fromScaling=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},c.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return gt[e]},c.getAABBPointSquareDist=function(n,e,i){let a=0;for(let h=0;h<2;++h){const g=i?i[h]:0;n[h]>g&&(a+=(n[h]-g)*(n[h]-g)),e[h]<g&&(a+=(g-e[h])*(g-e[h]))}return a},c.getAnchorAlignment=hm,c.getAnchorJustification=xm,c.getBounds=function(n){let e=1/0,i=1/0,a=-1/0,h=-1/0;for(const g of n)e=Math.min(e,g.x),i=Math.min(i,g.y),a=Math.max(a,g.x),h=Math.max(h,g.y);return{min:new ye(e,i),max:new ye(a,h)}},c.getColumn=Rt,c.getGridMatrix=function(n,e,i){const[a,h]=e,g=.015625;return[0,(h[1]-a[1])*g,1<<n.z,(h[0]-a[0])/ch[i],0,n.y,a[0],a[1],g]},c.getImage=tt,c.getJSON=function(n,e){return Ct(Qe(n,{type:"json"}),e)},c.getLatitudinalLod=function(n){const e=80.051129;n=St(n,-80.051129,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Pe(n))),3);return Math.round(i*(ch.length-1))},c.getMapSessionAPI=zt,c.getPerformanceMeasurement=kn,c.getProjection=c_,c.getRTLTextPluginStatus=xe,c.getReferrer=Mt,c.getTilePoint=function(n,{x:e,y:i},a=0){return new ye(((e-a)*n.scale-n.x)*Ti,(i*n.scale-n.y)*Ti)},c.getTileVec3=function(n,e,i=0){return jd(((e.x-i)*n.scale-n.x)*Ti,(e.y*n.scale-n.y)*Ti,lg(e.z,e.y))},c.getVideo=function(n,e){const i=Ce.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<n.length;a++){const h=Ce.document.createElement("source");en(n[a])||(i.crossOrigin="Anonymous"),h.src=n[a],i.appendChild(h)}return{cancel:()=>{}}},c.globeCenterToScreenPoint=function(n){const e=[0,0,0],i=Ms(new Float64Array(16));return El(i,n.pixelMatrix,n.globeMatrix),Fs(e,e,i),new ye(e[0],e[1])},c.globeECEFOrigin=function(n,e){const i=[0,0,0];return Fs(i,i,Iu(Kl(e.canonical))),Fs(i,i,n),i},c.globeNormalizeECEF=Iu,c.globePixelsToTileUnits=function(n,e){return Ti/(512*Math.pow(2,n))*Zp(Kl(e))},c.globePoleMatrixForTile=function(n,e,i){const a=Ms(new Float64Array(16)),h=1<<n,g=360*(e/h-.5),b=i.point,C=i.worldSize/(i.tileSize*h);return ld(a,a,[b.x,b.y,-i.worldSize/Math.PI/2]),Ka(a,a,[C,C,C]),vu(a,a,Pe(-i._center.lat)),wp(a,a,Pe(-i._center.lng+g)),Float32Array.from(a)},c.globeTileBounds=Kl,c.globeTileLatLngCorners=uh,c.globeTiltAtLngLat=Jh,c.globeToMercatorTransition=Zc,c.globeUseCustomAntiAliasing=function(n,e,i){const a=Zc(i.zoom),h=n.style.map._antialias,g=!!e.extStandardDerivatives,b=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===a&&!h&&!b&&g},c.identity=Ms,c.identity$1=$d,c.invert=function(n,e){var i=e[0],a=e[1],h=e[2],g=e[3],b=e[4],C=e[5],D=e[6],S=e[7],R=e[8],V=e[9],U=e[10],ee=e[11],oe=e[12],pe=e[13],Ie=e[14],Ne=e[15],at=i*C-a*b,ot=i*D-h*b,yt=i*S-g*b,wt=a*D-h*C,It=a*S-g*C,Wt=h*S-g*D,Yt=R*pe-V*oe,dn=R*Ie-U*oe,Tn=R*Ne-ee*oe,Vt=V*Ie-U*pe,on=V*Ne-ee*pe,Sn=U*Ne-ee*Ie,Dn=at*Sn-ot*on+yt*Vt+wt*Tn-It*dn+Wt*Yt;return Dn?(n[0]=(C*Sn-D*on+S*Vt)*(Dn=1/Dn),n[1]=(h*on-a*Sn-g*Vt)*Dn,n[2]=(pe*Wt-Ie*It+Ne*wt)*Dn,n[3]=(U*It-V*Wt-ee*wt)*Dn,n[4]=(D*Tn-b*Sn-S*dn)*Dn,n[5]=(i*Sn-h*Tn+g*dn)*Dn,n[6]=(Ie*yt-oe*Wt-Ne*ot)*Dn,n[7]=(R*Wt-U*yt+ee*ot)*Dn,n[8]=(b*on-C*Tn+S*Yt)*Dn,n[9]=(a*Tn-i*on-g*Yt)*Dn,n[10]=(oe*It-pe*yt+Ne*at)*Dn,n[11]=(V*yt-R*It-ee*at)*Dn,n[12]=(C*dn-b*Vt-D*Yt)*Dn,n[13]=(i*Vt-a*dn+h*Yt)*Dn,n[14]=(pe*ot-oe*wt-Ie*at)*Dn,n[15]=(R*wt-V*ot+U*at)*Dn,n):null},c.isLngLatBehindGlobe=function(n,e){return Jh(n,e)>Math.PI/2*1.01},c.isMapAuthenticated=function(n){return mt.has(n)},c.isMapboxURL=he,c.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!Ln(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},c.latFromMercatorY=No,c.len=fg,c.length=cd,c.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},c.loadVectorTile=Uy,c.makeRequest=Ct,c.mapValue=function(n,e,i,a,h){return St((n-e)/(i-e)*(h-a)+a,a,h)},c.mercatorXfromLng=Zl,c.mercatorYfromLat=zc,c.mercatorZfromAltitude=dl,c.mul=K_,c.mul$1=Rh,c.multiply=El,c.multiply$1=function(n,e,i){var a=e[0],h=e[1],g=e[2],b=e[3],C=e[4],D=e[5],S=e[6],R=e[7],V=e[8],U=i[0],ee=i[1],oe=i[2],pe=i[3],Ie=i[4],Ne=i[5],at=i[6],ot=i[7],yt=i[8];return n[0]=U*a+ee*b+oe*S,n[1]=U*h+ee*C+oe*R,n[2]=U*g+ee*D+oe*V,n[3]=pe*a+Ie*b+Ne*S,n[4]=pe*h+Ie*C+Ne*R,n[5]=pe*g+Ie*D+Ne*V,n[6]=at*a+ot*b+yt*S,n[7]=at*h+ot*C+yt*R,n[8]=at*g+ot*D+yt*V,n},c.multiply$2=X_,c.nextPowerOfTwo=vn,c.normalize=Da,c.normalize$1=function(n,e){var i=e[0],a=e[1],h=e[2],g=e[3],b=i*i+a*a+h*h+g*g;return b>0&&(b=1/Math.sqrt(b)),n[0]=i*b,n[1]=a*b,n[2]=h*b,n[3]=g*b,n},c.number=nn,c.ortho=function(n,e,i,a,h,g,b){var C=1/(e-i),D=1/(a-h),S=1/(g-b);return n[0]=-2*C,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*D,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*S,n[11]=0,n[12]=(e+i)*C,n[13]=(h+a)*D,n[14]=(b+g)*S,n[15]=1,n},c.pbf=ih,c.perspective=function(n,e,i,a,h){var g,b=1/Math.tan(e/2);return n[0]=b/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=b,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=h&&h!==1/0?(n[10]=(h+a)*(g=1/(a-h)),n[14]=2*h*a*g):(n[10]=-1,n[14]=-2*a),n},c.pick=function(n,e){const i={};for(let a=0;a<e.length;a++){const h=e[a];h in n&&(i[h]=n[h])}return i},c.plugin=Ee,c.pointGeometry=ye,c.polygonContainsPoint=_u,c.polygonIntersectsBox=cg,c.polygonIntersectsPolygon=Ph,c.polygonizeBounds=function(n,e,i=0,a=!0){const h=new ye(i,i),g=n.sub(h),b=e.add(h),C=[g,new ye(b.x,g.y),b,new ye(g.x,b.y)];return a&&C.push(g.clone()),C},c.posAttributes=Hp,c.postMapLoadEvent=gr,c.postTurnstileEvent=ii,c.potpack=Hc,c.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},c.radToDeg=ut,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.registerForPluginStateChange=function(n){return n({pluginStatus:te,pluginURL:se}),we.on("pluginStateChange",n),n},c.removeAuthState=function(n){mt.delete(n)},c.renderColorRamp=Lh,c.resample=Ah,c.rotateX=vu,c.rotateX$1=mg,c.rotateY=wp,c.rotateY$1=gg,c.rotateZ=function(n,e,i){var a=Math.sin(i),h=Math.cos(i),g=e[0],b=e[1],C=e[2],D=e[3],S=e[4],R=e[5],V=e[6],U=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=g*h+S*a,n[1]=b*h+R*a,n[2]=C*h+V*a,n[3]=D*h+U*a,n[4]=S*h-g*a,n[5]=R*h-b*a,n[6]=V*h-C*a,n[7]=U*h-D*a,n},c.rotateZ$1=function(n,e,i){i*=.5;var a=e[0],h=e[1],g=e[2],b=e[3],C=Math.sin(i),D=Math.cos(i);return n[0]=a*D+h*C,n[1]=h*D-a*C,n[2]=g*D+b*C,n[3]=b*D-g*C,n},c.scale=Ka,c.scale$1=Cp,c.scale$2=jc,c.scaleAndAdd=Bf,c.setCacheLimits=function(n,e){Ke=n,nt=e},c.setColumn=function(n,e,i){n[4*e+0]=i[0],n[4*e+1]=i[1],n[4*e+2]=i[2],n[4*e+3]=i[3]},c.setRTLTextPlugin=function(n,e,i=!1){if(te===I||te===k||te===B)throw new Error("setRTLTextPlugin cannot be called multiple times.");se=or.resolveURL(n),te=I,Z=e,Se(),i||$e()},c.smoothstep=Pn,c.spec=At,c.storeAuthState=function(n,e){e?mt.add(n):mt.delete(n)},c.sub=hl,c.subtract=kh,c.symbolSize=yy,c.tileAABB=function(n,e,i,a,h,g,b,C,D){if("globe"===D.name)return function Oy(n,e,i){const a=e/n.worldSize,h=Number.MAX_VALUE,g=[-h,-h,-h],b=[h,h,h],C=Ms(new Float64Array(16));if(Ka(C,C,[a,a,a]),El(C,C,n.globeMatrix),i.z<=1){const Vt=Kl(i).getCorners();for(let on=0;on<Vt.length;on++)Fs(Vt[on],Vt[on],C),Gd(b,b,Vt[on]),Hd(g,g,Vt[on]);return new pl(b,g)}const[D,S]=uh(i),R=new gu;R.setSouthWest([D[1],S[0]]),R.setNorthEast([S[1],D[0]]);const V=[ea(R.getSouth(),R.getWest()),ea(R.getSouth(),R.getEast()),ea(R.getNorth(),R.getEast()),ea(R.getNorth(),R.getWest())];for(let Vt=0;Vt<V.length;Vt++)Fs(V[Vt],V[Vt],C),Gd(b,b,V[Vt]),Hd(g,g,V[Vt]);if(R.contains(n.center)){g[2]=0;const Vt=n.point,on=[Vt.x*a,Vt.y*a,0];return Gd(b,b,on),Hd(g,g,on),new pl(b,g)}const U=[C[12],C[13],C[14]],ee=n.center.lng,oe=St(n.center.lat,-85.051129,Wl),pe=[Zl(ee),zc(oe)],Ie=R.getCenter().lng,Ne=St(R.getCenter().lat,-85.051129,Wl),at=[Zl(Ie),zc(Ne)];let ot=new Array(3),yt=0,wt=pe[0]-at[0];const It=pe[1]-at[1];if(wt>.5?wt-=1:wt<-.5&&(wt+=1),Math.abs(wt)>Math.abs(It))yt=wt>=0?1:3,ot=U;else{yt=It>=0?0:2;const Vt=[C[4],C[5],C[6]];let on;on=It>=0?-Math.sin(Pe(R.getSouth()))*Xa:-Math.sin(Pe(R.getNorth()))*Xa,ot=Bf(ot,U,Vt,on)}const Wt=V[yt],Yt=V[(yt+1)%4],dn=new Py(Wt,Yt,ot),Tn=[xc(dn,0)||Wt[0],xc(dn,1)||Wt[1],xc(dn,2)||Wt[2]];return b[2]=Math.min(Wt[2],Yt[2]),Gd(b,b,Tn),Hd(g,g,Tn),new pl(b,g)}(n,e,new Gh(i,a,h));const S=wc({z:i,x:a,y:h},D);return new pl([(g+S.x/S.scale)*e,e*(S.y/S.scale),b],[(g+S.x2/S.scale)*e,e*(S.y2/S.scale),C])},c.tileTransform=wc,c.transformMat3=function(n,e,i){var a=e[0],h=e[1],g=e[2];return n[0]=a*i[0]+h*i[3]+g*i[6],n[1]=a*i[1]+h*i[4]+g*i[7],n[2]=a*i[2]+h*i[5]+g*i[8],n},c.transformMat4=Fs,c.transformMat4$1=ud,c.transformQuat=zf,c.translate=ld,c.transpose=function(n,e){if(n===e){var i=e[1],a=e[2],h=e[5];n[1]=e[3],n[2]=e[6],n[3]=i,n[5]=e[7],n[6]=a,n[7]=h}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},c.triggerPluginCompletionEvent=fe,c.uniqueId=Jt,c.updateGlobeVertexNormal=function(n,e,i,a,h){const g=5*e+2;n.float32[g+0]=i,n.float32[g+1]=a,n.float32[g+2]=h},c.validateCustomStyleLayer=function(n){const e=[],i=n.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},c.validateFilter=n=>fs(Rd(n)),c.validateFog=n=>fs(pa(n)),c.validateLayer=n=>fs(Hu(n)),c.validateLight=n=>fs(Es(n)),c.validateSource=n=>fs(Ld(n)),c.validateStyle=fa,c.validateTerrain=n=>fs(cu(n)),c.values=Fe,c.vectorTile=Du,c.version="2.9.2",c.warnOnce=Yn,c.window=Ce,c.wrap=Xn}),d(0,function(c){function Ce(ae){if("number"==typeof ae||"boolean"==typeof ae||"string"==typeof ae||null==ae)return JSON.stringify(ae);if(Array.isArray(ae)){let le="[";for(const Te of ae)le+=`${Ce(Te)},`;return`${le}]`}let Y="{";for(const le of Object.keys(ae).sort())Y+=`${le}:${Ce(ae[le])},`;return`${Y}}`}function Ve(ae){let Y="";for(const le of c.refProperties)Y+=`/${Ce(ae[le])}`;return Y}class Je{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,le){for(const He of Y)this._layerConfigs[He.id]=He,(this._layers[He.id]=c.createStyleLayer(He)).compileFilter(),this.keyCache[He.id]&&delete this.keyCache[He.id];for(const He of le)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};const Te=function(He,Xe){const Mt={};for(let lt=0;lt<He.length;lt++){const Ot=Xe&&Xe[He[lt].id]||Ve(He[lt]);Xe&&(Xe[He[lt].id]=Ot);let Et=Mt[Ot];Et||(Et=Mt[Ot]=[]),Et.push(He[lt])}const Ct=[];for(const lt in Mt)Ct.push(Mt[lt]);return Ct}(c.values(this._layerConfigs),this.keyCache);for(const He of Te){const Xe=He.map(en=>this._layers[en.id]),Mt=Xe[0];if("none"===Mt.visibility)continue;const Ct=Mt.source||"";let lt=this.familiesBySource[Ct];lt||(lt=this.familiesBySource[Ct]={});const Ot=Mt.sourceLayer||"_geojsonTileLayer";let Et=lt[Ot];Et||(Et=lt[Ot]=[]),Et.push(Xe)}}}class ye{loadTile(Y,le){const{uid:Te,encoding:He,rawImageData:Xe,padding:Mt,buildQuadTree:Ct}=Y,lt=c.window.ImageBitmap&&Xe instanceof c.window.ImageBitmap?this.getImageData(Xe,Mt):Xe;le(null,new c.DEMData(Te,lt,He,Mt<1,Ct))}getImageData(Y,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const Te=this.offscreenCanvasContext.getImageData(-le,-le,Y.width+2*le,Y.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Te}}var Me=function ae(Y,le){var Te,He=Y&&Y.type;if("FeatureCollection"===He)for(Te=0;Te<Y.features.length;Te++)ae(Y.features[Te],le);else if("GeometryCollection"===He)for(Te=0;Te<Y.geometries.length;Te++)ae(Y.geometries[Te],le);else if("Feature"===He)ae(Y.geometry,le);else if("Polygon"===He)Ye(Y.coordinates,le);else if("MultiPolygon"===He)for(Te=0;Te<Y.coordinates.length;Te++)Ye(Y.coordinates[Te],le);return Y};function Ye(ae,Y){if(0!==ae.length){ft(ae[0],Y);for(var le=1;le<ae.length;le++)ft(ae[le],!Y)}}function ft(ae,Y){for(var le=0,Te=0,He=0,Xe=ae.length,Mt=Xe-1;He<Xe;Mt=He++){var Ct=(ae[He][0]-ae[Mt][0])*(ae[Mt][1]+ae[He][1]),lt=le+Ct;Te+=Math.abs(le)>=Math.abs(Ct)?le-lt+Ct:Ct-lt+le,le=lt}le+Te>=0!=!!Y&&ae.reverse()}const Pe=c.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ut{constructor(Y){this._feature=Y,this.extent=c.EXTENT,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(1===this._feature.type){const Y=[];for(const le of this._feature.geometry)Y.push([new c.pointGeometry(le[0],le[1])]);return Y}{const Y=[];for(const le of this._feature.geometry){const Te=[];for(const He of le)Te.push(new c.pointGeometry(He[0],He[1]));Y.push(Te)}return Y}}toGeoJSON(Y,le,Te){return Pe.call(this,Y,le,Te)}}class gt{constructor(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=Y.length,this._features=Y}feature(Y){return new ut(this._features[Y])}}var et=c.vectorTile.VectorTileFeature,Ut=Ft;function Ft(ae,Y){this.options=Y||{},this.features=ae,this.length=ae.length}function St(ae,Y){this.id="number"==typeof ae.id?ae.id:void 0,this.type=ae.type,this.rawGeometry=1===ae.type?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=Y||4096}Ft.prototype.feature=function(ae){return new St(this.features[ae],this.options.extent)},St.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var Y=0;Y<ae.length;Y++){for(var le=ae[Y],Te=[],He=0;He<le.length;He++)Te.push(new c.pointGeometry(le[He][0],le[He][1]));this.geometry.push(Te)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,Y=1/0,le=-1/0,Te=1/0,He=-1/0,Xe=0;Xe<ae.length;Xe++)for(var Mt=ae[Xe],Ct=0;Ct<Mt.length;Ct++){var lt=Mt[Ct];Y=Math.min(Y,lt.x),le=Math.max(le,lt.x),Te=Math.min(Te,lt.y),He=Math.max(He,lt.y)}return[Y,Te,le,He]},St.prototype.toGeoJSON=et.prototype.toGeoJSON;var Pn=Xt,Xn=Ut;function Xt(ae){var Y=new c.pbf;return function(le,Te){for(var He in le.layers)Te.writeMessage(3,Fe,le.layers[He])}(ae,Y),Y.finish()}function Fe(ae,Y){var le;Y.writeVarintField(15,ae.version||1),Y.writeStringField(1,ae.name||""),Y.writeVarintField(5,ae.extent||4096);var Te={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<ae.length;le++)Te.feature=ae.feature(le),Y.writeMessage(2,Qe,Te);var He=Te.keys;for(le=0;le<He.length;le++)Y.writeStringField(3,He[le]);var Xe=Te.values;for(le=0;le<Xe.length;le++)Y.writeMessage(4,xt,Xe[le])}function Qe(ae,Y){var le=ae.feature;void 0!==le.id&&Y.writeVarintField(1,le.id),Y.writeMessage(2,fn,ae),Y.writeVarintField(3,le.type),Y.writeMessage(4,vn,le)}function fn(ae,Y){var le=ae.feature,Te=ae.keys,He=ae.values,Xe=ae.keycache,Mt=ae.valuecache;for(var Ct in le.properties){var lt=le.properties[Ct],Ot=Xe[Ct];if(null!==lt){void 0===Ot&&(Te.push(Ct),Xe[Ct]=Ot=Te.length-1),Y.writeVarint(Ot);var Et=typeof lt;"string"!==Et&&"boolean"!==Et&&"number"!==Et&&(lt=JSON.stringify(lt));var en=Et+":"+lt,Le=Mt[en];void 0===Le&&(He.push(lt),Mt[en]=Le=He.length-1),Y.writeVarint(Le)}}}function Jt(ae,Y){return(Y<<3)+(7&ae)}function rn(ae){return ae<<1^ae>>31}function vn(ae,Y){for(var le=ae.loadGeometry(),Te=ae.type,He=0,Xe=0,Mt=le.length,Ct=0;Ct<Mt;Ct++){var lt=le[Ct],Ot=1;1===Te&&(Ot=lt.length),Y.writeVarint(Jt(1,Ot));for(var Et=3===Te?lt.length-1:lt.length,en=0;en<Et;en++){1===en&&1!==Te&&Y.writeVarint(Jt(2,Et-1));var Le=lt[en].x-He,Ge=lt[en].y-Xe;Y.writeVarint(rn(Le)),Y.writeVarint(rn(Ge)),He+=Le,Xe+=Ge}3===Te&&Y.writeVarint(Jt(7,1))}}function xt(ae,Y){var le=typeof ae;"string"===le?Y.writeStringField(1,ae):"boolean"===le?Y.writeBooleanField(7,ae):"number"===le&&(ae%1!=0?Y.writeDoubleField(3,ae):ae<0?Y.writeSVarintField(6,ae):Y.writeVarintField(5,ae))}function Tt(ae,Y,le,Te,He,Xe){if(He-Te<=le)return;const Mt=Te+He>>1;Gt(ae,Y,Mt,Te,He,Xe%2),Tt(ae,Y,le,Te,Mt-1,Xe+1),Tt(ae,Y,le,Mt+1,He,Xe+1)}function Gt(ae,Y,le,Te,He,Xe){for(;He>Te;){if(He-Te>600){const Ot=He-Te+1,Et=le-Te+1,en=Math.log(Ot),Le=.5*Math.exp(2*en/3),Ge=.5*Math.sqrt(en*Le*(Ot-Le)/Ot)*(Et-Ot/2<0?-1:1);Gt(ae,Y,le,Math.max(Te,Math.floor(le-Et*Le/Ot+Ge)),Math.min(He,Math.floor(le+(Ot-Et)*Le/Ot+Ge)),Xe)}const Mt=Y[2*le+Xe];let Ct=Te,lt=He;for(Bt(ae,Y,Te,le),Y[2*He+Xe]>Mt&&Bt(ae,Y,Te,He);Ct<lt;){for(Bt(ae,Y,Ct,lt),Ct++,lt--;Y[2*Ct+Xe]<Mt;)Ct++;for(;Y[2*lt+Xe]>Mt;)lt--}Y[2*Te+Xe]===Mt?Bt(ae,Y,Te,lt):(lt++,Bt(ae,Y,lt,He)),lt<=le&&(Te=lt+1),le<=lt&&(He=lt-1)}}function Bt(ae,Y,le,Te){Cn(ae,le,Te),Cn(Y,2*le,2*Te),Cn(Y,2*le+1,2*Te+1)}function Cn(ae,Y,le){const Te=ae[Y];ae[Y]=ae[le],ae[le]=Te}function mn(ae,Y,le,Te){const He=ae-le,Xe=Y-Te;return He*He+Xe*Xe}Pn.fromVectorTileJs=Xt,Pn.fromGeojsonVt=function(ae,Y){Y=Y||{};var le={};for(var Te in ae)le[Te]=new Ut(ae[Te].features,Y),le[Te].name=Te,le[Te].version=Y.version,le[Te].extent=Y.extent;return Xt({layers:le})},Pn.GeoJSONWrapper=Xn;const oi=ae=>ae[0],Yn=ae=>ae[1];class fi{constructor(Y,le=oi,Te=Yn,He=64,Xe=Float64Array){this.nodeSize=He,this.points=Y;const Mt=Y.length<65536?Uint16Array:Uint32Array,Ct=this.ids=new Mt(Y.length),lt=this.coords=new Xe(2*Y.length);for(let Ot=0;Ot<Y.length;Ot++)Ct[Ot]=Ot,lt[2*Ot]=le(Y[Ot]),lt[2*Ot+1]=Te(Y[Ot]);Tt(Ct,lt,He,0,Ct.length-1,0)}range(Y,le,Te,He){return function(Xe,Mt,Ct,lt,Ot,Et,en){const Le=[0,Xe.length-1,0],Ge=[];let Oe,tt;for(;Le.length;){const Nt=Le.pop(),bn=Le.pop(),ti=Le.pop();if(bn-ti<=en){for(let At=ti;At<=bn;At++)Oe=Mt[2*At],tt=Mt[2*At+1],Oe>=Ct&&Oe<=Ot&&tt>=lt&&tt<=Et&&Ge.push(Xe[At]);continue}const Ri=Math.floor((ti+bn)/2);Oe=Mt[2*Ri],tt=Mt[2*Ri+1],Oe>=Ct&&Oe<=Ot&&tt>=lt&&tt<=Et&&Ge.push(Xe[Ri]);const jn=(Nt+1)%2;(0===Nt?Ct<=Oe:lt<=tt)&&(Le.push(ti),Le.push(Ri-1),Le.push(jn)),(0===Nt?Ot>=Oe:Et>=tt)&&(Le.push(Ri+1),Le.push(bn),Le.push(jn))}return Ge}(this.ids,this.coords,Y,le,Te,He,this.nodeSize)}within(Y,le,Te){return function(He,Xe,Mt,Ct,lt,Ot){const Et=[0,He.length-1,0],en=[],Le=lt*lt;for(;Et.length;){const Ge=Et.pop(),Oe=Et.pop(),tt=Et.pop();if(Oe-tt<=Ot){for(let jn=tt;jn<=Oe;jn++)mn(Xe[2*jn],Xe[2*jn+1],Mt,Ct)<=Le&&en.push(He[jn]);continue}const Nt=Math.floor((tt+Oe)/2),bn=Xe[2*Nt],ti=Xe[2*Nt+1];mn(bn,ti,Mt,Ct)<=Le&&en.push(He[Nt]);const Ri=(Ge+1)%2;(0===Ge?Mt-lt<=bn:Ct-lt<=ti)&&(Et.push(tt),Et.push(Nt-1),Et.push(Ri)),(0===Ge?Mt+lt>=bn:Ct+lt>=ti)&&(Et.push(Nt+1),Et.push(Oe),Et.push(Ri))}return en}(this.ids,this.coords,Y,le,Te,this.nodeSize)}}const On={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},Di=Math.fround||(Ui=new Float32Array(1),ae=>(Ui[0]=+ae,Ui[0]));var Ui;class Pi{constructor(Y){this.options=wi(Object.create(On),Y),this.trees=new Array(this.options.maxZoom+1)}load(Y){const{log:le,minZoom:Te,maxZoom:He,nodeSize:Xe}=this.options;le&&console.time("total time");const Mt=`prepare ${Y.length} points`;le&&console.time(Mt),this.points=Y;let Ct=[];for(let lt=0;lt<Y.length;lt++)Y[lt].geometry&&Ct.push(Zn(Y[lt],lt));this.trees[He+1]=new fi(Ct,Ei,Ii,Xe,Float32Array),le&&console.timeEnd(Mt);for(let lt=He;lt>=Te;lt--){const Ot=+Date.now();Ct=this._cluster(Ct,lt),this.trees[lt]=new fi(Ct,Ei,Ii,Xe,Float32Array),le&&console.log("z%d: %d clusters in %dms",lt,Ct.length,+Date.now()-Ot)}return le&&console.timeEnd("total time"),this}getClusters(Y,le){let Te=((Y[0]+180)%360+360)%360-180;const He=Math.max(-90,Math.min(90,Y[1]));let Xe=180===Y[2]?180:((Y[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)Te=-180,Xe=180;else if(Te>Xe){const Et=this.getClusters([Te,He,180,Mt],le),en=this.getClusters([-180,He,Xe,Mt],le);return Et.concat(en)}const Ct=this.trees[this._limitZoom(le)],lt=Ct.range(kn(Te),zn(Mt),kn(Xe),zn(He)),Ot=[];for(const Et of lt){const en=Ct.points[Et];Ot.push(en.numPoints?Rt(en):this.points[en.index])}return Ot}getChildren(Y){const le=this._getOriginId(Y),Te=this._getOriginZoom(Y),He="No cluster with the specified id.",Xe=this.trees[Te];if(!Xe)throw new Error(He);const Mt=Xe.points[le];if(!Mt)throw new Error(He);const Ct=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),lt=Xe.within(Mt.x,Mt.y,Ct),Ot=[];for(const Et of lt){const en=Xe.points[Et];en.parentId===Y&&Ot.push(en.numPoints?Rt(en):this.points[en.index])}if(0===Ot.length)throw new Error(He);return Ot}getLeaves(Y,le,Te){const He=[];return this._appendLeaves(He,Y,le=le||10,Te=Te||0,0),He}getTile(Y,le,Te){const He=this.trees[this._limitZoom(Y)],Xe=Math.pow(2,Y),{extent:Mt,radius:Ct}=this.options,lt=Ct/Mt,Ot=(Te-lt)/Xe,Et=(Te+1+lt)/Xe,en={features:[]};return this._addTileFeatures(He.range((le-lt)/Xe,Ot,(le+1+lt)/Xe,Et),He.points,le,Te,Xe,en),0===le&&this._addTileFeatures(He.range(1-lt/Xe,Ot,1,Et),He.points,Xe,Te,Xe,en),le===Xe-1&&this._addTileFeatures(He.range(0,Ot,lt/Xe,Et),He.points,-1,Te,Xe,en),en.features.length?en:null}getClusterExpansionZoom(Y){let le=this._getOriginZoom(Y)-1;for(;le<=this.options.maxZoom;){const Te=this.getChildren(Y);if(le++,1!==Te.length)break;Y=Te[0].properties.cluster_id}return le}_appendLeaves(Y,le,Te,He,Xe){const Mt=this.getChildren(le);for(const Ct of Mt){const lt=Ct.properties;if(lt&&lt.cluster?Xe+lt.point_count<=He?Xe+=lt.point_count:Xe=this._appendLeaves(Y,lt.cluster_id,Te,He,Xe):Xe<He?Xe++:Y.push(Ct),Y.length===Te)break}return Xe}_addTileFeatures(Y,le,Te,He,Xe,Mt){for(const Ct of Y){const lt=le[Ct],Ot=lt.numPoints;let Et,en,Le;if(Ot)Et=Kt(lt),en=lt.x,Le=lt.y;else{const tt=this.points[lt.index];Et=tt.properties,en=kn(tt.geometry.coordinates[0]),Le=zn(tt.geometry.coordinates[1])}const Ge={type:1,geometry:[[Math.round(this.options.extent*(en*Xe-Te)),Math.round(this.options.extent*(Le*Xe-He))]],tags:Et};let Oe;Ot?Oe=lt.id:this.options.generateId?Oe=lt.index:this.points[lt.index].id&&(Oe=this.points[lt.index].id),void 0!==Oe&&(Ge.id=Oe),Mt.features.push(Ge)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(+Y,this.options.maxZoom+1))}_cluster(Y,le){const Te=[],{radius:He,extent:Xe,reduce:Mt,minPoints:Ct}=this.options,lt=He/(Xe*Math.pow(2,le));for(let Ot=0;Ot<Y.length;Ot++){const Et=Y[Ot];if(Et.zoom<=le)continue;Et.zoom=le;const en=this.trees[le+1],Le=en.within(Et.x,Et.y,lt),Ge=Et.numPoints||1;let Oe=Ge;for(const tt of Le){const Nt=en.points[tt];Nt.zoom>le&&(Oe+=Nt.numPoints||1)}if(Oe>Ge&&Oe>=Ct){let tt=Et.x*Ge,Nt=Et.y*Ge,bn=Mt&&Ge>1?this._map(Et,!0):null;const ti=(Ot<<5)+(le+1)+this.points.length;for(const Ri of Le){const jn=en.points[Ri];if(jn.zoom<=le)continue;jn.zoom=le;const At=jn.numPoints||1;tt+=jn.x*At,Nt+=jn.y*At,jn.parentId=ti,Mt&&(bn||(bn=this._map(Et,!0)),Mt(bn,this._map(jn)))}Et.parentId=ti,Te.push(Ln(tt/Oe,Nt/Oe,ti,Oe,bn))}else if(Te.push(Et),Oe>1)for(const tt of Le){const Nt=en.points[tt];Nt.zoom<=le||(Nt.zoom=le,Te.push(Nt))}}return Te}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,le){if(Y.numPoints)return le?wi({},Y.properties):Y.properties;const Te=this.points[Y.index].properties,He=this.options.map(Te);return le&&He===Te?wi({},He):He}}function Ln(ae,Y,le,Te,He){return{x:Di(ae),y:Di(Y),zoom:1/0,id:le,parentId:-1,numPoints:Te,properties:He}}function Zn(ae,Y){const[le,Te]=ae.geometry.coordinates;return{x:Di(kn(le)),y:Di(zn(Te)),zoom:1/0,index:Y,parentId:-1}}function Rt(ae){return{type:"Feature",id:ae.id,properties:Kt(ae),geometry:{type:"Point",coordinates:[(Y=ae.x,360*(Y-.5)),gn(ae.y)]}};var Y}function Kt(ae){const Y=ae.numPoints,le=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y;return wi(wi({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:Y,point_count_abbreviated:le})}function kn(ae){return ae/360+.5}function zn(ae){const Y=Math.sin(ae*Math.PI/180),le=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return le<0?0:le>1?1:le}function gn(ae){const Y=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function wi(ae,Y){for(const le in Y)ae[le]=Y[le];return ae}function Ei(ae){return ae.x}function Ii(ae){return ae.y}function or(ae,Y,le,Te){for(var He,Xe=Te,Mt=le-Y>>1,Ct=le-Y,lt=ae[Y],Ot=ae[Y+1],Et=ae[le],en=ae[le+1],Le=Y+3;Le<le;Le+=3){var Ge=Oi(ae[Le],ae[Le+1],lt,Ot,Et,en);if(Ge>Xe)He=Le,Xe=Ge;else if(Ge===Xe){var Oe=Math.abs(Le-Mt);Oe<Ct&&(He=Le,Ct=Oe)}}Xe>Te&&(He-Y>3&&or(ae,Y,He,Te),ae[He+2]=Xe,le-He>3&&or(ae,He,le,Te))}function Oi(ae,Y,le,Te,He,Xe){var Mt=He-le,Ct=Xe-Te;if(0!==Mt||0!==Ct){var lt=((ae-le)*Mt+(Y-Te)*Ct)/(Mt*Mt+Ct*Ct);lt>1?(le=He,Te=Xe):lt>0&&(le+=Mt*lt,Te+=Ct*lt)}return(Mt=ae-le)*Mt+(Ct=Y-Te)*Ct}function En(ae,Y,le,Te){var He={id:void 0===ae?null:ae,type:Y,geometry:le,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Xe){var Mt=Xe.geometry,Ct=Xe.type;if("Point"===Ct||"MultiPoint"===Ct||"LineString"===Ct)Wi(Xe,Mt);else if("Polygon"===Ct||"MultiLineString"===Ct)for(var lt=0;lt<Mt.length;lt++)Wi(Xe,Mt[lt]);else if("MultiPolygon"===Ct)for(lt=0;lt<Mt.length;lt++)for(var Ot=0;Ot<Mt[lt].length;Ot++)Wi(Xe,Mt[lt][Ot])}(He),He}function Wi(ae,Y){for(var le=0;le<Y.length;le+=3)ae.minX=Math.min(ae.minX,Y[le]),ae.minY=Math.min(ae.minY,Y[le+1]),ae.maxX=Math.max(ae.maxX,Y[le]),ae.maxY=Math.max(ae.maxY,Y[le+1])}function li(ae,Y,le,Te){if(Y.geometry){var He=Y.geometry.coordinates,Xe=Y.geometry.type,Mt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Ct=[],lt=Y.id;if(le.promoteId?lt=Y.properties[le.promoteId]:le.generateId&&(lt=Te||0),"Point"===Xe)ct(He,Ct);else if("MultiPoint"===Xe)for(var Ot=0;Ot<He.length;Ot++)ct(He[Ot],Ct);else if("LineString"===Xe)K(He,Ct,Mt,!1);else if("MultiLineString"===Xe){if(le.lineMetrics){for(Ot=0;Ot<He.length;Ot++)K(He[Ot],Ct=[],Mt,!1),ae.push(En(lt,"LineString",Ct,Y.properties));return}ie(He,Ct,Mt,!1)}else if("Polygon"===Xe)ie(He,Ct,Mt,!0);else{if("MultiPolygon"!==Xe){if("GeometryCollection"===Xe){for(Ot=0;Ot<Y.geometry.geometries.length;Ot++)li(ae,{id:lt,geometry:Y.geometry.geometries[Ot],properties:Y.properties},le,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ot=0;Ot<He.length;Ot++){var Et=[];ie(He[Ot],Et,Mt,!0),Ct.push(Et)}}ae.push(En(lt,Xe,Ct,Y.properties))}}function ct(ae,Y){Y.push(De(ae[0])),Y.push(dt(ae[1])),Y.push(0)}function K(ae,Y,le,Te){for(var He,Xe,Mt=0,Ct=0;Ct<ae.length;Ct++){var lt=De(ae[Ct][0]),Ot=dt(ae[Ct][1]);Y.push(lt),Y.push(Ot),Y.push(0),Ct>0&&(Mt+=Te?(He*Ot-lt*Xe)/2:Math.sqrt(Math.pow(lt-He,2)+Math.pow(Ot-Xe,2))),He=lt,Xe=Ot}var Et=Y.length-3;Y[2]=1,or(Y,0,Et,le),Y[Et+2]=1,Y.size=Math.abs(Mt),Y.start=0,Y.end=Y.size}function ie(ae,Y,le,Te){for(var He=0;He<ae.length;He++){var Xe=[];K(ae[He],Xe,le,Te),Y.push(Xe)}}function De(ae){return ae/360+.5}function dt(ae){var Y=Math.sin(ae*Math.PI/180),le=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return le<0?0:le>1?1:le}function ze(ae,Y,le,Te,He,Xe,Mt,Ct){if(Te/=Y,Xe>=(le/=Y)&&Mt<Te)return ae;if(Mt<le||Xe>=Te)return null;for(var lt=[],Ot=0;Ot<ae.length;Ot++){var Et=ae[Ot],en=Et.geometry,Le=Et.type,Ge=0===He?Et.minX:Et.minY,Oe=0===He?Et.maxX:Et.maxY;if(Ge>=le&&Oe<Te)lt.push(Et);else if(!(Oe<le||Ge>=Te)){var tt=[];if("Point"===Le||"MultiPoint"===Le)he(en,tt,le,Te,He);else if("LineString"===Le)ce(en,tt,le,Te,He,!1,Ct.lineMetrics);else if("MultiLineString"===Le)We(en,tt,le,Te,He,!1);else if("Polygon"===Le)We(en,tt,le,Te,He,!0);else if("MultiPolygon"===Le)for(var Nt=0;Nt<en.length;Nt++){var bn=[];We(en[Nt],bn,le,Te,He,!0),bn.length&&tt.push(bn)}if(tt.length){if(Ct.lineMetrics&&"LineString"===Le){for(Nt=0;Nt<tt.length;Nt++)lt.push(En(Et.id,Le,tt[Nt],Et.tags));continue}"LineString"!==Le&&"MultiLineString"!==Le||(1===tt.length?(Le="LineString",tt=tt[0]):Le="MultiLineString"),"Point"!==Le&&"MultiPoint"!==Le||(Le=3===tt.length?"Point":"MultiPoint"),lt.push(En(Et.id,Le,tt,Et.tags))}}}return lt.length?lt:null}function he(ae,Y,le,Te,He){for(var Xe=0;Xe<ae.length;Xe+=3){var Mt=ae[Xe+He];Mt>=le&&Mt<=Te&&(Y.push(ae[Xe]),Y.push(ae[Xe+1]),Y.push(ae[Xe+2]))}}function ce(ae,Y,le,Te,He,Xe,Mt){for(var Ct,lt,Ot=de(ae),Et=0===He?Qt:_n,en=ae.start,Le=0;Le<ae.length-3;Le+=3){var Ge=ae[Le],Oe=ae[Le+1],tt=ae[Le+2],Nt=ae[Le+3],bn=ae[Le+4],ti=0===He?Ge:Oe,Ri=0===He?Nt:bn,jn=!1;Mt&&(Ct=Math.sqrt(Math.pow(Ge-Nt,2)+Math.pow(Oe-bn,2))),ti<le?Ri>le&&(lt=Et(Ot,Ge,Oe,Nt,bn,le),Mt&&(Ot.start=en+Ct*lt)):ti>Te?Ri<Te&&(lt=Et(Ot,Ge,Oe,Nt,bn,Te),Mt&&(Ot.start=en+Ct*lt)):ht(Ot,Ge,Oe,tt),Ri<le&&ti>=le&&(lt=Et(Ot,Ge,Oe,Nt,bn,le),jn=!0),Ri>Te&&ti<=Te&&(lt=Et(Ot,Ge,Oe,Nt,bn,Te),jn=!0),!Xe&&jn&&(Mt&&(Ot.end=en+Ct*lt),Y.push(Ot),Ot=de(ae)),Mt&&(en+=Ct)}var At=ae.length-3;Ge=ae[At],Oe=ae[At+1],tt=ae[At+2],(ti=0===He?Ge:Oe)>=le&&ti<=Te&&ht(Ot,Ge,Oe,tt),At=Ot.length-3,Xe&&At>=3&&(Ot[At]!==Ot[0]||Ot[At+1]!==Ot[1])&&ht(Ot,Ot[0],Ot[1],Ot[2]),Ot.length&&Y.push(Ot)}function de(ae){var Y=[];return Y.size=ae.size,Y.start=ae.start,Y.end=ae.end,Y}function We(ae,Y,le,Te,He,Xe){for(var Mt=0;Mt<ae.length;Mt++)ce(ae[Mt],Y,le,Te,He,Xe,!1)}function ht(ae,Y,le,Te){ae.push(Y),ae.push(le),ae.push(Te)}function Qt(ae,Y,le,Te,He,Xe){var Mt=(Xe-Y)/(Te-Y);return ae.push(Xe),ae.push(le+(He-le)*Mt),ae.push(1),Mt}function _n(ae,Y,le,Te,He,Xe){var Mt=(Xe-le)/(He-le);return ae.push(Y+(Te-Y)*Mt),ae.push(Xe),ae.push(1),Mt}function An(ae,Y){for(var le=[],Te=0;Te<ae.length;Te++){var He,Xe=ae[Te],Mt=Xe.type;if("Point"===Mt||"MultiPoint"===Mt||"LineString"===Mt)He=ii(Xe.geometry,Y);else if("MultiLineString"===Mt||"Polygon"===Mt){He=[];for(var Ct=0;Ct<Xe.geometry.length;Ct++)He.push(ii(Xe.geometry[Ct],Y))}else if("MultiPolygon"===Mt)for(He=[],Ct=0;Ct<Xe.geometry.length;Ct++){for(var lt=[],Ot=0;Ot<Xe.geometry[Ct].length;Ot++)lt.push(ii(Xe.geometry[Ct][Ot],Y));He.push(lt)}le.push(En(Xe.id,Mt,He,Xe.tags))}return le}function ii(ae,Y){var le=[];le.size=ae.size,void 0!==ae.start&&(le.start=ae.start,le.end=ae.end);for(var Te=0;Te<ae.length;Te+=3)le.push(ae[Te]+Y,ae[Te+1],ae[Te+2]);return le}function qn(ae,Y){if(ae.transformed)return ae;var le,Te,He,Xe=1<<ae.z,Mt=ae.x,Ct=ae.y;for(le=0;le<ae.features.length;le++){var lt=ae.features[le],Ot=lt.geometry,Et=lt.type;if(lt.geometry=[],1===Et)for(Te=0;Te<Ot.length;Te+=2)lt.geometry.push(gr(Ot[Te],Ot[Te+1],Y,Xe,Mt,Ct));else for(Te=0;Te<Ot.length;Te++){var en=[];for(He=0;He<Ot[Te].length;He+=2)en.push(gr(Ot[Te][He],Ot[Te][He+1],Y,Xe,Mt,Ct));lt.geometry.push(en)}}return ae.transformed=!0,ae}function gr(ae,Y,le,Te,He,Xe){return[Math.round(le*(ae*Te-He)),Math.round(le*(Y*Te-Xe))]}function mi(ae,Y,le,Te,He){for(var Xe=Y===He.maxZoom?0:He.tolerance/((1<<Y)*He.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:Te,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ct=0;Ct<ae.length;Ct++){Mt.numFeatures++,zt(Mt,ae[Ct],Xe,He);var lt=ae[Ct].minX,Ot=ae[Ct].minY,Et=ae[Ct].maxX,en=ae[Ct].maxY;lt<Mt.minX&&(Mt.minX=lt),Ot<Mt.minY&&(Mt.minY=Ot),Et>Mt.maxX&&(Mt.maxX=Et),en>Mt.maxY&&(Mt.maxY=en)}return Mt}function zt(ae,Y,le,Te){var He=Y.geometry,Xe=Y.type,Mt=[];if("Point"===Xe||"MultiPoint"===Xe)for(var Ct=0;Ct<He.length;Ct+=3)Mt.push(He[Ct]),Mt.push(He[Ct+1]),ae.numPoints++,ae.numSimplified++;else if("LineString"===Xe)mt(Mt,He,ae,le,!1,!1);else if("MultiLineString"===Xe||"Polygon"===Xe)for(Ct=0;Ct<He.length;Ct++)mt(Mt,He[Ct],ae,le,"Polygon"===Xe,0===Ct);else if("MultiPolygon"===Xe)for(var lt=0;lt<He.length;lt++){var Ot=He[lt];for(Ct=0;Ct<Ot.length;Ct++)mt(Mt,Ot[Ct],ae,le,!0,0===Ct)}if(Mt.length){var Et=Y.tags||null;if("LineString"===Xe&&Te.lineMetrics){for(var en in Et={},Y.tags)Et[en]=Y.tags[en];Et.mapbox_clip_start=He.start/He.size,Et.mapbox_clip_end=He.end/He.size}var Le={geometry:Mt,type:"Polygon"===Xe||"MultiPolygon"===Xe?3:"LineString"===Xe||"MultiLineString"===Xe?2:1,tags:Et};null!==Y.id&&(Le.id=Y.id),ae.features.push(Le)}}function mt(ae,Y,le,Te,He,Xe){var Mt=Te*Te;if(Te>0&&Y.size<(He?Mt:Te))le.numPoints+=Y.length/3;else{for(var Ct=[],lt=0;lt<Y.length;lt+=3)(0===Te||Y[lt+2]>Mt)&&(le.numSimplified++,Ct.push(Y[lt]),Ct.push(Y[lt+1])),le.numPoints++;He&&function(Ot,Et){for(var en=0,Le=0,Ge=Ot.length,Oe=Ge-2;Le<Ge;Oe=Le,Le+=2)en+=(Ot[Le]-Ot[Oe])*(Ot[Le+1]+Ot[Oe+1]);if(en>0===Et)for(Le=0,Ge=Ot.length;Le<Ge/2;Le+=2){var tt=Ot[Le],Nt=Ot[Le+1];Ot[Le]=Ot[Ge-2-Le],Ot[Le+1]=Ot[Ge-1-Le],Ot[Ge-2-Le]=tt,Ot[Ge-1-Le]=Nt}}(Ct,Xe),ae.push(Ct)}}function _t(ae,Y){var le=(Y=this.options=function(He,Xe){for(var Mt in Xe)He[Mt]=Xe[Mt];return He}(Object.create(this.options),Y)).debug;if(le&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var He,Xe,Mt,Ct,lt,Ot,Te=function(He,Xe){var Mt=[];if("FeatureCollection"===He.type)for(var Ct=0;Ct<He.features.length;Ct++)li(Mt,He.features[Ct],Xe,Ct);else li(Mt,"Feature"===He.type?He:{geometry:He},Xe);return Mt}(ae,Y);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(He=Te,Xe=Y,Mt=Xe.buffer/Xe.extent,Ct=He,lt=ze(He,1,-1-Mt,Mt,0,-1,2,Xe),Ot=ze(He,1,1-Mt,2+Mt,0,-1,2,Xe),(lt||Ot)&&(Ct=ze(He,1,-Mt,1+Mt,0,-1,2,Xe)||[],lt&&(Ct=An(lt,1).concat(Ct)),Ot&&(Ct=Ct.concat(An(Ot,-1)))),Te=Ct).length&&this.splitTile(Te,0,0,0),le&&(Te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ke(ae,Y,le){return 32*((1<<ae)*le+Y)+ae}function nt(ae,Y){const le=ae.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const Te=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Te)return Y(null,null);const He=new gt(Te.features);let Xe=Pn(He);0===Xe.byteOffset&&Xe.byteLength===Xe.buffer.byteLength||(Xe=new Uint8Array(Xe)),Y(null,{vectorTile:He,rawData:Xe.buffer})}_t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_t.prototype.splitTile=function(ae,Y,le,Te,He,Xe,Mt){for(var Ct=[ae,Y,le,Te],lt=this.options,Ot=lt.debug;Ct.length;){Te=Ct.pop(),le=Ct.pop(),Y=Ct.pop(),ae=Ct.pop();var Et=1<<Y,en=Ke(Y,le,Te),Le=this.tiles[en];if(!Le&&(Ot>1&&console.time("creation"),Le=this.tiles[en]=mi(ae,Y,le,Te,lt),this.tileCoords.push({z:Y,x:le,y:Te}),Ot)){Ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,le,Te,Le.numFeatures,Le.numPoints,Le.numSimplified),console.timeEnd("creation"));var Ge="z"+Y;this.stats[Ge]=(this.stats[Ge]||0)+1,this.total++}if(Le.source=ae,He){if(Y===lt.maxZoom||Y===He)continue;var Oe=1<<He-Y;if(le!==Math.floor(Xe/Oe)||Te!==Math.floor(Mt/Oe))continue}else if(Y===lt.indexMaxZoom||Le.numPoints<=lt.indexMaxPoints)continue;if(Le.source=null,0!==ae.length){Ot>1&&console.time("clipping");var tt,Nt,bn,ti,Ri,jn,At=.5*lt.buffer/lt.extent,nr=.5-At,br=.5+At,jr=1+At;tt=Nt=bn=ti=null,Ri=ze(ae,Et,le-At,le+br,0,Le.minX,Le.maxX,lt),jn=ze(ae,Et,le+nr,le+jr,0,Le.minX,Le.maxX,lt),ae=null,Ri&&(tt=ze(Ri,Et,Te-At,Te+br,1,Le.minY,Le.maxY,lt),Nt=ze(Ri,Et,Te+nr,Te+jr,1,Le.minY,Le.maxY,lt),Ri=null),jn&&(bn=ze(jn,Et,Te-At,Te+br,1,Le.minY,Le.maxY,lt),ti=ze(jn,Et,Te+nr,Te+jr,1,Le.minY,Le.maxY,lt),jn=null),Ot>1&&console.timeEnd("clipping"),Ct.push(tt||[],Y+1,2*le,2*Te),Ct.push(Nt||[],Y+1,2*le,2*Te+1),Ct.push(bn||[],Y+1,2*le+1,2*Te),Ct.push(ti||[],Y+1,2*le+1,2*Te+1)}}},_t.prototype.getTile=function(ae,Y,le){var Te=this.options,He=Te.extent,Xe=Te.debug;if(ae<0||ae>24)return null;var Mt=1<<ae,Ct=Ke(ae,Y=(Y%Mt+Mt)%Mt,le);if(this.tiles[Ct])return qn(this.tiles[Ct],He);Xe>1&&console.log("drilling down to z%d-%d-%d",ae,Y,le);for(var lt,Ot=ae,Et=Y,en=le;!lt&&Ot>0;)Ot--,Et=Math.floor(Et/2),en=Math.floor(en/2),lt=this.tiles[Ke(Ot,Et,en)];return lt&&lt.source?(Xe>1&&console.log("found parent tile z%d-%d-%d",Ot,Et,en),Xe>1&&console.time("drilling down"),this.splitTile(lt.source,Ot,Et,en,ae,Y,le),Xe>1&&console.timeEnd("drilling down"),this.tiles[Ct]?qn(this.tiles[Ct],He):null):null};class Be extends c.VectorTileWorkerSource{constructor(Y,le,Te,He,Xe){super(Y,le,Te,He,nt),Xe&&(this.loadGeoJSON=Xe)}loadData(Y,le){const Te=Y&&Y.request,He=Te&&Te.collectResourceTiming;this.loadGeoJSON(Y,(Xe,Mt)=>{if(Xe||!Mt)return le(Xe);if("object"!=typeof Mt)return le(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{Me(Mt,!0);try{if(Y.filter){const lt=c.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===lt.result)throw new Error(lt.value.map(Et=>`${Et.key}: ${Et.message}`).join(", "));const Ot=Mt.features.filter(Et=>lt.value.evaluate({zoom:0},Et));Mt={type:"FeatureCollection",features:Ot}}this._geoJSONIndex=Y.cluster?new Pi(function({superclusterOptions:lt,clusterProperties:Ot}){if(!Ot||!lt)return lt;const Et={},en={},Le={accumulated:null,zoom:0},Ge={properties:null},Oe=Object.keys(Ot);for(const tt of Oe){const[Nt,bn]=Ot[tt],ti=c.createExpression(bn),Ri=c.createExpression("string"==typeof Nt?[Nt,["accumulated"],["get",tt]]:Nt);Et[tt]=ti.value,en[tt]=Ri.value}return lt.map=tt=>{Ge.properties=tt;const Nt={};for(const bn of Oe)Nt[bn]=Et[bn].evaluate(Le,Ge);return Nt},lt.reduce=(tt,Nt)=>{Ge.properties=Nt;for(const bn of Oe)Le.accumulated=tt[bn],tt[bn]=en[bn].evaluate(Le,Ge)},lt}(Y)).load(Mt.features):new _t(lt=Mt,Y.geojsonVtOptions)}catch(lt){return le(lt)}this.loaded={};const Ct={};if(He){const lt=c.getPerformanceMeasurement(Te);lt&&(Ct.resourceTiming={},Ct.resourceTiming[Y.source]=JSON.parse(JSON.stringify(lt)))}le(null,Ct)}var lt})}reloadTile(Y,le){const Te=this.loaded;return Te&&Te[Y.uid]?super.reloadTile(Y,le):this.loadTile(Y,le)}loadGeoJSON(Y,le){if(Y.request)c.getJSON(Y.request,le);else{if("string"!=typeof Y.data)return le(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(Y.data))}catch{return le(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(Te){le(Te)}}getClusterChildren(Y,le){try{le(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(Te){le(Te)}}getClusterLeaves(Y,le){try{le(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(Te){le(Te)}}}class Dt{constructor(Y){this.self=Y,this.actor=new c.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=c.getProjection({name:"mercator"}),this.workerSourceTypes={vector:c.VectorTileWorkerSource,geojson:Be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,Te)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Te},this.self.registerRTLTextPlugin=le=>{if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=le.applyArabicShaping,c.plugin.processBidirectionalText=le.processBidirectionalText,c.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(Y,le,Te){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],Te()}checkIfReady(Y,le,Te){Te()}setReferrer(Y,le){this.referrer=le}spriteLoaded(Y,le){this.isSpriteLoaded[Y]=le;for(const Te in this.workerSources[Y]){const He=this.workerSources[Y][Te];for(const Xe in He)He[Xe]instanceof c.VectorTileWorkerSource&&(He[Xe].isSpriteLoaded=le,He[Xe].fire(new c.Event("isSpriteLoaded")))}}setImages(Y,le,Te){this.availableImages[Y]=le;for(const He in this.workerSources[Y]){const Xe=this.workerSources[Y][He];for(const Mt in Xe)Xe[Mt].availableImages=le}Te()}enableTerrain(Y,le,Te){this.terrain=le,Te()}setProjection(Y,le){this.projections[Y]=c.getProjection(le)}setLayers(Y,le,Te){this.getLayerIndex(Y).replace(le),Te()}updateLayers(Y,le,Te){this.getLayerIndex(Y).update(le.layers,le.removedIds),Te()}loadTile(Y,le,Te){const He=this.enableTerrain?c.extend({enableTerrain:this.terrain},le):le;He.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,le.type,le.source).loadTile(He,Te)}loadDEMTile(Y,le,Te){const He=this.enableTerrain?c.extend({buildQuadTree:this.terrain},le):le;this.getDEMWorkerSource(Y,le.source).loadTile(He,Te)}reloadTile(Y,le,Te){const He=this.enableTerrain?c.extend({enableTerrain:this.terrain},le):le;He.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,le.type,le.source).reloadTile(He,Te)}abortTile(Y,le,Te){this.getWorkerSource(Y,le.type,le.source).abortTile(le,Te)}removeTile(Y,le,Te){this.getWorkerSource(Y,le.type,le.source).removeTile(le,Te)}removeSource(Y,le,Te){if(!this.workerSources[Y]||!this.workerSources[Y][le.type]||!this.workerSources[Y][le.type][le.source])return;const He=this.workerSources[Y][le.type][le.source];delete this.workerSources[Y][le.type][le.source],void 0!==He.removeSource?He.removeSource(le,Te):Te()}loadWorkerSource(Y,le,Te){try{this.self.importScripts(le.url),Te()}catch(He){Te(He.toString())}}syncRTLPluginState(Y,le,Te){try{c.plugin.setState(le);const He=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=He){this.self.importScripts(He);const Xe=c.plugin.isParsed();Te(Xe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${He}`),Xe)}}catch(He){Te(He.toString())}}getAvailableImages(Y){let le=this.availableImages[Y];return le||(le=[]),le}getLayerIndex(Y){let le=this.layerIndexes[Y];return le||(le=this.layerIndexes[Y]=new Je),le}getWorkerSource(Y,le,Te){return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][le]||(this.workerSources[Y][le]={}),this.workerSources[Y][le][Te]||(this.workerSources[Y][le][Te]=new this.workerSourceTypes[le]({send:(He,Xe,Mt,Ct,lt,Ot)=>{this.actor.send(He,Xe,Mt,Y,lt,Ot)},scheduler:this.actor.scheduler},this.getLayerIndex(Y),this.getAvailableImages(Y),this.isSpriteLoaded[Y])),this.workerSources[Y][le][Te]}getDEMWorkerSource(Y,le){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][le]||(this.demWorkerSources[Y][le]=new ye),this.demWorkerSources[Y][le]}enforceCacheSizeLimit(Y,le){c.enforceCacheSizeLimit(le)}getWorkerPerformanceMetrics(Y,le,Te){Te(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Dt(self)),Dt}),d(0,function(c){function Ce(f,t){if(Array.isArray(f)){if(!Array.isArray(t)||f.length!==t.length)return!1;for(let u=0;u<f.length;u++)if(!Ce(f[u],t[u]))return!1;return!0}if("object"==typeof f&&null!==f&&null!==t){if("object"!=typeof t||Object.keys(f).length!==Object.keys(t).length)return!1;for(const u in f)if(!Ce(f[u],t[u]))return!1;return!0}return f===t}var Ve=Je;function Je(f){return t=f,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,E=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(E);try{w=new Worker(I),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(I),v}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var E=w.getImageData(0,0,1,1);return E&&E.width===v.width}()||(void 0===ye[u=t&&t.failIfMajorPerformanceCaveat]&&(ye[u]=function(v){var w,I,k,B,E=(I=v,k=document.createElement("canvas"),(B=Object.create(Je.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,k.getContext("webgl",B)||k.getContext("experimental-webgl",B));if(!E)return!1;try{w=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!w||E.isContextLost())&&(E.shaderSource(w,"void main() {}"),E.compileShader(w),!0===E.getShaderParameter(w,E.COMPILE_STATUS))}(u)),!ye[u]||document.documentMode));var t,u}var ye={};function Me(f,t,u){const v=c.window.document.createElement(f);return void 0!==t&&(v.className=t),u&&u.appendChild(v),v}function Ye(f,t,u){const v=c.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const w of Object.keys(t))v.setAttributeNS(null,w,t[w]);return u&&u.appendChild(v),v}Je.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ft=c.window.document&&c.window.document.documentElement.style,Pe=ft&&void 0!==ft.userSelect?"userSelect":"WebkitUserSelect";let ut;function gt(){ft&&Pe&&(ut=ft[Pe],ft[Pe]="none")}function et(){ft&&Pe&&(ft[Pe]=ut)}function Ut(f){f.preventDefault(),f.stopPropagation(),c.window.removeEventListener("click",Ut,!0)}function Ft(){c.window.addEventListener("click",Ut,!0),c.window.setTimeout(()=>{c.window.removeEventListener("click",Ut,!0)},0)}function St(f,t){const u=f.getBoundingClientRect();return Xt(f,u,t)}function Pn(f,t){const u=f.getBoundingClientRect(),v=[];for(let w=0;w<t.length;w++)v.push(Xt(f,u,t[w]));return v}function Xn(f){return void 0!==c.window.InstallTrigger&&2===f.button&&f.ctrlKey&&c.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Xt(f,t,u){const v=f.offsetWidth===t.width?1:f.offsetWidth/t.width;return new c.pointGeometry((u.clientX-t.left)*v,(u.clientY-t.top)*v)}function Fe(f,t){var u=t[0],v=t[1],w=t[2],E=t[3],I=u*E-w*v;return I?(f[0]=E*(I=1/I),f[1]=-v*I,f[2]=-w*I,f[3]=u*I,f):null}function Qe(f){const{userImage:t}=f;return!!(t&&t.render&&t.render())&&(f.data.replace(new Uint8Array(t.data.buffer)),!0)}class fn extends c.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:u,callback:v}of this.requestors)this._notify(u,v);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,u){this._validate(t,u)&&(this.images[t]=u)}_validate(t,u){let v=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),v=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),v=!1),this._validateContent(u.content,u)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),v=!1),v}_validateStretch(t,u){if(!t)return!0;let v=0;for(const w of t){if(w[0]<v||w[1]<w[0]||u<w[1])return!1;v=w[1]}return!0}_validateContent(t,u){return!(t&&(4!==t.length||t[0]<0||u.data.width<t[0]||t[1]<0||u.data.height<t[1]||t[2]<0||u.data.width<t[2]||t[3]<0||u.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,u){u.version=this.images[t].version+1,this.images[t]=u,this.updatedImages[t]=!0}removeImage(t){const u=this.images[t];delete this.images[t],delete this.patterns[t],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,u){let v=!0;if(!this.isLoaded())for(const w of t)this.images[w]||(v=!1);this.isLoaded()||v?this._notify(t,u):this.requestors.push({ids:t,callback:u})}_notify(t,u){const v={};for(const w of t){this.images[w]||this.fire(new c.Event("styleimagemissing",{id:w}));const E=this.images[w];E?v[w]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:Boolean(E.userImage&&E.userImage.render)}:c.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,v)}getPixelSize(){const{width:t,height:u}=this.atlasImage;return{width:t,height:u}}getPattern(t){const u=this.patterns[t],v=this.getImage(t);if(!v)return null;if(u&&u.position.version===v.version)return u.position;if(u)u.position.version=v.version;else{const w={w:v.data.width+2,h:v.data.height+2,x:0,y:0},E=new c.ImagePosition(w,v);this.patterns[t]={bin:w,position:E}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const u=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.Texture(t,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const E in this.patterns)t.push(this.patterns[E].bin);const{w:u,h:v}=c.potpack(t),w=this.atlasImage;w.resize({width:u||1,height:v||1});for(const E in this.patterns){const{bin:I}=this.patterns[E],k=I.x+1,B=I.y+1,Z=this.images[E].data,te=Z.width,se=Z.height;c.RGBAImage.copy(Z,w,{x:0,y:0},{x:k,y:B},{width:te,height:se}),c.RGBAImage.copy(Z,w,{x:0,y:se-1},{x:k,y:B-1},{width:te,height:1}),c.RGBAImage.copy(Z,w,{x:0,y:0},{x:k,y:B+se},{width:te,height:1}),c.RGBAImage.copy(Z,w,{x:te-1,y:0},{x:k-1,y:B},{width:1,height:se}),c.RGBAImage.copy(Z,w,{x:0,y:0},{x:k+te,y:B},{width:1,height:se})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const u of t){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const v=this.images[u];Qe(v)&&this.updateImage(u,v)}}}const Jt=new c.Properties({anchor:new c.DataConstantProperty(c.spec.light.anchor),position:new class{constructor(){this.specification=c.spec.light.position}possiblyEvaluate(f,t){return function([u,v,w]){const E=c.degToRad(v+90),I=c.degToRad(w);return{x:u*Math.cos(E)*Math.sin(I),y:u*Math.sin(E)*Math.sin(I),z:u*Math.cos(I),azimuthal:v,polar:w}}(f.expression.evaluate(t))}interpolate(f,t,u){return{x:c.number(f.x,t.x,u),y:c.number(f.y,t.y,u),z:c.number(f.z,t.z,u),azimuthal:c.number(f.azimuthal,t.azimuthal,u),polar:c.number(f.polar,t.polar,u)}}},color:new c.DataConstantProperty(c.spec.light.color),intensity:new c.DataConstantProperty(c.spec.light.intensity)}),rn="-transition";class vn extends c.Evented{constructor(t){super(),this._transitionable=new c.Transitionable(Jt),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,u={}){if(!this._validate(c.validateLight,t,u))for(const v in t){const w=t[v];c.endsWith(v,rn)?this._transitionable.setTransition(v.slice(0,-rn.length),w):this._transitionable.setValue(v,w)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,v){return(!v||!1!==v.validate)&&c.emitValidationErrors(this,t.call(c.validateStyle,c.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}const xt=new c.Properties({source:new c.DataConstantProperty(c.spec.terrain.source),exaggeration:new c.DataConstantProperty(c.spec.terrain.exaggeration)}),Tt="-transition";class Gt extends c.Evented{constructor(t,u){super(),this._transitionable=new c.Transitionable(xt),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(t){for(const u in t){const v=t[u];c.endsWith(u,Tt)?this._transitionable.setTransition(u.slice(0,-Tt.length),v):this._transitionable.setValue(u,v)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function Bt(f,t,u,v){const w=c.smoothstep(45,65,u),[E,I]=Cn(f,v),k=c.length(t);let B=1-Math.min(1,Math.exp((k-E)/(I-E)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*w*f.alpha}function Cn(f,t){const u=.5/Math.tan(.5*t);return[f.range[0]+u,f.range[1]+u]}const mn=new c.Properties({range:new c.DataConstantProperty(c.spec.fog.range),color:new c.DataConstantProperty(c.spec.fog.color),"high-color":new c.DataConstantProperty(c.spec.fog["high-color"]),"space-color":new c.DataConstantProperty(c.spec.fog["space-color"]),"horizon-blend":new c.DataConstantProperty(c.spec.fog["horizon-blend"]),"star-intensity":new c.DataConstantProperty(c.spec.fog["star-intensity"])}),oi="-transition";class Yn extends c.Evented{constructor(t,u){super(),this._transitionable=new c.Transitionable(mn),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const t=this._transform,u="globe"===t.projection.name,v=c.globeToMercatorTransition(t.zoom),w=this.properties.get("range"),E=[.5,3];return{range:u?[c.number(E[0],w[0],v),c.number(E[1],w[1],v)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,u={}){if(!this._validate(c.validateFog,t,u)){for(const v of Object.keys(c.spec.fog))t&&void 0===t[v]&&(t[v]=c.spec.fog[v].default);for(const v in t){const w=t[v];c.endsWith(v,oi)?this._transitionable.setTransition(v.slice(0,-oi.length),w):this._transitionable.setValue(v,w)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:c.smoothstep(45,65,t))*u.a}getOpacityAtLatLng(t,u){return this._transform.projection.supportsFog?function(v,w,E){const I=c.MercatorCoordinate.fromLngLat(w),k=E.elevation?E.elevation.getAtPointOrZero(I):0,B=[I.x,I.y,k];return c.transformMat4(B,B,E.mercatorFogMatrix),Bt(v,B,E.pitch,E._fov)}(this.state,t,u):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?Cn(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,v){return(!v||!1!==v.validate)&&c.emitValidationErrors(this,t.call(c.validateStyle,c.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}class fi{constructor(t,u){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c.uniqueId();const v=this.workerPool.acquire(this.id);for(let w=0;w<v.length;w++){const E=new fi.Actor(v[w],u,this.id);E.name=`Worker ${w}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,u,v){c.asyncAll(this.actors,(w,E)=>{w.send(t,u,E)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function On(f,t,u){return t*(c.EXTENT/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}fi.Actor=c.Actor;class Di{constructor(t,u,v,w){this.screenBounds=t,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(t,u){let v,w;if(t instanceof c.pointGeometry||"number"==typeof t[0]){const E=c.pointGeometry.convert(t);v=[c.pointGeometry.convert(t)],w=u.isPointAboveHorizon(E)}else{const E=c.pointGeometry.convert(t[0]),I=c.pointGeometry.convert(t[1]);v=[E,I],w=c.polygonizeBounds(E,I).every(k=>u.isPointAboveHorizon(k))}return new Di(v,u.getCameraPoint(),w,u)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return c.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const u=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new c.pointGeometry(1,1)):this.screenBounds[1],w=c.polygonizeBounds(u,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<v.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?w[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(w[3]=this.cameraPoint)),c.bufferConvexPolygon(w,t)}bufferedCameraGeometryGlobe(t){const u=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new c.pointGeometry(1,1)):this.screenBounds[1],w=c.polygonizeBounds(u,v,t),E=this.cameraPoint.clone();switch(3*((E.y>u.y)+(E.y>v.y))+((E.x>u.x)+(E.x>v.x))){case 0:w[0]=E,w[4]=E.clone();break;case 1:w.splice(1,0,E);break;case 2:w[1]=E;break;case 3:w.splice(4,0,E);break;case 5:w.splice(2,0,E);break;case 6:w[3]=E;break;case 7:w.splice(3,0,E);break;case 8:w[2]=E}return w}containsTile(t,u,v,w=0){const E=t.queryPadding/u._projectionScaler+1,I=v?this._bufferedCameraMercator(E,u):this._bufferedScreenMercator(E,u);let k=t.tileID.wrap+(I.unwrapped?w:0);const B=I.polygon.map($e=>c.getTilePoint(t.tileTransform,$e,k));if(!c.polygonIntersectsBox(B,0,0,c.EXTENT,c.EXTENT))return;k=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const Z=this.screenGeometryMercator.polygon.map($e=>c.getTileVec3(t.tileTransform,$e,k)),te=Z.map($e=>new c.pointGeometry($e[0],$e[1])),se=u.getFreeCameraOptions().position||new c.MercatorCoordinate(0,0,0),fe=c.getTileVec3(t.tileTransform,se,k),Se=Z.map($e=>{const Ee=c.sub($e,$e,fe);return c.normalize(Ee,Ee),new c.Ray(fe,Ee)}),we=On(t,1,u.zoom)*u._projectionScaler;return{queryGeometry:this,tilespaceGeometry:te,tilespaceRays:Se,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(xe=c.getBounds(B),xe.min.x=c.clamp(xe.min.x,0,c.EXTENT),xe.min.y=c.clamp(xe.min.y,0,c.EXTENT),xe.max.x=c.clamp(xe.max.x,0,c.EXTENT),xe.max.y=c.clamp(xe.max.y,0,c.EXTENT),xe),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:we};var xe}_bufferedScreenMercator(t,u){const v=Ln(t);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let w;return w="globe"===u.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),u):{polygon:this.bufferedScreenGeometry(t).map(E=>u.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[v]=w,w}}_bufferedCameraMercator(t,u){const v=Ln(t);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let w;return w="globe"===u.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),u):{polygon:this.bufferedCameraGeometry(t).map(E=>u.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[v]=w,w}}_projectAndResample(t,u){const v=function(E,I){const k=c.multiply([],I.pixelMatrix,I.globeMatrix),B=[0,-c.GLOBE_RADIUS,0,1],Z=[0,c.GLOBE_RADIUS,0,1],te=[0,0,0,1];c.transformMat4$1(B,B,k),c.transformMat4$1(Z,Z,k),c.transformMat4$1(te,te,k);const se=new c.pointGeometry(B[0]/B[3],B[1]/B[3]),fe=new c.pointGeometry(Z[0]/Z[3],Z[1]/Z[3]),Se=c.polygonContainsPoint(E,se)&&B[3]<te[3],we=c.polygonContainsPoint(E,fe)&&Z[3]<te[3];if(!Se&&!we)return null;const xe=function(bt,Ht,Zt){for(let $t=1;$t<bt.length;$t++){const jt=Pi(Ht.pointCoordinate3D(bt[$t-1]).x),it=Pi(Ht.pointCoordinate3D(bt[$t]).x);if(Zt<0){if(jt<it)return{idx:$t,t:-jt/(it-1-jt)}}else if(it<jt)return{idx:$t,t:(1-jt)/(it+1-jt)}}return null}(E,I,Se?-1:1);if(!xe)return null;const{idx:$e,t:Ee}=xe;let ke=$e>1?Ui(E.slice(0,$e),I):[],Re=$e<E.length?Ui(E.slice($e),I):[];ke=ke.map(bt=>new c.pointGeometry(Pi(bt.x),bt.y)),Re=Re.map(bt=>new c.pointGeometry(Pi(bt.x),bt.y));const st=[...ke];0===st.length&&st.push(Re[Re.length-1]);const Ue=c.number(st[st.length-1].y,(0===Re.length?ke[0]:Re[0]).y,Ee);let je;return je=Se?[new c.pointGeometry(0,Ue),new c.pointGeometry(0,0),new c.pointGeometry(1,0),new c.pointGeometry(1,Ue)]:[new c.pointGeometry(1,Ue),new c.pointGeometry(1,1),new c.pointGeometry(0,1),new c.pointGeometry(0,Ue)],st.push(...je),0===Re.length?st.push(ke[0]):st.push(...Re),{polygon:st.map(bt=>new c.MercatorCoordinate(bt.x,bt.y)),unwrapped:!1}}(t,u);if(v)return v;const w=function(E,I){let k=!1,B=-1/0,Z=0;for(let se=0;se<E.length-1;se++)E[se].x>B&&(B=E[se].x,Z=se);for(let se=0;se<E.length-1;se++){const fe=(Z+se)%(E.length-1),Se=E[fe],we=E[fe+1];Math.abs(Se.x-we.x)>.5&&(Se.x<we.x?(Se.x+=1,0===fe&&(E[E.length-1].x+=1)):(we.x+=1,fe+1===E.length-1&&(E[0].x+=1)),k=!0)}const te=c.mercatorXfromLng(I.center.lng);return k&&te<Math.abs(te-1)&&E.forEach(se=>{se.x-=1}),{polygon:E,unwrapped:k}}(Ui(t,u).map(E=>new c.pointGeometry(Pi(E.x),E.y)),u);return{polygon:w.polygon.map(E=>new c.MercatorCoordinate(E.x,E.y)),unwrapped:w.unwrapped}}}function Ui(f,t){return c.resample(f,u=>{const v=t.pointCoordinate3D(u);u.x=v.x,u.y=v.y},1/256)}function Pi(f){return f<0?1+f%1:f%1}function Ln(f){return 100*f|0}function Zn(f,t,u,v,w){const E=function(I,k){if(I)return w(I);if(k){const B=c.pick(c.extend(k,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);k.vector_layers&&(B.vectorLayers=k.vector_layers,B.vectorLayerIds=B.vectorLayers.map(Z=>Z.id)),k.language_options&&(B.languageOptions=k.language_options),k.language&&k.language[k.id]&&(B.language=k.language[k.id]),k.worldview_options&&(B.worldviewOptions=k.worldview_options),k.worldview?B.worldview=k.worldview[k.id]:k.worldview_default&&(B.worldview=k.worldview_default),B.tiles=t.canonicalizeTileset(B,f.url),w(null,B)}};return f.url?c.getJSON(t.transformRequest(t.normalizeSourceURL(f.url,null,u,v),c.ResourceType.Source),E):c.exported.frame(()=>E(null,f))}class Rt{constructor(t,u,v){this.bounds=c.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=u||0,this.maxzoom=v||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const u=Math.pow(2,t.z),v=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*u),w=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*u),E=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*u),I=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*u);return t.x>=v&&t.x<E&&t.y>=w&&t.y<I}}class Kt{constructor(t,u,v){this.context=t;const w=t.gl;this.buffer=w.createBuffer(),this.dynamicDraw=Boolean(v),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const kn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class zn{constructor(t,u,v,w){this.length=u.length,this.attributes=v,this.itemSize=u.bytesPerElement,this.dynamicDraw=w,this.context=t;const E=t.gl;this.buffer=E.createBuffer(),t.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,u){for(let v=0;v<this.attributes.length;v++){const w=u.attributes[this.attributes[v].name];void 0!==w&&t.enableVertexAttribArray(w)}}setVertexAttribPointers(t,u,v){for(let w=0;w<this.attributes.length;w++){const E=this.attributes[w],I=u.attributes[E.name];void 0!==I&&t.vertexAttribPointer(I,E.components,t[kn[E.type]],!1,this.itemSize,E.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class gn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wi extends gn{getDefault(){return c.Color.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ei extends gn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Ii extends gn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class or extends gn{getDefault(){return[!0,!0,!0,!0]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Oi extends gn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class En extends gn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Wi extends gn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const u=this.current;(t.func!==u.func||t.ref!==u.ref||t.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class li extends gn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ct extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=t,this.dirty=!1}}class K extends gn{getDefault(){return[0,1]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class ie extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=t,this.dirty=!1}}class De extends gn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class dt extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.BLEND):u.disable(u.BLEND),this.current=t,this.dirty=!1}}class ze extends gn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class he extends gn{getDefault(){return c.Color.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ce extends gn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class de extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=t,this.dirty=!1}}class We extends gn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class ht extends gn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Qt extends gn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class _n extends gn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class An extends gn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ii extends gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class qn extends gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class gr extends gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class mi extends gn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class zt extends gn{getDefault(){return null}set(t){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class mt extends gn{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class _t extends gn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ke extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class nt extends gn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Be extends gn{constructor(t,u){super(t),this.context=t,this.parent=u}getDefault(){return null}}class Dt extends Be{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ae extends Be{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Y extends ae{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class le{constructor(t,u,v,w){this.context=t,this.width=u,this.height=v;const E=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Dt(t,E),w&&(this.depthAttachment=new ae(t,E))}destroy(){const t=this.context.gl,u=this.colorAttachment.get();if(u&&t.deleteTexture(u),this.depthAttachment){const v=this.depthAttachment.get();v&&t.deleteRenderbuffer(v)}t.deleteFramebuffer(this.framebuffer)}}class Te{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new wi(this),this.clearDepth=new Ei(this),this.clearStencil=new Ii(this),this.colorMask=new or(this),this.depthMask=new Oi(this),this.stencilMask=new En(this),this.stencilFunc=new Wi(this),this.stencilOp=new li(this),this.stencilTest=new ct(this),this.depthRange=new K(this),this.depthTest=new ie(this),this.depthFunc=new De(this),this.blend=new dt(this),this.blendFunc=new ze(this),this.blendColor=new he(this),this.blendEquation=new ce(this),this.cullFace=new de(this),this.cullFaceSide=new We(this),this.frontFace=new ht(this),this.program=new Qt(this),this.activeTexture=new _n(this),this.viewport=new An(this),this.bindFramebuffer=new ii(this),this.bindRenderbuffer=new qn(this),this.bindTexture=new gr(this),this.bindVertexBuffer=new mi(this),this.bindElementBuffer=new zt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new mt(this),this.pixelStoreUnpack=new _t(this),this.pixelStoreUnpackPremultiplyAlpha=new Ke(this),this.pixelStoreUnpackFlipY=new nt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,u){return new Kt(this,t,u)}createVertexBuffer(t,u,v){return new zn(this,t,u,v)}createRenderbuffer(t,u,v){const w=this.gl,E=w.createRenderbuffer();return this.bindRenderbuffer.set(E),w.renderbufferStorage(w.RENDERBUFFER,t,u,v),this.bindRenderbuffer.set(null),E}createFramebuffer(t,u,v){return new le(this,t,u,v)}clear({color:t,depth:u,stencil:v}){const w=this.gl;let E=0;t&&(E|=w.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(E|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==v&&(E|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),w.clear(E)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Ce(t.blendFunction,c.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class He extends c.Evented{constructor(t,u,v,w){super(),this.id=t,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},u),c.extend(this,c.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zn(this._options,this.map._requestManager,null,null,(t,u)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new c.ErrorEvent(t)):u&&(c.extend(this,u),u.bounds&&(this.tileBounds=new Rt(u.bounds,this.minzoom,this.maxzoom)),c.postTurnstileEvent(u.tiles),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,u){const v=c.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);t.request=c.getImage(this.map._requestManager.transformRequest(w,c.ResourceType.Tile),(E,I,k,B)=>(delete t.request,t.aborted?(t.state="unloaded",u(null)):E?(t.state="errored",u(E)):I?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:k,expires:B}),t.setTexture(I,this.map.painter),t.state="loaded",c.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(t,u,v){t.setTexture(u,v)}static unloadTileData(t,u){t.texture&&u.saveTileTexture(t.texture)}abortTile(t,u){t.request&&(t.request.cancel(),delete t.request),u()}unloadTile(t,u){t.texture&&this.map.painter.saveTileTexture(t.texture),u()}hasTransition(){return!1}}let Xe;function Mt(f,t,u,v,w,E,I,k){const B=[f,u,w,t,v,E,1,1,1],Z=[I,k,1],te=c.adjoint([],B),[se,fe,Se]=c.transformMat3(Z,Z,c.transpose(te,te));return c.multiply$1(B,[se,0,0,0,fe,0,0,0,Se],B)}class Ct extends c.Evented{constructor(t,u,v,w){super(),this.id=t,this.dispatcher=v,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=u}load(t,u){this._loaded=u||!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),(v,w)=>{if(this._loaded=!0,v)this.fire(new c.ErrorEvent(v));else if(w){const{HTMLImageElement:E}=c.window;this.image=w instanceof E?c.exported.getImageData(w):w,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const u=t.map(c.MercatorCoordinate.fromLngLat);return this.tileID=function(v){let w=1/0,E=1/0,I=-1/0,k=-1/0;for(const se of v)w=Math.min(w,se.x),E=Math.min(E,se.y),I=Math.max(I,se.x),k=Math.max(k,se.y);const B=Math.max(I-w,k-E),Z=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),te=Math.pow(2,Z);return new c.CanonicalTileID(Z,Math.floor((w+I)/2*te),Math.floor((E+k)/2*te))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const B in this.tiles){const Z=this.tiles[B];"loaded"!==Z.state&&(Z.state="loaded",Z.texture=this.texture)}if(this._boundsArray)return;const u=c.tileTransform(this.tileID,this.map.transform.projection),[v,w,E,I]=this.coordinates.map(B=>{const Z=u.projection.project(B[0],B[1]);return c.getTilePoint(u,Z)._round()});this.perspectiveTransform=function(B,Z,te,se,fe,Se,we,xe,$e,Ee){const ke=Mt(0,0,B,0,0,Z,B,Z),Re=Mt(te,se,fe,Se,we,xe,$e,Ee);return c.multiply$1(Re,c.adjoint(ke,ke),Re),[Re[6]/Re[8]*B/c.EXTENT,Re[7]/Re[8]*Z/c.EXTENT]}(this.width,this.height,v.x,v.y,w.x,w.y,I.x,I.y,E.x,E.y);const k=this._boundsArray=new c.StructArrayLayout4i8;k.emplaceBack(v.x,v.y,0,0),k.emplaceBack(w.x,w.y,c.EXTENT,0),k.emplaceBack(I.x,I.y,0,c.EXTENT),k.emplaceBack(E.x,E.y,c.EXTENT,c.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(k,c.boundsAttributes.members),this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,u=t.gl;this.texture?this.texture.update(this.image):(this.texture=new c.Texture(t,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._prepareData(t)}loadTile(t,u){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},u(null)):(t.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const lt={vector:class extends c.Evented{constructor(f,t,u,v){if(super(),this.id=f,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(t,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new c.DedupedRequest}load(f){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"}));const t=this.language||this.map._language,u=this.worldview||this.map._worldview;this._tileJSONRequest=Zn(this._options,this.map._requestManager,t,u,(v,w)=>{this._tileJSONRequest=null,this._loaded=!0,v?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${t}`),u&&2!==u.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new c.ErrorEvent(v))):w&&(c.extend(this,w),w.bounds&&(this.tileBounds=new Rt(w.bounds,this.minzoom,this.maxzoom)),c.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))),f&&f(v)})}loaded(){return this._loaded}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}onAdd(f){this.map=f,this.load()}setSourceProperty(f){this._tileJSONRequest&&this._tileJSONRequest.cancel(),f(),this.load(()=>{const t=this.map.style._getSourceCaches(this.id);for(const u of t)u.clearTiles()})}setTiles(f){return this.setSourceProperty(()=>{this._options.tiles=f}),this}setUrl(f){return this.setSourceProperty(()=>{this.url=f,this._options.url=f}),this}_setLanguage(f){return f===this.language||this.setSourceProperty(()=>{this.language=f}),this}_setWorldview(f){return f===this.worldview?this:this.worldviewOptions&&f&&!this.worldviewOptions[f]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${f}".`),this):(this.setSourceProperty(()=>{this.worldview=f}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}loadTile(f,t){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(u,c.ResourceType.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:c.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:f.isSymbolTile};if(v.request.collectResourceTiming=this._collectResourceTiming,f.actor&&"expired"!==f.state)"loading"===f.state?f.reloadCallback=t:f.request=f.actor.send("reloadTile",v,w.bind(this));else if(f.actor=this._tileWorkers[u]=this._tileWorkers[u]||this.dispatcher.getActor(),this.dispatcher.ready)f.request=f.actor.send("loadTile",v,w.bind(this),void 0,!0);else{const E=c.loadVectorTile.call({deduped:this._deduped},v,(I,k)=>{I||!k?w.call(this,I):(v.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},f.actor&&f.actor.send("loadTile",v,w.bind(this),void 0,!0))},!0);f.request={cancel:E}}function w(E,I){return delete f.request,f.aborted?t(null):E&&404!==E.status?t(E):(I&&I.resourceTiming&&(f.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&f.setExpiryData(I),f.loadVectorData(I,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id})}unloadTile(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:He,"raster-dem":class extends He{constructor(f,t,u,v){super(f,t,u,v),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(f,t){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(w,E){w&&(f.state="errored",t(w)),E&&(f.dem=E,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",t(null))}f.request=c.getImage(this.map._requestManager.transformRequest(u,c.ResourceType.Tile),function(w,E,I,k){if(delete f.request,f.aborted)f.state="unloaded",t(null);else if(w)f.state="errored",t(w);else if(E){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:I,expires:k});const B=c.window.ImageBitmap&&E instanceof c.window.ImageBitmap&&(null==Xe&&(Xe=c.window.OffscreenCanvas&&new c.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof c.window.createImageBitmap),Xe),Z=1-(E.width-c.prevPowerOfTwo(E.width))/2;Z<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const te=B?E:c.exported.getImageData(E,Z),se={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:te,encoding:this.encoding,padding:Z};f.actor&&"expired"!==f.state||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",se,v.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const t=f.canonical,u=Math.pow(2,t.z),v=(t.x-1+u)%u,w=0===t.x?f.wrap-1:f.wrap,E=(t.x+1+u)%u,I=t.x+1===u?f.wrap+1:f.wrap,k={};return k[new c.OverscaledTileID(f.overscaledZ,w,t.z,v,t.y).key]={backfilled:!1},k[new c.OverscaledTileID(f.overscaledZ,I,t.z,E,t.y).key]={backfilled:!1},t.y>0&&(k[new c.OverscaledTileID(f.overscaledZ,w,t.z,v,t.y-1).key]={backfilled:!1},k[new c.OverscaledTileID(f.overscaledZ,f.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},k[new c.OverscaledTileID(f.overscaledZ,I,t.z,E,t.y-1).key]={backfilled:!1}),t.y+1<u&&(k[new c.OverscaledTileID(f.overscaledZ,w,t.z,v,t.y+1).key]={backfilled:!1},k[new c.OverscaledTileID(f.overscaledZ,f.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},k[new c.OverscaledTileID(f.overscaledZ,I,t.z,E,t.y+1).key]={backfilled:!1}),k}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends c.Evented{constructor(f,t,u,v){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(v),this._data=t.data,this._options=c.extend({},t),this._collectResourceTiming=t.collectResourceTiming,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const w=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(void 0!==t.buffer?t.buffer:128)*w,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*w,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:void 0!==t.clusterMaxZoom?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:c.EXTENT,radius:(void 0!==t.clusterRadius?t.clusterRadius:50)*w,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},t),this}getClusterChildren(f,t){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},t),this}getClusterLeaves(f,t,u,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:t,offset:u},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new c.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=c.extend({},this.workerOptions),t=this._data;"string"==typeof t?(f.request=this.map._requestManager.transformRequest(c.exported.resolveURL(t),c.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(u,v)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new c.ErrorEvent(u));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),this.fire(new c.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,t){const u=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(u,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:c.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(v,w)=>(delete f.request,f.unloadVectorData(),f.aborted?t(null):v?t(v):(f.loadVectorData(w,this.map.painter,"reloadTile"===u),t(null))),void 0,"loadTile"===u)}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return c.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ct{constructor(f,t,u,v){super(f,t,u,v),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const t of f.urls)this.urls.push(this.map._requestManager.transformRequest(t,c.ResourceType.Source).url);c.getVideo(this.urls,(t,u)=>{this._loaded=!0,t?this.fire(new c.ErrorEvent(t)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const t=this.video.seekable;f<t.start(0)||f>t.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const f=this.map.painter.context,t=f.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new c.Texture(f,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ct,canvas:class extends Ct{constructor(f,t,u,v){super(f,t,u,v),t.coordinates?Array.isArray(t.coordinates)&&4===t.coordinates.length&&!t.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(E=>"number"!=typeof E))||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),t.animate&&"boolean"!=typeof t.animate&&this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),t.canvas?"string"==typeof t.canvas||t.canvas instanceof c.window.HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=t,this.animate=void 0===t.animate||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof c.window.HTMLCanvasElement?this.options.canvas:c.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const t=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends c.Evented{constructor(f,t,u,v){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=t,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new c.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new c.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Rt(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.coveringTiles=this._coveringTiles.bind(this),c.extend(this,c.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return c.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:t,y:u,z:v}=f.canonical;return this._implementation.hasTile({x:t,y:u,z:v})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,t){const{x:u,y:v,z:w}=f.tileID.canonical,E=new c.window.AbortController,I=this._implementation.loadTile({x:u,y:v,z:w},{signal:E.signal});if(!I)return this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",t(null);I.cancel=()=>E.abort(),f.request=I.then(function(k){return delete f.request,f.aborted?(f.state="unloaded",t(null)):k?(B=k)instanceof c.window.ImageData||B instanceof c.window.ImageBitmap||B instanceof c.window.HTMLCanvasElement?(this.loadTileData(f,k),f.state="loaded",void t(null)):(f.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",t(null));var B}.bind(this)).catch(k=>{20!==k.code&&(f.state="errored",t(k))})}loadTileData(f,t){He.loadTileData(f,t,this._map.painter)}unloadTileData(f){He.unloadTileData(f,this._map.painter)}prepareTile(f){if(!this._implementation.prepareTile)return null;const{x:t,y:u,z:v}=f.tileID.canonical,w=this._implementation.prepareTile({x:t,y:u,z:v});return w?(this.loadTileData(f,w),f.state="loaded",w):null}unloadTile(f,t){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:u,y:v,z:w}=f.tileID.canonical;this._implementation.unloadTile({x:u,y:v,z:w})}t()}abortTile(f,t){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_update(){this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ot=function(f,t,u,v){const w=new lt[t.type](f,t,u,v);if(w.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${w.id}`);return c.bindAll(["load","abort","unload","serialize","prepare"],w),w};function Et(f,t){const u=c.identity([]);return c.scale(u,u,[.5*f.width,.5*-f.height,1]),c.translate(u,u,[1,-1,0]),c.multiply(u,u,f.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(u)}function en(f,t,u,v,w,E,I,k=!1){const B=f.tilesIn(v,I,k);B.sort(Ge);const Z=[];for(const se of B)Z.push({wrappedTileID:se.tile.tileID.wrapped().key,queryResults:se.tile.queryRenderedFeatures(t,u,f._state,se,w,E,Et(f.transform,se.tile.tileID),k)});const te=function(se){const fe={},Se={};for(const we of se){const xe=we.queryResults,$e=we.wrappedTileID,Ee=Se[$e]=Se[$e]||{};for(const ke in xe){const Re=xe[ke],st=Ee[ke]=Ee[ke]||{},Ue=fe[ke]=fe[ke]||[];for(const je of Re)st[je.featureIndex]||(st[je.featureIndex]=!0,Ue.push(je))}}return fe}(Z);for(const se in te)te[se].forEach(fe=>{const Se=fe.feature,we=Se.layer;we&&"background"!==we.type&&"sky"!==we.type&&(Se.source=we.source,we["source-layer"]&&(Se.sourceLayer=we["source-layer"]),Se.state=void 0!==Se.id?f.getFeatureState(we["source-layer"],Se.id):{})});return te}function Le(f,t){const u=f.getRenderableIds().map(E=>f.getTileByID(E)),v=[],w={};for(let E=0;E<u.length;E++){const I=u[E],k=I.tileID.canonical.key;w[k]||(w[k]=!0,I.querySourceFeatures(v,t))}return v}function Ge(f,t){const u=f.tileID,v=t.tileID;return u.overscaledZ-v.overscaledZ||u.canonical.y-v.canonical.y||u.wrap-v.wrap||u.canonical.x-v.canonical.x}function Oe(){return null!=Bd.workerClass?new Bd.workerClass:new c.window.Worker(Bd.workerUrl)}const tt="mapboxgl_preloaded_worker_pool";class Nt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Nt.workerCount;)this.workers.push(new Oe);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[tt]}numActive(){return Object.keys(this.active).length}}let bn;function ti(){return bn||(bn=new Nt),bn}function Ri(f,t){const u={};for(const v in f)"ref"!==v&&(u[v]=f[v]);return c.refProperties.forEach(v=>{v in t&&(u[v]=t[v])}),u}function jn(f){f=f.slice();const t=Object.create(null);for(let u=0;u<f.length;u++)t[f[u].id]=f[u];for(let u=0;u<f.length;u++)"ref"in f[u]&&(f[u]=Ri(f[u],t[f[u].ref]));return f}Nt.workerCount=2;const At={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function nr(f,t,u){u.push({command:At.addSource,args:[f,t[f]]})}function br(f,t,u){t.push({command:At.removeSource,args:[f]}),u[f]=!0}function jr(f,t,u,v){br(f,u,v),nr(f,t,u)}function Zr(f,t,u){let v;for(v in f[u])if(f[u].hasOwnProperty(v)&&"data"!==v&&!Ce(f[u][v],t[u][v]))return!1;for(v in t[u])if(t[u].hasOwnProperty(v)&&"data"!==v&&!Ce(f[u][v],t[u][v]))return!1;return!0}function Br(f,t,u,v,w,E){let I;for(I in t=t||{},f=f||{})f.hasOwnProperty(I)&&(Ce(f[I],t[I])||u.push({command:E,args:[v,I,t[I],w]}));for(I in t)t.hasOwnProperty(I)&&!f.hasOwnProperty(I)&&(Ce(f[I],t[I])||u.push({command:E,args:[v,I,t[I],w]}))}function Uo(f){return f.id}function jo(f,t){return f[t.id]=t,f}class as{constructor(t,u){this.reset(t,u)}reset(t,u){this.points=t||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=c.clamp(t,0,1);let u=1,v=this._distances[u];const w=t*this.paddedLength+this.padding;for(;v<w&&u<this._distances.length;)v=this._distances[++u];const E=u-1,I=this._distances[E],k=v-I,B=k>0?(w-I)/k:0;return this.points[E].mult(1-B).add(this.points[u].mult(B))}}class Gn{constructor(t,u,v){const w=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(t/v),this.yCellCount=Math.ceil(u/v);for(let I=0;I<this.xCellCount*this.yCellCount;I++)w.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=u,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,u,v,w,E){this._forEachCell(u,v,w,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(u),this.bboxes.push(v),this.bboxes.push(w),this.bboxes.push(E)}insertCircle(t,u,v,w){this._forEachCell(u-w,v-w,u+w,v+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(u),this.circles.push(v),this.circles.push(w)}_insertBoxCell(t,u,v,w,E,I){this.boxCells[E].push(I)}_insertCircleCell(t,u,v,w,E,I){this.circleCells[E].push(I)}_query(t,u,v,w,E,I){if(v<0||t>this.width||w<0||u>this.height)return!E&&[];const k=[];if(t<=0&&u<=0&&this.width<=v&&this.height<=w){if(E)return!0;for(let B=0;B<this.boxKeys.length;B++)k.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const Z=this.circles[3*B],te=this.circles[3*B+1],se=this.circles[3*B+2];k.push({key:this.circleKeys[B],x1:Z-se,y1:te-se,x2:Z+se,y2:te+se})}return I?k.filter(I):k}return this._forEachCell(t,u,v,w,this._queryCell,k,{hitTest:E,seenUids:{box:{},circle:{}}},I),E?k.length>0:k}_queryCircle(t,u,v,w,E){const I=t-v,k=t+v,B=u-v,Z=u+v;if(k<0||I>this.width||Z<0||B>this.height)return!w&&[];const te=[];return this._forEachCell(I,B,k,Z,this._queryCellCircle,te,{hitTest:w,circle:{x:t,y:u,radius:v},seenUids:{box:{},circle:{}}},E),w?te.length>0:te}query(t,u,v,w,E){return this._query(t,u,v,w,!1,E)}hitTest(t,u,v,w,E){return this._query(t,u,v,w,!0,E)}hitTestCircle(t,u,v,w){return this._queryCircle(t,u,v,!0,w)}_queryCell(t,u,v,w,E,I,k,B){const Z=k.seenUids,te=this.boxCells[E];if(null!==te){const fe=this.bboxes;for(const Se of te)if(!Z.box[Se]){Z.box[Se]=!0;const we=4*Se;if(t<=fe[we+2]&&u<=fe[we+3]&&v>=fe[we+0]&&w>=fe[we+1]&&(!B||B(this.boxKeys[Se]))){if(k.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[Se],x1:fe[we],y1:fe[we+1],x2:fe[we+2],y2:fe[we+3]})}}}const se=this.circleCells[E];if(null!==se){const fe=this.circles;for(const Se of se)if(!Z.circle[Se]){Z.circle[Se]=!0;const we=3*Se;if(this._circleAndRectCollide(fe[we],fe[we+1],fe[we+2],t,u,v,w)&&(!B||B(this.circleKeys[Se]))){if(k.hitTest)return I.push(!0),!0;{const xe=fe[we],$e=fe[we+1],Ee=fe[we+2];I.push({key:this.circleKeys[Se],x1:xe-Ee,y1:$e-Ee,x2:xe+Ee,y2:$e+Ee})}}}}}_queryCellCircle(t,u,v,w,E,I,k,B){const Z=k.circle,te=k.seenUids,se=this.boxCells[E];if(null!==se){const Se=this.bboxes;for(const we of se)if(!te.box[we]){te.box[we]=!0;const xe=4*we;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,Se[xe+0],Se[xe+1],Se[xe+2],Se[xe+3])&&(!B||B(this.boxKeys[we])))return I.push(!0),!0}}const fe=this.circleCells[E];if(null!==fe){const Se=this.circles;for(const we of fe)if(!te.circle[we]){te.circle[we]=!0;const xe=3*we;if(this._circlesCollide(Se[xe],Se[xe+1],Se[xe+2],Z.x,Z.y,Z.radius)&&(!B||B(this.circleKeys[we])))return I.push(!0),!0}}}_forEachCell(t,u,v,w,E,I,k,B){const Z=this._convertToXCellCoord(t),te=this._convertToYCellCoord(u),se=this._convertToXCellCoord(v),fe=this._convertToYCellCoord(w);for(let Se=Z;Se<=se;Se++)for(let we=te;we<=fe;we++)if(E.call(this,t,u,v,w,this.xCellCount*we+Se,I,k,B))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,u,v,w,E,I){const k=w-t,B=E-u,Z=v+I;return Z*Z>k*k+B*B}_circleAndRectCollide(t,u,v,w,E,I,k){const B=(I-w)/2,Z=Math.abs(t-(w+B));if(Z>B+v)return!1;const te=(k-E)/2,se=Math.abs(u-(E+te));if(se>te+v)return!1;if(Z<=B||se<=te)return!0;const fe=Z-B,Se=se-te;return fe*fe+Se*Se<=v*v}}const ri=Math.tan(85*Math.PI/180);function ki(f,t,u,v,w,E,I){const k=c.create();if(u)if("globe"===E.name){const B=c.calculateGlobeLabelMatrix(w,t);c.multiply(k,k,B)}else{const B=Fe([],I);k[0]=B[0],k[1]=B[1],k[4]=B[2],k[5]=B[3],v||c.rotateZ(k,k,w.angle)}else c.multiply(k,w.labelPlaneMatrix,f);return k}function ls(f,t,u,v,w,E,I){const k=ki(f,t,u,v,w,E,I);return"globe"===E.name&&u||(k[2]=k[6]=k[10]=k[14]=0),k}function po(f,t,u,v,w,E,I){if(u){if("globe"===E.name){const k=ki(f,t,u,v,w,E,I);return c.invert(k,k),c.multiply(k,f,k),k}{const k=c.clone(f),B=c.identity([]);return B[0]=I[0],B[1]=I[1],B[4]=I[2],B[5]=I[3],c.multiply(k,k,B),v||c.rotateZ(k,k,-w.angle),k}}return w.glCoordMatrix}function vi(f,t,u=0){const v=[f.x,f.y,u,1];u?c.transformMat4$1(v,v,t):xr(v,v,t);const w=v[3];return{point:[v[0]/w,v[1]/w,v[2]/w],signedDistanceFromCamera:w}}function so(f,t){const u=[f[0],f[1],f[2],1];c.transformMat4$1(u,u,t);const v=u[3];return{point:[u[0]/v,u[1]/v,u[2]/v],signedDistanceFromCamera:v}}function Go(f,t){return Math.min(.5+f/t*.5,1.5)}function zr(f,t){const u=f[0]/f[3],v=f[1]/f[3];return u>=-t[0]&&u<=t[0]&&v>=-t[1]&&v<=t[1]}function yr(f,t,u,v,w,E,I,k,B,Z){const te=u.transform,se=v?f.textSizeData:f.iconSizeData,fe=c.evaluateSizeForZoom(se,u.transform.zoom),Se="globe"===te.projection.name,we=[256/u.width*2+1,256/u.height*2+1],xe=v?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;xe.clear();let $e=null;Se&&($e=v?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const Ee=f.lineVertexArray,ke=v?f.text.placedSymbolArray:f.icon.placedSymbolArray,Re=u.transform.width/u.transform.height;let st=!1;for(let Ue=0;Ue<ke.length;Ue++){const je=ke.get(Ue);if(je.writingMode!==c.WritingMode.vertical||st||0!==Ue&&ke.get(Ue-1).writingMode===c.WritingMode.horizontal||(st=!0),(je.hidden||je.writingMode===c.WritingMode.vertical)&&!st){Jr(je.numGlyphs,xe);continue}st=!1;const bt=new c.pointGeometry(je.tileAnchorX,je.tileAnchorY),Ht=B?B(bt):[0,0,0],Zt=te.projection.projectTilePoint(bt.x,bt.y,Z.canonical),$t=[Zt.x+Ht[0],Zt.y+Ht[1],Zt.z+Ht[2]],jt=[...$t,1];if(c.transformMat4$1(jt,jt,t),!zr(jt,we)){Jr(je.numGlyphs,xe);continue}const it=Go(u.transform.cameraToCenterDistance,jt[3]),pn=c.evaluateSizeForFeature(se,fe,je),hn=I?pn/it:pn*it,Un=vi(new c.pointGeometry($t[0],$t[1]),w,$t[2]);if(Un.signedDistanceFromCamera<=0){Jr(je.numGlyphs,xe);continue}let tn={};const ci=I?null:B,Fn=ao(je,hn,!1,k,t,w,E,f.glyphOffsetArray,Ee,xe,$e,Un.point,bt,tn,Re,ci,te.projection,Z,I);st=Fn.useVertical,ci&&Fn.needsFlipping&&(tn={}),(Fn.notEnoughRoom||st||Fn.needsFlipping&&ao(je,hn,!0,k,t,w,E,f.glyphOffsetArray,Ee,xe,$e,Un.point,bt,tn,Re,ci,te.projection,Z,I).notEnoughRoom)&&Jr(je.numGlyphs,xe)}v?(f.text.dynamicLayoutVertexBuffer.updateData(xe),$e&&f.text.globeExtVertexBuffer.updateData($e)):(f.icon.dynamicLayoutVertexBuffer.updateData(xe),$e&&f.icon.globeExtVertexBuffer.updateData($e))}function Xi(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe){const $e=k.glyphStartIndex+k.numGlyphs,Ee=k.lineStartIndex,ke=k.lineStartIndex+k.lineLength,Re=t.getoffsetX(k.glyphStartIndex),st=t.getoffsetX($e-1),Ue=Vs(f*Re,u,v,w,E,I,k.segment,Ee,ke,B,Z,te,se,fe,!0,Se,we,xe);if(!Ue)return null;const je=Vs(f*st,u,v,w,E,I,k.segment,Ee,ke,B,Z,te,se,fe,!0,Se,we,xe);return je?{first:Ue,last:je}:null}function Gr(f,t,u,v){return f.writingMode===c.WritingMode.horizontal&&Math.abs(u.y-t.y)>Math.abs(u.x-t.x)*v?{useVertical:!0}:f.writingMode===c.WritingMode.vertical?t.y<u.y?{needsFlipping:!0}:null:0!==f.flipState&&function(w,E,I){const k=(E.x-w.x)*I;return 0===k||Math.abs((E.y-w.y)/k)>ri}(t,u,v)?1===f.flipState?{needsFlipping:!0}:null:t.x>u.x?{needsFlipping:!0}:null}function ao(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe,$e,Ee,ke){const Re=t/24,st=f.lineOffsetX*Re,Ue=f.lineOffsetY*Re;let je;if(f.numGlyphs>1){const bt=f.glyphStartIndex+f.numGlyphs,Ht=f.lineStartIndex,Zt=f.lineStartIndex+f.lineLength,$t=Xi(Re,k,st,Ue,u,se,fe,f,B,E,Se,xe,!1,$e,Ee,ke);if(!$t)return{notEnoughRoom:!0};const jt=so($t.first.point,I).point,it=so($t.last.point,I).point,pn=new c.pointGeometry(jt[0],jt[1]),hn=new c.pointGeometry(it[0],it[1]);if(v&&!u){const Un=Gr(f,pn,hn,we);if(f.flipState=Un&&Un.needsFlipping?1:2,Un)return Un}je=[$t.first];for(let Un=f.glyphStartIndex+1;Un<bt-1;Un++)je.push(Vs(Re*k.getoffsetX(Un),st,Ue,u,se,fe,f.segment,Ht,Zt,B,E,Se,xe,!1,!1,$e,Ee,ke));je.push($t.last)}else{if(v&&!u){const Ht=vi(fe,w).point,Zt=f.lineStartIndex+f.segment+1,$t=new c.pointGeometry(B.getx(Zt),B.gety(Zt)),jt=vi($t,w),it=jt.signedDistanceFromCamera>0?jt.point:ys(fe,$t,Ht,1,w,void 0,$e,Ee.canonical),pn=Gr(f,new c.pointGeometry(Ht[0],Ht[1]),new c.pointGeometry(it[0],it[1]),we);if(f.flipState=pn&&pn.needsFlipping?1:2,pn)return pn}const bt=Vs(Re*k.getoffsetX(f.glyphStartIndex),st,Ue,u,se,fe,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,B,E,Se,xe,!1,!1,$e,Ee,ke);if(!bt)return{notEnoughRoom:!0};je=[bt]}if(te)for(const bt of je)c.updateGlobeVertexNormal(te,Z.length+0,bt.up[0],bt.up[1],bt.up[2]),c.updateGlobeVertexNormal(te,Z.length+1,bt.up[0],bt.up[1],bt.up[2]),c.updateGlobeVertexNormal(te,Z.length+2,bt.up[0],bt.up[1],bt.up[2]),c.updateGlobeVertexNormal(te,Z.length+3,bt.up[0],bt.up[1],bt.up[2]),c.addDynamicAttributes(Z,bt.point[0],bt.point[1],bt.point[2],bt.angle);else for(const bt of je)c.addDynamicAttributes(Z,bt.point[0],bt.point[1],bt.point[2],bt.angle);return{}}function xa(f,t,u,v,w){const E=v.projectTilePoint(f.x,f.y,t);if(!w)return vi(E,u,E.z);const I=w(f);return vi(new c.pointGeometry(E.x+I[0],E.y+I[1]),u,E.z+I[2])}function ys(f,t,u,v,w,E,I,k){const B=xa(f.add(f.sub(t)._unit()),k,w,I,E).point,Z=c.sub([],u,B);return c.scaleAndAdd([],u,Z,v/c.length(Z))}function Vs(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe,$e,Ee){const ke=v?f-t:f+t;let Re=ke>0?1:-1,st=0;v&&(Re*=-1,st=Math.PI),Re<0&&(st+=Math.PI);let Ue=Re>0?k+I:k+I+1,je=w,bt=w,Ht=0,Zt=0;const $t=Math.abs(ke),jt=[],it=[];let pn=E;const hn=()=>{const pi=Ue-Re;return 0===Ht?E:new c.pointGeometry(Z.getx(pi),Z.gety(pi))},Un=()=>ys(hn(),pn,bt,$t-Ht+1,te,fe,xe,$e.canonical);for(;Ht+Zt<=$t;){if(Ue+=Re,Ue<k||Ue>=B)return null;if(bt=je,jt.push(je),Se&&it.push(pn||hn()),je=se[Ue],void 0===je){pn=new c.pointGeometry(Z.getx(Ue),Z.gety(Ue));const pi=xa(pn,$e.canonical,te,xe,fe);je=pi.signedDistanceFromCamera>0?se[Ue]=pi.point:Un()}else pn=null;Ht+=Zt,Zt=c.distance(bt,je)}pn=pn||new c.pointGeometry(Z.getx(Ue),Z.gety(Ue));const tn=hn();we&&fe&&(se[Ue]=je=void 0===se[Ue]?je:Un(),Zt=c.distance(bt,je));const ci=($t-Ht)/Zt,Fn=pn.sub(tn).mult(ci)._add(tn),Vn=c.sub([],je,bt),In=c.scaleAndAdd([],bt,Vn,ci);let Nn=[0,0,1],Si=Vn[0],bi=Vn[1];if(Ee&&(Nn=xe.upVector($e.canonical,Fn.x,Fn.y),0!==Nn[0]||0!==Nn[1]||1!==Nn[2])){const pi=[1,0,0],Gi=[0,1,0];pi[0]=Nn[2],pi[1]=0,pi[2]=-Nn[0],c.cross(Gi,Nn,pi),c.normalize(pi,pi),c.normalize(Gi,Gi),Si=c.dot(Vn,pi),bi=c.dot(Vn,Gi)}if(u){const pi=c.cross([],Nn,Vn);c.normalize(pi,pi),c.scaleAndAdd(In,In,pi,u*Re)}const Qi=st+Math.atan2(bi,Si);return jt.push(In),Se&&it.push(Fn),{point:In,angle:Qi,path:jt,tilePath:it,up:Nn}}const Ko=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Jr(f,t){for(let u=0;u<f;u++){const v=t.length;t.resize(v+4),t.float32.set(Ko,4*v)}}function xr(f,t,u){const v=t[0],w=t[1];return f[0]=u[0]*v+u[4]*w+u[12],f[1]=u[1]*v+u[5]*w+u[13],f[3]=u[3]*v+u[7]*w+u[15],f}const Lo=100;class ra{constructor(t,u,v=new Gn(t.width+200,t.height+200,25),w=new Gn(t.width+200,t.height+200,25)){this.transform=t,this.grid=v,this.ignoredGrid=w,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Lo,this.screenBottomBoundary=t.height+Lo,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=u}placeCollisionBox(t,u,v,w,E,I,k,B){let Z=v.projectedAnchorX,te=v.projectedAnchorY,se=v.projectedAnchorZ;const fe=v.elevation,Se=v.tileID;if(fe&&Se){const Ue=t.getProjection().upVector(Se.canonical,v.tileAnchorX,v.tileAnchorY),je=t.getProjection().upVectorScale(Se.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=Ue[0]*fe*je,te+=Ue[1]*fe*je,se+=Ue[2]*fe*je}const we=this.projectAndGetPerspectiveRatio(k,[Z,te,se],v.tileID,"globe"===t.projection.name||!!fe||this.transform.pitch>0,t.getProjection()),xe=I*we.perspectiveRatio,$e=(v.x1*u+w.x-v.padding)*xe+we.point.x,Ee=(v.y1*u+w.y-v.padding)*xe+we.point.y,ke=(v.x2*u+w.x+v.padding)*xe+we.point.x,Re=(v.y2*u+w.y+v.padding)*xe+we.point.y,st=we.perspectiveRatio<=.55||we.occluded;return!this.isInsideGrid($e,Ee,ke,Re)||!E&&this.grid.hitTest($e,Ee,ke,Re,B)||st?{box:[],offscreen:!1,occluded:we.occluded}:{box:[$e,Ee,ke,Re],offscreen:this.isOffscreen($e,Ee,ke,Re),occluded:!1}}placeCollisionCircles(t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe){const $e=[],Ee=this.transform.elevation,ke=Ee?Ee.getAtTileOffsetFunc(xe,this.transform.center.lat,this.transform.worldSize,t.getProjection()):tn=>[0,0,0],Re=new c.pointGeometry(v.tileAnchorX,v.tileAnchorY),st=t.getProjection().projectTilePoint(v.tileAnchorX,v.tileAnchorY,xe.canonical),Ue=ke(Re),je=[st.x+Ue[0],st.y+Ue[1],st.z+Ue[2]],bt="globe"===t.projection.name,Ht=this.projectAndGetPerspectiveRatio(k,[je[0],je[1],je[2]],xe,bt||!!Ee||this.transform.pitch>0,t.getProjection()),{perspectiveRatio:Zt}=Ht,$t=(se?I/Zt:I*Zt)/c.ONE_EM,jt=vi(new c.pointGeometry(je[0],je[1]),B,je[2]).point,it=Ht.signedDistanceFromCamera>0?Xi($t,E,v.lineOffsetX*$t,v.lineOffsetY*$t,!1,jt,Re,v,w,B,{},Ee&&!se?ke:null,se&&!!Ee,t.getProjection(),xe,se):null;let pn=!1,hn=!1,Un=!0;if(it&&!Ht.occluded){const tn=.5*Se*Zt+we,ci=new c.pointGeometry(-100,-100),Fn=new c.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Vn=new as,In=it.first,Nn=it.last;let Si=[];for(let pi=In.path.length-1;pi>=1;pi--)Si.push(In.path[pi]);for(let pi=1;pi<Nn.path.length;pi++)Si.push(Nn.path[pi]);const bi=2.5*tn;if(Z){const pi=Si.map(Ee&&!bt?(Gi,mr)=>{const Ir=ke(mr<In.path.length-1?In.tilePath[In.path.length-1-mr]:Nn.tilePath[mr-In.path.length+2]);return Gi[2]=Ir[2],so(Gi,Z)}:Gi=>so(Gi,Z));Si=pi.some(Gi=>Gi.signedDistanceFromCamera<=0)?[]:pi.map(Gi=>Gi.point)}let Qi=[];if(Si.length>0){const pi=Si.map(Lr=>new c.pointGeometry(Lr[0],Lr[1]));let Gi=1/0,mr=-1/0,Ir=1/0,So=-1/0;for(let Lr=0;Lr<pi.length;Lr++)Gi=Math.min(Gi,pi[Lr].x),Ir=Math.min(Ir,pi[Lr].y),mr=Math.max(mr,pi[Lr].x),So=Math.max(So,pi[Lr].y);Qi=Gi>=ci.x&&mr<=Fn.x&&Ir>=ci.y&&So<=Fn.y?[pi]:mr<ci.x||Gi>Fn.x||So<ci.y||Ir>Fn.y?[]:c.clipLine([pi],ci.x,ci.y,Fn.x,Fn.y)}for(const pi of Qi){Vn.reset(pi,.25*tn);let Gi=0;Gi=Vn.length<=.5*tn?1:Math.ceil(Vn.paddedLength/bi)+1;for(let mr=0;mr<Gi;mr++){const Ir=mr/Math.max(Gi-1,1),So=Vn.lerp(Ir),Lr=So.x+Lo,Ya=So.y+Lo;$e.push(Lr,Ya,tn,0);const cl=Lr-tn,hc=Ya-tn,Hr=Lr+tn,no=Ya+tn;if(Un=Un&&this.isOffscreen(cl,hc,Hr,no),hn=hn||this.isInsideGrid(cl,hc,Hr,no),!u&&this.grid.hitTestCircle(Lr,Ya,tn,fe)&&(pn=!0,!te))return{circles:[],offscreen:!1,collisionDetected:pn,occluded:!1}}}}return{circles:!te&&pn||!hn?[]:$e,offscreen:Un,collisionDetected:pn,occluded:Ht.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let v=1/0,w=1/0,E=-1/0,I=-1/0;for(const te of t){const se=new c.pointGeometry(te.x+Lo,te.y+Lo);v=Math.min(v,se.x),w=Math.min(w,se.y),E=Math.max(E,se.x),I=Math.max(I,se.y),u.push(se)}const k=this.grid.query(v,w,E,I).concat(this.ignoredGrid.query(v,w,E,I)),B={},Z={};for(const te of k){const se=te.key;if(void 0===B[se.bucketInstanceId]&&(B[se.bucketInstanceId]={}),B[se.bucketInstanceId][se.featureIndex])continue;const fe=[new c.pointGeometry(te.x1,te.y1),new c.pointGeometry(te.x2,te.y1),new c.pointGeometry(te.x2,te.y2),new c.pointGeometry(te.x1,te.y2)];c.polygonIntersectsPolygon(u,fe)&&(B[se.bucketInstanceId][se.featureIndex]=!0,void 0===Z[se.bucketInstanceId]&&(Z[se.bucketInstanceId]=[]),Z[se.bucketInstanceId].push(se.featureIndex))}return Z}insertCollisionBox(t,u,v,w,E){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:E},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,u,v,w,E){const I=u?this.ignoredGrid:this.grid,k={bucketInstanceId:v,featureIndex:w,collisionGroupID:E};for(let B=0;B<t.length;B+=4)I.insertCircle(k,t[B],t[B+1],t[B+2])}projectAndGetPerspectiveRatio(t,u,v,w,E){const I=[u[0],u[1],u[2],1];let k=!1;if(u[2]||this.transform.pitch>0){c.transformMat4$1(I,I,t);const B="globe"===E.name;this.fogState&&v&&!B&&(k=function(Z,te,se,fe,Se,we){const xe=we.calculateFogTileMatrix(Se),$e=[te,se,fe];return c.transformMat4($e,$e,xe),Bt(Z,$e,we.pitch,we._fov)}(this.fogState,u[0],u[1],u[2],v.toUnwrapped(),this.transform)>.9)}else xr(I,I,t);return{point:new c.pointGeometry((I[0]/I[3]+1)/2*this.transform.width+Lo,(-I[1]/I[3]+1)/2*this.transform.height+Lo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(E)/I[3]*.5,1.5),signedDistanceFromCamera:I[3],occluded:w&&I[2]>I[3]||k}}isOffscreen(t,u,v,w){return v<Lo||t>=this.screenRightBoundary||w<Lo||u>this.screenBottomBoundary}isInsideGrid(t,u,v,w){return v>=0&&t<this.gridRightBoundary&&w>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const t=c.identity([]);return c.translate(t,t,[-100,-100,0]),t}}function lo(f,t,u){const v=t.createTileMatrix(f,f.worldSize,u.toUnwrapped());return c.multiply(new Float32Array(16),f.projMatrix,v)}function Ps(f,t,u){if(t.projection.name===u.projection.name)return f.projMatrix;const v=u.clone();return v.setProjection(t.projection),lo(v,t.getProjection(),f)}function Ho(f,t,u){return t.name===u.projection.name?f.projMatrix:lo(u,t,f)}class el{constructor(t,u,v,w){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?u:-u))):w&&v?1:0,this.placed=v}isHidden(){return 0===this.opacity&&!this.placed}}class Wr{constructor(t,u,v,w,E,I=!1){this.text=new el(t?t.text:null,u,v,E),this.icon=new el(t?t.icon:null,u,w,E),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oa{constructor(t,u,v,w=!1){this.text=t,this.icon=u,this.skipFade=v,this.clipped=w}}class Oa{constructor(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]}}class sa{constructor(t,u,v,w,E){this.bucketInstanceId=t,this.featureIndex=u,this.sourceLayerIndex=v,this.bucketIndex=w,this.tileID=E}}class Sr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const u=++this.maxGroupID;this.collisionGroups[t]={ID:u,predicate:v=>v.collisionGroupID===u}}return this.collisionGroups[t]}}function vs(f,t,u,v,w){const{horizontalAlign:E,verticalAlign:I}=c.getAnchorAlignment(f),k=-(E-.5)*t,B=-(I-.5)*u,Z=c.evaluateVariableOffset(f,v);return new c.pointGeometry(k+Z[0]*w,B+Z[1]*w)}function Us(f,t,u,v,w){const E=new c.pointGeometry(f,t);return u&&E._rotate(v?w:-w),E}class js{constructor(t,u,v,w,E){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new ra(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Sr(v),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,u,v,w){const E=v.getBucket(u),I=v.latestFeatureIndex;if(!E||!I||u.id!==E.layerIds[0])return;const k=E.layers[0].layout,B=v.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),te=v.tileSize/c.EXTENT,se=v.tileID.toUnwrapped();this.transform.setProjection(E.projection);const fe=(Se=v.tileID,we=E.getProjection(),xe=this.transform,we.name===this.projection?xe.calculateProjMatrix(Se.toUnwrapped()):lo(xe,we,Se));var Se,we,xe;const $e="map"===k.get("text-pitch-alignment"),Ee="map"===k.get("text-rotation-alignment");u.compileFilter();const ke=u.dynamicFilter(),Re=u.dynamicFilterNeedsFeature(),st=this.transform.calculatePixelsToTileUnitsMatrix(v),Ue=ls(fe,v.tileID.canonical,$e,Ee,this.transform,E.getProjection(),st);let je=null;if($e){const Zt=po(fe,v.tileID.canonical,$e,Ee,this.transform,E.getProjection(),st);je=c.multiply([],this.transform.labelPlaneMatrix,Zt)}let bt=null;ke&&v.latestFeatureIndex&&(bt={unwrappedTileID:se,dynamicFilter:ke,dynamicFilterNeedsFeature:Re,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new sa(E.bucketInstanceId,I,E.sourceLayerIndex,E.index,v.tileID);const Ht={bucket:E,layout:k,posMatrix:fe,textLabelPlaneMatrix:Ue,labelToScreenMatrix:je,clippingData:bt,scale:Z,textPixelRatio:te,holdingForFade:v.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:c.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(w)for(const Zt of E.sortKeyRanges){const{sortKey:$t,symbolInstanceStart:jt,symbolInstanceEnd:it}=Zt;t.push({sortKey:$t,symbolInstanceStart:jt,symbolInstanceEnd:it,parameters:Ht})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ht})}attemptAnchorPlacement(t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe,$e,Ee,ke){const Re=[fe.textOffset0,fe.textOffset1],st=vs(t,v,w,Re,E),Ue=this.collisionIndex.placeCollisionBox(we,E,u,Us(st.x,st.y,I,k,this.transform.angle),se,B,Z,te.predicate);if((!$e||0!==this.collisionIndex.placeCollisionBox(we,we.getSymbolInstanceIconSize(ke,this.transform.zoom,Se),$e,Us(st.x,st.y,I,k,this.transform.angle),se,B,Z,te.predicate).box.length)&&Ue.box.length>0){let je;return this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&(je=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),this.variableOffsets[fe.crossTileID]={textOffset:Re,width:v,height:w,anchor:t,textScale:E,prevAnchor:je},this.markUsedJustification(we,t,fe,xe),we.allowVerticalPlacement&&(this.markUsedOrientation(we,xe,fe),this.placedOrientations[fe.crossTileID]=xe),{shift:st,placedGlyphBoxes:Ue}}}placeLayerBucketPart(t,u,v,w){const{bucket:E,layout:I,posMatrix:k,textLabelPlaneMatrix:B,labelToScreenMatrix:Z,clippingData:te,textPixelRatio:se,holdingForFade:fe,collisionBoxArray:Se,partiallyEvaluatedTextSize:we,partiallyEvaluatedIconSize:xe,collisionGroup:$e}=t.parameters,Ee=I.get("text-optional"),ke=I.get("icon-optional"),Re=I.get("text-allow-overlap"),st=I.get("icon-allow-overlap"),Ue="map"===I.get("text-rotation-alignment"),je="map"===I.get("text-pitch-alignment"),bt="none"!==I.get("icon-text-fit"),Ht="viewport-y"===I.get("symbol-z-order");this.transform.setProjection(E.projection);let Zt=Re&&(st||!E.hasIconData()||ke),$t=st&&(Re||!E.hasTextData()||Ee);!E.collisionArrays&&Se&&E.deserializeCollisionBoxes(Se),v&&w&&E.updateCollisionDebugBuffers(this.transform.zoom,Se);const jt=(it,pn,hn)=>{if(te){const Hr={zoom:this.transform.zoom,pitch:this.transform.pitch};let no=null;if(te.dynamicFilterNeedsFeature){const Cr=this.retainedQueryData[E.bucketInstanceId];no=te.featureIndex.loadFeature({featureIndex:it.featureIndex,bucketIndex:Cr.bucketIndex,sourceLayerIndex:Cr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,te.dynamicFilter)(Hr,no,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new c.pointGeometry(it.tileAnchorX,it.tileAnchorY),this.transform.calculateDistanceTileData(te.unwrappedTileID)))return this.placements[it.crossTileID]=new oa(!1,!1,!1,!0),void(u[it.crossTileID]=!0)}if(u[it.crossTileID])return;if(fe)return void(this.placements[it.crossTileID]=new oa(!1,!1,!1));let Un=!1,tn=!1,ci=!0,Fn=!1,Vn=!1,In=null,Nn={box:null,offscreen:null,occluded:null},Si={box:null,offscreen:null,occluded:null},bi=null,Qi=null,pi=null,Gi=0,mr=0,Ir=0;hn.textFeatureIndex?Gi=hn.textFeatureIndex:it.useRuntimeCollisionCircles&&(Gi=it.featureIndex),hn.verticalTextFeatureIndex&&(mr=hn.verticalTextFeatureIndex);const So=Hr=>{Hr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID,(this.transform.elevation||Hr.elevation)&&(Hr.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[E.bucketInstanceId].tileID,Hr.tileAnchorX,Hr.tileAnchorY):0)},Lr=hn.textBox;if(Lr){So(Lr);const Hr=Cr=>{let mo=c.WritingMode.horizontal;if(E.allowVerticalPlacement&&!Cr&&this.prevPlacement){const es=this.prevPlacement.placedOrientations[it.crossTileID];es&&(this.placedOrientations[it.crossTileID]=es,mo=es,this.markUsedOrientation(E,mo,it))}return mo},no=(Cr,mo)=>{if(E.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&hn.verticalTextBox){for(const es of E.writingModes)if(es===c.WritingMode.vertical?(Nn=mo(),Si=Nn):Nn=Cr(),Nn&&Nn.box&&Nn.box.length)break}else Nn=Cr()};if(I.get("text-variable-anchor")){let Cr=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[it.crossTileID]){const sr=this.prevPlacement.variableOffsets[it.crossTileID];Cr.indexOf(sr.anchor)>0&&(Cr=Cr.filter(ma=>ma!==sr.anchor),Cr.unshift(sr.anchor))}const mo=(sr,ma,Lc)=>{const Cl=E.getSymbolInstanceTextSize(we,it,this.transform.zoom,pn),jl=(sr.x2-sr.x1)*Cl+2*sr.padding,pc=(sr.y2-sr.y1)*Cl+2*sr.padding,Gl=bt&&!st?ma:null;Gl&&So(Gl);let Ao={box:[],offscreen:!1,occluded:!1};const Er=Re?2*Cr.length:Cr.length;for(let Xs=0;Xs<Er;++Xs){const Xu=this.attemptAnchorPlacement(Cr[Xs%Cr.length],sr,jl,pc,Cl,Ue,je,se,k,$e,Xs>=Cr.length,it,pn,E,Lc,Gl,we,xe);if(Xu&&(Ao=Xu.placedGlyphBoxes,Ao&&Ao.box&&Ao.box.length)){Un=!0,In=Xu.shift;break}}return Ao};no(()=>mo(Lr,hn.iconBox,c.WritingMode.horizontal),()=>{const sr=hn.verticalTextBox;return sr&&So(sr),E.allowVerticalPlacement&&!(Nn&&Nn.box&&Nn.box.length)&&it.numVerticalGlyphVertices>0&&sr?mo(sr,hn.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Nn&&(Un=Nn.box,ci=Nn.offscreen,Fn=Nn.occluded);const es=Hr(Nn&&Nn.box);if(!Un&&this.prevPlacement){const sr=this.prevPlacement.variableOffsets[it.crossTileID];sr&&(this.variableOffsets[it.crossTileID]=sr,this.markUsedJustification(E,sr.anchor,it,es))}}else{const Cr=(mo,es)=>{const sr=E.getSymbolInstanceTextSize(we,it,this.transform.zoom,pn),ma=this.collisionIndex.placeCollisionBox(E,sr,mo,new c.pointGeometry(0,0),Re,se,k,$e.predicate);return ma&&ma.box&&ma.box.length&&(this.markUsedOrientation(E,es,it),this.placedOrientations[it.crossTileID]=es),ma};no(()=>Cr(Lr,c.WritingMode.horizontal),()=>{const mo=hn.verticalTextBox;return E.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&mo?(So(mo),Cr(mo,c.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Hr(Nn&&Nn.box&&Nn.box.length)}}if(bi=Nn,Un=bi&&bi.box&&bi.box.length>0,ci=bi&&bi.offscreen,Fn=bi&&bi.occluded,it.useRuntimeCollisionCircles){const Hr=E.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex>=0?it.centerJustifiedTextSymbolIndex:it.verticalPlacedTextSymbolIndex),no=c.evaluateSizeForFeature(E.textSizeData,we,Hr),Cr=I.get("text-padding");Qi=this.collisionIndex.placeCollisionCircles(E,Re,Hr,E.lineVertexArray,E.glyphOffsetArray,no,k,B,Z,v,je,$e.predicate,it.collisionCircleDiameter*no/c.ONE_EM,Cr,this.retainedQueryData[E.bucketInstanceId].tileID),Un=Re||Qi.circles.length>0&&!Qi.collisionDetected,ci=ci&&Qi.offscreen,Fn=Qi.occluded}if(hn.iconFeatureIndex&&(Ir=hn.iconFeatureIndex),hn.iconBox){const Hr=no=>{So(no);const Cr=bt&&In?Us(In.x,In.y,Ue,je,this.transform.angle):new c.pointGeometry(0,0),mo=E.getSymbolInstanceIconSize(xe,this.transform.zoom,pn);return this.collisionIndex.placeCollisionBox(E,mo,no,Cr,st,se,k,$e.predicate)};Si&&Si.box&&Si.box.length&&hn.verticalIconBox?(pi=Hr(hn.verticalIconBox),tn=pi.box.length>0):(pi=Hr(hn.iconBox),tn=pi.box.length>0),ci=ci&&pi.offscreen,Vn=pi.occluded}const Ya=Ee||0===it.numHorizontalGlyphVertices&&0===it.numVerticalGlyphVertices,cl=ke||0===it.numIconVertices;if(Ya||cl?cl?Ya||(tn=tn&&Un):Un=tn&&Un:tn=Un=tn&&Un,Un&&bi&&bi.box&&this.collisionIndex.insertCollisionBox(bi.box,I.get("text-ignore-placement"),E.bucketInstanceId,Si&&Si.box&&mr?mr:Gi,$e.ID),tn&&pi&&this.collisionIndex.insertCollisionBox(pi.box,I.get("icon-ignore-placement"),E.bucketInstanceId,Ir,$e.ID),Qi&&(Un&&this.collisionIndex.insertCollisionCircles(Qi.circles,I.get("text-ignore-placement"),E.bucketInstanceId,Gi,$e.ID),v)){const Hr=E.bucketInstanceId;let no=this.collisionCircleArrays[Hr];void 0===no&&(no=this.collisionCircleArrays[Hr]=new Oa);for(let Cr=0;Cr<Qi.circles.length;Cr+=4)no.circles.push(Qi.circles[Cr+0]),no.circles.push(Qi.circles[Cr+1]),no.circles.push(Qi.circles[Cr+2]),no.circles.push(Qi.collisionDetected?1:0)}const hc="globe"!==E.projection.name;Zt=Zt&&(hc||!Fn),$t=$t&&(hc||!Vn),this.placements[it.crossTileID]=new oa(Un||Zt,tn||$t,ci||E.justReloaded),u[it.crossTileID]=!0};if(Ht){const it=E.getSortedSymbolIndexes(this.transform.angle);for(let pn=it.length-1;pn>=0;--pn){const hn=it[pn];jt(E.symbolInstances.get(hn),hn,E.collisionArrays[hn])}}else for(let it=t.symbolInstanceStart;it<t.symbolInstanceEnd;it++)jt(E.symbolInstances.get(it),it,E.collisionArrays[it]);if(v&&E.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[E.bucketInstanceId];c.invert(it.invProjMatrix,k),it.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(t,u,v,w){let E;E=w===c.WritingMode.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(u)];const I=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const k of I)k>=0&&(t.text.placedSymbolArray.get(k).crossTileID=E>=0&&k!==E?0:v.crossTileID)}markUsedOrientation(t,u,v){const w=u===c.WritingMode.horizontal||u===c.WritingMode.horizontalOnly?u:0,E=u===c.WritingMode.vertical?u:0,I=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const k of I)t.text.placedSymbolArray.get(k).placedOrientation=w;v.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let v=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const w=u?u.symbolFadeChange(t):1,E=u?u.opacities:{},I=u?u.variableOffsets:{},k=u?u.placedOrientations:{};for(const B in this.placements){const Z=this.placements[B],te=E[B];te?(this.opacities[B]=new Wr(te,w,Z.text,Z.icon,null,Z.clipped),v=v||Z.text!==te.text.placed||Z.icon!==te.icon.placed):(this.opacities[B]=new Wr(null,w,Z.text,Z.icon,Z.skipFade,Z.clipped),v=v||Z.text||Z.icon)}for(const B in E){const Z=E[B];if(!this.opacities[B]){const te=new Wr(Z,w,!1,!1);te.isHidden()||(this.opacities[B]=te,v=v||Z.text.placed||Z.icon.placed)}}for(const B in I)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=I[B]);for(const B in k)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=k[B]);v?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:t)}updateLayerOpacities(t,u){const v={};for(const w of u){const E=w.getBucket(t);E&&w.latestFeatureIndex&&t.id===E.layerIds[0]&&this.updateBucketOpacities(E,v,w.collisionBoxArray)}}updateBucketOpacities(t,u,v){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const w=t.layers[0].layout,E=!!t.layers[0].dynamicFilter(),I=new Wr(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),B=w.get("icon-allow-overlap"),Z=w.get("text-variable-anchor"),te="map"===w.get("text-rotation-alignment"),se="map"===w.get("text-pitch-alignment"),fe="none"!==w.get("icon-text-fit"),Se=new Wr(null,0,k&&(B||!t.hasIconData()||w.get("icon-optional")),B&&(k||!t.hasTextData()||w.get("text-optional")),!0);!t.collisionArrays&&v&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(v);const we=($e,Ee,ke)=>{for(let Re=0;Re<Ee/4;Re++)$e.opacityVertexArray.emplaceBack(ke)};let xe=0;for(let $e=0;$e<t.symbolInstances.length;$e++){const Ee=t.symbolInstances.get($e),{numHorizontalGlyphVertices:ke,numVerticalGlyphVertices:Re,crossTileID:st}=Ee;let Ue=this.opacities[st];u[st]?Ue=I:Ue||(Ue=Se,this.opacities[st]=Ue),u[st]=!0;const je=ke>0||Re>0,bt=Ee.numIconVertices>0,Ht=this.placedOrientations[Ee.crossTileID],Zt=Ht===c.WritingMode.vertical,$t=Ht===c.WritingMode.horizontal||Ht===c.WritingMode.horizontalOnly;if(!je&&!bt||Ue.isHidden()||xe++,je){const jt=$o(Ue.text);we(t.text,ke,Zt?Xo:jt),we(t.text,Re,$t?Xo:jt);const it=Ue.text.isHidden();[Ee.rightJustifiedTextSymbolIndex,Ee.centerJustifiedTextSymbolIndex,Ee.leftJustifiedTextSymbolIndex].forEach(Un=>{Un>=0&&(t.text.placedSymbolArray.get(Un).hidden=it||Zt?1:0)}),Ee.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(Ee.verticalPlacedTextSymbolIndex).hidden=it||$t?1:0);const pn=this.variableOffsets[Ee.crossTileID];pn&&this.markUsedJustification(t,pn.anchor,Ee,Ht);const hn=this.placedOrientations[Ee.crossTileID];hn&&(this.markUsedJustification(t,"left",Ee,hn),this.markUsedOrientation(t,hn,Ee))}if(bt){const jt=$o(Ue.icon);Ee.placedIconSymbolIndex>=0&&(we(t.icon,Ee.numIconVertices,Zt?Xo:jt),t.icon.placedSymbolArray.get(Ee.placedIconSymbolIndex).hidden=Ue.icon.isHidden()),Ee.verticalPlacedIconSymbolIndex>=0&&(we(t.icon,Ee.numVerticalIconVertices,$t?Xo:jt),t.icon.placedSymbolArray.get(Ee.verticalPlacedIconSymbolIndex).hidden=Ue.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const jt=t.collisionArrays[$e];if(jt){let it=new c.pointGeometry(0,0),pn=!0;if(jt.textBox||jt.verticalTextBox){if(Z){const Un=this.variableOffsets[st];Un?(it=vs(Un.anchor,Un.width,Un.height,Un.textOffset,Un.textScale),te&&it._rotate(se?this.transform.angle:-this.transform.angle)):pn=!1}E&&(pn=!Ue.clipped),jt.textBox&&Gs(t.textCollisionBox.collisionVertexArray,Ue.text.placed,!pn||Zt,it.x,it.y),jt.verticalTextBox&&Gs(t.textCollisionBox.collisionVertexArray,Ue.text.placed,!pn||$t,it.x,it.y)}const hn=pn&&Boolean(!$t&&jt.verticalIconBox);jt.iconBox&&Gs(t.iconCollisionBox.collisionVertexArray,Ue.icon.placed,hn,fe?it.x:0,fe?it.y:0),jt.verticalIconBox&&Gs(t.iconCollisionBox.collisionVertexArray,Ue.icon.placed,!hn,fe?it.x:0,fe?it.y:0)}}}if(t.fullyClipped=0===xe,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=$e.invProjMatrix,t.placementViewportMatrix=$e.viewportMatrix,t.collisionCircleArray=$e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,u){const v=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*v>t}setStale(){this.stale=!0}}function Gs(f,t,u,v,w){f.emplaceBack(t?1:0,u?1:0,v||0,w||0),f.emplaceBack(t?1:0,u?1:0,v||0,w||0),f.emplaceBack(t?1:0,u?1:0,v||0,w||0),f.emplaceBack(t?1:0,u?1:0,v||0,w||0)}const Hs=Math.pow(2,25),tl=Math.pow(2,24),wa=Math.pow(2,17),$s=Math.pow(2,16),Sc=Math.pow(2,9),nl=Math.pow(2,8),Fo=Math.pow(2,1);function $o(f){if(0===f.opacity&&!f.placed)return 0;if(1===f.opacity&&f.placed)return 4294967295;const t=f.placed?1:0,u=Math.floor(127*f.opacity);return u*Hs+t*tl+u*wa+t*$s+u*Sc+t*nl+u*Fo+t}const Xo=0;class aa{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,u,v,w,E){const I=this._bucketParts;for(;this._currentTileIndex<t.length;)if(u.getBucketParts(I,w,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((k,B)=>k.sortKey-B.sortKey));this._currentPartIndex<I.length;){const k=I[this._currentPartIndex];if(u.placeLayerBucketPart(k,this._seenCrossTileIDs,v,0===k.symbolInstanceStart),this._currentPartIndex++,E())return!0}return!1}}class la{constructor(t,u,v,w,E,I,k,B){this.placement=new js(t,E,I,k,B),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(t,u,v){const w=c.exported.now(),E=()=>{const I=c.exported.now()-w;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=u[t[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=k)&&(!I.maxzoom||I.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new aa(I)),this._inProgressLayer.continuePlacement(v[I.source],this.placement,this._showCollisionBoxes,I,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ka=512/c.EXTENT/2;class Ra{constructor(t,u,v){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(let w=0;w<u.length;w++){const E=u.get(w),I=E.key;this.indexedSymbolInstances[I]||(this.indexedSymbolInstances[I]=[]),this.indexedSymbolInstances[I].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,t)})}}getScaledCoordinates(t,u){const v=ka/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*c.EXTENT+t.tileAnchorX)*v),y:Math.floor((u.canonical.y*c.EXTENT+t.tileAnchorY)*v)}}findMatches(t,u,v){const w=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let E=0;E<t.length;E++){const I=t.get(E);if(I.crossTileID)continue;const k=this.indexedSymbolInstances[I.key];if(!k)continue;const B=this.getScaledCoordinates(I,u);for(const Z of k)if(Math.abs(Z.coord.x-B.x)<=w&&Math.abs(Z.coord.y-B.y)<=w&&!v[Z.crossTileID]){v[Z.crossTileID]=!0,I.crossTileID=Z.crossTileID;break}}}}class _l{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Al{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const u=Math.round((t-this.lng)/360);if(0!==u)for(const v in this.indexes){const w=this.indexes[v],E={};for(const I in w){const k=w[I];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+u),E[k.tileID.key]=k}this.indexes[v]=E}this.lng=t}addBucket(t,u,v){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let E=0;E<u.symbolInstances.length;E++)u.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const w=this.usedCrossTileIDs[t.overscaledZ];for(const E in this.indexes){const I=this.indexes[E];if(Number(E)>t.overscaledZ)for(const k in I){const B=I[k];B.tileID.isChildOf(t)&&B.findMatches(u.symbolInstances,t,w)}else{const k=I[t.scaledTo(Number(E)).key];k&&k.findMatches(u.symbolInstances,t,w)}}for(let E=0;E<u.symbolInstances.length;E++){const I=u.symbolInstances.get(E);I.crossTileID||(I.crossTileID=v.generate(),w[I.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ra(t,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(t,u){for(const v in u.indexedSymbolInstances)for(const w of u.indexedSymbolInstances[v])delete this.usedCrossTileIDs[t][w.crossTileID]}removeStaleBuckets(t){let u=!1;for(const v in this.indexes){const w=this.indexes[v];for(const E in w)t[w[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,w[E]),delete w[E],u=!0)}return u}}class La{constructor(){this.layerIndexes={},this.crossTileIDs=new _l,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,u,v,w){let E=this.layerIndexes[t.id];void 0===E&&(E=this.layerIndexes[t.id]=new Al);let I=!1;const k={};"globe"!==w.name&&E.handleWrapJump(v);for(const B of u){const Z=B.getBucket(t);Z&&t.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(B.tileID,Z,this.crossTileIDs)&&(I=!0),k[Z.bucketInstanceId]=!0)}return E.removeStaleBuckets(k)&&(I=!0),I}pruneUnusedLayers(t){const u={};t.forEach(v=>{u[v]=!0});for(const v in this.layerIndexes)u[v]||delete this.layerIndexes[v]}}const ca=(f,t)=>c.emitValidationErrors(f,t&&t.filter(u=>"source.canvas"!==u.identifier)),cs=c.pick(At,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Fa=c.pick(At,["setCenter","setZoom","setBearing","setPitch"]),Ba={version:8,layers:[],sources:{}},Zs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Bo extends c.Evented{constructor(t,u={}){super(),this.map=t,this.dispatcher=new fi(ti(),this),this.imageManager=new fn,this.imageManager.setEventedParent(this),this.glyphManager=new c.GlyphManager(t._requestManager,u.localFontFamily?c.LocalGlyphMode.all:u.localIdeographFontFamily?c.LocalGlyphMode.ideographs:c.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.lineAtlas=new c.LineAtlas(256,512),this.crossTileSymbolIndex=new La,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());const v=this;this._rtlTextPluginCallback=Bo.registerForPluginStateChange(w=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(E,I)=>{if(c.triggerPluginCompletionEvent(E),I&&I.every(k=>k))for(const k in v._sourceCaches){const B=v._sourceCaches[k],Z=B.getSource().type;"vector"!==Z&&"geojson"!==Z||B.reload()}})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const E=this.getSource(w.sourceId);if(E&&E.vectorLayerIds)for(const I in this._layers){const k=this._layers[I];k.source===E.id&&this._validateLayer(k)}})}loadURL(t,u={}){this.fire(new c.Event("dataloading",{dataType:"style"}));const v="boolean"==typeof u.validate?u.validate:!c.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,u.accessToken);const w=this.map._requestManager.transformRequest(t,c.ResourceType.Style);this._request=c.getJSON(w,(E,I)=>{this._request=null,E?this.fire(new c.ErrorEvent(E)):I&&this._load(I,v)})}loadJSON(t,u={}){this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.exported.frame(()=>{this._request=null,this._load(t,!1!==u.validate)})}loadEmpty(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(Ba,!1)}_updateLayerCount(t,u){const v=u?1:-1;t.is3D()&&(this._num3DLayers+=v),"circle"===t.type&&(this._numCircleLayers+=v),"symbol"===t.type&&(this._numSymbolLayers+=v)}_load(t,u){if(u&&ca(this,c.validateStyle(t)))return;this._loaded=!0,this.stylesheet=c.clone$1(t),this._updateMapProjection();for(const w in t.sources)this.addSource(w,t.sources[w],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const v=jn(this.stylesheet.layers);this._order=v.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of v)w=c.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new vn(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(t){this._spriteRequest=function(u,v,w){let E,I,k;const B=c.exported.devicePixelRatio>1?"@2x":"";let Z=c.getJSON(v.transformRequest(v.normalizeSpriteURL(u,B,".json"),c.ResourceType.SpriteJSON),(fe,Se)=>{Z=null,k||(k=fe,E=Se,se())}),te=c.getImage(v.transformRequest(v.normalizeSpriteURL(u,B,".png"),c.ResourceType.SpriteImage),(fe,Se)=>{te=null,k||(k=fe,I=Se,se())});function se(){if(k)w(k);else if(E&&I){const fe=c.exported.getImageData(I),Se={};for(const we in E){const{width:xe,height:$e,x:Ee,y:ke,sdf:Re,pixelRatio:st,stretchX:Ue,stretchY:je,content:bt}=E[we],Ht=new c.RGBAImage({width:xe,height:$e});c.RGBAImage.copy(fe,Ht,{x:Ee,y:ke},{x:0,y:0},{width:xe,height:$e}),Se[we]={data:Ht,pixelRatio:st,sdf:Re,stretchX:Ue,stretchY:je,content:bt}}w(null,Se)}}return{cancel(){Z&&(Z.cancel(),Z=null),te&&(te.cancel(),te=null)}}}(t,this.map._requestManager,(u,v)=>{if(this._spriteRequest=null,u)this.fire(new c.ErrorEvent(u));else if(v)for(const w in v)this.imageManager.addImage(w,v[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new c.Event("data",{dataType:"style"}))})}_validateLayer(t){const u=this.getSource(t.source);if(!u)return;const v=t.sourceLayer;v&&("geojson"===u.type||u.vectorLayerIds&&-1===u.vectorLayerIds.indexOf(v))&&this.fire(new c.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${u.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const u=[];for(const v of t){const w=this._layers[v];"custom"!==w.type&&u.push(w.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Zs[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const u=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(w.length||E.length)&&this._updateWorkerLayers(w,E);for(const I in this._updatedSources){const k=this._updatedSources[I];"reload"===k?this._reloadSource(I):"clear"===k&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const v={};for(const w in this._sourceCaches){const E=this._sourceCaches[w];v[w]=E.used,E.used=!1}for(const w of this._order){const E=this._layers[w];if(E.recalculate(t,this._availableImages),!E.isHidden(t.zoom)){const k=this._getLayerSourceCache(E);k&&(k.used=!0)}const I=this.map.painter;if(I){const k=E.getProgramIds();if(!k)continue;const B=E.getProgramConfiguration(t.zoom);for(const Z of k)I.useProgram(Z,B)}}for(const w in v){const E=this._sourceCaches[w];v[w]!==E.used&&E.getSource().fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new c.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),ca(this,c.validateStyle(t)))return!1;(t=c.clone$1(t)).layers=jn(t.layers);const u=function(w,E){if(!w)return[{command:At.setStyle,args:[E]}];let I=[];try{if(!Ce(w.version,E.version))return[{command:At.setStyle,args:[E]}];Ce(w.center,E.center)||I.push({command:At.setCenter,args:[E.center]}),Ce(w.zoom,E.zoom)||I.push({command:At.setZoom,args:[E.zoom]}),Ce(w.bearing,E.bearing)||I.push({command:At.setBearing,args:[E.bearing]}),Ce(w.pitch,E.pitch)||I.push({command:At.setPitch,args:[E.pitch]}),Ce(w.sprite,E.sprite)||I.push({command:At.setSprite,args:[E.sprite]}),Ce(w.glyphs,E.glyphs)||I.push({command:At.setGlyphs,args:[E.glyphs]}),Ce(w.transition,E.transition)||I.push({command:At.setTransition,args:[E.transition]}),Ce(w.light,E.light)||I.push({command:At.setLight,args:[E.light]}),Ce(w.fog,E.fog)||I.push({command:At.setFog,args:[E.fog]}),Ce(w.projection,E.projection)||I.push({command:At.setProjection,args:[E.projection]});const k={},B=[];!function(se,fe,Se,we){let xe;for(xe in fe=fe||{},se=se||{})se.hasOwnProperty(xe)&&(fe.hasOwnProperty(xe)||br(xe,Se,we));for(xe in fe)fe.hasOwnProperty(xe)&&(se.hasOwnProperty(xe)?Ce(se[xe],fe[xe])||("geojson"===se[xe].type&&"geojson"===fe[xe].type&&Zr(se,fe,xe)?Se.push({command:At.setGeoJSONSourceData,args:[xe,fe[xe].data]}):jr(xe,fe,Se,we)):nr(xe,fe,Se))}(w.sources,E.sources,B,k);const Z=[];w.layers&&w.layers.forEach(se=>{se.source&&k[se.source]?I.push({command:At.removeLayer,args:[se.id]}):Z.push(se)});let te=w.terrain;te&&k[te.source]&&(I.push({command:At.setTerrain,args:[void 0]}),te=void 0),I=I.concat(B),Ce(te,E.terrain)||I.push({command:At.setTerrain,args:[E.terrain]}),function(se,fe,Se){fe=fe||[];const we=(se=se||[]).map(Uo),xe=fe.map(Uo),$e=se.reduce(jo,{}),Ee=fe.reduce(jo,{}),ke=we.slice(),Re=Object.create(null);let st,Ue,je,bt,Ht,Zt,$t;for(st=0,Ue=0;st<we.length;st++)je=we[st],Ee.hasOwnProperty(je)?Ue++:(Se.push({command:At.removeLayer,args:[je]}),ke.splice(ke.indexOf(je,Ue),1));for(st=0,Ue=0;st<xe.length;st++)je=xe[xe.length-1-st],ke[ke.length-1-st]!==je&&($e.hasOwnProperty(je)?(Se.push({command:At.removeLayer,args:[je]}),ke.splice(ke.lastIndexOf(je,ke.length-Ue),1)):Ue++,Zt=ke[ke.length-st],Se.push({command:At.addLayer,args:[Ee[je],Zt]}),ke.splice(ke.length-st,0,je),Re[je]=!0);for(st=0;st<xe.length;st++)if(je=xe[st],bt=$e[je],Ht=Ee[je],!Re[je]&&!Ce(bt,Ht))if(Ce(bt.source,Ht.source)&&Ce(bt["source-layer"],Ht["source-layer"])&&Ce(bt.type,Ht.type)){for($t in Br(bt.layout,Ht.layout,Se,je,null,At.setLayoutProperty),Br(bt.paint,Ht.paint,Se,je,null,At.setPaintProperty),Ce(bt.filter,Ht.filter)||Se.push({command:At.setFilter,args:[je,Ht.filter]}),Ce(bt.minzoom,Ht.minzoom)&&Ce(bt.maxzoom,Ht.maxzoom)||Se.push({command:At.setLayerZoomRange,args:[je,Ht.minzoom,Ht.maxzoom]}),bt)bt.hasOwnProperty($t)&&"layout"!==$t&&"paint"!==$t&&"filter"!==$t&&"metadata"!==$t&&"minzoom"!==$t&&"maxzoom"!==$t&&(0===$t.indexOf("paint.")?Br(bt[$t],Ht[$t],Se,je,$t.slice(6),At.setPaintProperty):Ce(bt[$t],Ht[$t])||Se.push({command:At.setLayerProperty,args:[je,$t,Ht[$t]]}));for($t in Ht)Ht.hasOwnProperty($t)&&!bt.hasOwnProperty($t)&&"layout"!==$t&&"paint"!==$t&&"filter"!==$t&&"metadata"!==$t&&"minzoom"!==$t&&"maxzoom"!==$t&&(0===$t.indexOf("paint.")?Br(bt[$t],Ht[$t],Se,je,$t.slice(6),At.setPaintProperty):Ce(bt[$t],Ht[$t])||Se.push({command:At.setLayerProperty,args:[je,$t,Ht[$t]]}))}else Se.push({command:At.removeLayer,args:[je]}),Zt=ke[ke.lastIndexOf(je)+1],Se.push({command:At.addLayer,args:[Ht,Zt]})}(Z,E.layers,I)}catch(k){console.warn("Unable to compute style diff:",k),I=[{command:At.setStyle,args:[E]}]}return I}(this.serialize(),t).filter(w=>!(w.command in Fa));if(0===u.length)return!1;const v=u.filter(w=>!(w.command in cs));if(v.length>0)throw new Error(`Unimplemented: ${v.map(w=>w.command).join(", ")}.`);return u.forEach(w=>{"setTransition"!==w.command&&this[w.command].apply(this,w.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,u){return this.getImage(t)?this.fire(new c.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,u),this._afterImageUpdated(t),this)}updateImage(t,u){this.imageManager.updateImage(t,u)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new c.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,u,v={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(c.validateSource,`sources.${t}`,u,null,v))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const w=Ot(t,u,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:w.serialize(),sourceId:t}));const E=I=>{const k=(I?"symbol:":"other:")+t,B=this._sourceCaches[k]=new c.SourceCache(k,w,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[t]=B,B.style=this,B.onAdd(this.map)};E(!1),"vector"!==u.type&&"geojson"!==u.type||E(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const u=this.getSource(t);if(!u)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===t)return this.fire(new c.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new c.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const v=this._getSourceCaches(t);for(const w of v)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,u){this._checkLoaded(),this.getSource(t).setData(u),this._changed=!0}getSource(t){const u=this._getSourceCache(t);return u&&u.getSource()}addLayer(t,u,v={}){this._checkLoaded();const w=t.id;if(this.getLayer(w))return void this.fire(new c.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let E;if("custom"===t.type){if(ca(this,c.validateCustomStyleLayer(t)))return;E=c.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(w,t.source),t=c.clone$1(t),t=c.extend(t,{source:w})),this._validate(c.validateLayer,`layers.${w}`,t,{arrayIndex:-1},v))return;E=c.createStyleLayer(t),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const I=u?this._order.indexOf(u):this._order.length;if(u&&-1===I)return void this.fire(new c.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(I,0,w),this._layerOrderChanged=!0,this._layers[w]=E;const k=this._getLayerSourceCache(E);if(this._removedLayers[w]&&E.source&&k&&"custom"!==E.type){const B=this._removedLayers[w];delete this._removedLayers[w],B.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",k.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,u){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===u)return;const v=this._order.indexOf(t);this._order.splice(v,1);const w=u?this._order.indexOf(u):this._order.length;u&&-1===w?this.fire(new c.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(w,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const u=this._layers[t];if(!u)return void this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const v=this._order.indexOf(t);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=u,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const u in this._layers)if(this._layers[u].type===t)return!0;return!1}setLayerZoomRange(t,u,v){this._checkLoaded();const w=this.getLayer(t);w?w.minzoom===u&&w.maxzoom===v||(null!=u&&(w.minzoom=u),null!=v&&(w.maxzoom=v),this._updateLayer(w)):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,u,v={}){this._checkLoaded();const w=this.getLayer(t);if(w){if(!Ce(w.filter,u))return null==u?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(c.validateFilter,`layers.${w.id}.filter`,u,{layerType:w.type},v)||(w.filter=c.clone$1(u),this._updateLayer(w)))}else this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const u=this.getLayer(t);return u&&c.clone$1(u.filter)}setLayoutProperty(t,u,v,w={}){this._checkLoaded();const E=this.getLayer(t);E?Ce(E.getLayoutProperty(u),v)||(E.setLayoutProperty(u,v,w),this._updateLayer(E)):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,u){const v=this.getLayer(t);if(v)return v.getLayoutProperty(u);this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,u,v,w={}){this._checkLoaded();const E=this.getLayer(t);E?Ce(E.getPaintProperty(u),v)||(E.setPaintProperty(u,v,w)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,u){const v=this.getLayer(t);return v&&v.getPaintProperty(u)}setFeatureState(t,u){this._checkLoaded();const v=t.source,w=t.sourceLayer,E=this.getSource(v);if(!E)return void this.fire(new c.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const I=E.type;if("geojson"===I&&w)return void this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!w)return void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(v);for(const B of k)B.setFeatureState(w,t.id,u)}removeFeatureState(t,u){this._checkLoaded();const v=t.source,w=this.getSource(v);if(!w)return void this.fire(new c.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const E=w.type,I="vector"===E?t.sourceLayer:void 0;if("vector"===E&&!I)return void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(v);for(const B of k)B.removeFeatureState(I,t.id,u)}getFeatureState(t){this._checkLoaded();const u=t.source,v=t.sourceLayer,w=this.getSource(u);if(w){if("vector"!==w.type||v)return void 0===t.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(v,t.id);this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const u in this._sourceCaches){const v=this._sourceCaches[u].getSource();t[v.id]||(t[v.id]=v.serialize())}return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},u=>void 0!==u)}_updateLayer(t){this._updatedLayers[t.id]=!0;const u=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&u&&"raster"!==u.getSource().type&&(this._updatedSources[t.source]="reload",u.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const u=I=>"fill-extrusion"===this._layers[I].type,v={},w=[];for(let I=this._order.length-1;I>=0;I--){const k=this._order[I];if(u(k)){v[k]=I;for(const B of t){const Z=B[k];if(Z)for(const te of Z)w.push(te)}}}w.sort((I,k)=>k.intersectionZ-I.intersectionZ);const E=[];for(let I=this._order.length-1;I>=0;I--){const k=this._order[I];if(u(k))for(let B=w.length-1;B>=0;B--){const Z=w[B].feature;if(v[Z.layer.id]<I)break;E.push(Z),w.pop()}else for(const B of t){const Z=B[k];if(Z)for(const te of Z)E.push(te.feature)}}return E}queryRenderedFeatures(t,u,v){u&&u.filter&&this._validate(c.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const w={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of u.layers){const Z=this._layers[B];if(!Z)return this.fire(new c.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];w[Z.source]=!0}}const E=[];u.availableImages=this._availableImages;const I=u&&u.layers?u.layers.some(B=>{const Z=this.getLayer(B);return Z&&Z.is3D()}):this.has3DLayers(),k=Di.createFromScreenPoints(t,v);for(const B in this._sourceCaches){const Z=this._sourceCaches[B].getSource().id;u.layers&&!w[Z]||E.push(en(this._sourceCaches[B],this._layers,this._serializedLayers,k,u,v,I,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(B,Z,te,se,fe,Se,we){const xe={},$e=Se.queryRenderedSymbols(se),Ee=[];for(const ke of Object.keys($e).map(Number))Ee.push(we[ke]);Ee.sort(Ge);for(const ke of Ee){const Re=ke.featureIndex.lookupSymbolFeatures($e[ke.bucketInstanceId],Z,ke.bucketIndex,ke.sourceLayerIndex,fe.filter,fe.layers,fe.availableImages,B);for(const st in Re){const Ue=xe[st]=xe[st]||[],je=Re[st];je.sort((bt,Ht)=>{const Zt=ke.featureSortOrder;if(Zt){const $t=Zt.indexOf(bt.featureIndex);return Zt.indexOf(Ht.featureIndex)-$t}return Ht.featureIndex-bt.featureIndex});for(const bt of je)Ue.push(bt)}}for(const ke in xe)xe[ke].forEach(Re=>{const st=Re.feature,Ue=te(B[ke]).getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=Ue});return xe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(t,u){u&&u.filter&&this._validate(c.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const v=this._getSourceCaches(t);let w=[];for(const E of v)w=w.concat(Le(E,u));return w}addSourceType(t,u,v){return Bo.getSourceType(t)?v(new Error(`A source type called "${t}" already exists.`)):(Bo.setSourceType(t,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:u.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(t,u={}){this._checkLoaded();const v=this.light.getLight();let w=!1;for(const I in t)if(!Ce(t[I],v[I])){w=!0;break}if(!w)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,u),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,u=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===u){if("object"==typeof t.source){const v="terrain-dem-src";this.addSource(v,t.source),t=c.clone$1(t),t=c.extend(t,{source:v})}if(this._validate(c.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(t,u);else{const v=this.terrain,w=v.get();for(const E of Object.keys(c.spec.terrain))!t.hasOwnProperty(E)&&c.spec.terrain[E].default&&(t[E]=c.spec.terrain[E].default);for(const E in t)if(!Ce(t[E],w[E])){v.set(t),this.stylesheet.terrain=t;const I=this._setTransitionParameters({duration:0});v.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const u=this.fog=new Yn(t,this.map.transform);this.stylesheet.fog=t;const v=this._setTransitionParameters({duration:0});u.updateTransitions(v)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,v=u.get();0===Object.keys(t).length&&u.set(t);for(const w in t)if(!Ce(t[w],v[w])){u.set(t),this.stylesheet.fog=t;const E=this._setTransitionParameters({duration:0});u.updateTransitions(E);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:c.exported.now(),transition:c.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(v=>this.isLayerDraped(this._layers[v])),u=this._order.filter(v=>!this.isLayerDraped(this._layers[v]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...u)}_createTerrain(t,u){const v=this.terrain=new Gt(t,u);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});v.updateTransitions(w)}_force3DLayerUpdate(){for(const t in this._layers){const u=this._layers[t];"fill-extrusion"===u.type&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const u=this._layers[t];"symbol"===u.type&&this._updateLayer(u)}}_validate(t,u,v,w,E={}){return(!E||!1!==E.validate)&&ca(this,t.call(c.validateStyle,c.extend({key:u,style:this.serialize(),value:v,styleSpec:c.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const u=this._getSourceCaches(t);for(const v of u)v.clearTiles()}_reloadSource(t){const u=this._getSourceCaches(t);for(const v of u)v.resume(),v.reload()}_updateSources(t){for(const u in this._sourceCaches)this._sourceCaches[u].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const u=this._sourceCaches[t];u.resume(),u.reload()}}_updatePlacement(t,u,v,w,E=!1){let I=!1,k=!1;const B={};for(const Z of this._order){const te=this._layers[Z];if("symbol"!==te.type)continue;if(!B[te.source]){const fe=this._getLayerSourceCache(te);if(!fe)continue;B[te.source]=fe.getRenderableIds(!0).map(Se=>fe.getTileByID(Se)).sort((Se,we)=>we.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(we.tileID)?-1:1))}const se=this.crossTileSymbolIndex.addLayer(te,B[te.source],t.center.lng,t.projection);I=I||se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||0===v,this._layerOrderChanged&&this.fire(new c.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.exported.now(),t.zoom))&&(this.pauseablePlacement=new la(t,this._order,E,u,v,w,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.exported.now()),k=!0),I&&this.pauseablePlacement.placement.setStale()),k||I)for(const Z of this._order){const te=this._layers[Z];"symbol"===te.type&&this.placement.updateLayerOpacities(te,B[te.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,u,v){this.imageManager.getImages(u.icons,v),this._updateTilesForChangedImages();const w=E=>{E&&E.setDependencies(u.tileID.key,u.type,u.icons)};w(this._otherSourceCaches[u.source]),w(this._symbolSourceCaches[u.source])}getGlyphs(t,u,v){this.glyphManager.getGlyphs(u.stacks,v)}getResource(t,u,v){return c.makeRequest(u,v)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const u=[];return this._otherSourceCaches[t]&&u.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&u.push(this._symbolSourceCaches[t]),u}_isSourceCacheLoaded(t){const u=this._getSourceCaches(t);return 0===u.length?(this.fire(new c.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):u.every(v=>v.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Bo.getSourceType=function(f){return lt[f]},Bo.setSourceType=function(f,t){lt[f]=t},Bo.registerForPluginStateChange=c.registerForPluginStateChange;var Ca="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Qr="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let za={},Ws={};za=Li("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),Ws=Li("#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const ua=Li("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),vo=Ca,Co="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var da={background:Li("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Li("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Li("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);\n#else \nmat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Li("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Li("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Li("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Li("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Li("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Li("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Li("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Li("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Li("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Li("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Li("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Li("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Li("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nhighp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nvec4 out_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Li("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Li("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Li("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Li("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\nvec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Li("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nvec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Li("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Li("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Li("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qr),skyboxGradient:Li("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qr),skyboxCapture:Li("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Li("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\nvec4 color=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector.xyz*height;vec4 globe=u_globe_matrix*vec4(globe_pos,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Li("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);\n#ifdef PROJECTION_GLOBE_VIEW\nfloat globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nfloat horizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Li(f,t,u){const v=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,E=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),I=f.match(w),k=t.match(w),B=Ca.match(w);let Z=k?k.concat(I):I;u||(za.staticUniforms&&(Z=za.staticUniforms.concat(Z)),Ws.staticUniforms&&(Z=Ws.staticUniforms.concat(Z))),Z&&(Z=Z.concat(B));const te={};return{fragmentSource:f=f.replace(v,(se,fe,Se,we,xe)=>(te[xe]=!0,"define"===fe?`\n#ifndef HAS_UNIFORM_u_${xe}\nvarying ${Se} ${we} ${xe};\n#else\nuniform ${Se} ${we} u_${xe};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${xe}\n    ${Se} ${we} ${xe} = u_${xe};\n#endif\n`)),vertexSource:t=t.replace(v,(se,fe,Se,we,xe)=>{const $e="float"===we?"vec2":"vec4",Ee=xe.match(/color/)?"color":$e;return te[xe]?"define"===fe?`\n#ifndef HAS_UNIFORM_u_${xe}\nuniform lowp float u_${xe}_t;\nattribute ${Se} ${$e} a_${xe};\nvarying ${Se} ${we} ${xe};\n#else\nuniform ${Se} ${we} u_${xe};\n#endif\n`:"vec4"===Ee?`\n#ifndef HAS_UNIFORM_u_${xe}\n    ${xe} = a_${xe};\n#else\n    ${Se} ${we} ${xe} = u_${xe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${xe}\n    ${xe} = unpack_mix_${Ee}(a_${xe}, u_${xe}_t);\n#else\n    ${Se} ${we} ${xe} = u_${xe};\n#endif\n`:"define"===fe?`\n#ifndef HAS_UNIFORM_u_${xe}\nuniform lowp float u_${xe}_t;\nattribute ${Se} ${$e} a_${xe};\n#else\nuniform ${Se} ${we} u_${xe};\n#endif\n`:"vec4"===Ee?`\n#ifndef HAS_UNIFORM_u_${xe}\n    ${Se} ${we} ${xe} = a_${xe};\n#else\n    ${Se} ${we} ${xe} = u_${xe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${xe}\n    ${Se} ${we} ${xe} = unpack_mix_${Ee}(a_${xe}, u_${xe}_t);\n#else\n    ${Se} ${we} ${xe} = u_${xe};\n#endif\n`}),staticAttributes:E,staticUniforms:Z}}class X{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,u,v,w,E,I,k,B,Z){this.context=t;let te=this.boundPaintVertexBuffers.length!==w.length;for(let se=0;!te&&se<w.length;se++)this.boundPaintVertexBuffers[se]!==w[se]&&(te=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===v&&!te&&this.boundIndexBuffer===E&&this.boundVertexOffset===I&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===B&&this.boundDynamicVertexBuffer3===Z?(t.bindVertexArrayOES.set(this.vao),k&&k.bind(),E&&E.dynamicDraw&&E.bind(),B&&B.bind(),Z&&Z.bind()):this.freshBind(u,v,w,E,I,k,B,Z)}freshBind(t,u,v,w,E,I,k,B){let Z;const te=t.numAttributes,se=this.context,fe=se.gl;if(se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=se.extVertexArrayObject.createVertexArrayOES(),se.bindVertexArrayOES.set(this.vao),Z=0,this.boundProgram=t,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=w,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=I,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=B;else{Z=se.currentNumAttributes||0;for(let Se=te;Se<Z;Se++)fe.disableVertexAttribArray(Se)}u.enableAttributes(fe,t);for(const Se of v)Se.enableAttributes(fe,t);I&&I.enableAttributes(fe,t),k&&k.enableAttributes(fe,t),B&&B.enableAttributes(fe,t),u.bind(),u.setVertexAttribPointers(fe,t,E);for(const Se of v)Se.bind(),Se.setVertexAttribPointers(fe,t,E);I&&(I.bind(),I.setVertexAttribPointers(fe,t,E)),w&&w.bind(),k&&(k.bind(),k.setVertexAttribPointers(fe,t,E)),B&&(B.bind(),B.setVertexAttribPointers(fe,t,E)),se.currentNumAttributes=te}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function be(f,t){const u=Math.pow(2,t.canonical.z),v=t.canonical.y;return[new c.MercatorCoordinate(0,v/u).toLngLat().lat,new c.MercatorCoordinate(0,(v+1)/u).toLngLat().lat]}function J(f,t,u,v,w,E,I){const k=f.context,B=k.gl,Z=u.fbo;if(!Z)return;f.prepareDrawTile();const te=f.useProgram("hillshade");k.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,Z.colorAttachment.get());const se=((xe,$e,Ee,ke)=>{const Re=Ee.paint.get("hillshade-shadow-color"),st=Ee.paint.get("hillshade-highlight-color"),Ue=Ee.paint.get("hillshade-accent-color");let je=Ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ee.paint.get("hillshade-illumination-anchor")&&(je-=xe.transform.angle);const bt=!xe.options.moving;return{u_matrix:ke||xe.transform.calculateProjMatrix($e.tileID.toUnwrapped(),bt),u_image:0,u_latrange:be(0,$e.tileID),u_light:[Ee.paint.get("hillshade-exaggeration"),je],u_shadow:Re,u_highlight:st,u_accent:Ue}})(f,u,v,f.terrain?t.projMatrix:null);f.prepareDrawProgram(k,te,t.toUnwrapped());const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:Se,tileBoundsSegments:we}=f.getTileBoundsBuffers(u);te.draw(k,B.TRIANGLES,w,E,I,c.CullFaceMode.disabled,se,v.id,fe,Se,we)}function Ae(f,t,u){if(!t.needsDEMTextureUpload)return;const v=f.context,w=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||f.getTileTexture(u.stride);const E=u.getPixels();t.demTexture?t.demTexture.update(E,{premultiply:!1}):t.demTexture=new c.Texture(v,E,w.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function vt(f,t,u,v,w,E){const I=f.context,k=I.gl;if(!t.dem)return;const B=t.dem;if(I.activeTexture.set(k.TEXTURE1),Ae(f,t,B),!t.demTexture)return;t.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const Z=B.dim;I.activeTexture.set(k.TEXTURE0);let te=t.fbo;if(!te){const we=new c.Texture(I,{width:Z,height:Z,data:null},k.RGBA);we.bind(k.LINEAR,k.CLAMP_TO_EDGE),te=t.fbo=I.createFramebuffer(Z,Z,!0),te.colorAttachment.set(we.texture)}I.bindFramebuffer.set(te.framebuffer),I.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:se,tileBoundsIndexBuffer:fe,tileBoundsSegments:Se}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(I,k.TRIANGLES,v,w,E,c.CullFaceMode.disabled,((we,xe)=>{const $e=xe.stride,Ee=c.create();return c.ortho(Ee,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(Ee,Ee,[0,-c.EXTENT,0]),{u_matrix:Ee,u_image:1,u_dimension:[$e,$e],u_zoom:we.overscaledZ,u_unpack:xe.unpackVector}})(t.tileID,B),u.id,se,fe,Se),t.needsHillshadePrepare=!1}const sn=(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_image0:new c.Uniform1i(f,t.u_image0),u_skirt_height:new c.Uniform1f(f,t.u_skirt_height)}),xn=(f,t)=>({u_matrix:f,u_image0:0,u_skirt_height:t}),nn=(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:u,u_zoom_transition:w,u_merc_center:E,u_image0:0,u_frustum_tl:I,u_frustum_tr:k,u_frustum_br:B,u_frustum_bl:Z,u_globe_pos:te,u_globe_radius:se,u_viewport:fe,u_grid_matrix:Se?Float32Array.from(Se):new Float32Array(9)});function wr(f,t){return null!=f&&null!=t&&!(!f.hasData()||!t.hasData())&&null!=f.demTexture&&null!=t.demTexture&&f.tileID.key!==t.tileID.key}const vr=new class{constructor(){this.operations={}}newMorphing(f,t,u,v,w){if(f in this.operations){const E=this.operations[f];E.to.tileID.key!==u.tileID.key&&(E.queued=u)}else this.operations[f]={startTime:v,phase:0,duration:w,from:t,to:u,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const t=this.operations[f];return{from:t.from,to:t.to,phase:t.phase}}update(f){for(const t in this.operations){const u=this.operations[t];for(u.phase=(f-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,f)){delete this.operations[t];break}}}_nextOp(f,t){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=t,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},_r={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Vi(f,t){const u=1<<f.z;return!t&&(0===f.x||f.x===u-1)||0===f.y||f.y===u-1}const kr=f=>({u_matrix:f});function Dr(f,t,u,v,w){if(w>0){const E=c.exported.now(),I=(E-f.timeAdded)/w,k=t?(E-t.timeAdded)/w:-1,B=u.getSource(),Z=v.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),te=!t||Math.abs(t.tileID.overscaledZ-Z)>Math.abs(f.tileID.overscaledZ-Z),se=te&&f.refreshedUponExpiration?1:c.clamp(te?I:1-k,0,1);return f.refreshedUponExpiration&&I>=1&&(f.refreshedUponExpiration=!1),t?{opacity:1,mix:1-se}:{opacity:se,mix:0}}return{opacity:1,mix:0}}class co extends c.SourceCache{constructor(t){const u={type:"raster-dem",maxzoom:t.transform.maxZoom},v=new fi(ti(),null),w=Ot("mock-dem",u,v,t.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,u){t.state="loaded",u(null)}}class il extends c.SourceCache{constructor(t){const u=Ot("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new fi(ti(),null),t.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,u,v){if(t.freezeTileCoverage)return;this.transform=t;const w=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,I)=>{if(E[I.key]="",!this._tiles[I.key]){const k=new c.Tile(I,this._source.tileSize*I.overscaleFactor(),t.tileZoom);k.state="loaded",this._tiles[I.key]=k}return E},{});for(const E in this._tiles)E in w||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(t){const u=this.proxyCachedFBO[t];if(void 0!==u){const v=Object.values(u);this.renderCachePool.push(...v),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class yn extends c.OverscaledTileID{constructor(t,u,v){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=u,this.projMatrix=v}}class ji extends c.Elevation{constructor(t,u){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,w,E]=function(B){const Z=new c.StructArrayLayout4i8,te=new c.StructArrayLayout3ui6;Z.reserve(17161),te.reserve(33800);const fe=c.EXTENT/128,Se=c.EXTENT+fe/2,we=Se+fe;for(let $e=-fe;$e<we;$e+=fe)for(let Ee=-fe;Ee<we;Ee+=fe){const ke=Ee<0||Ee>Se||$e<0||$e>Se?24575:0,Re=c.clamp(Math.round(Ee),0,c.EXTENT),st=c.clamp(Math.round($e),0,c.EXTENT);Z.emplaceBack(Re+ke,st,Re,st)}const xe=($e,Ee)=>{const ke=131*Ee+$e;te.emplaceBack(ke+1,ke,ke+131),te.emplaceBack(ke+131,ke+131+1,ke+1)};for(let $e=1;$e<129;$e++)for(let Ee=1;Ee<129;Ee++)xe(Ee,$e);return[0,129].forEach($e=>{for(let Ee=0;Ee<130;Ee++)xe(Ee,$e),xe($e,Ee)}),[Z,te,32768]}(),I=t.context;this.gridBuffer=I.createVertexBuffer(v,c.boundsAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(w),this.gridSegments=c.SegmentVector.simpleSegment(0,0,v.length,w.length),this.gridNoSkirtSegments=c.SegmentVector.simpleSegment(0,0,v.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new il(u.map),this.orthoMatrix=c.create(),c.ortho(this.orthoMatrix,0,c.EXTENT,0,c.EXTENT,0,1);const k=I.gl;this._overlapStencilMode=new c.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new co(u.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,u,v){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const w=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const E=()=>{this.sourceCache.used&&c.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(u,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),u.updateElevation(!v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&c.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=0===v._centerAltitude&&-1===this.getAtPointOrZero(c.MercatorCoordinate.fromLngLat(v.center),-1),this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=u.getIds().map(B=>{const Z=u.getTileByID(B).tileID;return Z.projMatrix=v.calculateProjMatrix(Z.toUnwrapped()),Z});(function(B,Z){const te=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),se=new c.pointGeometry(te.x,te.y);B.sort((fe,Se)=>{if(Se.overscaledZ-fe.overscaledZ)return Se.overscaledZ-fe.overscaledZ;const we=new c.pointGeometry(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),xe=new c.pointGeometry(Se.canonical.x+(1<<Se.canonical.z)*Se.wrap,Se.canonical.y),$e=se.mult(1<<fe.canonical.z);return $e.x-=.5,$e.y-=.5,$e.distSqr(we)-$e.distSqr(xe)})})(w,this.painter),this._previousZoom=v.zoom;const E=this.proxyToSource||{};this.proxyToSource={},w.forEach(B=>{this.proxyToSource[B.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const B in I){const Z=I[B];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,t[B],E),Z.usedForTerrain))continue;const te=t[B];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(te)}this.proxiedCoords[u.id]=w.map(B=>new yn(B,B.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=c.exported.now();const k={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const Z=this.terrainTileForTile[B.key];if(!Z)continue;const te=Z.tileID.key;te in k||(this._visibleDemTiles.push(Z),k[te]=te)}}_assignTerrainTiles(t){this._initializing||t.forEach(u=>{if(this.terrainTileForTile[u.key])return;const v=this._findTileCoveringTileID(u,this.sourceCache);v&&(this.terrainTileForTile[u.key]=v)})}_prepareDEMTextures(){const t=this.painter.context,u=t.gl;for(const v in this.terrainTileForTile){const w=this.terrainTileForTile[v],E=w.dem;!E||w.demTexture&&!w.needsDEMTextureUpload||(t.activeTexture.set(u.TEXTURE1),Ae(this.painter,w,E))}}_prepareDemTileUniforms(t,u,v,w){if(!u||null==u.demTexture)return!1;const E=t.tileID.canonical,I=Math.pow(2,u.tileID.canonical.z-E.z),k=w||"";return v[`u_dem_tl${k}`]=[E.x*I%1,E.y*I%1],v[`u_dem_scale${k}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,u=t.gl;if(!this._emptyDepthBufferTexture){const v=new c.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new c.Texture(t,v,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const u=this._visibleDemTiles.reduce((v,w)=>{if(!w.dem)return v;const E=w.dem.tree.minimums[0];return E>0&&t++,v+E},0);return t?u/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,u=t.gl;t.activeTexture.set(u.TEXTURE2);const v=this._getLoadedAreaMinimum(),w=new c.RGBAImage({width:1,height:1},new Uint8Array(c.DEMData.pack(v,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(w,{premultiply:!1}):E=this._emptyDEMTexture=new c.Texture(t,w,u.RGBA,{premultiply:!1}),E}setupElevationDraw(t,u,v){const w=this.painter.context,E=w.gl,I=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:c.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var k;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();const B=this.painter.transform,Z=B.projection,te=t.tileID.canonical;I.u_tile_tl_up=Z.upVector(te,0,0),I.u_tile_tr_up=Z.upVector(te,c.EXTENT,0),I.u_tile_br_up=Z.upVector(te,c.EXTENT,c.EXTENT),I.u_tile_bl_up=Z.upVector(te,0,c.EXTENT),I.u_tile_up_scale=v&&v.useDenormalizedUpVectorScale?c.GLOBE_METERS_TO_ECEF:Z.upVectorScale(te,B.center.lat,B.worldSize).metersToTile;let se=null,fe=null,Se=1;if(v&&v.morphing&&this._useVertexMorphing){const we=v.morphing.srcDemTile,xe=v.morphing.dstDemTile;Se=v.morphing.phase,we&&xe&&(this._prepareDemTileUniforms(t,we,I,"_prev")&&(fe=we),this._prepareDemTileUniforms(t,xe,I)&&(se=xe))}if(fe&&se?(w.activeTexture.set(E.TEXTURE2),se.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),w.activeTexture.set(E.TEXTURE4),fe.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),I.u_dem_lerp=Se):(se=this.terrainTileForTile[t.tileID.key],w.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(t,se,I)?se.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),w.activeTexture.set(E.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&se){const we=(1<<se.tileID.canonical.z)*c.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=we}v&&v.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),u.setTerrainUniformValues(w,I)}renderToBackBuffer(t){const u=this.painter,v=this.painter.context;0!==t.length&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,E,I,k,B){if("globe"===w.transform.projection.name)!function(Z,te,se,fe,Se){const we=Z.context,xe=we.gl;let $e,Ee;const ke=Z.options.showTerrainWireframe?2:0,Re=Z.transform,st=c.globeUseCustomAntiAliasing(Z,we,Re),Ue=(it,pn)=>{if(Ee===it)return;const hn=[_r[it],"PROJECTION_GLOBE_VIEW"];st&&hn.push("CUSTOM_ANTIALIASING"),pn&&hn.push(_r[ke]),$e=Z.useProgram("globeRaster",null,hn),Ee=it},je=Z.colorModeForRenderPass(),bt=new c.DepthMode(xe.LEQUAL,c.DepthMode.ReadWrite,Z.depthRangeFor3D);vr.update(Se);const Ht=c.calculateGlobeMercatorMatrix(Re),Zt=[c.mercatorXfromLng(Re.center.lng),c.mercatorYfromLat(Re.center.lat)],$t=Z.globeSharedBuffers,jt=[Re.width*c.exported.devicePixelRatio,Re.height*c.exported.devicePixelRatio];if((ke?[!1,!0]:[!1]).forEach(it=>{Ee=-1;const pn=it?xe.LINES:xe.TRIANGLES;for(const hn of fe){const Un=se.getTile(hn),tn=c.StencilMode.disabled,ci=te.prevTerrainTileForTile[hn.key],Fn=te.terrainTileForTile[hn.key];wr(ci,Fn)&&vr.newMorphing(hn.key,ci,Fn,Se,250),we.activeTexture.set(xe.TEXTURE0),Un.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Vn=vr.getMorphValuesForProxy(hn.key),In=Vn?1:0,Nn={useDenormalizedUpVectorScale:!0};Vn&&c.extend$1(Nn,{morphing:{srcDemTile:Vn.from,dstDemTile:Vn.to,phase:c.easeCubicInOut(Vn.phase)}});const Si=Float32Array.from(Re.globeMatrix),bi=c.globeTileLatLngCorners(hn.canonical),Qi=c.getLatitudinalLod((bi[0][0]+bi[1][0])/2),pi=c.getGridMatrix(hn.canonical,bi,Qi),Gi=c.globeNormalizeECEF(c.globeTileBounds(hn.canonical)),mr=nn(Re.projMatrix,Si,Ht,Gi,c.globeToMercatorTransition(Re.zoom),Zt,Re.frustumCorners.TL,Re.frustumCorners.TR,Re.frustumCorners.BR,Re.frustumCorners.BL,Re.globeCenterInViewSpace,Re.globeRadius,jt,pi);if(Ue(In,it),te.setupElevationDraw(Un,$e,Nn),Z.prepareDrawProgram(we,$e,hn.toUnwrapped()),$t){const[Ir,So,Lr]=it?$t.getWirefameBuffers(Z.context,Qi):$t.getGridBuffers(Qi);$e.draw(we,pn,bt,tn,je,c.CullFaceMode.backCCW,mr,"globe_raster",Ir,So,Lr)}}}),$t){const it=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];st&&it.push("CUSTOM_ANTIALIASING"),$e=Z.useProgram("globeRaster",null,it);for(const pn of fe){const{x:hn,y:Un,z:tn}=pn.canonical,ci=0===Un,Fn=Un===(1<<tn)-1,[Vn,In,Nn,Si]=$t.getPoleBuffers(tn);if(Si&&(ci||Fn)){const bi=se.getTile(pn);we.activeTexture.set(xe.TEXTURE0),bi.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);let Qi=c.globePoleMatrixForTile(tn,hn,Re);const pi=c.globeNormalizeECEF(c.globeTileBounds(pn.canonical)),Gi=(mr,Ir)=>mr.draw(we,xe.TRIANGLES,bt,c.StencilMode.disabled,je,c.CullFaceMode.disabled,nn(Re.projMatrix,Qi,Qi,pi,0,Zt,Re.frustumCorners.TL,Re.frustumCorners.TR,Re.frustumCorners.BR,Re.frustumCorners.BL,Re.globeCenterInViewSpace,Re.globeRadius,jt),"globe_pole_raster",Ir,Nn,Si);te.setupElevationDraw(bi,$e,{}),Z.prepareDrawProgram(we,$e,pn.toUnwrapped()),ci&&Gi($e,Vn),Fn&&(Qi=c.scale(c.create(),Qi,[1,-1,1]),Gi($e,In))}}}}(w,E,I,k,B);else{const Z=w.context,te=Z.gl;let se,fe;const Se=w.options.showTerrainWireframe?2:0,we=(Re,st)=>{if(fe===Re)return;const Ue=[_r[Re]];st&&Ue.push(_r[Se]),se=w.useProgram("terrainRaster",null,Ue),fe=Re},xe=w.colorModeForRenderPass(),$e=new c.DepthMode(te.LEQUAL,c.DepthMode.ReadWrite,w.depthRangeFor3D);vr.update(B);const Ee=w.transform,ke=6*Math.pow(1.5,22-Ee.zoom)*E.exaggeration();(Se?[!1,!0]:[!1]).forEach(Re=>{fe=-1;const st=Re?te.LINES:te.TRIANGLES,[Ue,je]=Re?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const bt of k){const Ht=I.getTile(bt),Zt=c.StencilMode.disabled,$t=E.prevTerrainTileForTile[bt.key],jt=E.terrainTileForTile[bt.key];wr($t,jt)&&vr.newMorphing(bt.key,$t,jt,B,250),Z.activeTexture.set(te.TEXTURE0),Ht.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE,te.LINEAR_MIPMAP_NEAREST);const it=vr.getMorphValuesForProxy(bt.key),pn=it?1:0;let hn;it&&(hn={morphing:{srcDemTile:it.from,dstDemTile:it.to,phase:c.easeCubicInOut(it.phase)}});const Un=xn(bt.projMatrix,Vi(bt.canonical,Ee.renderWorldCopies)?ke/10:ke);we(pn,Re),E.setupElevationDraw(Ht,se,hn),w.prepareDrawProgram(Z,se,bt.toUnwrapped()),se.draw(Z,st,$e,Zt,xe,c.CullFaceMode.backCCW,Un,"terrain_raster",E.gridBuffer,Ue,je)}})}}(u,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const u=this.painter,v=this.painter.context,w=this.proxySourceCache,E=this.proxiedCoords[w.id],I=this._drapedRenderBatches.shift(),k=[],B=u.style.order;let Z=0;for(const te of E){const se=w.getTileByID(te.proxyTileKey),fe=w.proxyCachedFBO[te.key]?w.proxyCachedFBO[te.key][t]:void 0,Se=void 0!==fe?w.renderCache[fe]:this.pool[Z++],we=void 0!==fe;if(se.texture=Se.tex,we&&!Se.dirty){k.push(se.tileID);continue}let xe;v.bindFramebuffer.set(Se.fb.framebuffer),this.renderedToTile=!1,Se.dirty&&(v.clear({color:c.Color.transparent,stencil:0}),Se.dirty=!1);for(let $e=I.start;$e<=I.end;++$e){const Ee=u.style._layers[B[$e]];if(Ee.isHidden(u.transform.zoom))continue;const ke=u.style._getLayerSourceCache(Ee),Re=ke?this.proxyToSource[te.key][ke.id]:[te];if(!Re)continue;const st=Re;v.viewport.set([0,0,Se.fb.width,Se.fb.height]),xe!==(ke?ke.id:null)&&(this._setupStencil(Se,Re,Ee,ke),xe=ke?ke.id:null),u.renderLayer(u,ke,Ee,st)}this.renderedToTile?(Se.dirty=!0,k.push(se.tileID)):we||--Z,5===Z&&(Z=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,u.width,u.height]),I.end+1}postRender(){}renderCacheEfficiency(t){const u=t.order.length;if(0===u)return{efficiency:100};let v,w=0,E=0,I=!1;for(let k=0;k<u;++k){const B=t._layers[t.order[k]];this._style.isLayerDraped(B)?(I&&++w,++E):I||(I=!0,v=B.id)}return 0===E?{efficiency:100}:{efficiency:100*(1-w/E),firstUndrapedLayer:v}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{t=Math.min(t,u.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,u,v){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const I=E.tileID,k=Math.pow(2,I.overscaledZ),{x:B,y:Z}=I.canonical,te=B/k,se=(B+1)/k,fe=Z/k,Se=(Z+1)/k;return{minx:te,miny:fe,maxx:se,maxy:Se,t:E.dem.tree.raycastRoot(te,fe,se,Se,t,u,v),tile:E}});w.sort((E,I)=>(null!==E.t?E.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const E of w){if(null==E.t)return null;const I=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,t,u,v);if(null!=I)return I}return null}_createFBO(){const t=this.painter.context,u=t.gl,v=this.drapeBufferSize;t.activeTexture.set(u.TEXTURE0);const w=new c.Texture(t,{width:v[0],height:v[1],data:null},u.RGBA);w.bind(u.LINEAR,u.CLAMP_TO_EDGE);const E=t.createFramebuffer(v[0],v[1],!1);return E.colorAttachment.set(w.texture),E.depthAttachment=new Y(t,E.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:E,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const u=this._style._layers[t],v=u.isHidden(this.painter.transform.zoom),w=u.getCrossfadeParameters(),E=!!w&&1!==w.t,I=u.hasTransition();return"custom"!==u.type&&!v&&(E||I)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u]._source instanceof He){t=!0;break}if(t)for(let u=0;u<this._style.order.length;++u){const v=this._style._layers[this._style.order[u]],w=v.isHidden(this.painter.transform.zoom),E=this._style._getLayerSourceCache(v);if("raster"!==v.type||w||!E)continue;const I=v.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const B=this.proxyToSource[k.key][E.id];if(B)for(const Z of B){const te=Dr(E.getTile(Z),E.findLoadedParent(Z,0),E,this.painter.transform,I);(1!==te.opacity||0!==te.mix)&&this._clearRenderCacheForTile(E.id,Z)}}}}_setupDrapedRenderBatches(){const t=this._style.order,u=t.length;if(0===u)return;const v=[];let w,E=0,I=this._style._layers[t[E]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++E<u;)I=this._style._layers[t[E]];for(;E<u;++E){const k=this._style._layers[t[E]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?void 0===w&&(w=E):void 0!==w&&(v.push({start:w,end:E-1}),w=void 0))}void 0!==w&&v.push({start:w,end:E-1}),this._drapedRenderBatches=v}_setupRenderCache(t){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const I=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let k=0;k<I.length;++k){const B=Object.values(I[k]);u.renderCachePool.push(...B)}}return}this._clearRasterFadeFromRenderCache();const v=this.proxyCoords,w=this._tilesDirty;for(let I=v.length-1;I>=0;I--){const k=v[I];if(u.getTileByID(k.key),void 0!==u.proxyCachedFBO[k.key]){const B=t[k.key],Z=this.proxyToSource[k.key];let te=0;for(const se in Z){const fe=Z[se],Se=B[se];if(!Se||Se.length!==fe.length||fe.some((we,xe)=>we!==Se[xe]||w[se]&&w[se].hasOwnProperty(we.key))){te=-1;break}++te}for(const se in u.proxyCachedFBO[k.key])u.renderCache[u.proxyCachedFBO[k.key][se]].dirty=te<0||te!==Object.values(B).length}}const E=[...this._drapedRenderBatches];E.sort((I,k)=>k.end-k.start-(I.end-I.start));for(const I of E)for(const k of v){if(u.proxyCachedFBO[k.key])continue;let B=u.renderCachePool.pop();void 0===B&&u.renderCache.length<50&&(B=u.renderCache.length,u.renderCache.push(this._createFBO())),void 0!==B&&(u.proxyCachedFBO[k.key]={},u.proxyCachedFBO[k.key][I.start]=B,u.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(t,u,v,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,I=E.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let k;if(v.isTileClipped())k=u.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):c.StencilMode.disabled}_renderTileClippingMasks(t,u){const v=this.painter,w=this.painter.context,E=w.gl;v._tileClippingMaskIDs={},w.setColorMode(c.ColorMode.disabled),w.setDepthMode(c.DepthMode.disabled);const I=v.useProgram("clippingMask");for(const k of t){const B=v._tileClippingMaskIDs[k.key]=--u;I.draw(w,E.TRIANGLES,c.DepthMode.disabled,new c.StencilMode({func:E.ALWAYS,mask:0},B,255,E.KEEP,E.KEEP,E.REPLACE),c.ColorMode.disabled,c.CullFaceMode.disabled,kr(k.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(t){const u=this.painter.transform;if(t.x<0||t.x>u.width||t.y<0||t.y>u.height)return null;const v=[t.x,t.y,1,1];c.transformMat4$1(v,v,u.pixelMatrixInverse),c.scale$1(v,v,1/v[3]),v[0]/=u.worldSize,v[1]/=u.worldSize;const w=u._camera.position,E=c.mercatorZfromAltitude(1,u.center.lat),I=[w[0],w[1],w[2]/E,0],k=c.subtract([],v.slice(0,3),I);c.normalize(k,k);const B=this.raycast(I,k,this._exaggeration);return null!==B&&B?(c.scaleAndAdd(I,I,k,B),I[3]=I[2],I[2]*=E,I):null}drawDepth(){const t=this.painter,u=t.context,v=this.proxySourceCache,w=Math.ceil(t.width),E=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=u.gl,k=u.createFramebuffer(w,E,!0);u.activeTexture.set(I.TEXTURE0);const B=new c.Texture(u,{width:w,height:E,data:null},I.RGBA);B.bind(I.NEAREST,I.CLAMP_TO_EDGE),k.colorAttachment.set(B.texture);const Z=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,w,E);k.depthAttachment.set(Z),this._depthFBO=k,this._depthTexture=B}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,w,E]),function(I,k,B,Z){if("globe"===I.transform.projection.name)return;const te=I.context,se=te.gl;te.clear({depth:1});const fe=I.useProgram("terrainDepth"),Se=new c.DepthMode(se.LESS,c.DepthMode.ReadWrite,I.depthRangeFor3D);for(const we of Z){const xe=B.getTile(we),$e=xn(we.projMatrix,0);k.setupElevationDraw(xe,fe),fe.draw(te,se.TRIANGLES,Se,c.StencilMode.disabled,c.ColorMode.unblended,c.CullFaceMode.backCCW,$e,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(t,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,u,v){if(t.getSource()instanceof Ct)return this._setupProxiedCoordsForImageSource(t,u,v);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const w=this.proxiedCoords[t.id]=[],E=this.proxyCoords;for(let k=0;k<E.length;k++){const B=E[k],Z=this._findTileCoveringTileID(B,t);if(Z){const te=this._createProxiedId(B,Z,v[B.key]&&v[B.key][t.id]);w.push(te),this.proxyToSource[B.key][t.id]=[te]}}let I=!1;for(let k=0;k<u.length;k++){const B=t.getTile(u[k]);if(!B||!B.hasData())continue;const Z=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==B.tileID.canonical.z){const te=this.proxyToSource[Z.tileID.key][t.id],se=this._createProxiedId(Z.tileID,B,v[Z.tileID.key]&&v[Z.tileID.key][t.id]);te?te.splice(te.length-1,0,se):this.proxyToSource[Z.tileID.key][t.id]=[se],w.push(se),I=!0}}this._sourceTilesOverlap[t.id]=I}_setupProxiedCoordsForImageSource(t,u,v){if(!t.getSource().loaded())return;const w=this.proxiedCoords[t.id]=[],E=this.proxyCoords,I=t.getSource(),k=new c.pointGeometry(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),B=I.coordinates.map(c.MercatorCoordinate.fromLngLat).reduce((te,se)=>(te.min.x=Math.min(te.min.x,se.x-k.x),te.min.y=Math.min(te.min.y,se.y-k.y),te.max.x=Math.max(te.max.x,se.x-k.x),te.max.y=Math.max(te.max.y,se.y-k.y),te),{min:new c.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new c.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(te,se)=>{const fe=te.wrap+te.canonical.x/(1<<te.canonical.z),Se=te.canonical.y/(1<<te.canonical.z),we=c.EXTENT/(1<<te.canonical.z),xe=se.wrap+se.canonical.x/(1<<se.canonical.z),$e=se.canonical.y/(1<<se.canonical.z);return fe+we<xe+B.min.x||fe>xe+B.max.x||Se+we<$e+B.min.y||Se>$e+B.max.y};for(let te=0;te<E.length;te++){const se=E[te];for(let fe=0;fe<u.length;fe++){const Se=t.getTile(u[fe]);if(!Se||!Se.hasData()||Z(se,Se.tileID))continue;const we=this._createProxiedId(se,Se,v[se.key]&&v[se.key][t.id]),xe=this.proxyToSource[se.key][t.id];xe?xe.push(we):this.proxyToSource[se.key][t.id]=[we],w.push(we)}}}_createProxiedId(t,u,v){let w=this.orthoMatrix;if(v){const E=v.find(I=>I.key===u.tileID.key);if(E)return E}if(u.tileID.key!==t.key){const E=t.canonical.z-u.tileID.canonical.z;let I,k,B;w=c.create();const Z=u.tileID.wrap-t.wrap<<t.overscaledZ;E>0?(I=c.EXTENT>>E,k=I*((u.tileID.canonical.x<<E)-t.canonical.x+Z),B=I*((u.tileID.canonical.y<<E)-t.canonical.y)):(I=c.EXTENT<<-E,k=c.EXTENT*(u.tileID.canonical.x-(t.canonical.x+Z<<-E)),B=c.EXTENT*(u.tileID.canonical.y-(t.canonical.y<<-E))),c.ortho(w,0,I,0,I,0,1),c.translate(w,w,[k,B,0])}return new yn(u.tileID,t.key,w)}_findTileCoveringTileID(t,u){let v=u.getTile(t);if(v&&v.hasData())return v;const w=this._findCoveringTileCache[u.id],E=w[t.key];if(v=E?u.getTileByID(E):null,v&&v.hasData()||null===E)return v;let I=v?v.tileID:t,k=I.overscaledZ;const B=u.getSource().minzoom,Z=[];if(!E){const se=u.getSource().maxzoom;if(t.canonical.z>=se){const fe=t.canonical.z-se;u.getSource().reparseOverscaled?(k=Math.max(t.canonical.z+2,u.transform.tileZoom),I=new c.OverscaledTileID(k,t.wrap,se,t.canonical.x>>fe,t.canonical.y>>fe)):0!==fe&&(k=se,I=new c.OverscaledTileID(k,t.wrap,se,t.canonical.x>>fe,t.canonical.y>>fe))}I.key!==t.key&&(Z.push(I.key),v=u.getTile(I))}const te=se=>{Z.forEach(fe=>{w[fe]=se}),Z.length=0};for(k-=1;k>=B&&(!v||!v.hasData());k--){v&&te(v.tileID.key);const se=I.calculateScaledKey(k);if(v=u.getTileByID(se),v&&v.hasData())break;const fe=w[se];if(null===fe)break;void 0===fe?Z.push(se):v=u.getTileByID(fe)}return te(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,u){let v=this._tilesDirty[t];v||(v=this._tilesDirty[t]={}),v[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(u){let v=0;const w=new c.StructArrayLayout2ui4,E=131;for(let I=1;I<129;I++){for(let k=1;k<129;k++)v=I*E+k,w.emplaceBack(v,v+1),w.emplaceBack(v,v+E),w.emplaceBack(v+1,v+E),128===I&&w.emplaceBack(v+E,v+E+1);w.emplaceBack(v+1,v+1+E)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=c.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Eo(f){const t=[];for(let u=0;u<f.length;u++){if(null===f[u])continue;const v=f[u].split(" ");t.push(v.pop())}return t}class rl{static cacheKey(t,u,v){let w=`${t}${v?v.cacheKey:""}`;for(const E of u)w+=`/${E}`;return w}constructor(t,u,v,w,E,I){const k=t.gl;this.program=k.createProgram();const B=Eo(v.staticAttributes),Z=w?w.getBinderAttributes():[],te=B.concat(Z),se=v.staticUniforms?Eo(v.staticUniforms):[],fe=w?w.getBinderUniforms():[],Se=se.concat(fe),we=[];for(const Ue of Se)we.indexOf(Ue)<0&&we.push(Ue);let xe=w?w.defines():[];xe=xe.concat(I.map(Ue=>`#define ${Ue}`));const $e=xe.concat(t.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(Co):Co,Co,vo,ua.fragmentSource,Ws.fragmentSource,v.fragmentSource).join("\n"),Ee=xe.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",vo,ua.vertexSource,Ws.vertexSource,za.vertexSource,v.vertexSource).join("\n"),ke=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ke,$e),k.compileShader(ke),k.attachShader(this.program,ke);const Re=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Re,Ee),k.compileShader(Re),k.attachShader(this.program,Re),this.attributes={};const st={};this.numAttributes=te.length;for(let Ue=0;Ue<this.numAttributes;Ue++)te[Ue]&&(k.bindAttribLocation(this.program,Ue,te[Ue]),this.attributes[te[Ue]]=Ue);k.linkProgram(this.program),k.deleteShader(Re),k.deleteShader(ke);for(let Ue=0;Ue<we.length;Ue++){const je=we[Ue];if(je&&!st[je]){const bt=k.getUniformLocation(this.program,je);bt&&(st[je]=bt)}}var Ue,je;this.fixedUniforms=E(t,st),this.binderUniforms=w?w.getUniforms(t,st):[],-1!==I.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new c.Uniform1i(Ue=t,(je=st).u_dem),u_dem_prev:new c.Uniform1i(Ue,je.u_dem_prev),u_dem_unpack:new c.Uniform4f(Ue,je.u_dem_unpack),u_dem_tl:new c.Uniform2f(Ue,je.u_dem_tl),u_dem_scale:new c.Uniform1f(Ue,je.u_dem_scale),u_dem_tl_prev:new c.Uniform2f(Ue,je.u_dem_tl_prev),u_dem_scale_prev:new c.Uniform1f(Ue,je.u_dem_scale_prev),u_dem_size:new c.Uniform1f(Ue,je.u_dem_size),u_dem_lerp:new c.Uniform1f(Ue,je.u_dem_lerp),u_exaggeration:new c.Uniform1f(Ue,je.u_exaggeration),u_depth:new c.Uniform1i(Ue,je.u_depth),u_depth_size_inv:new c.Uniform2f(Ue,je.u_depth_size_inv),u_meter_to_dem:new c.Uniform1f(Ue,je.u_meter_to_dem),u_label_plane_matrix_inv:new c.UniformMatrix4f(Ue,je.u_label_plane_matrix_inv),u_tile_tl_up:new c.Uniform3f(Ue,je.u_tile_tl_up),u_tile_tr_up:new c.Uniform3f(Ue,je.u_tile_tr_up),u_tile_br_up:new c.Uniform3f(Ue,je.u_tile_br_up),u_tile_bl_up:new c.Uniform3f(Ue,je.u_tile_bl_up),u_tile_up_scale:new c.Uniform1f(Ue,je.u_tile_up_scale)}),-1!==I.indexOf("FOG")&&(this.fogUniforms=((Ue,je)=>({u_fog_matrix:new c.UniformMatrix4f(Ue,je.u_fog_matrix),u_fog_range:new c.Uniform2f(Ue,je.u_fog_range),u_fog_color:new c.Uniform4f(Ue,je.u_fog_color),u_fog_horizon_blend:new c.Uniform1f(Ue,je.u_fog_horizon_blend),u_fog_temporal_offset:new c.Uniform1f(Ue,je.u_fog_temporal_offset),u_frustum_tl:new c.Uniform3f(Ue,je.u_frustum_tl),u_frustum_tr:new c.Uniform3f(Ue,je.u_frustum_tr),u_frustum_br:new c.Uniform3f(Ue,je.u_frustum_br),u_frustum_bl:new c.Uniform3f(Ue,je.u_frustum_bl),u_globe_pos:new c.Uniform3f(Ue,je.u_globe_pos),u_globe_radius:new c.Uniform1f(Ue,je.u_globe_radius),u_globe_transition:new c.Uniform1f(Ue,je.u_globe_transition),u_is_globe:new c.Uniform1i(Ue,je.u_is_globe),u_viewport:new c.Uniform2f(Ue,je.u_viewport)}))(t,st))}setTerrainUniformValues(t,u){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const w in u)v[w].set(u[w])}}setFogUniformValues(t,u){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const w in u)v[w].location&&v[w].set(u[w])}}draw(t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe,$e,Ee){const ke=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(v),t.setStencilMode(w),t.setColorMode(E),t.setCullFace(I);for(const st of Object.keys(this.fixedUniforms))this.fixedUniforms[st].set(k[st]);we&&we.setUniforms(t,this.binderUniforms,fe,{zoom:Se});const Re={[ke.LINES]:2,[ke.TRIANGLES]:3,[ke.LINE_STRIP]:1}[u];for(const st of se.get()){const Ue=st.vaos||(st.vaos={});(Ue[B]||(Ue[B]=new X)).bind(t,this,Z,we?we.getPaintVertexBuffers():[],te,st.vertexOffset,xe,$e,Ee),ke.drawElements(u,st.primitiveLength*Re,ke.UNSIGNED_SHORT,st.primitiveOffset*Re*2)}}}function qr(f,t,u){const v=1/On(u,1,t.transform.tileZoom),w=Math.pow(2,u.tileID.overscaledZ),E=u.tileSize*Math.pow(2,t.transform.tileZoom)/w,I=E*(u.tileID.canonical.x+u.tileID.wrap*w),k=E*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[v,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[I>>16,k>>16],u_pixel_coord_lower:[65535&I,65535&k]}}const ol=c.create(),ne=(f,t,u,v,w,E,I,k,B)=>{const Z=t.style.light,te=Z.properties.get("position"),se=[te.x,te.y,te.z],fe=c.create$1();"viewport"===Z.properties.get("anchor")&&(c.fromRotation(fe,-t.transform.angle),c.transformMat3(se,se,fe));const Se=Z.properties.get("color"),we=t.transform,xe={u_matrix:f,u_lightpos:se,u_lightintensity:Z.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+u,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ol,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return"globe"===we.projection.name&&(xe.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],xe.u_zoom_transition=I,xe.u_inv_rot_matrix=B,xe.u_merc_center=k,xe.u_up_dir=we.projection.upVector(new c.CanonicalTileID(0,0,0),k[0]*c.EXTENT,k[1]*c.EXTENT),xe.u_height_lift=E),xe},q=(f,t,u,v,w,E,I,k,B,Z,te)=>{const se=ne(f,t,u,v,w,k,B,Z,te),fe={u_height_factor:-Math.pow(2,w.overscaledZ)/I.tileSize/8};return c.extend(se,qr(E,t,I),fe)},$=f=>({u_matrix:f}),me=(f,t,u,v)=>c.extend($(f),qr(u,t,v)),cn=(f,t)=>({u_matrix:f,u_world:t}),Ci=(f,t,u,v,w)=>c.extend(me(f,t,u,v),{u_world:w}),Ar=c.create(),bs=(f,t,u,v,w,E)=>{const I=f.transform,k="globe"===I.projection.name;let B;if("map"===E.paint.get("circle-pitch-alignment"))if(k){const te=c.globePixelsToTileUnits(I.zoom,t.canonical)*I._projectionScaler;B=Float32Array.from([te,0,0,te])}else B=I.calculatePixelsToTileUnitsMatrix(u);else B=new Float32Array([I.pixelsToGLUnits[0],0,0,I.pixelsToGLUnits[1]]);const Z={u_camera_to_center_distance:I.cameraToCenterDistance,u_matrix:f.translatePosMatrix(t.projMatrix,u,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:c.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:Ar,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){Z.u_inv_rot_matrix=v,Z.u_merc_center=w,Z.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],Z.u_zoom_transition=c.globeToMercatorTransition(I.zoom);const te=w[0]*c.EXTENT,se=w[1]*c.EXTENT;Z.u_up_dir=I.projection.upVector(new c.CanonicalTileID(0,0,0),te,se)}return Z},eo=f=>{const t=[];return"map"===f.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===f.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},us=(f,t,u,v)=>{const w=c.EXTENT/u.tileSize;return{u_matrix:f,u_camera_to_center_distance:t.getCameraToCenterDistance(v),u_extrude_scale:[t.pixelsToGLUnits[0]/w,t.pixelsToGLUnits[1]/w]}},ru=(f,t,u=1)=>({u_matrix:f,u_color:t,u_overlay:0,u_overlay_scale:u}),sl=c.create(),al=(f,t,u,v,w,E,I)=>{const k=f.transform,B="globe"===k.projection.name,Z=B?c.globePixelsToTileUnits(k.zoom,t.canonical)*k._projectionScaler:On(u,1,E),te={u_matrix:t.projMatrix,u_extrude_scale:Z,u_intensity:I,u_inv_rot_matrix:sl,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){te.u_inv_rot_matrix=v,te.u_merc_center=w,te.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],te.u_zoom_transition=c.globeToMercatorTransition(k.zoom);const se=w[0]*c.EXTENT,fe=w[1]*c.EXTENT;te.u_up_dir=k.projection.upVector(new c.CanonicalTileID(0,0,0),se,fe)}return te},zu=(f,t,u,v,w,E,I,k)=>{const B=f.transform,Z=B.calculatePixelsToTileUnitsMatrix(t),te={u_matrix:Nu(f,t,u,w),u_pixels_to_tile_units:Z,u_device_pixel_ratio:I,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:E,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:k};if(tc(u)){const se=Ac(t,f.transform);te.u_texsize=t.lineAtlasTexture.size,te.u_scale=[se,v.fromScale,v.toScale],te.u_mix=v.t}return te},Pd=(f,t,u,v,w,E)=>{const I=f.transform,k=Ac(t,I);return{u_matrix:Nu(f,t,u,w),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:I.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:E,u_image:0,u_scale:[k,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ac(f,t){return 1/On(f,1,t.tileZoom)}function Nu(f,t,u,v){return f.translatePosMatrix(v||t.tileID.projMatrix,t,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function tc(f){const t=f.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const nc=(f,t,u,v,w,E)=>{return{u_matrix:f,u_tl_parent:t,u_scale_parent:u,u_fade_t:v.mix,u_opacity:v.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(k=w.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(I=w.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Il(w.paint.get("raster-hue-rotate")),u_perspective_transform:E};var I,k};function Il(f){f*=Math.PI/180;const t=Math.sin(f),u=Math.cos(f);return[(2*u+1)/3,(-Math.sqrt(3)*t-u+1)/3,(Math.sqrt(3)*t-u+1)/3]}const Pl=c.create(),yl=(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe)=>{const $e=w.transform,Ee={u_is_size_zoom_constant:+("constant"===f||"source"===f),u_is_size_feature_constant:+("constant"===f||"camera"===f),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:$e.width/$e.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:I,u_coord_matrix:k,u_is_text:+B,u_pitch_with_map:+v,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Pl,u_up_vector:[0,-1,0]};return"globe"===xe.name&&(Ee.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],Ee.u_zoom_transition=se,Ee.u_inv_rot_matrix=Se,Ee.u_merc_center=fe,Ee.u_camera_forward=$e._camera.forward(),Ee.u_ecef_origin=c.globeECEFOrigin($e.globeMatrix,te.toUnwrapped()),Ee.u_tile_matrix=Float32Array.from($e.globeMatrix),Ee.u_up_vector=we),Ee},Od=(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe,$e)=>c.extend(yl(f,t,u,v,w,E,I,k,B,Z,se,fe,Se,we,xe,$e),{u_gamma_scale:v?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:c.exported.devicePixelRatio,u_is_halo:+te}),Vu=(f,t,u,v,w,E,I,k,B,Z,te,se,fe,Se,we,xe)=>c.extend(Od(f,t,u,v,w,E,I,k,!0,B,!0,te,se,fe,Se,we,xe),{u_texsize_icon:Z,u_texture_icon:1}),kd=(f,t,u)=>({u_matrix:f,u_opacity:t,u_color:u}),ds=(f,t,u,v,w,E)=>c.extend(function(I,k,B,Z){const te=B.imageManager.getPattern(I.from.toString()),se=B.imageManager.getPattern(I.to.toString()),{width:fe,height:Se}=B.imageManager.getPixelSize(),we=Math.pow(2,Z.tileID.overscaledZ),xe=Z.tileSize*Math.pow(2,B.transform.tileZoom)/we,$e=xe*(Z.tileID.canonical.x+Z.tileID.wrap*we),Ee=xe*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:te.tl,u_pattern_br_a:te.br,u_pattern_tl_b:se.tl,u_pattern_br_b:se.br,u_texsize:[fe,Se],u_mix:k.t,u_pattern_size_a:te.displaySize,u_pattern_size_b:se.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/On(Z,1,B.transform.tileZoom),u_pixel_coord_upper:[$e>>16,Ee>>16],u_pixel_coord_lower:[65535&$e,65535&Ee]}}(v,E,u,w),{u_matrix:f,u_opacity:t}),ic={fillExtrusion:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_lightpos:new c.Uniform3f(f,t.u_lightpos),u_lightintensity:new c.Uniform1f(f,t.u_lightintensity),u_lightcolor:new c.Uniform3f(f,t.u_lightcolor),u_vertical_gradient:new c.Uniform1f(f,t.u_vertical_gradient),u_opacity:new c.Uniform1f(f,t.u_opacity),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_up_dir:new c.Uniform3f(f,t.u_up_dir),u_height_lift:new c.Uniform1f(f,t.u_height_lift)}),fillExtrusionPattern:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_lightpos:new c.Uniform3f(f,t.u_lightpos),u_lightintensity:new c.Uniform1f(f,t.u_lightintensity),u_lightcolor:new c.Uniform3f(f,t.u_lightcolor),u_vertical_gradient:new c.Uniform1f(f,t.u_vertical_gradient),u_height_factor:new c.Uniform1f(f,t.u_height_factor),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_up_dir:new c.Uniform3f(f,t.u_up_dir),u_height_lift:new c.Uniform1f(f,t.u_height_lift),u_image:new c.Uniform1i(f,t.u_image),u_texsize:new c.Uniform2f(f,t.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,t.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,t.u_scale),u_fade:new c.Uniform1f(f,t.u_fade),u_opacity:new c.Uniform1f(f,t.u_opacity)}),fill:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix)}),fillPattern:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_image:new c.Uniform1i(f,t.u_image),u_texsize:new c.Uniform2f(f,t.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,t.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,t.u_scale),u_fade:new c.Uniform1f(f,t.u_fade)}),fillOutline:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_world:new c.Uniform2f(f,t.u_world)}),fillOutlinePattern:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_world:new c.Uniform2f(f,t.u_world),u_image:new c.Uniform1i(f,t.u_image),u_texsize:new c.Uniform2f(f,t.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,t.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,t.u_scale),u_fade:new c.Uniform1f(f,t.u_fade)}),circle:(f,t)=>({u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_extrude_scale:new c.UniformMatrix2f(f,t.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(f,t.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_up_dir:new c.Uniform3f(f,t.u_up_dir)}),collisionBox:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_extrude_scale:new c.Uniform2f(f,t.u_extrude_scale)}),collisionCircle:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_inv_matrix:new c.UniformMatrix4f(f,t.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(f,t.u_viewport_size)}),debug:(f,t)=>({u_color:new c.UniformColor(f,t.u_color),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_overlay:new c.Uniform1i(f,t.u_overlay),u_overlay_scale:new c.Uniform1f(f,t.u_overlay_scale)}),clippingMask:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix)}),heatmap:(f,t)=>({u_extrude_scale:new c.Uniform1f(f,t.u_extrude_scale),u_intensity:new c.Uniform1f(f,t.u_intensity),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_up_dir:new c.Uniform3f(f,t.u_up_dir)}),heatmapTexture:(f,t)=>({u_image:new c.Uniform1i(f,t.u_image),u_color_ramp:new c.Uniform1i(f,t.u_color_ramp),u_opacity:new c.Uniform1f(f,t.u_opacity)}),hillshade:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_image:new c.Uniform1i(f,t.u_image),u_latrange:new c.Uniform2f(f,t.u_latrange),u_light:new c.Uniform2f(f,t.u_light),u_shadow:new c.UniformColor(f,t.u_shadow),u_highlight:new c.UniformColor(f,t.u_highlight),u_accent:new c.UniformColor(f,t.u_accent)}),hillshadePrepare:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_image:new c.Uniform1i(f,t.u_image),u_dimension:new c.Uniform2f(f,t.u_dimension),u_zoom:new c.Uniform1f(f,t.u_zoom),u_unpack:new c.Uniform4f(f,t.u_unpack)}),line:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_pixels_to_tile_units:new c.UniformMatrix2f(f,t.u_pixels_to_tile_units),u_device_pixel_ratio:new c.Uniform1f(f,t.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(f,t.u_units_to_pixels),u_dash_image:new c.Uniform1i(f,t.u_dash_image),u_gradient_image:new c.Uniform1i(f,t.u_gradient_image),u_image_height:new c.Uniform1f(f,t.u_image_height),u_texsize:new c.Uniform2f(f,t.u_texsize),u_scale:new c.Uniform3f(f,t.u_scale),u_mix:new c.Uniform1f(f,t.u_mix),u_alpha_discard_threshold:new c.Uniform1f(f,t.u_alpha_discard_threshold),u_trim_offset:new c.Uniform2f(f,t.u_trim_offset)}),linePattern:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_texsize:new c.Uniform2f(f,t.u_texsize),u_pixels_to_tile_units:new c.UniformMatrix2f(f,t.u_pixels_to_tile_units),u_device_pixel_ratio:new c.Uniform1f(f,t.u_device_pixel_ratio),u_image:new c.Uniform1i(f,t.u_image),u_units_to_pixels:new c.Uniform2f(f,t.u_units_to_pixels),u_scale:new c.Uniform3f(f,t.u_scale),u_fade:new c.Uniform1f(f,t.u_fade),u_alpha_discard_threshold:new c.Uniform1f(f,t.u_alpha_discard_threshold)}),raster:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_tl_parent:new c.Uniform2f(f,t.u_tl_parent),u_scale_parent:new c.Uniform1f(f,t.u_scale_parent),u_fade_t:new c.Uniform1f(f,t.u_fade_t),u_opacity:new c.Uniform1f(f,t.u_opacity),u_image0:new c.Uniform1i(f,t.u_image0),u_image1:new c.Uniform1i(f,t.u_image1),u_brightness_low:new c.Uniform1f(f,t.u_brightness_low),u_brightness_high:new c.Uniform1f(f,t.u_brightness_high),u_saturation_factor:new c.Uniform1f(f,t.u_saturation_factor),u_contrast_factor:new c.Uniform1f(f,t.u_contrast_factor),u_spin_weights:new c.Uniform3f(f,t.u_spin_weights),u_perspective_transform:new c.Uniform2f(f,t.u_perspective_transform)}),symbolIcon:(f,t)=>({u_is_size_zoom_constant:new c.Uniform1i(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,t.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,t.u_size_t),u_size:new c.Uniform1f(f,t.u_size),u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_rotate_symbol:new c.Uniform1i(f,t.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,t.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,t.u_fade_change),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,t.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,t.u_coord_matrix),u_is_text:new c.Uniform1i(f,t.u_is_text),u_pitch_with_map:new c.Uniform1i(f,t.u_pitch_with_map),u_texsize:new c.Uniform2f(f,t.u_texsize),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_camera_forward:new c.Uniform3f(f,t.u_camera_forward),u_tile_matrix:new c.UniformMatrix4f(f,t.u_tile_matrix),u_up_vector:new c.Uniform3f(f,t.u_up_vector),u_ecef_origin:new c.Uniform3f(f,t.u_ecef_origin),u_texture:new c.Uniform1i(f,t.u_texture)}),symbolSDF:(f,t)=>({u_is_size_zoom_constant:new c.Uniform1i(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,t.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,t.u_size_t),u_size:new c.Uniform1f(f,t.u_size),u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_rotate_symbol:new c.Uniform1i(f,t.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,t.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,t.u_fade_change),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,t.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,t.u_coord_matrix),u_is_text:new c.Uniform1i(f,t.u_is_text),u_pitch_with_map:new c.Uniform1i(f,t.u_pitch_with_map),u_texsize:new c.Uniform2f(f,t.u_texsize),u_texture:new c.Uniform1i(f,t.u_texture),u_gamma_scale:new c.Uniform1f(f,t.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(f,t.u_device_pixel_ratio),u_tile_id:new c.Uniform3f(f,t.u_tile_id),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_inv_rot_matrix:new c.UniformMatrix4f(f,t.u_inv_rot_matrix),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_camera_forward:new c.Uniform3f(f,t.u_camera_forward),u_tile_matrix:new c.UniformMatrix4f(f,t.u_tile_matrix),u_up_vector:new c.Uniform3f(f,t.u_up_vector),u_ecef_origin:new c.Uniform3f(f,t.u_ecef_origin),u_is_halo:new c.Uniform1i(f,t.u_is_halo)}),symbolTextAndIcon:(f,t)=>({u_is_size_zoom_constant:new c.Uniform1i(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,t.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,t.u_size_t),u_size:new c.Uniform1f(f,t.u_size),u_camera_to_center_distance:new c.Uniform1f(f,t.u_camera_to_center_distance),u_rotate_symbol:new c.Uniform1i(f,t.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,t.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,t.u_fade_change),u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,t.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,t.u_coord_matrix),u_is_text:new c.Uniform1i(f,t.u_is_text),u_pitch_with_map:new c.Uniform1i(f,t.u_pitch_with_map),u_texsize:new c.Uniform2f(f,t.u_texsize),u_texsize_icon:new c.Uniform2f(f,t.u_texsize_icon),u_texture:new c.Uniform1i(f,t.u_texture),u_texture_icon:new c.Uniform1i(f,t.u_texture_icon),u_gamma_scale:new c.Uniform1f(f,t.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(f,t.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(f,t.u_is_halo)}),background:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_opacity:new c.Uniform1f(f,t.u_opacity),u_color:new c.UniformColor(f,t.u_color)}),backgroundPattern:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_opacity:new c.Uniform1f(f,t.u_opacity),u_image:new c.Uniform1i(f,t.u_image),u_pattern_tl_a:new c.Uniform2f(f,t.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(f,t.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(f,t.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(f,t.u_pattern_br_b),u_texsize:new c.Uniform2f(f,t.u_texsize),u_mix:new c.Uniform1f(f,t.u_mix),u_pattern_size_a:new c.Uniform2f(f,t.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(f,t.u_pattern_size_b),u_scale_a:new c.Uniform1f(f,t.u_scale_a),u_scale_b:new c.Uniform1f(f,t.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(f,t.u_tile_units_to_pixels)}),terrainRaster:sn,terrainDepth:sn,skybox:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_sun_direction:new c.Uniform3f(f,t.u_sun_direction),u_cubemap:new c.Uniform1i(f,t.u_cubemap),u_opacity:new c.Uniform1f(f,t.u_opacity),u_temporal_offset:new c.Uniform1f(f,t.u_temporal_offset)}),skyboxGradient:(f,t)=>({u_matrix:new c.UniformMatrix4f(f,t.u_matrix),u_color_ramp:new c.Uniform1i(f,t.u_color_ramp),u_center_direction:new c.Uniform3f(f,t.u_center_direction),u_radius:new c.Uniform1f(f,t.u_radius),u_opacity:new c.Uniform1f(f,t.u_opacity),u_temporal_offset:new c.Uniform1f(f,t.u_temporal_offset)}),skyboxCapture:(f,t)=>({u_matrix_3f:new c.UniformMatrix3f(f,t.u_matrix_3f),u_sun_direction:new c.Uniform3f(f,t.u_sun_direction),u_sun_intensity:new c.Uniform1f(f,t.u_sun_intensity),u_color_tint_r:new c.Uniform4f(f,t.u_color_tint_r),u_color_tint_m:new c.Uniform4f(f,t.u_color_tint_m),u_luminance:new c.Uniform1f(f,t.u_luminance)}),globeRaster:(f,t)=>({u_proj_matrix:new c.UniformMatrix4f(f,t.u_proj_matrix),u_globe_matrix:new c.UniformMatrix4f(f,t.u_globe_matrix),u_normalize_matrix:new c.UniformMatrix4f(f,t.u_normalize_matrix),u_merc_matrix:new c.UniformMatrix4f(f,t.u_merc_matrix),u_zoom_transition:new c.Uniform1f(f,t.u_zoom_transition),u_merc_center:new c.Uniform2f(f,t.u_merc_center),u_image0:new c.Uniform1i(f,t.u_image0),u_grid_matrix:new c.UniformMatrix3f(f,t.u_grid_matrix),u_frustum_tl:new c.Uniform3f(f,t.u_frustum_tl),u_frustum_tr:new c.Uniform3f(f,t.u_frustum_tr),u_frustum_br:new c.Uniform3f(f,t.u_frustum_br),u_frustum_bl:new c.Uniform3f(f,t.u_frustum_bl),u_globe_pos:new c.Uniform3f(f,t.u_globe_pos),u_globe_radius:new c.Uniform1f(f,t.u_globe_radius),u_viewport:new c.Uniform2f(f,t.u_viewport)}),globeAtmosphere:(f,t)=>({u_frustum_tl:new c.Uniform3f(f,t.u_frustum_tl),u_frustum_tr:new c.Uniform3f(f,t.u_frustum_tr),u_frustum_br:new c.Uniform3f(f,t.u_frustum_br),u_frustum_bl:new c.Uniform3f(f,t.u_frustum_bl),u_horizon:new c.Uniform1f(f,t.u_horizon),u_transition:new c.Uniform1f(f,t.u_transition),u_fadeout_range:new c.Uniform1f(f,t.u_fadeout_range),u_color:new c.Uniform4f(f,t.u_color),u_high_color:new c.Uniform4f(f,t.u_high_color),u_space_color:new c.Uniform4f(f,t.u_space_color),u_star_intensity:new c.Uniform1f(f,t.u_star_intensity),u_star_density:new c.Uniform1f(f,t.u_star_density),u_star_size:new c.Uniform1f(f,t.u_star_size),u_temporal_offset:new c.Uniform1f(f,t.u_temporal_offset),u_horizon_angle:new c.Uniform1f(f,t.u_horizon_angle),u_rotation_matrix:new c.UniformMatrix4f(f,t.u_rotation_matrix)})};let fo;function to(f,t,u,v,w,E,I){const k=f.context,B=k.gl,Z=f.transform,te=f.useProgram("collisionBox"),se=[];let fe=0,Se=0;for(let st=0;st<v.length;st++){const Ue=v[st],je=t.getTile(Ue),bt=je.getBucket(u);if(!bt)continue;const Ht=Ps(Ue,bt,Z);let Zt=Ht;0===w[0]&&0===w[1]||(Zt=f.translatePosMatrix(Ht,je,w,E));const $t=I?bt.textCollisionBox:bt.iconCollisionBox,jt=bt.collisionCircleArray;if(jt.length>0){const it=c.create(),pn=Zt;c.mul(it,bt.placementInvProjMatrix,Z.glCoordMatrix),c.mul(it,it,bt.placementViewportMatrix),se.push({circleArray:jt,circleOffset:Se,transform:pn,invTransform:it,projection:bt.getProjection()}),fe+=jt.length/4,Se=fe}$t&&(f.terrain&&f.terrain.setupElevationDraw(je,te),te.draw(k,B.LINES,c.DepthMode.disabled,c.StencilMode.disabled,f.colorModeForRenderPass(),c.CullFaceMode.disabled,us(Zt,Z,je,bt.getProjection()),u.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,null,Z.zoom,null,$t.collisionVertexBuffer,$t.collisionVertexBufferExt))}if(!I||!se.length)return;const we=f.useProgram("collisionCircle"),xe=new c.StructArrayLayout2f1f2i16;xe.resize(4*fe),xe._trim();let $e=0;for(const st of se)for(let Ue=0;Ue<st.circleArray.length/4;Ue++){const je=4*Ue,bt=st.circleArray[je+0],Ht=st.circleArray[je+1],Zt=st.circleArray[je+2],$t=st.circleArray[je+3];xe.emplace($e++,bt,Ht,Zt,$t,0),xe.emplace($e++,bt,Ht,Zt,$t,1),xe.emplace($e++,bt,Ht,Zt,$t,2),xe.emplace($e++,bt,Ht,Zt,$t,3)}(!fo||fo.length<2*fe)&&(fo=function(st){const Ue=2*st,je=new c.StructArrayLayout3ui6;je.resize(Ue),je._trim();for(let bt=0;bt<Ue;bt++){const Ht=6*bt;je.uint16[Ht+0]=4*bt+0,je.uint16[Ht+1]=4*bt+1,je.uint16[Ht+2]=4*bt+2,je.uint16[Ht+3]=4*bt+2,je.uint16[Ht+4]=4*bt+3,je.uint16[Ht+5]=4*bt+0}return je}(fe));const Ee=k.createIndexBuffer(fo,!0),ke=k.createVertexBuffer(xe,c.collisionCircleLayout.members,!0);for(const st of se){const Ue={u_matrix:st.transform,u_inv_matrix:st.invTransform,u_camera_to_center_distance:(Re=Z).getCameraToCenterDistance(st.projection),u_viewport_size:[Re.width,Re.height]};we.draw(k,B.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,f.colorModeForRenderPass(),c.CullFaceMode.disabled,Ue,u.id,ke,Ee,c.SegmentVector.simpleSegment(0,2*st.circleOffset,st.circleArray.length,st.circleArray.length/2),null,Z.zoom)}var Re;ke.destroy(),Ee.destroy()}const rc=c.create();function Na(f,t,u,v,w,E){const{horizontalAlign:I,verticalAlign:k}=c.getAnchorAlignment(f),B=-(I-.5)*t,Z=-(k-.5)*u,te=c.evaluateVariableOffset(f,v);return new c.pointGeometry((B/w+te[0])*E,(Z/w+te[1])*E)}function Qo(f,t,u,v,w,E,I,k,B,Z,te){const se=f.text.placedSymbolArray,fe=f.text.dynamicLayoutVertexArray,Se=f.icon.dynamicLayoutVertexArray,we={},xe=Ho(k,f.getProjection(),E),$e=E.elevation,Ee=f.getProjection().upVectorScale(k.canonical,E.center.lat,E.worldSize);fe.clear();for(let ke=0;ke<se.length;ke++){const Re=se.get(ke),st=f.allowVerticalPlacement&&!Re.placedOrientation,Ue=Re.hidden||!Re.crossTileID||st?null:v[Re.crossTileID];if(Ue){const je=new c.pointGeometry(Re.tileAnchorX,Re.tileAnchorY),bt=f.getProjection().upVector(k.canonical,je.x,je.y),Ht=$e?$e.getAtTileOffset(k,je.x,je.y):0,Zt=so([Re.projectedAnchorX+Ht*bt[0]*Ee.metersToTile,Re.projectedAnchorY+Ht*bt[1]*Ee.metersToTile,Re.projectedAnchorZ+Ht*bt[2]*Ee.metersToTile],u?xe:I),$t=Go(E.getCameraToCenterDistance(f.getProjection()),Zt.signedDistanceFromCamera);let jt=w.evaluateSizeForFeature(f.textSizeData,Z,Re)*$t/c.ONE_EM;u&&(jt*=f.tilePixelRatio/B);const{width:it,height:pn,anchor:hn,textOffset:Un,textScale:tn}=Ue,ci=Na(hn,it,pn,Un,tn,jt);let Fn;if(u){const In=je.add(ci),{x:Nn,y:Si,z:bi}=f.getProjection().projectTilePoint(In.x,In.y,k.canonical);Fn=so([Nn+Ht*bt[0]*Ee.metersToTile,Si+Ht*bt[1]*Ee.metersToTile,bi+Ht*bt[2]*Ee.metersToTile],I).point}else{const In=t?ci.rotate(-E.angle):ci;Fn=[Zt.point[0]+In.x,Zt.point[1]+In.y,0]}const Vn=f.allowVerticalPlacement&&Re.placedOrientation===c.WritingMode.vertical?Math.PI/2:0;for(let In=0;In<Re.numGlyphs;In++)c.addDynamicAttributes(fe,Fn[0],Fn[1],Fn[2],Vn);te&&Re.associatedIconIndex>=0&&(we[Re.associatedIconIndex]={shiftedAnchor:Fn,angle:Vn})}else Jr(Re.numGlyphs,fe)}if(te){Se.clear();const ke=f.icon.placedSymbolArray;for(let Re=0;Re<ke.length;Re++){const st=ke.get(Re);if(st.hidden)Jr(st.numGlyphs,Se);else{const Ue=we[Re];if(Ue)for(let je=0;je<st.numGlyphs;je++)c.addDynamicAttributes(Se,Ue.shiftedAnchor[0],Ue.shiftedAnchor[1],Ue.shiftedAnchor[2],Ue.angle);else Jr(st.numGlyphs,Se)}}f.icon.dynamicLayoutVertexBuffer.updateData(Se)}f.text.dynamicLayoutVertexBuffer.updateData(fe)}function xs(f,t,u){return u.iconsInText&&t?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function ir(f,t,u,v,w,E,I,k,B,Z,te,se){const fe=f.context,Se=fe.gl,we=f.transform,xe="map"===k,$e="map"===B,Ee=xe&&"point"!==u.layout.get("symbol-placement"),ke=xe&&!$e&&!Ee,Re=void 0!==u.layout.get("symbol-sort-key").constantOr(1);let st=!1;const Ue=f.depthModeForSublayer(0,c.DepthMode.ReadOnly),je=[c.mercatorXfromLng(we.center.lng),c.mercatorYfromLat(we.center.lat)],bt=u.layout.get("text-variable-anchor"),Ht="globe"===we.projection.name,Zt=[],$t=[0,-1,0];let jt=$t;!Ht&&!we.mercatorFromTransition||xe||(jt=function(it){const pn=it._camera.getWorldToCamera(it.worldSize,1),hn=c.multiply([],pn,it.globeMatrix);c.invert(hn,hn);const Un=[0,0,0],tn=[0,1,0,0];return c.transformMat4$1(tn,tn,hn),Un[0]=tn[0],Un[1]=tn[1],Un[2]=tn[2],c.normalize(Un,Un),Un}(we));for(const it of v){const pn=t.getTile(it),hn=pn.getBucket(u);if(!hn||"mercator"===hn.projection.name&&Ht)continue;const Un=w?hn.text:hn.icon;if(!Un||hn.fullyClipped||!Un.segments.get().length)continue;const tn=Un.programConfigurations.get(u.id),ci=w||hn.sdfIcons,Fn=w?hn.textSizeData:hn.iconSizeData,Vn=$e||0!==we.pitch,In=c.evaluateSizeForZoom(Fn,we.zoom);let Nn,Si,bi,Qi,pi=[0,0],Gi=null;if(w){if(Si=pn.glyphAtlasTexture,bi=Se.LINEAR,Nn=pn.glyphAtlasTexture.size,hn.iconsInText){pi=pn.imageAtlasTexture.size,Gi=pn.imageAtlasTexture;const Ao="composite"===Fn.kind||"camera"===Fn.kind;Qi=Vn||f.options.rotating||f.options.zooming||Ao?Se.LINEAR:Se.NEAREST}}else{const Ao=1!==u.layout.get("icon-size").constantOr(0)||hn.iconsNeedLinear;Si=pn.imageAtlasTexture,bi=ci||f.options.rotating||f.options.zooming||Ao||Vn?Se.LINEAR:Se.NEAREST,Nn=pn.imageAtlasTexture.size}const mr="globe"===hn.projection.name,Ir=mr?jt:$t,So=mr?c.globeToMercatorTransition(we.zoom):0,Lr=Ho(it,hn.getProjection(),we),Ya=we.calculatePixelsToTileUnitsMatrix(pn),cl=ki(Lr,pn.tileID.canonical,$e,xe,we,hn.getProjection(),Ya),hc=f.terrain&&$e&&Ee?c.invert(c.create(),cl):rc,Hr=po(Lr,pn.tileID.canonical,$e,xe,we,hn.getProjection(),Ya),no=bt&&hn.hasTextData(),Cr="none"!==u.layout.get("icon-text-fit")&&no&&hn.hasIconData();if(Ee){const Ao=we.elevation,Er=Ao?Ao.getAtTileOffsetFunc(it,we.center.lat,we.worldSize,hn.getProjection()):Xu=>[0,0,0],Xs=ls(Lr,pn.tileID.canonical,$e,xe,we,hn.getProjection(),Ya);yr(hn,Lr,f,w,Xs,Hr,$e,Z,Er,it)}const mo=Ee||w&&bt||Cr,es=f.translatePosMatrix(Lr,pn,E,I),sr=mo?rc:cl,ma=f.translatePosMatrix(Hr,pn,E,I,!0),Lc=hn.getProjection().createInversionMatrix(we,it.canonical),Cl=[];f.terrain&&$e&&Cl.push("PITCH_WITH_MAP_TERRAIN"),mr&&Cl.push("PROJECTION_GLOBE_VIEW"),mo&&Cl.push("PROJECTED_POS_ON_VIEWPORT");const jl=ci&&0!==u.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1);let pc;pc=ci?hn.iconsInText?Vu(Fn.kind,In,ke,$e,f,es,sr,ma,Nn,pi,it,So,je,Lc,Ir,hn.getProjection()):Od(Fn.kind,In,ke,$e,f,es,sr,ma,w,Nn,!0,it,So,je,Lc,Ir,hn.getProjection()):yl(Fn.kind,In,ke,$e,f,es,sr,ma,w,Nn,it,So,je,Lc,Ir,hn.getProjection());const Gl={program:f.useProgram(xs(ci,w,hn),tn,Cl),buffers:Un,uniformValues:pc,atlasTexture:Si,atlasTextureIcon:Gi,atlasInterpolation:bi,atlasInterpolationIcon:Qi,isSDF:ci,hasHalo:jl,tile:pn,labelPlaneMatrixInv:hc};if(Re&&hn.canOverlap){st=!0;const Ao=Un.segments.get();for(const Er of Ao)Zt.push({segments:new c.SegmentVector([Er]),sortKey:Er.sortKey,state:Gl})}else Zt.push({segments:Un.segments,sortKey:0,state:Gl})}st&&Zt.sort((it,pn)=>it.sortKey-pn.sortKey);for(const it of Zt){const pn=it.state;if(f.terrain&&f.terrain.setupElevationDraw(pn.tile,pn.program,{useDepthForOcclusion:!Ht,labelPlaneMatrixInv:pn.labelPlaneMatrixInv}),fe.activeTexture.set(Se.TEXTURE0),pn.atlasTexture.bind(pn.atlasInterpolation,Se.CLAMP_TO_EDGE),pn.atlasTextureIcon&&(fe.activeTexture.set(Se.TEXTURE1),pn.atlasTextureIcon&&pn.atlasTextureIcon.bind(pn.atlasInterpolationIcon,Se.CLAMP_TO_EDGE)),pn.isSDF){const hn=pn.uniformValues;pn.hasHalo&&(hn.u_is_halo=1,ou(pn.buffers,it.segments,u,f,pn.program,Ue,te,se,hn)),hn.u_is_halo=0}ou(pn.buffers,it.segments,u,f,pn.program,Ue,te,se,pn.uniformValues)}}function ou(f,t,u,v,w,E,I,k,B){const Z=v.context;w.draw(Z,Z.gl.TRIANGLES,E,I,k,c.CullFaceMode.disabled,B,u.id,f.layoutVertexBuffer,f.indexBuffer,t,u.paint,v.transform.zoom,f.programConfigurations.get(u.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer)}function Uu(f,t,u,v,w,E,I){const k=f.context.gl,B=u.paint.get("fill-pattern"),Z=B&&B.constantOr(1),te=u.getCrossfadeParameters();let se,fe,Se,we,xe;I?(fe=Z&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",se=k.LINES):(fe=Z?"fillPattern":"fill",se=k.TRIANGLES);for(const $e of v){const Ee=t.getTile($e);if(Z&&!Ee.patternsLoaded())continue;const ke=Ee.getBucket(u);if(!ke)continue;f.prepareDrawTile();const Re=ke.programConfigurations.get(u.id),st=f.useProgram(fe,Re);Z&&(f.context.activeTexture.set(k.TEXTURE0),Ee.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Re.updatePaintBuffers(te));const Ue=B.constantOr(null);if(Ue&&Ee.imageAtlas){const bt=Ee.imageAtlas,Ht=bt.patternPositions[Ue.to.toString()],Zt=bt.patternPositions[Ue.from.toString()];Ht&&Zt&&Re.setConstantPatternPositions(Ht,Zt)}const je=f.translatePosMatrix($e.projMatrix,Ee,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(I){we=ke.indexBuffer2,xe=ke.segments2;const bt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];Se="fillOutlinePattern"===fe&&Z?Ci(je,f,te,Ee,bt):cn(je,bt)}else we=ke.indexBuffer,xe=ke.segments,Se=Z?me(je,f,te,Ee):$(je);f.prepareDrawProgram(f.context,st,$e.toUnwrapped()),st.draw(f.context,se,w,f.stencilModeForClipping($e),E,c.CullFaceMode.disabled,Se,u.id,ke.layoutVertexBuffer,we,xe,u.paint,f.transform.zoom,Re)}}function Ic(f,t,u,v,w,E,I){const k=f.context,B=k.gl,Z=f.transform,te=u.paint.get("fill-extrusion-pattern"),se=te.constantOr(1),fe=u.getCrossfadeParameters(),Se=u.paint.get("fill-extrusion-opacity"),we="globe"===Z.projection.name?c.fillExtrusionHeightLift():0,xe="globe"===Z.projection.name,$e=xe?c.globeToMercatorTransition(Z.zoom):0,Ee=[c.mercatorXfromLng(Z.center.lng),c.mercatorYfromLat(Z.center.lat)],ke=[];xe&&ke.push("PROJECTION_GLOBE_VIEW");for(const Re of v){const st=t.getTile(Re),Ue=st.getBucket(u);if(!Ue||Ue.projection.name!==Z.projection.name)continue;const je=Ue.programConfigurations.get(u.id),bt=f.useProgram(se?"fillExtrusionPattern":"fillExtrusion",je,ke);if(f.terrain){const pn=f.terrain;if(f.style.terrainSetForDrapingOnly())pn.setupElevationDraw(st,bt,{useMeterToDem:!0});else{if(!Ue.enableTerrain)continue;if(pn.setupElevationDraw(st,bt,{useMeterToDem:!0}),zo(k,t,Re,Ue,u,pn),!Ue.centroidVertexBuffer){const hn=bt.attributes.a_centroid_pos;void 0!==hn&&B.vertexAttrib2f(hn,0,0)}}}se&&(f.context.activeTexture.set(B.TEXTURE0),st.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),je.updatePaintBuffers(fe));const Ht=te.constantOr(null);if(Ht&&st.imageAtlas){const pn=st.imageAtlas,hn=pn.patternPositions[Ht.to.toString()],Un=pn.patternPositions[Ht.from.toString()];hn&&Un&&je.setConstantPatternPositions(hn,Un)}const Zt=f.translatePosMatrix(Re.projMatrix,st,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),$t=Z.projection.createInversionMatrix(Z,Re.canonical),jt=u.paint.get("fill-extrusion-vertical-gradient"),it=se?q(Zt,f,jt,Se,Re,fe,st,we,$e,Ee,$t):ne(Zt,f,jt,Se,Re,we,$e,Ee,$t);f.prepareDrawProgram(k,bt,Re.toUnwrapped()),bt.draw(k,k.gl.TRIANGLES,w,E,I,c.CullFaceMode.backCCW,it,u.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,u.paint,f.transform.zoom,je,f.terrain?Ue.centroidVertexBuffer:null,xe?Ue.layoutVertexExtBuffer:null)}}function zo(f,t,u,v,w,E){const I=[Ee=>{let ke=Ee.canonical.x-1,Re=Ee.wrap;return ke<0&&(ke=(1<<Ee.canonical.z)-1,Re--),new c.OverscaledTileID(Ee.overscaledZ,Re,Ee.canonical.z,ke,Ee.canonical.y)},Ee=>{let ke=Ee.canonical.x+1,Re=Ee.wrap;return ke===1<<Ee.canonical.z&&(ke=0,Re++),new c.OverscaledTileID(Ee.overscaledZ,Re,Ee.canonical.z,ke,Ee.canonical.y)},Ee=>new c.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,(0===Ee.canonical.y?1<<Ee.canonical.z:Ee.canonical.y)-1),Ee=>new c.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,Ee.canonical.y===(1<<Ee.canonical.z)-1?0:Ee.canonical.y+1)],k=Ee=>{const ke=t.getSource().minzoom,Re=Ue=>{const je=t.getTileByID(Ue);if(je&&je.hasData())return je.getBucket(w)},st=[0,-1,1];for(const Ue of st){if(Ee.overscaledZ+Ue<ke)continue;const je=Re(Ee.calculateScaledKey(Ee.overscaledZ+Ue));if(je)return je}},B=[0,0,0],Z=(Ee,ke)=>(B[0]=Math.min(Ee.min.y,ke.min.y),B[1]=Math.max(Ee.max.y,ke.max.y),B[2]=c.EXTENT-ke.min.x>Ee.max.x?ke.min.x-c.EXTENT:Ee.max.x,B),te=(Ee,ke)=>(B[0]=Math.min(Ee.min.x,ke.min.x),B[1]=Math.max(Ee.max.x,ke.max.x),B[2]=c.EXTENT-ke.min.y>Ee.max.y?ke.min.y-c.EXTENT:Ee.max.y,B),se=[(Ee,ke)=>Z(Ee,ke),(Ee,ke)=>Z(ke,Ee),(Ee,ke)=>te(Ee,ke),(Ee,ke)=>te(ke,Ee)],fe=new c.pointGeometry(0,0);let Se,we,xe;const $e=(Ee,ke,Re,st,Ue)=>{const je=[[st?Re:Ee,st?Ee:Re,0],[st?Re:ke,st?ke:Re,0]],bt=Ue<0?c.EXTENT+Ue:Ue,Ht=[st?bt:(Ee+ke)/2,st?(Ee+ke)/2:bt,0];return 0===Re&&Ue<0||0!==Re&&Ue>0?E.getForTilePoints(xe,[Ht],!0,we):je.push(Ht),E.getForTilePoints(u,je,!0,Se),Math.max(je[0][2],je[1][2],Ht[2])/E.exaggeration()};for(let Ee=0;Ee<4;Ee++){const ke=(Ee<2?1:5)-Ee,Re=v.borders[Ee];if(0===Re.length)continue;const st=xe=I[Ee](u),Ue=k(st);if(!(Ue&&Ue instanceof c.FillExtrusionBucket&&Ue.enableTerrain)||v.borderDoneWithNeighborZ[Ee]===Ue.canonical.z&&Ue.borderDoneWithNeighborZ[ke]===v.canonical.z||(we=E.findDEMTileFor(st),!we||!we.dem))continue;if(!Se){const Zt=E.findDEMTileFor(u);if(!Zt||!Zt.dem)return;Se=Zt}const je=Ue.borders[ke];let bt=0;const Ht=Ue.borderDoneWithNeighborZ[ke]!==v.canonical.z;if(v.canonical.z===Ue.canonical.z){for(let Zt=0;Zt<Re.length;Zt++){const $t=v.featuresOnBorder[Re[Zt]],jt=$t.borders[Ee];let it;for(;bt<je.length&&(it=Ue.featuresOnBorder[je[bt]],!(it.borders[ke][1]>jt[0]+3));)Ht&&Ue.encodeCentroid(void 0,it,!1),bt++;if(it&&bt<je.length){const pn=bt;let hn=0;for(;!(it.borders[ke][0]>jt[1]-3)&&(hn++,++bt!==je.length);)it=Ue.featuresOnBorder[je[bt]];if(it=Ue.featuresOnBorder[je[pn]],$t.intersectsCount()>1||it.intersectsCount()>1||1!==hn){1!==hn&&(bt=pn),v.encodeCentroid(void 0,$t,!1),Ht&&Ue.encodeCentroid(void 0,it,!1);continue}const Un=se[Ee]($t,it),tn=Ee%2?c.EXTENT-1:0;fe.x=$e(Un[0],Math.min(c.EXTENT-1,Un[1]),tn,Ee<2,Un[2]),fe.y=0,v.encodeCentroid(fe,$t,!1),Ht&&Ue.encodeCentroid(fe,it,!1)}else v.encodeCentroid(void 0,$t,!1)}v.borderDoneWithNeighborZ[Ee]=Ue.canonical.z,v.needsCentroidUpdate=!0,Ht&&(Ue.borderDoneWithNeighborZ[ke]=v.canonical.z,Ue.needsCentroidUpdate=!0)}else{for(const Zt of Re)v.encodeCentroid(void 0,v.featuresOnBorder[Zt],!1);if(Ht){for(const Zt of je)Ue.encodeCentroid(void 0,Ue.featuresOnBorder[Zt],!1);Ue.borderDoneWithNeighborZ[ke]=v.canonical.z,Ue.needsCentroidUpdate=!0}v.borderDoneWithNeighborZ[Ee]=Ue.canonical.z,v.needsCentroidUpdate=!0}}(v.needsCentroidUpdate||!v.centroidVertexBuffer&&0!==v.centroidVertexArray.length)&&v.uploadCentroid(f)}const ll=new c.Color(1,0,0,1),Va=new c.Color(0,1,0,1),Ol=new c.Color(0,0,1,1),Ea=new c.Color(1,0,1,1),Ma=new c.Color(0,1,1,1);function ws(f,t,u,v){cr(f,0,t+u/2,f.transform.width,u,v)}function Zo(f,t,u,v){cr(f,t-u/2,0,u,f.transform.height,v)}function cr(f,t,u,v,w,E){const I=f.context,k=I.gl;k.enable(k.SCISSOR_TEST),k.scissor(t*c.exported.devicePixelRatio,u*c.exported.devicePixelRatio,v*c.exported.devicePixelRatio,w*c.exported.devicePixelRatio),I.clear({color:E}),k.disable(k.SCISSOR_TEST)}function Mo(f,t,u){const v=f.context,w=v.gl,E="globe"===f.transform.projection.name,I=u.projMatrix,k=f.useProgram("debug",null,E?["PROJECTION_GLOBE_VIEW"]:null),B=t.getTileByID(u.key);f.terrain&&f.terrain.setupElevationDraw(B,k);const Z=c.DepthMode.disabled,te=c.StencilMode.disabled,se=f.colorModeForRenderPass();v.activeTexture.set(w.TEXTURE0),f.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),E?B._makeGlobeTileDebugBuffers(f.context,f.transform.projection):B._makeDebugTileBoundsBuffers(f.context,f.transform.projection);const Se=B._tileDebugBuffer||f.debugBuffer,we=B._tileDebugIndexBuffer||f.debugIndexBuffer,xe=B._tileDebugSegments||f.debugSegments;k.draw(v,w.LINE_STRIP,Z,te,se,c.CullFaceMode.disabled,ru(I,c.Color.red),"$debug",Se,we,xe,null,null,null,B._globeTileDebugBorderBuffer);const $e=B.latestRawTileData,Ee=Math.floor(($e&&$e.byteLength||0)/1024),ke=t.getTile(u).tileSize,Re=512/Math.min(ke,512)*(u.overscaledZ/f.transform.zoom)*.5;let st=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(st+=` => ${u.overscaledZ}`),function(Ht,Zt){Ht.initDebugOverlayCanvas();const $t=Ht.debugOverlayCanvas,jt=Ht.context.gl,it=Ht.debugOverlayCanvas.getContext("2d");it.clearRect(0,0,$t.width,$t.height),it.shadowColor="white",it.shadowBlur=2,it.lineWidth=1.5,it.strokeStyle="white",it.textBaseline="top",it.font="bold 36px Open Sans, sans-serif",it.fillText(Zt,5,5),it.strokeText(Zt,5,5),Ht.debugOverlayTexture.update($t),Ht.debugOverlayTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE)}(f,`${st} ${Ee}kb`);const Ue=B._tileDebugTextBuffer||f.debugBuffer,je=B._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,bt=B._tileDebugTextSegments||f.debugSegments;k.draw(v,w.TRIANGLES,Z,te,c.ColorMode.alphaBlended,c.CullFaceMode.disabled,ru(I,c.Color.transparent,Re),"$debug",Ue,je,bt,null,null,null,B._globeTileDebugTextBuffer)}const Rr=c.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Pc}=Rr;function Cs(f,t,u,v){f.emplaceBack(t,u,v)}class ha{constructor(t){this.vertexArray=new c.StructArrayLayout3f12,this.indices=new c.StructArrayLayout3ui6,Cs(this.vertexArray,-1,-1,1),Cs(this.vertexArray,1,-1,1),Cs(this.vertexArray,-1,1,1),Cs(this.vertexArray,1,1,1),Cs(this.vertexArray,-1,-1,-1),Cs(this.vertexArray,1,-1,-1),Cs(this.vertexArray,-1,1,-1),Cs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Pc),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=c.SegmentVector.simpleSegment(0,0,36,12)}}function Os(f,t,u,v,w,E){const I=f.gl,k=t.paint.get("sky-atmosphere-color"),B=t.paint.get("sky-atmosphere-halo-color"),Z=t.paint.get("sky-atmosphere-sun-intensity"),te={u_matrix_3f:c.fromMat4(c.create$1(),v),u_sun_direction:w,u_sun_intensity:Z,u_color_tint_r:[(we=k).r,we.g,we.b,we.a],u_color_tint_m:[(xe=B).r,xe.g,xe.b,xe.a],u_luminance:5e-5};var we,xe;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+E,t.skyboxTexture,0),u.draw(f,I.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,c.ColorMode.unblended,c.CullFaceMode.frontCW,te,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const bo=c.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ju{constructor(t){const u=new c.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const v=new c.StructArrayLayout3ui6;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(u,bo.members),this.indexBuffer=t.createIndexBuffer(v),this.segments=c.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const qs={symbol:function(f,t,u,v,w){if("translucent"!==f.renderPass)return;const E=c.StencilMode.disabled,I=f.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(k,B,Z,te,se,fe,Se){const we=B.transform,xe="map"===se,$e="map"===fe;for(const Ee of k){const ke=te.getTile(Ee),Re=ke.getBucket(Z);if(!Re||!Re.text||!Re.text.segments.get().length)continue;const st=c.evaluateSizeForZoom(Re.textSizeData,we.zoom),Ue=Ho(Ee,Re.getProjection(),we),je=we.calculatePixelsToTileUnitsMatrix(ke),bt=ki(Ue,ke.tileID.canonical,$e,xe,we,Re.getProjection(),je),Ht="none"!==Z.layout.get("icon-text-fit")&&Re.hasIconData();if(st){const Zt=Math.pow(2,we.zoom-ke.tileID.overscaledZ);Qo(Re,xe,$e,Se,c.symbolSize,we,bt,Ee,Zt,st,Ht)}}}(v,f,u,t,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),w),0!==u.paint.get("icon-opacity").constantOr(1)&&ir(f,t,u,v,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),E,I),0!==u.paint.get("text-opacity").constantOr(1)&&ir(f,t,u,v,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),E,I),t.map.showCollisionBoxes&&(to(f,t,u,v,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),to(f,t,u,v,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(f,t,u,v){if("translucent"!==f.renderPass)return;const w=u.paint.get("circle-opacity"),E=u.paint.get("circle-stroke-width"),I=u.paint.get("circle-stroke-opacity"),k=void 0!==u.layout.get("circle-sort-key").constantOr(1);if(0===w.constantOr(1)&&(0===E.constantOr(1)||0===I.constantOr(1)))return;const B=f.context,Z=B.gl,te=f.transform,se=f.depthModeForSublayer(0,c.DepthMode.ReadOnly),fe=c.StencilMode.disabled,Se=f.colorModeForRenderPass(),we="globe"===te.projection.name,xe=[c.mercatorXfromLng(te.center.lng),c.mercatorYfromLat(te.center.lat)],$e=[];for(let ke=0;ke<v.length;ke++){const Re=v[ke],st=t.getTile(Re),Ue=st.getBucket(u);if(!Ue||Ue.projection.name!==te.projection.name)continue;const je=Ue.programConfigurations.get(u.id),bt=eo(u);we&&bt.push("PROJECTION_GLOBE_VIEW");const Ht=f.useProgram("circle",je,bt),Zt=Ue.layoutVertexBuffer,$t=Ue.globeExtVertexBuffer,jt=Ue.indexBuffer,it=te.projection.createInversionMatrix(te,Re.canonical),pn={programConfiguration:je,program:Ht,layoutVertexBuffer:Zt,globeExtVertexBuffer:$t,indexBuffer:jt,uniformValues:bs(f,Re,st,it,xe,u),tile:st};if(k){const hn=Ue.segments.get();for(const Un of hn)$e.push({segments:new c.SegmentVector([Un]),sortKey:Un.sortKey,state:pn})}else $e.push({segments:Ue.segments,sortKey:0,state:pn})}k&&$e.sort((ke,Re)=>ke.sortKey-Re.sortKey);const Ee={useDepthForOcclusion:!we};for(const ke of $e){const{programConfiguration:Re,program:st,layoutVertexBuffer:Ue,globeExtVertexBuffer:je,indexBuffer:bt,uniformValues:Ht,tile:Zt}=ke.state,$t=ke.segments;f.terrain&&f.terrain.setupElevationDraw(Zt,st,Ee),f.prepareDrawProgram(B,st,Zt.tileID.toUnwrapped()),st.draw(B,Z.TRIANGLES,se,fe,Se,c.CullFaceMode.disabled,Ht,u.id,Ue,bt,$t,u.paint,te.zoom,Re,we?je:null)}},heatmap:function(f,t,u,v){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===f.renderPass){const w=f.context,E=w.gl,I=c.StencilMode.disabled,k=new c.ColorMode([E.ONE,E.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(Se,we,xe,$e){const Ee=Se.gl,ke=we.width*$e,Re=we.height*$e;Se.activeTexture.set(Ee.TEXTURE1),Se.viewport.set([0,0,ke,Re]);let st=xe.heatmapFbo;if(!st||st&&(st.width!==ke||st.height!==Re)){st&&st.destroy();const Ue=Ee.createTexture();Ee.bindTexture(Ee.TEXTURE_2D,Ue),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_S,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_T,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MIN_FILTER,Ee.LINEAR),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MAG_FILTER,Ee.LINEAR),st=xe.heatmapFbo=Se.createFramebuffer(ke,Re,!1),function(je,bt,Ht,Zt,$t,jt){const it=je.gl;it.texImage2D(it.TEXTURE_2D,0,it.RGBA,$t,jt,0,it.RGBA,je.extRenderToTextureHalfFloat?je.extTextureHalfFloat.HALF_FLOAT_OES:it.UNSIGNED_BYTE,null),Zt.colorAttachment.set(Ht)}(Se,0,Ue,st,ke,Re)}else Ee.bindTexture(Ee.TEXTURE_2D,st.colorAttachment.get()),Se.bindFramebuffer.set(st.framebuffer)})(w,f,u,"globe"===f.transform.projection.name?.5:.25),w.clear({color:c.Color.transparent});const B=f.transform,Z="globe"===B.projection.name,te=Z?["PROJECTION_GLOBE_VIEW"]:null,se=Z?c.CullFaceMode.frontCCW:c.CullFaceMode.disabled,fe=[c.mercatorXfromLng(B.center.lng),c.mercatorYfromLat(B.center.lat)];for(let Se=0;Se<v.length;Se++){const we=v[Se];if(t.hasRenderableParent(we))continue;const xe=t.getTile(we),$e=xe.getBucket(u);if(!$e||$e.projection.name!==B.projection.name)continue;const Ee=$e.programConfigurations.get(u.id),ke=f.useProgram("heatmap",Ee,te),{zoom:Re}=f.transform;f.terrain&&f.terrain.setupElevationDraw(xe,ke),f.prepareDrawProgram(w,ke,we.toUnwrapped());const st=B.projection.createInversionMatrix(B,we.canonical);ke.draw(w,E.TRIANGLES,c.DepthMode.disabled,I,k,se,al(f,we,xe,st,fe,Re,u.paint.get("heatmap-intensity")),u.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,u.paint,f.transform.zoom,Ee,Z?$e.globeExtVertexBuffer:null)}w.viewport.set([0,0,f.width,f.height])}else"translucent"===f.renderPass&&(f.context.setColorMode(f.colorModeForRenderPass()),function(w,E){const I=w.context,k=I.gl,B=E.heatmapFbo;if(!B)return;I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,B.colorAttachment.get()),I.activeTexture.set(k.TEXTURE1);let Z=E.colorRampTexture;Z||(Z=E.colorRampTexture=new c.Texture(I,E.colorRamp,k.RGBA)),Z.bind(k.LINEAR,k.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(I,k.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,w.colorModeForRenderPass(),c.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")},E.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,E.paint,w.transform.zoom)}(f,u))},line:function(f,t,u,v){if("translucent"!==f.renderPass)return;const w=u.paint.get("line-opacity"),E=u.paint.get("line-width");if(0===w.constantOr(1)||0===E.constantOr(1))return;const I=f.depthModeForSublayer(0,c.DepthMode.ReadOnly),k=f.colorModeForRenderPass(),B=f.terrain&&f.terrain.renderingToTexture?1:c.exported.devicePixelRatio,Z=u.paint.get("line-dasharray"),te=Z.constantOr(1),se=u.layout.get("line-cap"),fe=u.paint.get("line-pattern"),Se=fe.constantOr(1),we=u.paint.get("line-gradient"),xe=u.getCrossfadeParameters(),$e=Se?"linePattern":"line",Ee=f.context,ke=Ee.gl,Re=(Ue=>{const je=[];tc(Ue)&&je.push("RENDER_LINE_DASH"),Ue.paint.get("line-gradient")&&je.push("RENDER_LINE_GRADIENT");const bt=Ue.paint.get("line-trim-offset");0===bt[0]&&0===bt[1]||je.push("RENDER_LINE_TRIM_OFFSET");const Ht=Ue.paint.get("line-pattern").constantOr(1),Zt=1!==Ue.paint.get("line-opacity").constantOr(1);return!Ht&&Zt&&je.push("RENDER_LINE_ALPHA_DISCARD"),je})(u);let st=Re.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(st=!1);for(const Ue of v){const je=t.getTile(Ue);if(Se&&!je.patternsLoaded())continue;const bt=je.getBucket(u);if(!bt)continue;f.prepareDrawTile();const Ht=bt.programConfigurations.get(u.id),Zt=f.useProgram($e,Ht,Re),$t=fe.constantOr(null);if($t&&je.imageAtlas){const Fn=je.imageAtlas,Vn=Fn.patternPositions[$t.to.toString()],In=Fn.patternPositions[$t.from.toString()];Vn&&In&&Ht.setConstantPatternPositions(Vn,In)}const jt=Z.constantOr(null),it=se.constantOr(null);if(!Se&&jt&&it&&je.lineAtlas){const Fn=je.lineAtlas,Vn=Fn.getDash(jt.to,it),In=Fn.getDash(jt.from,it);Vn&&In&&Ht.setConstantPatternPositions(Vn,In)}let[pn,hn]=u.paint.get("line-trim-offset");("round"===it||"square"===it)&&pn!==hn&&(0===pn&&(pn-=1),1===hn&&(hn+=1));const Un=f.terrain?Ue.projMatrix:null,tn=Se?Pd(f,je,u,xe,Un,B):zu(f,je,u,xe,Un,bt.lineClipsArray.length,B,[pn,hn]);if(we){const Fn=bt.gradients[u.id];let Vn=Fn.texture;if(u.gradientVersion!==Fn.version){let In=256;if(u.stepInterpolant){const Nn=t.getSource().maxzoom,Si=Ue.canonical.z===Nn?Math.ceil(1<<f.transform.maxZoom-Ue.canonical.z):1;In=c.clamp(c.nextPowerOfTwo(bt.maxLineLength/c.EXTENT*1024*Si),256,Ee.maxTextureSize)}Fn.gradient=c.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:In,image:Fn.gradient||void 0,clips:bt.lineClipsArray}),Fn.texture?Fn.texture.update(Fn.gradient):Fn.texture=new c.Texture(Ee,Fn.gradient,ke.RGBA),Fn.version=u.gradientVersion,Vn=Fn.texture}Ee.activeTexture.set(ke.TEXTURE1),Vn.bind(u.stepInterpolant?ke.NEAREST:ke.LINEAR,ke.CLAMP_TO_EDGE)}te&&(Ee.activeTexture.set(ke.TEXTURE0),je.lineAtlasTexture.bind(ke.LINEAR,ke.REPEAT),Ht.updatePaintBuffers(xe)),Se&&(Ee.activeTexture.set(ke.TEXTURE0),je.imageAtlasTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),Ht.updatePaintBuffers(xe)),f.prepareDrawProgram(Ee,Zt,Ue.toUnwrapped());const ci=Fn=>{Zt.draw(Ee,ke.TRIANGLES,I,Fn,k,c.CullFaceMode.disabled,tn,u.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,u.paint,f.transform.zoom,Ht,bt.layoutVertexBuffer2)};if(st){const Fn=f.stencilModeForClipping(Ue).ref;0===Fn&&f.terrain&&Ee.clear({stencil:0});const Vn={func:ke.EQUAL,mask:255};tn.u_alpha_discard_threshold=.8,ci(new c.StencilMode(Vn,Fn,255,ke.KEEP,ke.KEEP,ke.INVERT)),tn.u_alpha_discard_threshold=0,ci(new c.StencilMode(Vn,Fn,255,ke.KEEP,ke.KEEP,ke.KEEP))}else ci(f.stencilModeForClipping(Ue))}st&&(f.resetStencilClippingMasks(),f.terrain&&Ee.clear({stencil:0}))},fill:function(f,t,u,v){const w=u.paint.get("fill-color"),E=u.paint.get("fill-opacity");if(0===E.constantOr(1))return;const I=f.colorModeForRenderPass(),k=u.paint.get("fill-pattern"),B=f.opaquePassEnabledForLayer()&&!k.constantOr(1)&&1===w.constantOr(c.Color.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(f.renderPass===B){const Z=f.depthModeForSublayer(1,"opaque"===f.renderPass?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly);Uu(f,t,u,v,Z,I,!1)}if("translucent"===f.renderPass&&u.paint.get("fill-antialias")){const Z=f.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,c.DepthMode.ReadOnly);Uu(f,t,u,v,Z,I,!0)}},"fill-extrusion":function(f,t,u,v){const w=u.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===f.renderPass){const E=new c.DepthMode(f.context.gl.LEQUAL,c.DepthMode.ReadWrite,f.depthRangeFor3D);if(1!==w||u.paint.get("fill-extrusion-pattern").constantOr(1))Ic(f,t,u,v,E,c.StencilMode.disabled,c.ColorMode.disabled),Ic(f,t,u,v,E,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const I=f.colorModeForRenderPass();Ic(f,t,u,v,E,c.StencilMode.disabled,I)}}},hillshade:function(f,t,u,v){if("offscreen"!==f.renderPass&&"translucent"!==f.renderPass)return;const w=f.context,E=f.depthModeForSublayer(0,c.DepthMode.ReadOnly),I=f.colorModeForRenderPass(),k=f.terrain&&f.terrain.renderingToTexture,[B,Z]="translucent"!==f.renderPass||k?[{},v]:f.stencilConfigForOverlap(v);for(const te of Z){const se=t.getTile(te);if(se.needsHillshadePrepare&&"offscreen"===f.renderPass)vt(f,se,u,E,c.StencilMode.disabled,I);else if("translucent"===f.renderPass){const fe=k&&f.terrain?f.terrain.stencilModeForRTTOverlap(te):B[te.overscaledZ];J(f,te,se,u,E,fe,I)}}w.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,t,u,v,w,E){if("translucent"!==f.renderPass||0===u.paint.get("raster-opacity")||!v.length)return;const I=f.context,k=I.gl,B=t.getSource(),Z=f.useProgram("raster"),te=f.colorModeForRenderPass(),se=f.terrain&&f.terrain.renderingToTexture,[fe,Se]=B instanceof Ct||se?[{},v]:f.stencilConfigForOverlap(v),we=Se[Se.length-1].overscaledZ,xe=!f.options.moving;for(const $e of Se){const Ee=se?c.DepthMode.disabled:f.depthModeForSublayer($e.overscaledZ-we,1===u.paint.get("raster-opacity")?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly,k.LESS),ke=$e.toUnwrapped(),Re=t.getTile($e);if(se&&(!Re||!Re.hasData()))continue;const st=se?$e.projMatrix:f.transform.calculateProjMatrix(ke,xe),Ue=f.terrain&&se?f.terrain.stencilModeForRTTOverlap($e):fe[$e.overscaledZ],je=E?0:u.paint.get("raster-fade-duration");Re.registerFadeDuration(je);const bt=t.findLoadedParent($e,0),Ht=Dr(Re,bt,t,f.transform,je);let Zt,$t;f.terrain&&f.terrain.prepareDrawTile();const jt="nearest"===u.paint.get("raster-resampling")?k.NEAREST:k.LINEAR;I.activeTexture.set(k.TEXTURE0),Re.texture.bind(jt,k.CLAMP_TO_EDGE),I.activeTexture.set(k.TEXTURE1),bt?(bt.texture.bind(jt,k.CLAMP_TO_EDGE),Zt=Math.pow(2,bt.tileID.overscaledZ-Re.tileID.overscaledZ),$t=[Re.tileID.canonical.x*Zt%1,Re.tileID.canonical.y*Zt%1]):Re.texture.bind(jt,k.CLAMP_TO_EDGE);const it=nc(st,$t||[0,0],Zt||1,Ht,u,B instanceof Ct?B.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(I,Z,ke),B instanceof Ct)B.boundsBuffer&&B.boundsSegments&&Z.draw(I,k.TRIANGLES,Ee,c.StencilMode.disabled,te,c.CullFaceMode.disabled,it,u.id,B.boundsBuffer,f.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:pn,tileBoundsIndexBuffer:hn,tileBoundsSegments:Un}=f.getTileBoundsBuffers(Re);Z.draw(I,k.TRIANGLES,Ee,Ue,te,c.CullFaceMode.disabled,it,u.id,pn,hn,Un)}}f.resetStencilClippingMasks()},background:function(f,t,u,v){const w=u.paint.get("background-color"),E=u.paint.get("background-opacity");if(0===E)return;const I=f.context,k=I.gl,B=f.transform,Z=B.tileSize,te=u.paint.get("background-pattern");if(f.isPatternMissing(te))return;const se=!te&&1===w.a&&1===E&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==se)return;const fe=c.StencilMode.disabled,Se=f.depthModeForSublayer(0,"opaque"===se?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly),we=f.colorModeForRenderPass(),xe=f.useProgram(te?"backgroundPattern":"background");let $e,Ee=v;Ee||($e=f.getBackgroundTiles(),Ee=Object.values($e).map(Re=>Re.tileID)),te&&(I.activeTexture.set(k.TEXTURE0),f.imageManager.bind(f.context));const ke=u.getCrossfadeParameters();for(const Re of Ee){const st=Re.toUnwrapped(),Ue=v?Re.projMatrix:f.transform.calculateProjMatrix(st);f.prepareDrawTile();const je=t?t.getTile(Re):$e?$e[Re.key]:new c.Tile(Re,Z,B.zoom,f),bt=te?ds(Ue,E,f,te,{tileID:Re,tileSize:Z},ke):kd(Ue,E,w);f.prepareDrawProgram(I,xe,st);const{tileBoundsBuffer:Ht,tileBoundsIndexBuffer:Zt,tileBoundsSegments:$t}=f.getTileBoundsBuffers(je);xe.draw(I,k.TRIANGLES,Se,fe,we,c.CullFaceMode.disabled,bt,u.id,Ht,Zt,$t)}},sky:function(f,t,u){const v=f.transform,w="mercator"===v.projection.name||"globe"===v.projection.name?1:c.smoothstep(7,8,v.zoom),E=u.paint.get("sky-opacity")*w;if(0===E)return;const I=f.context,k=u.paint.get("sky-type"),B=new c.DepthMode(I.gl.LEQUAL,c.DepthMode.ReadOnly,[0,1]),Z=f.frameCounter/1e3%1;"atmosphere"===k?"offscreen"===f.renderPass?u.needsSkyboxCapture(f)&&(function(te,se,fe,Se){const we=te.context,xe=we.gl;let $e=se.skyboxFbo;if(!$e){$e=se.skyboxFbo=we.createFramebuffer(32,32,!1),se.skyboxGeometry=new ha(we),se.skyboxTexture=we.gl.createTexture(),xe.bindTexture(xe.TEXTURE_CUBE_MAP,se.skyboxTexture),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MAG_FILTER,xe.LINEAR);for(let st=0;st<6;++st)xe.texImage2D(xe.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,xe.RGBA,32,32,0,xe.RGBA,xe.UNSIGNED_BYTE,null)}we.bindFramebuffer.set($e.framebuffer),we.viewport.set([0,0,32,32]);const Ee=se.getCenter(te,!0),ke=te.useProgram("skyboxCapture"),Re=new Float64Array(16);c.identity(Re),c.rotateY(Re,Re,.5*-Math.PI),Os(we,se,ke,Re,Ee,0),c.identity(Re),c.rotateY(Re,Re,.5*Math.PI),Os(we,se,ke,Re,Ee,1),c.identity(Re),c.rotateX(Re,Re,.5*-Math.PI),Os(we,se,ke,Re,Ee,2),c.identity(Re),c.rotateX(Re,Re,.5*Math.PI),Os(we,se,ke,Re,Ee,3),c.identity(Re),Os(we,se,ke,Re,Ee,4),c.identity(Re),c.rotateY(Re,Re,Math.PI),Os(we,se,ke,Re,Ee,5),we.viewport.set([0,0,te.width,te.height])}(f,u),u.markSkyboxValid(f)):"sky"===f.renderPass&&function(te,se,fe,Se,we){const xe=te.context,$e=xe.gl,Ee=te.transform,ke=te.useProgram("skybox");xe.activeTexture.set($e.TEXTURE0),$e.bindTexture($e.TEXTURE_CUBE_MAP,se.skyboxTexture);const Re={u_matrix:Ee.skyboxMatrix,u_sun_direction:se.getCenter(te,!1),u_cubemap:0,u_opacity:Se,u_temporal_offset:we};te.prepareDrawProgram(xe,ke),ke.draw(xe,$e.TRIANGLES,fe,c.StencilMode.disabled,te.colorModeForRenderPass(),c.CullFaceMode.backCW,Re,"skybox",se.skyboxGeometry.vertexBuffer,se.skyboxGeometry.indexBuffer,se.skyboxGeometry.segment)}(f,u,B,E,Z):"gradient"===k&&"sky"===f.renderPass&&function(te,se,fe,Se,we){const xe=te.context,$e=xe.gl,Ee=te.transform,ke=te.useProgram("skyboxGradient");se.skyboxGeometry||(se.skyboxGeometry=new ha(xe)),xe.activeTexture.set($e.TEXTURE0);let Re=se.colorRampTexture;Re||(Re=se.colorRampTexture=new c.Texture(xe,se.colorRamp,$e.RGBA)),Re.bind($e.LINEAR,$e.CLAMP_TO_EDGE);const st=(Ue=Ee.skyboxMatrix,je=se.getCenter(te,!1),bt=se.paint.get("sky-gradient-radius"),Ht=Se,Zt=we,{u_matrix:Ue,u_color_ramp:0,u_center_direction:je,u_radius:c.degToRad(bt),u_opacity:Ht,u_temporal_offset:Zt});var Ue,je,bt,Ht,Zt;te.prepareDrawProgram(xe,ke),ke.draw(xe,$e.TRIANGLES,fe,c.StencilMode.disabled,te.colorModeForRenderPass(),c.CullFaceMode.backCW,st,"skyboxGradient",se.skyboxGeometry.vertexBuffer,se.skyboxGeometry.indexBuffer,se.skyboxGeometry.segment)}(f,u,B,E,Z)},debug:function(f,t,u){for(let v=0;v<u.length;v++)Mo(f,t,u[v])},custom:function(f,t,u){const v=f.context,w=u.implementation;if(f.transform.projection.unsupportedLayers&&f.transform.projection.unsupportedLayers.includes("custom"))c.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===f.renderPass){const E=w.prerender;E&&(f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),E.call(w,v.gl,f.transform.customLayerMatrix()),v.setDirty(),f.setBaseState())}else if("translucent"===f.renderPass){f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),v.setStencilMode(c.StencilMode.disabled);const E="3d"===w.renderingMode?new c.DepthMode(f.context.gl.LEQUAL,c.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,c.DepthMode.ReadOnly);v.setDepthMode(E),w.render(v.gl,f.transform.customLayerMatrix()),v.setDirty(),f.setBaseState(),v.bindFramebuffer.set(null)}}};class vl{constructor(t,u){this.context=new Te(t),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=c.SourceCache.maxUnderzooming+c.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new La,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,u){const v=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ji(this,t));const w=this._terrain;this.transform.elevation=v?w:null,w.update(t,this.transform,u)}_updateFog(t){const u=t.fog;if(!u||"globe"===this.transform.projection.name||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,w]=u.getFovAdjustedRange(this.transform._fov);if(v>w)return void(this.transform.fogCullDistSq=null);const E=v+.78*(w-v);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,u){if(this.width=t*c.exported.devicePixelRatio,this.height=u*c.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._layers[v].resize()}setup(){const t=this.context,u=new c.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(c.EXTENT,0),u.emplaceBack(0,c.EXTENT),u.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(u,c.posAttributes.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);const v=new c.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(c.EXTENT,0),v.emplaceBack(0,c.EXTENT),v.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=t.createVertexBuffer(v,c.posAttributes.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);const w=new c.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(w,c.posAttributes.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);const E=new c.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(c.EXTENT,0,c.EXTENT,0),E.emplaceBack(0,c.EXTENT,0,c.EXTENT),E.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(E,c.boundsAttributes.members),this.mercatorBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);const I=new c.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(I);const k=new c.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])k.emplaceBack(Z);this.debugIndexBuffer=t.createIndexBuffer(k),this.emptyTexture=new c.Texture(t,new c.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=c.create();const B=this.context.gl;this.stencilClearMode=new c.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(c.window.performance.now()),this.atmosphereBuffer=new ju(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,u=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,u.TRIANGLES,c.DepthMode.disabled,this.stencilClearMode,c.ColorMode.disabled,c.CullFaceMode.disabled,kr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,u,v){if(!u||this.currentStencilSource===u.id||!t.isTileClipped()||!v||0===v.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let k=!1;for(const B of v)if(void 0===this._tileClippingMaskIDs[B.key]){k=!0;break}if(!k)return}this.currentStencilSource=u.id;const w=this.context,E=w.gl;this.nextStencilID+v.length>256&&this.clearStencil(),w.setColorMode(c.ColorMode.disabled),w.setDepthMode(c.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of v){const B=u.getTile(k),Z=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,{tileBoundsBuffer:te,tileBoundsIndexBuffer:se,tileBoundsSegments:fe}=this.getTileBoundsBuffers(B);I.draw(w,E.TRIANGLES,c.DepthMode.disabled,new c.StencilMode({func:E.ALWAYS,mask:0},Z,255,E.KEEP,E.KEEP,E.REPLACE),c.ColorMode.disabled,c.CullFaceMode.disabled,kr(k.projMatrix),"$clipping",te,se,fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,u=this.context.gl;return new c.StencilMode({func:u.NOTEQUAL,mask:255},t,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const u=this.context.gl;return new c.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(t){const u=this.context.gl,v=t.sort((I,k)=>k.overscaledZ-I.overscaledZ),w=v[v.length-1].overscaledZ,E=v[0].overscaledZ-w+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const I={};for(let k=0;k<E;k++)I[k+w]=new c.StencilMode({func:u.GEQUAL,mask:255},k+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=E,[I,v]}return[{[w]:c.StencilMode.disabled},v]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new c.ColorMode([t.CONSTANT_COLOR,t.ONE],new c.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?c.ColorMode.unblended:c.ColorMode.alphaBlended}depthModeForSublayer(t,u,v){if(!this.opaquePassEnabledForLayer())return c.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new c.DepthMode(v||this.context.gl.LEQUAL,u,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,u){this.style=t,this.options=u,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(c.exported.now()),this.imageManager.beginFrame();const v=this.style.order,w=this.style._sourceCaches;for(const B in w){const Z=w[B];Z.used&&Z.prepare(this.context)}const E={},I={},k={};for(const B in w){const Z=w[B];E[B]=Z.getVisibleCoordinates(),I[B]=E[B].slice().reverse(),k[B]=Z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<v.length;B++)if(this.style._layers[v[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new c.GlobeSharedBuffers(this.context)),c.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const B of v){const Z=this.style._layers[B],te=t._getLayerSourceCache(Z);if(!Z.hasOffscreenPass()||Z.isHidden(this.transform.zoom))continue;const se=te?I[te.id]:void 0;("custom"===Z.type||Z.isSky()||se&&se.length)&&this.renderLayer(this,te,Z,se)}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[v[this.currentLayer]],Z=t._getLayerSourceCache(B);if(B.isSky())continue;const te=Z?I[Z.id]:void 0;this._renderTileClippingMasks(B,Z,te),this.renderLayer(this,Z,B,te)}if(this.style.fog&&this.transform.projection.supportsFog&&function(B,Z){const te=B.context,se=te.gl,fe=B.transform,Se=new c.DepthMode(se.LEQUAL,c.DepthMode.ReadOnly,[0,1]),we=B.useProgram("globeAtmosphere",null,"globe"===fe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),xe=c.globeToMercatorTransition(fe.zoom),$e=Z.properties.get("color").toArray01(),Ee=Z.properties.get("high-color").toArray01(),ke=Z.properties.get("space-color").toArray01PremultipliedAlpha(),Re=c.identity$1([]);c.rotateY$1(Re,Re,-c.degToRad(fe._center.lng)),c.rotateX$1(Re,Re,c.degToRad(fe._center.lat)),c.rotateZ$1(Re,Re,fe.angle),c.rotateX$1(Re,Re,-fe._pitch);const st=c.fromQuat(new Float32Array(16),Re),Ue=c.mapValue(Z.properties.get("star-intensity"),0,1,0,.25),bt=c.mapValue(Z.properties.get("horizon-blend"),0,1,5e-4,.25),Ht=c.globeUseCustomAntiAliasing(B,te,fe)&&5e-4===bt?fe.worldSize/(2*Math.PI*1.025)-1:fe.globeRadius,Zt=B.frameCounter/1e3%1,$t=c.length(fe.globeCenterInViewSpace),jt=Math.sqrt(Math.pow($t,2)-Math.pow(Ht,2)),it=Math.acos(jt/$t),pn={u_frustum_tl:fe.frustumCorners.TL,u_frustum_tr:fe.frustumCorners.TR,u_frustum_br:fe.frustumCorners.BR,u_frustum_bl:fe.frustumCorners.BL,u_horizon:fe.frustumCorners.horizon,u_transition:xe,u_fadeout_range:bt,u_color:$e,u_high_color:Ee,u_space_color:ke,u_star_intensity:Ue,u_star_size:5*c.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Zt,u_horizon_angle:it,u_rotation_matrix:st};B.prepareDrawProgram(te,we);const hn=B.atmosphereBuffer;hn&&we.draw(te,se.TRIANGLES,Se,c.StencilMode.disabled,c.ColorMode.alphaBlended,c.CullFaceMode.backCW,pn,"skybox",hn.vertexBuffer,hn.indexBuffer,hn.segments)}(this,this.style.fog),this.renderPass="sky",(c.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const B=this.style._layers[v[this.currentLayer]],Z=t._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,Z,B,Z?I[Z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;){const B=this.style._layers[v[this.currentLayer]],Z=t._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const te=Z?("symbol"===B.type?k:I)[Z.id]:void 0;this._renderTileClippingMasks(B,Z,Z?E[Z.id]:void 0),this.renderLayer(this,Z,B,te),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let B=null;c.values(this.style._layers).forEach(Z=>{const te=t._getLayerSourceCache(Z);te&&!Z.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<te.getSource().maxzoom)&&(B=te)}),B&&this.options.showTileBoundaries&&qs.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const Z=B.transform.padding;ws(B,B.transform.height-(Z.top||0),3,ll),ws(B,Z.bottom||0,3,Va),Zo(B,Z.left||0,3,Ol),Zo(B,B.transform.width-(Z.right||0),3,Ea);const te=B.transform.centerPoint;var se,fe,Se,we;cr(se=B,(fe=te.x)-1,(Se=B.transform.height-te.y)-10,2,20,we=Ma),cr(se,fe-10,Se-1,20,2,we)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(c.window.performance.now()),this.saveCanvasCopy())}}renderLayer(t,u,v,w){v.isHidden(this.transform.zoom)||("background"===v.type||"sky"===v.type||"custom"===v.type||w&&w.length)&&(this.id=v.id,this.gpuTimingStart(v),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(v.type)||qs[v.type](t,u,v,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let v=this.gpuTimers[t.id];v||(v=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),v.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,u=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),t.beginQueryEXT(t.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const u={};for(const v in t){const w=t[v],E=this.context.extTimerQuery,I=E.getQueryObjectEXT(w.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(w.query),u[v]=I}return u}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let v=0;for(const w of t)v+=u.getQueryObjectEXT(w,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(w);return v}translatePosMatrix(t,u,v,w,E){if(!v[0]&&!v[1])return t;const I=E?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(I){const Z=Math.sin(I),te=Math.cos(I);v=[v[0]*te-v[1]*Z,v[0]*Z+v[1]*te]}const k=[E?v[0]:On(u,v[0],this.transform.zoom),E?v[1]:On(u,v[1],this.transform.zoom),0],B=new Float32Array(16);return c.translate(B,t,k),B}saveTileTexture(t){const u=this._tileTextures[t.size[0]];u?u.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const u=this._tileTextures[t];return u&&u.length>0?u.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const u=this.imageManager.getPattern(t.from.toString()),v=this.imageManager.getPattern(t.to.toString());return!u||!v}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,u=this.style&&this.style.fog,v=[];return this.terrain&&!this.terrain.renderingToTexture&&v.push("TERRAIN"),u&&!t&&0!==u.getOpacity(this.transform.pitch)&&v.push("FOG"),t&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}useProgram(t,u,v){this.cache=this.cache||{};const w=v||[],E=this.currentGlobalDefines().concat(w),I=rl.cacheKey(t,E,u);return this.cache[I]||(this.cache[I]=new rl(this.context,t,da[t],u,ic[t],E)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=c.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,u,v){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const E=w.getOpacity(this.transform.pitch),I=((k,B,Z,te,se,fe,Se,we,xe,$e,Ee)=>{const ke=k.transform,Re=B.properties.get("color").toArray01();Re[3]=te;const st=k.frameCounter/1e3%1;return{u_fog_matrix:Z?ke.calculateFogTileMatrix(Z):k.identityMat,u_fog_range:B.getFovAdjustedRange(ke._fov),u_fog_color:Re,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:st,u_frustum_tl:se,u_frustum_tr:fe,u_frustum_br:Se,u_frustum_bl:we,u_globe_pos:xe,u_globe_radius:$e,u_viewport:Ee,u_globe_transition:c.globeToMercatorTransition(ke.zoom),u_is_globe:+("globe"===ke.projection.name)}})(this,w,v,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*c.exported.devicePixelRatio,this.transform.height*c.exported.devicePixelRatio]);u.setFogUniformValues(t,I)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,u=t.createTexture();return t.bindTexture(t.TEXTURE_2D,u),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,u=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const w of v)u[w.key]=t[w.key]||new c.Tile(w,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class Ua{constructor(t=0,u=0,v=0,w=0){if(isNaN(t)||t<0||isNaN(u)||u<0||isNaN(v)||v<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=u,this.left=v,this.right=w}interpolate(t,u,v){return null!=u.top&&null!=t.top&&(this.top=c.number(t.top,u.top,v)),null!=u.bottom&&null!=t.bottom&&(this.bottom=c.number(t.bottom,u.bottom,v)),null!=u.left&&null!=t.left&&(this.left=c.number(t.left,u.left,v)),null!=u.right&&null!=t.right&&(this.right=c.number(t.right,u.right,v)),this}getCenter(t,u){const v=c.clamp((this.left+t-this.right)/2,0,t),w=c.clamp((this.top+u-this.bottom)/2,0,u);return new c.pointGeometry(v,w)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ua(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function kl(f,t){const u=c.getColumn(f,3);c.fromQuat(f,t),c.setColumn(f,3,u)}function oc(f,t){const u=c.identity$1([]);return c.rotateZ$1(u,u,-t),c.rotateX$1(u,u,-f),u}function Rl(f,t){const u=[f[0],f[1],0],v=[t[0],t[1],0];if(c.length(u)>=1e-15){const I=c.normalize([],u);c.scale$2(v,I,c.dot(v,I)),t[0]=v[0],t[1]=v[1]}const w=c.cross([],t,f);if(c.len(w)<1e-15)return null;const E=Math.atan2(-w[1],w[0]);return oc(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),E)}class sc{constructor(t,u){this.position=t,this.orientation=u}get position(){return this._position}set position(t){if(t){const u=t instanceof c.MercatorCoordinate?t:new c.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(u.x=c.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(t,u){if(this.orientation=null,!this.position)return;const v=this._elevation?this._elevation.getAtPointOrZero(c.MercatorCoordinate.fromLngLat(t)):0,w=this.position,E=c.MercatorCoordinate.fromLngLat(t,v),I=[E.x-w.x,E.y-w.y,E.z-w.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Rl(I,u)}setPitchBearing(t,u){this.orientation=oc(c.degToRad(t),c.degToRad(-u))}}class zi{constructor(t,u){this._transform=c.identity([]),this.orientation=u,this.position=t}get mercatorPosition(){const t=this.position;return new c.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=c.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var u;t&&c.setColumn(this._transform,3,[(u=t)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||c.identity$1([]),t&&kl(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,u){this._orientation=oc(t,u),kl(this._transform,this._orientation)}forward(){const t=c.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=c.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=c.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,u){const v=new Float64Array(16);return c.invert(v,this.getWorldToCamera(t,u)),v}getWorldToCameraPosition(t,u,v){const w=this.position;c.scale$2(w,w,-t);const E=new Float64Array(16);return c.fromScaling(E,[v,v,v]),c.translate(E,E,w),E[10]*=u,E}getWorldToCamera(t,u){const v=new Float64Array(16),w=new Float64Array(4),E=this.position;return c.conjugate(w,this._orientation),c.scale$2(E,E,-t),c.fromQuat(v,w),c.translate(v,v,E),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=u,v[9]*=u,v[10]*=u,v[11]*=u,v}getCameraToClipPerspective(t,u,v,w){const E=new Float64Array(16);return c.perspective(E,t,u,v,w),E}getDistanceToElevation(t){const u=0===t?0:c.mercatorZfromAltitude(t,this.position[1]),v=this.forward();return(u-this.position[2])/v[2]}clone(){return new zi([...this.position],[...this.orientation])}}function Hn(f,t){const u=hs(f.projection,f.zoom,f.width,f.height),v=function(E,I,k,B,Z){const te=new c.LngLat(k.lng-180*ja,k.lat),se=new c.LngLat(k.lng+180*ja,k.lat),fe=E.project(te.lng,te.lat),Se=E.project(se.lng,se.lat),we=-Math.atan2(Se.y-fe.y,Se.x-fe.x),xe=c.MercatorCoordinate.fromLngLat(k);xe.y=c.clamp(xe.y,-.999975,.999975);const $e=xe.toLngLat(),Ee=E.project($e.lng,$e.lat),ke=c.MercatorCoordinate.fromLngLat($e);ke.x+=ja;const Re=ke.toLngLat(),st=E.project(Re.lng,Re.lat),Ue=Ll(st.x-Ee.x,st.y-Ee.y,we),je=c.MercatorCoordinate.fromLngLat($e);je.y+=ja;const bt=je.toLngLat(),Ht=E.project(bt.lng,bt.lat),Zt=Ll(Ht.x-Ee.x,Ht.y-Ee.y,we),$t=Math.abs(Ue.x)/Math.abs(Zt.y),jt=c.identity([]);c.rotateZ(jt,jt,-we*(1-(Z?0:B)));const it=c.identity([]);return c.scale(it,it,[1,1-(1-$t)*B,1]),it[4]=-Zt.x/Zt.y*B,c.rotateZ(it,it,we),c.multiply(it,jt,it),it}(f.projection,0,f.center,u,t),w=Ys(f);return c.scale(v,v,[w,w,1]),v}function Ys(f){const t=f.projection,u=hs(f.projection,f.zoom,f.width,f.height),v=ac(t,f.center),w=ac(t,c.LngLat.convert(t.center));return Math.pow(2,v*u+(1-u)*w)}function hs(f,t,u,v,w=1/0){const E=f.range;if(!E)return 0;const I=Math.min(w,Math.max(u,v)),k=Math.log(I/1024)/Math.LN2;return c.smoothstep(E[0]+k,E[1]+k,t)}const ja=1/4e4;function ac(f,t){const u=c.clamp(t.lat,-c.MAX_MERCATOR_LATITUDE,c.MAX_MERCATOR_LATITUDE),v=new c.LngLat(t.lng-180*ja,u),w=new c.LngLat(t.lng+180*ja,u),E=f.project(v.lng,u),I=f.project(w.lng,u),k=c.MercatorCoordinate.fromLngLat(v),B=c.MercatorCoordinate.fromLngLat(w),Z=I.x-E.x,te=I.y-E.y,se=B.x-k.x,fe=B.y-k.y,Se=Math.sqrt((se*se+fe*fe)/(Z*Z+te*te));return Math.log(Se)/Math.LN2}function Ll(f,t,u){const v=Math.cos(u),w=Math.sin(u);return{x:f*v-t*w,y:f*w+t*v}}class Oc{constructor(t,u,v,w,E,I,k){this.tileSize=512,this._renderWorldCopies=void 0===E||E,this._minZoom=t||0,this._maxZoom=u||22,this._minPitch=v??0,this._maxPitch=w??60,this.setProjection(I),this.setMaxBounds(k),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ua,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new zi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new Oc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){const u=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||u)&&this._updateCameraOnTerrain(),(t||u)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return c.pick(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=c.getProjection(this.projectionOptions);const v=!Ce(u,this.getProjection());return v&&this._calcMatrices(),v}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return c.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.pointGeometry(this.width,this.height)}get bearing(){return c.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const u=-t*Math.PI/180;var v,w,E,I,k,B,Z,te,se,fe;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(v=new c.ARRAY_TYPE(4),c.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),w=this.rotationMatrix,I=this.angle,k=(E=this.rotationMatrix)[0],B=E[1],Z=E[2],te=E[3],se=Math.sin(I),fe=Math.cos(I),w[0]=k*fe+Z*se,w[1]=B*fe+te*se,w[2]=k*-se+Z*fe,w[3]=B*-se+te*fe)}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const u=c.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const u=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let w=0,E=0;for(let I=0;I<u.length;I++){const k=new c.pointGeometry(u[I][0]*this.width,v+u[I][1]*(this.height-v)),B=t.pointCoordinate(k);if(!B)continue;const Z=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);w+=B[3]*Z,E+=Z}return 0===E?NaN:w/E}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*u,w=this._mercatorZfromZoom(t),E=this._mercatorZfromZoom(this._maxZoom),I=Math.max(w-v,E);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let v;v=t.z<this._camera.position[2]?[u.x,u.y,u.z]:[t.x,t.y,t.z];const w=c.length(c.sub([],this._camera.position,v));return c.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let u=!1;if(t.orientation&&!c.exactEquals(t.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(t.orientation)),t.position){const v=[t.position.x,t.position.y,t.position.z];c.exactEquals$1(v,this._camera.position)||(this._setCameraPosition(v),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,u=new sc;return u.position=new c.MercatorCoordinate(t[0],t[1],t[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(t){if(!c.length$1(t))return!1;c.normalize$1(t,t);const u=c.transformQuat([],[0,0,-1],t),v=c.transformQuat([],[0,-1,0],t);if(v[2]<0)return!1;const w=Rl(u,v);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(t){const u=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;t[2]=c.clamp(t[2],w/v,w/u),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,u,v){this._unmodified=!1,this._edgeInsets.interpolate(t,u,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const u=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(t){const u=[new c.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const v=this.pointCoordinate(new c.pointGeometry(0,0)),w=this.pointCoordinate(new c.pointGeometry(this.width,0)),E=this.pointCoordinate(new c.pointGeometry(this.width,this.height)),I=this.pointCoordinate(new c.pointGeometry(0,this.height)),k=Math.floor(Math.min(v.x,w.x,E.x,I.x)),B=Math.floor(Math.max(v.x,w.x,E.x,I.x)),Z=1;for(let te=k-Z;te<=B+Z;te++)0!==te&&u.push(new c.UnwrappedTileID(te,t))}return u}coveringTiles(t){let u=this.coveringZoomLevel(t);const v=u,w=this.elevation&&!t.isTerrainDEM,E="mercator"===this.projection.name;if(void 0!==t.minzoom&&u<t.minzoom)return[];void 0!==t.maxzoom&&u>t.maxzoom&&(u=t.maxzoom);const I=this.locationCoordinate(this.center),k=this.center.lat,B=1<<u,Z=[B*I.x,B*I.y,0],te="globe"===this.projection.name,se=!te,fe=c.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,se),Se=te?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),we=B*c.mercatorZfromAltitude(1,this.center.lat),xe=this._camera.position[2]/c.mercatorZfromAltitude(1,this.center.lat),$e=[B*Se.x,B*Se.y,xe*(se?1:we)],Ee=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),ke=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,Re=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,st=t.isTerrainDEM?-Re:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ue=this.projection.isReprojectedInTileSpace?Ys(this):1,je=tn=>{const Fn=new c.MercatorCoordinate(tn.x+25e-6,tn.y,tn.z),Vn=new c.MercatorCoordinate(tn.x,tn.y+25e-6,tn.z),In=tn.toLngLat(),Nn=Fn.toLngLat(),Si=Vn.toLngLat(),bi=this.locationCoordinate(In),Qi=this.locationCoordinate(Nn),pi=this.locationCoordinate(Si),Gi=Math.hypot(Qi.x-bi.x,Qi.y-bi.y),mr=Math.hypot(pi.x-bi.x,pi.y-bi.y);return Math.sqrt(Gi*mr)*Ue/25e-6},bt=tn=>{const ci=Re,Fn=st;return{aabb:c.tileAABB(this,B,0,0,0,tn,Fn,ci,this.projection),zoom:0,x:0,y:0,minZ:Fn,maxZ:ci,wrap:tn,fullyVisible:!1}},Ht=[];let Zt=[];const $t=u,jt=t.reparseOverscaled?v:u,it=tn=>tn*tn,pn=it((xe-this._centerAltitude)*we),hn=tn=>{if(!this._elevation||!tn.tileID||!E)return;const ci=this._elevation.getMinMaxForTile(tn.tileID),Fn=tn.aabb;ci?(Fn.min[2]=ci.min,Fn.max[2]=ci.max,Fn.center[2]=(Fn.min[2]+Fn.max[2])/2):(tn.shouldSplit=Un(tn),tn.shouldSplit||(Fn.min[2]=Fn.max[2]=Fn.center[2]=this._centerAltitude))},Un=tn=>{if(tn.zoom<ke)return!0;if(tn.zoom===$t)return!1;if(null!=tn.shouldSplit)return tn.shouldSplit;const ci=tn.aabb.distanceX($e),Fn=tn.aabb.distanceY($e);let Vn=pn,In=1;if(te){Vn=it(tn.aabb.distanceZ($e));const Si=Math.pow(2,tn.zoom),bi=c.latFromMercatorY((tn.y+1)/Si),Qi=c.latFromMercatorY(tn.y/Si),pi=Math.min(Math.max(k,bi),Qi),Gi=c.circumferenceAtLatitude(pi)/c.circumferenceAtLatitude(k);if(In=pi===k?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Gi/this._mercatorScaleRatio),this.zoom<=c.GLOBE_ZOOM_THRESHOLD_MIN&&tn.zoom===$t-1&&Gi>=.9)return!0}else if(w&&(Vn=it(tn.aabb.distanceZ($e)*we)),this.projection.isReprojectedInTileSpace&&v<=5){const Si=Math.pow(2,tn.zoom),bi=je(new c.MercatorCoordinate((tn.x+.5)/Si,(tn.y+.5)/Si));In=bi>.85?1:bi}const Nn=ci*ci+Fn*Fn+Vn;return Nn<it((1<<$t-tn.zoom)*Ee*In*((Si,bi)=>{if(bi*it(.707)<Si)return 1;const Qi=Math.sqrt(bi/Si);return Qi/(1.4144271570014144+(Math.pow(1.1,Qi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Vn,pn),Nn))};if(this.renderWorldCopies)for(let tn=1;tn<=3;tn++)Ht.push(bt(-tn)),Ht.push(bt(tn));for(Ht.push(bt(0));Ht.length>0;){const tn=Ht.pop(),ci=tn.x,Fn=tn.y;let Vn=tn.fullyVisible;if(!Vn){const In=tn.aabb.intersects(fe);if(0===In)continue;Vn=2===In}if(tn.zoom!==$t&&Un(tn))for(let In=0;In<4;In++){const Nn=(ci<<1)+In%2,Si=(Fn<<1)+(In>>1),bi={aabb:E?tn.aabb.quadrant(In):c.tileAABB(this,B,tn.zoom+1,Nn,Si,tn.wrap,tn.minZ,tn.maxZ,this.projection),zoom:tn.zoom+1,x:Nn,y:Si,wrap:tn.wrap,fullyVisible:Vn,tileID:void 0,shouldSplit:void 0,minZ:tn.minZ,maxZ:tn.maxZ};w&&!te&&(bi.tileID=new c.OverscaledTileID(tn.zoom+1===$t?jt:tn.zoom+1,tn.wrap,tn.zoom+1,Nn,Si),hn(bi)),Ht.push(bi)}else{const In=tn.zoom===$t?jt:tn.zoom;if(t.minzoom&&t.minzoom>In)continue;const Nn=Z[0]-(.5+ci+(tn.wrap<<tn.zoom))*(1<<u-tn.zoom),Si=Z[1]-.5-Fn,bi=tn.tileID?tn.tileID:new c.OverscaledTileID(In,tn.wrap,tn.zoom,ci,Fn);Zt.push({tileID:bi,distanceSq:Nn*Nn+Si*Si})}}if(this.fogCullDistSq){const tn=this.fogCullDistSq,ci=this.horizonLineFromTop();Zt=Zt.filter(Fn=>{const Vn=[0,0,0,1],In=[c.EXTENT,c.EXTENT,0,1],Nn=this.calculateFogTileMatrix(Fn.tileID.toUnwrapped());c.transformMat4$1(Vn,Vn,Nn),c.transformMat4$1(In,In,Nn);const Si=c.getAABBPointSquareDist(Vn,In);if(0===Si)return!0;let bi=!1;const Qi=this._elevation;if(Qi&&Si>tn&&0!==ci){const pi=this.calculateProjMatrix(Fn.tileID.toUnwrapped());let Gi;t.isTerrainDEM||(Gi=Qi.getMinMaxForTile(Fn.tileID)),Gi||(Gi={min:st,max:Re});const mr=c.furthestTileCorner(this.rotation),Ir=[mr[0]*c.EXTENT,mr[1]*c.EXTENT,Gi.max];c.transformMat4(Ir,Ir,pi),bi=(1-Ir[1])*this.height*.5<ci}return Si<tn||bi})}return Zt.sort((tn,ci)=>tn.distanceSq-ci.distanceSq).map(tn=>tn.tileID)}resize(t,u){this.width=t,this.height=u,this.pixelsToGLUnits=[2/t,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const u=c.clamp(t.lat,-c.MAX_MERCATOR_LATITUDE,c.MAX_MERCATOR_LATITUDE),v=this.projection.project(t.lng,u);return new c.pointGeometry(v.x*this.worldSize,v.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,u){let v,w;const E=this.centerPoint;if("globe"===this.projection.name){const k=this.worldSize;v=(u.x-E.x)/k,w=(u.y-E.y)/k}else{const k=this.pointCoordinate(u),B=this.pointCoordinate(E);v=k.x-B.x,w=k.y-B.y}const I=this.locationCoordinate(t);this.setLocation(new c.MercatorCoordinate(I.x-v,I.y-w))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,u){const v=u?c.mercatorZfromAltitude(u,t.lat):void 0,w=this.projection.project(t.lng,t.lat);return new c.MercatorCoordinate(w.x,w.y,v)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,u){const v=u??this._centerAltitude,w=[t.x,t.y,0,1],E=[t.x,t.y,1,1];c.transformMat4$1(w,w,this.pixelMatrixInverse),c.transformMat4$1(E,E,this.pixelMatrixInverse);const I=E[3];c.scale$1(w,w,1/w[3]),c.scale$1(E,E,1/I);const k=w[2],B=E[2];return{p0:w,p1:E,t:k===B?0:(v-k)/(B-k)}}screenPointToMercatorRay(t){const u=[t.x,t.y,0,1],v=[t.x,t.y,1,1];return c.transformMat4$1(u,u,this.pixelMatrixInverse),c.transformMat4$1(v,v,this.pixelMatrixInverse),c.scale$1(u,u,1/u[3]),c.scale$1(v,v,1/v[3]),u[2]=c.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,v[2]=c.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,c.scale$1(u,u,1/this.worldSize),c.scale$1(v,v,1/this.worldSize),new c.Ray([u[0],u[1],u[2]],c.normalize([],c.sub([],v,u)))}rayIntersectionCoordinate(t){const{p0:u,p1:v,t:w}=t,E=c.mercatorZfromAltitude(u[2],this._center.lat),I=c.mercatorZfromAltitude(v[2],this._center.lat);return new c.MercatorCoordinate(c.number(u[0],v[0],w)/this.worldSize,c.number(u[1],v[1],w)/this.worldSize,c.number(E,I,w))}pointCoordinate(t,u=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,u)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let u=this.projection.pointCoordinate3D(this,t.x,t.y);if(u)return new c.MercatorCoordinate(u[0],u[1],u[2]);let v=0,w=this.horizonLineFromTop();if(t.y>w)return this.pointCoordinate(t);const E=.02*w,I=t.clone();for(let k=0;k<10&&w-v>E;k++){I.y=c.number(v,w,.66);const B=this.projection.pointCoordinate3D(this,I.x,I.y);B?(w=I.y,u=B):v=I.y}return u?new c.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}_coordinatePoint(t,u){const v=u&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,w=[t.x*this.worldSize,t.y*this.worldSize,v+t.toAltitude(),1];return c.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new c.pointGeometry(w[0]/w[3],w[1]/w[3]):new c.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(t,u){const v=new c.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),w=new c.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),E=new c.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),I=new c.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let k=this.pointCoordinate(v,t),B=this.pointCoordinate(w,t);const Z=this.pointCoordinate(E,u),te=this.pointCoordinate(I,u),se=(fe,Se)=>(Se.y-fe.y)/(Se.x-fe.x);return k.y>1&&B.y>=0?k=new c.MercatorCoordinate((1-te.y)/se(te,k)+te.x,1):k.y<0&&B.y<=1&&(k=new c.MercatorCoordinate(-te.y/se(te,k)+te.x,0)),B.y>1&&k.y>=0?B=new c.MercatorCoordinate((1-Z.y)/se(Z,B)+Z.x,1):B.y<0&&k.y<=1&&(B=new c.MercatorCoordinate(-Z.y/se(Z,B)+Z.x,0)),(new c.LngLatBounds).extend(this.coordinateLocation(k)).extend(this.coordinateLocation(B)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(Z))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length)return this._getBounds(0,0);const u=t.visibleDemTiles.reduce((v,w)=>{if(w.dem){const E=w.dem.tree;v.min=Math.min(v.min,E.minimums[0]),v.max=Math.max(v.max,E.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBounds(u.min*t.exaggeration(),u.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,v=this.height/2-u*(1-this._horizonShift);return t?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-c.MAX_MERCATOR_LATITUDE,this.maxLat=c.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=c.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=c.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=c.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=c.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,u){return this.projection.createTileMatrix(this,u,t)}calculateDistanceTileData(t){const u=t.key,v=this._distanceTileDataCache;if(v[u])return v[u];const w=t.canonical,E=1/this.height,I=this.cameraWorldSize/this.zoomScale(w.z),k=(w.x+Math.pow(2,w.z)*t.wrap)*I,B=w.y*I,Z=this.point,te=this.angle,se=Math.sin(-te),fe=-Math.cos(-te);return v[u]={bearing:[se,fe],center:[(Z.x-k)*E,(Z.y-B)*E],scale:I/c.EXTENT*E},v[u]}calculateFogTileMatrix(t){const u=t.key,v=this._fogTileMatrixCache;if(v[u])return v[u];const w=this.projection.createTileMatrix(this,this.cameraWorldSize,t);return c.multiply(w,this.worldToFogMatrix,w),v[u]=new Float32Array(w),v[u]}calculateProjMatrix(t,u=!1){const v=t.key,w=u?this._alignedProjMatrixCache:this._projMatrixCache;if(w[v])return w[v];const E=this.calculatePosMatrix(t,this.worldSize);return c.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,E),w[v]=new Float32Array(E),w[v]}calculatePixelsToTileUnitsMatrix(t){const u=t.tileID.key,v=this._pixelsToTileUnitsCache;if(v[u])return v[u];const w=function(E,I){const{scale:k}=E.tileTransform,B=k*c.EXTENT/(E.tileSize*Math.pow(2,I.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return Z=new Float32Array(4),fe=(te=I.inverseAdjustmentMatrix)[1],Se=te[2],we=te[3],$e=(se=[B,B])[1],Z[0]=te[0]*(xe=se[0]),Z[1]=fe*xe,Z[2]=Se*$e,Z[3]=we*$e,Z;var Z,te,se,fe,Se,we,xe,$e}(t,this);return v[u]=w,v[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const u=c.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(u),w=this._camera.forward(),E=c.mercatorZfromAltitude(1,this._center.lat);v[2]/=E,w[2]/=E,c.normalize(w,w);const I=t.raycast(v,w,t.exaggeration());if(I){const k=c.scaleAndAdd([],v,w,I),B=new c.MercatorCoordinate(k[0],k[1],c.mercatorZfromAltitude(k[2],c.latFromMercatorY(k[1]))),Z=(B.z+c.length([B.x-v[0],B.y-v[1],B.z-v[2]*E]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const u=c.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(u),w=t.getAtPointOrZero(new c.MercatorCoordinate(...v)),E=this._minimumHeightOverTerrain()*Math.cos(c.degToRad(this._maxPitch)),I=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*w;if(I<E){const k=this.locationCoordinate(this._center,this._centerAltitude),B=[k.x-v[0],k.y-v[1],k.z-v[2]],Z=c.length(B);B[2]-=(E-I)/this._projectionScaler;const te=c.length(B);if(0===te)return;c.scale$2(B,B,Z/te*this._projectionScaler),this._camera.position=[k.x-B[0],k.y-B[1],k.z*this._projectionScaler-B[2]],this._camera.orientation=Rl(B,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const se=this.center;return se.lat=c.clamp(se.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(se.lng=c.clamp(se.lng,this.minLng,this.maxLng)),this.center=se,void(this._constraining=!1)}const t=this._unmodified,{x:u,y:v}=this.point;let w=0,E=u,I=v;const k=this.width/2,B=this.height/2,Z=this.worldMinY*this.scale,te=this.worldMaxY*this.scale;if(v-B<Z&&(I=Z+B),v+B>te&&(I=te-B),te-Z<this.height&&(w=Math.max(w,this.height/(te-Z)),I=(te+Z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const se=this.worldMinX*this.scale,fe=this.worldMaxX*this.scale,Se=this.worldSize/2-(se+fe)/2;E=(u+Se+this.worldSize)%this.worldSize-Se,E-k<se&&(E=se+k),E+k>fe&&(E=fe-k),fe-se<this.width&&(w=Math.max(w,this.width/(fe-se)),E=(fe+se)/2)}E===u&&I===v||(this.center=this.unproject(new c.pointGeometry(E,I))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCameraAltitude(),this._unmodified=t,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,u=this.pixelsPerMeter;if("globe"===this.projection.name){const Ue=c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,je=c.mercatorZfromAltitude(1,c.GLOBE_SCALE_MATCH_LATITUDE)*this.worldSize;this._mercatorScaleRatio=Ue/je}const v=hs(this.projection,this.zoom,this.width,this.height,1024);this._projectionScaler=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=this.getCameraToCenterDistance(this.projection),this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?u:1),E=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);E[8]=2*-t.x/this.width,E[9]=2*t.y/this.height;let I=c.mul([],E,w);if(this.projection.isReprojectedInTileSpace){const Ue=this.locationCoordinate(this.center),je=c.identity([]);c.translate(je,je,[Ue.x*this.worldSize,Ue.y*this.worldSize,0]),c.multiply(je,je,Hn(this)),c.translate(je,je,[-Ue.x*this.worldSize,-Ue.y*this.worldSize,0]),c.multiply(I,I,je),this.inverseAdjustmentMatrix=function(bt){const Ht=Hn(bt,!0);return Fe([],[Ht[0],Ht[1],Ht[4],Ht[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=c.scale([],I,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=I,this.invProjMatrix=c.invert(new Float64Array(16),this.projMatrix);const k=c.invert([],E);this.frustumCorners=c.FrustumCorners.fromInvProjectionMatrix(k,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);c.identity(B),c.scale(B,B,[1,-1,1]),c.rotateX(B,B,this._pitch),c.rotateZ(B,B,this.angle);const Z=c.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),te=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Z[8]=2*-t.x/this.width,Z[9]=2*(t.y+te)/this.height,this.skyboxMatrix=c.multiply(B,Z,B);const se=this.point,fe=se.x,Se=se.y,we=this.width%2/2,xe=this.height%2/2,$e=Math.cos(this.angle),Ee=Math.sin(this.angle),ke=fe-Math.round(fe)+$e*we+Ee*xe,Re=Se-Math.round(Se)+$e*xe+Ee*we,st=new Float64Array(I);if(c.translate(st,st,[ke>.5?ke-1:ke,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=st,I=c.create(),c.scale(I,I,[this.width/2,-this.height/2,1]),c.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=c.create(),c.scale(I,I,[1,-1,1]),c.translate(I,I,[-1,-1,0]),c.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=c.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=c.calculateGlobeMatrix(this);const Ue=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=c.transformMat4(Ue,Ue,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSize,u=this.cameraPixelsPerMeter,v=this._camera.position,w=1/this.height/this._projectionScaler,E=[t,t,u];c.scale$2(E,E,w),c.scale$2(v,v,-1),c.multiply$2(v,v,E);const I=c.create();c.translate(I,I,v),c.scale(I,I,E),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,u,w)}_computeCameraPosition(t){const u=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),w=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-t/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-v[0]*E,w.y/this.worldSize-v[1]*E,t/this.worldSize*this._centerAltitude-v[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=t[2];let w=1;v>0&&(w=Math.min((u-this._camera.position[2])/v,1)),this._camera.position=c.scaleAndAdd([],this._camera.position,t,w),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const t=this._camera.position,u=this._camera.forward(),{pitch:v,bearing:w}=this._camera.getPitchBearing(),E=c.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(c.degToRad(this._maxPitch)),k=Math.max((t[2]-E)/Math.cos(v),I),B=this._zoomFromMercatorZ(k);c.scaleAndAdd(t,t,u,k),this._pitch=c.clamp(v,c.degToRad(this.minPitch),c.degToRad(this.maxPitch)),this.angle=c.wrap(w,-Math.PI,Math.PI),this._setZoom(c.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new c.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(c.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,u){const v=Math.min(t.x,u.x),w=Math.max(t.x,u.x),E=Math.min(t.y,u.y),I=Math.max(t.y,u.y);if(E<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const k=[new c.pointGeometry(v,E),new c.pointGeometry(w,I),new c.pointGeometry(v,I),new c.pointGeometry(w,E)],B=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const te of k){const se=this.pointRayIntersection(te);if(se.t<0)return!0;const fe=this.rayIntersectionCoordinate(se);if(fe.x<B||fe.y<0||fe.x>Z||fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+c.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new c.pointGeometry(0,0),new c.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,u){const v=c.length(c.sub([],this._camera.position,t)),w=this._zoomFromMercatorZ(v)+u;return v-this._mercatorZfromZoom(w)}getCameraPoint(){if("globe"===this.projection.name){const t=function(u,v){const w=[u[0],u[1],u[2],1];c.transformMat4$1(w,w,v);const E=Math.max(w[3],1e-6);return[w[0]/E,w[1]/E,w[2]/E,E]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new c.pointGeometry(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.pointGeometry(0,t))}}getCameraToCenterDistance(t){const u=hs(t,this.zoom,this.width,this.height,1024),v=t.pixelSpaceConversion(this.center.lat,this.worldSize,u);return.5/Math.tan(.5*this._fov)*this.height*v}}function bl(f,t){let u=!1,v=null;const w=()=>{v=null,u&&(f(),v=setTimeout(w,t),u=!1)};return()=>(u=!0,v||w(),v)}class su{constructor(t){this._hashName=t&&encodeURIComponent(t),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=bl(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,c.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),c.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(t){const u=this._map;if(!u)return"";const v=u.getCenter(),w=Math.round(100*u.getZoom())/100,E=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,E),k=Math.round(v.lng*I)/I,B=Math.round(v.lat*I)/I,Z=u.getBearing(),te=u.getPitch();let se="";if(se+=t?`/${k}/${B}/${w}`:`${w}/${B}/${k}`,(Z||te)&&(se+="/"+Math.round(10*Z)/10),te&&(se+=`/${Math.round(te)}`),this._hashName){const fe=this._hashName;let Se=!1;const we=c.window.location.hash.slice(1).split("&").map(xe=>{const $e=xe.split("=")[0];return $e===fe?(Se=!0,`${$e}=${se}`):xe}).filter(xe=>xe);return Se||we.push(`${fe}=${se}`),`#${we.join("&")}`}return`#${se}`}_getCurrentHash(){const t=c.window.location.hash.replace("#","");if(this._hashName){let u;return t.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(u=v)}),(u&&u[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(v=>isNaN(v))){const v=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(u[3]||0):t.getBearing();return t.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:v,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=c.window.location.href.replace(/(#.+)?$/,this.getHashString());c.window.history.replaceState(c.window.history.state,null,t)}}const Wo={linearity:.3,easing:c.bezier(0,0,.3,1)},au=c.extend({deceleration:2500,maxSpeed:1400},Wo),Fl=c.extend({deceleration:20,maxSpeed:1400},Wo),Ga=c.extend({deceleration:1e3,maxSpeed:360},Wo),lc=c.extend({deceleration:1e3,maxSpeed:90},Wo);class kc{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,u=c.exported.now();for(;t.length>0&&u-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new c.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)u.zoom+=E.zoomDelta||0,u.bearing+=E.bearingDelta||0,u.pitch+=E.pitchDelta||0,E.panDelta&&u.pan._add(E.panDelta),E.around&&(u.around=E.around),E.pinchAround&&(u.pinchAround=E.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(u.pan.mag()){const E=Bl(u.pan.mag(),v,c.extend({},au,t||{}));w.offset=u.pan.mult(E.amount/u.pan.mag()),w.center=this._map.transform.center,Ha(w,E)}if(u.zoom){const E=Bl(u.zoom,v,Fl);w.zoom=this._map.transform.zoom+E.amount,Ha(w,E)}if(u.bearing){const E=Bl(u.bearing,v,Ga);w.bearing=this._map.transform.bearing+c.clamp(E.amount,-179,179),Ha(w,E)}if(u.pitch){const E=Bl(u.pitch,v,lc);w.pitch=this._map.transform.pitch+E.amount,Ha(w,E)}if(w.zoom||w.bearing){const E=void 0===u.pinchAround?u.around:u.pinchAround;w.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Ha(f,t){(!f.duration||f.duration<t.duration)&&(f.duration=t.duration,f.easing=t.easing)}function Bl(f,t,u){const{maxSpeed:v,linearity:w,deceleration:E}=u,I=c.clamp(f*w/(t/1e3),-v,v),k=Math.abs(I)/(E*w);return{easing:u.easing,duration:1e3*k,amount:I*(k/2)}}class ps extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,v,w={}){const E=St(u.getCanvasContainer(),v),I=u.unproject(E);super(t,c.extend({point:E,lngLat:I,originalEvent:v},w)),this._defaultPrevented=!1,this.target=u}}class $a extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,v){const w="touchend"===t?v.changedTouches:v.touches,E=Pn(u.getCanvasContainer(),w),I=E.map(B=>u.unproject(B)),k=E.reduce((B,Z,te,se)=>B.add(Z.div(se.length)),new c.pointGeometry(0,0));super(t,{points:E,point:k,lngLats:I,lngLat:u.unproject(k),originalEvent:v}),this._defaultPrevented=!1}}class Gu extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,v){super(t,{originalEvent:v}),this._defaultPrevented=!1}}class Do{constructor(t,u){this._map=t,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Gu(t.type,this._map,t))}mousedown(t,u){return this._mousedownPos=u,this._firePreventable(new ps(t.type,this._map,t))}mouseup(t){this._map.fire(new ps(t.type,this._map,t))}preclick(t){const u=c.extend({},t);u.type="preclick",this._map.fire(new ps(u.type,this._map,u))}click(t,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(t),this._map.fire(new ps(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new ps(t.type,this._map,t))}mouseover(t){this._map.fire(new ps(t.type,this._map,t))}mouseout(t){this._map.fire(new ps(t.type,this._map,t))}touchstart(t){return this._firePreventable(new $a(t.type,this._map,t))}touchmove(t){this._map.fire(new $a(t.type,this._map,t))}touchend(t){this._map.fire(new $a(t.type,this._map,t))}touchcancel(t){this._map.fire(new $a(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rd{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new ps(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ps("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new ps(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rc{constructor(t,u){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,u){this.isEnabled()&&t.shiftKey&&0===t.button&&(gt(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(t,u){if(!this._active)return;const v=u;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const w=this._startPos;this._lastPos=v,this._box||(this._box=Me("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const E=Math.min(w.x,v.x),I=Math.max(w.x,v.x),k=Math.min(w.y,v.y),B=Math.max(w.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${k}px)`,this._box.style.width=I-E+"px",this._box.style.height=B-k+"px")})}mouseupWindow(t,u){if(!this._active||0!==t.button)return;const v=this._startPos,w=u;if(this.reset(),Ft(),v.x!==w.x||v.y!==w.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:E=>E.fitScreenCoordinates(v,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),et(),delete this._startPos,delete this._lastPos}_fireEvent(t,u){return this._map.fire(new c.Event(t,{originalEvent:u}))}}function Za(f,t){const u={};for(let v=0;v<f.length;v++)u[f[v].identifier]=t[v];return u}class lu{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,u,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),v.length===this.numTouches&&(this.centroid=function(w){const E=new c.pointGeometry(0,0);for(const I of w)E._add(I);return E.div(w.length)}(u),this.touches=Za(v,u)))}touchmove(t,u,v){if(this.aborted||!this.centroid)return;const w=Za(v,u);for(const E in this.touches){const I=this.touches[E],k=w[E];(!k||k.dist(I)>30)&&(this.aborted=!0)}}touchend(t,u,v){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===v.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class zl{constructor(t){this.singleTap=new lu(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,u,v){this.singleTap.touchstart(t,u,v)}touchmove(t,u,v){this.singleTap.touchmove(t,u,v)}touchend(t,u,v){const w=this.singleTap.touchend(t,u,v);if(w){const E=t.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(w)<30;if(E&&I||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Hu{constructor(){this._zoomIn=new zl({numTouches:1,numTaps:2}),this._zoomOut=new zl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,u,v){this._zoomIn.touchstart(t,u,v),this._zoomOut.touchstart(t,u,v)}touchmove(t,u,v){this._zoomIn.touchmove(t,u,v),this._zoomOut.touchmove(t,u,v)}touchend(t,u,v){const w=this._zoomIn.touchend(t,u,v),E=this._zoomOut.touchend(t,u,v);return w?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(w)},{originalEvent:t})}):E?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(E)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ks={0:1,2:2};class $u{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,u){return!1}_move(t,u){return{}}mousedown(t,u){if(this._lastPoint)return;const v=Xn(t);this._correctButton(t,v)&&(this._lastPoint=u,this._eventButton=v)}mousemoveWindow(t,u){const v=this._lastPoint;if(v)if(t.preventDefault(),null!=this._eventButton&&function(w,E){const I=Ks[E];return void 0===w.buttons||(w.buttons&I)!==I}(t,this._eventButton))this.reset();else if(this._moved||!(u.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(v,u)}mouseupWindow(t){this._lastPoint&&Xn(t)===this._eventButton&&(this._moved&&Ft(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ld extends $u{mousedown(t,u){super.mousedown(t,u),this._lastPoint&&(this._active=!0)}_correctButton(t,u){return 0===u&&!t.ctrlKey}_move(t,u){return{around:u,panDelta:u.sub(t)}}}class Es extends $u{_correctButton(t,u){return 0===u&&t.ctrlKey||2===u}_move(t,u){const v=.8*(u.x-t.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(t){t.preventDefault()}}class cu extends $u{_correctButton(t,u){return 0===u&&t.ctrlKey||2===u}_move(t,u){const v=-.5*(u.y-t.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(t){t.preventDefault()}}class pa{constructor(t,u){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),c.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new c.pointGeometry(0,0)}touchstart(t,u,v){return this._calculateTransform(t,u,v)}touchmove(t,u,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===v.length)return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.preventDefault(),this._calculateTransform(t,u,v)}}touchend(t,u,v){this._calculateTransform(t,u,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,u,v){v.length>0&&(this._active=!0);const w=Za(v,u),E=new c.pointGeometry(0,0),I=new c.pointGeometry(0,0);let k=0;for(const Z in w){const te=w[Z],se=this._touches[Z];se&&(E._add(te),I._add(te.sub(se)),k++,w[Z]=te)}if(this._touches=w,k<this._minTouches||!I.mag())return;const B=I.div(k);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(k),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Me("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class ks{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,u,v){return{}}touchstart(t,u,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([u[0],u[1]]))}touchmove(t,u,v){const w=this._firstTwoTouches;if(!w)return;t.preventDefault();const[E,I]=w,k=uo(v,u,E),B=uo(v,u,I);if(!k||!B)return;const Z=this._aroundCenter?null:k.add(B).div(2);return this._move([k,B],Z,t)}touchend(t,u,v){if(!this._firstTwoTouches)return;const[w,E]=this._firstTwoTouches,I=uo(v,u,w),k=uo(v,u,E);I&&k||(this._active&&Ft(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function uo(f,t,u){for(let v=0;v<f.length;v++)if(f[v].identifier===u)return t[v]}function xl(f,t){return Math.log(f/t)/Math.LN2}class fa extends ks{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,u){const v=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(xl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xl(this._distance,v),pinchAround:u}}}function Zu(f,t){return 180*f.angleWith(t)/Math.PI}class Wu extends ks{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,u){const v=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Zu(this._vector,v),pinchAround:u}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const u=25/(Math.PI*this._minDiameter)*360,v=Zu(t,this._startVector);return Math.abs(v)<u}}function fs(f){return Math.abs(f.y)>Math.abs(f.x)}class wh extends ks{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,fs(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,u,v){const w=this._lastPoints;if(!w)return;const E=t[0].sub(w[0]),I=t[1].sub(w[1]);return this._map._cooperativeGestures&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(E,I,v.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(E.y+I.y)/2*-.5})}gestureBeginsVertically(t,u,v){if(void 0!==this._valid)return this._valid;const w=t.mag()>=2,E=u.mag()>=2;if(!w&&!E)return;if(!w||!E)return null==this._firstMove&&(this._firstMove=v),v-this._firstMove<100&&void 0;const I=t.y>0==u.y>0;return fs(t)&&fs(u)&&I}}const cc={panStep:100,bearingStep:15,pitchStep:10};class fr{constructor(){const t=cc;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let u=0,v=0,w=0,E=0,I=0;switch(t.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:t.shiftKey?v=-1:(t.preventDefault(),E=-1);break;case 39:t.shiftKey?v=1:(t.preventDefault(),E=1);break;case 38:t.shiftKey?w=1:(t.preventDefault(),I=-1);break;case 40:t.shiftKey?w=-1:(t.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(v=0,w=0),{cameraAnimation:k=>{const B=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:qu,zoom:u?Math.round(B)+u*(t.shiftKey?2:1):B,bearing:k.getBearing()+v*this._bearingStep,pitch:k.getPitch()+w*this._pitchStep,offset:[-E*this._panStep,-I*this._panStep],center:k.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qu(f){return f*(2-f)}const Jn=4.000244140625;class Yu{constructor(t,u){this._map=t,this._el=t.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,c.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=t.deltaMode===c.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const v=c.exported.now(),w=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,0!==u&&u%Jn==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(w*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),t.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=t,this._delta-=u,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=St(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform,u=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const B="wheel"===this._type&&Math.abs(this._delta)>Jn?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&0!==Z&&(Z=1/Z);const te=u(),se=Math.pow(2,te),fe="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):se;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(fe*Z))),"wheel"===this._type&&(this._startZoom=u(),this._easing=this._smoothOutEasing(200)),this._delta=0}const v="number"==typeof this._targetZoom?this._targetZoom:u(),w=this._startZoom,E=this._easing;let I,k=!1;if("wheel"===this._type&&w&&E){const B=Math.min((c.exported.now()-this._lastWheelEventTime)/200,1),Z=E(B);I=c.number(w,v,Z),B<1?this._frameId||(this._frameId=!0):k=!0}else I=v,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:I-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let u=c.ease;if(this._prevEase){const v=this._prevEase,w=(c.exported.now()-v.start)/v.duration,E=v.easing(w+.01)-v.easing(w),I=.27/Math.sqrt(E*E+1e-4)*.01,k=Math.sqrt(.0729-I*I);u=c.bezier(I,k,.25,1)}return this._prevEase={start:c.exported.now(),duration:t,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Me("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(c.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!c.window.document.fullscreenElement||!!c.window.document.webkitFullscreenElement}_showBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Ch{constructor(t,u){this._clickZoom=t,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wa{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,u){return t.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(t.shiftKey?-1:1),around:v.unproject(u)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uu{constructor(){this._tap=new zl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,u,v){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=u[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(t,u,v))}touchmove(t,u,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const w=u[0],E=w.y-this._swipePoint.y;return this._swipePoint=w,t.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(t,u,v)}touchend(t,u,v){this._tapTime?this._swipePoint&&0===v.length&&this.reset():this._tap.touchend(t,u,v)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uc{constructor(t,u,v){this._el=t,this._mousePan=u,this._touchPan=v}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nl{constructor(t,u,v){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=u,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Eh{constructor(t,u,v,w){this._el=t,this._touchZoom=u,this._touchRotate=v,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const dc=f=>f.zoom||f.drag||f.pitch||f.rotate;class To extends c.Event{}class du{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,u){const v=c.sub([],u,t);this.radius=c.length(v[2]<0?c.div([],v,this.constants):[v[0],v[1],0])}projectRay(t){c.div(t,t,this.constants),c.normalize(t,t),c.mul$1(t,t,this.constants);const u=c.scale$2([],t,this.radius);if(u[2]>0){const v=c.scale$2([],[0,0,1],c.dot(u,[0,0,1])),w=c.scale$2([],c.normalize([],[u[0],u[1],0]),this.radius),E=c.add([],u,c.scale$2([],c.sub([],c.add([],w,v),u),2));u[0]=E[0],u[1]=E[1]}return u}}function qa(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Fd{constructor(t,u){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new kc(t),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new du,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),c.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[c.window.document,"mousemove",{capture:!0}],[c.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[c.window,"blur",void 0]];for(const[w,E,I]of this._listeners)w.addEventListener(E,w===c.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[t,u,v]of this._listeners)t.removeEventListener(u,t===c.window.document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(t){const u=this._map,v=u.getCanvasContainer();this._add("mapEvent",new Do(u,t));const w=u.boxZoom=new Rc(u,t);this._add("boxZoom",w);const E=new Hu,I=new Wa;u.doubleClickZoom=new Ch(I,E),this._add("tapZoom",E),this._add("clickZoom",I);const k=new uu;this._add("tapDragZoom",k);const B=u.touchPitch=new wh(u);this._add("touchPitch",B);const Z=new Es(t),te=new cu(t);u.dragRotate=new Nl(t,Z,te),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",te,["mouseRotate"]);const se=new Ld(t),fe=new pa(u,t);u.dragPan=new uc(v,se,fe),this._add("mousePan",se),this._add("touchPan",fe,["touchZoom","touchRotate"]);const Se=new Wu,we=new fa;u.touchZoomRotate=new Eh(v,we,Se,k),this._add("touchRotate",Se,["touchPan","touchZoom"]),this._add("touchZoom",we,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Rd(u));const xe=u.scrollZoom=new Yu(u,this);this._add("scrollZoom",xe,["mousePan"]);const $e=u.keyboard=new fr;this._add("keyboard",$e);for(const Ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[Ee]&&u[Ee].enable(t[Ee])}_add(t,u,v){this._handlers.push({handlerName:t,handler:u,allowed:v}),this._handlersById[t]=u}stop(t){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!dc(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,u,v){for(const w in t)if(w!==v&&(!u||u.indexOf(w)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const u=[];for(const v of t)this._el.contains(v.target)&&u.push(v);return u}handleEvent(t,u){this._updatingCamera=!0;const v="renderFrame"===t.type,w=v?void 0:t,E={needsRenderFrame:!1},I={},k={},B=t.touches?this._getMapTouches(t.touches):void 0,Z=B?Pn(this._el,B):v?void 0:St(this._el,t);for(const{handlerName:fe,handler:Se,allowed:we}of this._handlers){if(!Se.isEnabled())continue;let xe;this._blockedByActive(k,we,fe)?Se.reset():Se[u||t.type]&&(xe=Se[u||t.type](t,Z,B),this.mergeHandlerResult(E,I,xe,fe,w),xe&&xe.needsRenderFrame&&this._triggerRenderFrame()),(xe||Se.isActive())&&(k[fe]=Se)}const te={};for(const fe in this._previousActiveHandlers)k[fe]||(te[fe]=w);this._previousActiveHandlers=k,(Object.keys(te).length||qa(E))&&(this._changes.push([E,I,te]),this._triggerRenderFrame()),(Object.keys(k).length||qa(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:se}=E;se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],se(this._map))}mergeHandlerResult(t,u,v,w,E){if(!v)return;c.extend(t,v);const I={handlerName:w,originalEvent:v.originalEvent||E};void 0!==v.zoomDelta&&(u.zoom=I),void 0!==v.panDelta&&(u.drag=I),void 0!==v.pitchDelta&&(u.pitch=I),void 0!==v.bearingDelta&&(u.rotate=I)}_applyChanges(){const t={},u={},v={};for(const[w,E,I]of this._changes)w.panDelta&&(t.panDelta=(t.panDelta||new c.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(t.around=w.around),void 0!==w.aroundCoord&&(t.aroundCoord=w.aroundCoord),void 0!==w.pinchAround&&(t.pinchAround=w.pinchAround),w.noInertia&&(t.noInertia=w.noInertia),c.extend(u,E),c.extend(v,I);this._updateMapTransform(t,u,v),this._changes=[]}_updateMapTransform(t,u,v){const w=this._map,E=w.transform,I=ke=>[ke.x,ke.y,ke.z];if((ke=>{const Re=this._eventsInProgress.drag;return Re&&!this._handlersById[Re.handlerName].isActive()})()&&!qa(t)){const ke=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",ke!==E.zoom&&this._map._update(!0)}if(!qa(t))return void this._fireEvents(u,v,!0);let{panDelta:k,zoomDelta:B,bearingDelta:Z,pitchDelta:te,around:se,aroundCoord:fe,pinchAround:Se}=t;void 0!==Se&&(se=Se),(ke=>u.drag&&!this._eventsInProgress.drag)()&&se&&(this._dragOrigin=I(E.pointCoordinate3D(se)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",w._stop(!0),se=se||w.transform.centerPoint,Z&&(E.bearing+=Z),te&&(E.pitch+=te),E._updateCameraState();const we=[0,0,0];if(k){const ke=E.pointCoordinate(se);if("globe"===E.projection.name){const Re=c.latFromMercatorY(ke.y),st=E.center.lat,Ue=Math.min(c.mercatorZfromAltitude(1,Re)/c.mercatorZfromAltitude(1,st),2);k=k.rotate(-E.angle),we[0]=-k.x/E.worldSize*Ue,we[1]=-k.y/E.worldSize*Ue}else{const Re=E.pointCoordinate(se.sub(k));ke&&Re&&(we[0]=Re.x-ke.x,we[1]=Re.y-ke.y)}}const xe=E.zoom,$e=[0,0,0];if(B){const ke=I(fe||E.pointCoordinate3D(se)),Re={dir:c.normalize([],c.sub([],ke,E._camera.position))};if(Re.dir[2]<0){const st=E.zoomDeltaToMovement(ke,B);c.scale$2($e,Re.dir,st)}}const Ee=c.add(we,we,$e);E._translateCameraConstrained(Ee),B&&Math.abs(E.zoom-xe)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(u,v,!0)}_fireEvents(t,u,v){const w=dc(this._eventsInProgress),E=dc(t),I={};for(const te in t){const{originalEvent:se}=t[te];this._eventsInProgress[te]||(I[`${te}start`]=se),this._eventsInProgress[te]=t[te]}!w&&E&&this._fireEvent("movestart",E.originalEvent);for(const te in I)this._fireEvent(te,I[te]);E&&this._fireEvent("move",E.originalEvent);for(const te in t){const{originalEvent:se}=t[te];this._fireEvent(te,se)}const k={};let B;for(const te in this._eventsInProgress){const{handlerName:se,originalEvent:fe}=this._eventsInProgress[te];this._handlersById[se].isActive()||(delete this._eventsInProgress[te],B=u[se]||fe,k[`${te}end`]=B)}for(const te in k)this._fireEvent(te,k[te]);const Z=dc(this._eventsInProgress);if(v&&(w||E)&&!Z){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),se=fe=>0!==fe&&-this._bearingSnap<fe&&fe<this._bearingSnap;te?(se(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:B})):(this._map.fire(new c.Event("moveend",{originalEvent:B})),se(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,u){this._map.fire(new c.Event(t,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new To("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const F="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class L extends c.Evented{constructor(t,u){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=u.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}getCenter(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,u){return this.jumpTo({center:t},u)}panBy(t,u,v){return t=c.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,c.extend({offset:t},u),v)}panTo(t,u,v){return this.easeTo(c.extend({center:t},u),v)}getZoom(){return this.transform.zoom}setZoom(t,u){return this.jumpTo({zoom:t},u),this}zoomTo(t,u,v){return this.easeTo(c.extend({zoom:t},u),v)}zoomIn(t,u){return this.zoomTo(this.getZoom()+1,t,u),this}zoomOut(t,u){return this.zoomTo(this.getZoom()-1,t,u),this}getBearing(){return this.transform.bearing}setBearing(t,u){return this.jumpTo({bearing:t},u),this}getPadding(){return this.transform.padding}setPadding(t,u){return this.jumpTo({padding:t},u),this}rotateTo(t,u,v){return this.easeTo(c.extend({bearing:t},u),v)}resetNorth(t,u){return this.rotateTo(0,c.extend({duration:1e3},t),u),this}resetNorthPitch(t,u){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},t),u),this}snapToNorth(t,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,u):this}getPitch(){return this.transform.pitch}setPitch(t,u){return this.jumpTo({pitch:t},u),this}cameraForBounds(t,u){"globe"===this.transform.projection.name&&c.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),t=c.LngLatBounds.convert(t);const v=u&&u.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),v,u)}_extendCameraOptions(t){const u={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=c.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const v=t.padding;t.padding={top:v,bottom:v,right:v,left:v}}return t.padding=c.extend(u,t.padding),t}_cameraForBoxAndBearing(t,u,v,w){const E=this._extendCameraOptions(w),I=this.transform,k=I.padding,B=I.project(c.LngLat.convert(t)),Z=I.project(c.LngLat.convert(u)),te=new c.pointGeometry(B.x,Z.y),se=new c.pointGeometry(Z.x,B.y),fe=-c.degToRad(v),Se=B.rotate(fe),we=Z.rotate(fe),xe=te.rotate(fe),$e=se.rotate(fe),Ee=new c.pointGeometry(Math.max(Se.x,we.x,xe.x,$e.x),Math.max(Se.y,we.y,xe.y,$e.y)),ke=new c.pointGeometry(Math.min(Se.x,we.x,xe.x,$e.x),Math.min(Se.y,we.y,xe.y,$e.y)),Re=Ee.sub(ke),st=(I.width-((k.left||0)+(k.right||0)+E.padding.left+E.padding.right))/Re.x,Ue=(I.height-((k.top||0)+(k.bottom||0)+E.padding.top+E.padding.bottom))/Re.y;if(Ue<0||st<0)return void c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const je=Math.min(I.scaleZoom(I.scale*Math.min(st,Ue)),E.maxZoom),bt="number"==typeof E.offset.x&&"number"==typeof E.offset.y?new c.pointGeometry(E.offset.x,E.offset.y):c.pointGeometry.convert(E.offset),Ht=new c.pointGeometry((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(v*Math.PI/180),Zt=bt.add(Ht).mult(I.scale/I.zoomScale(je));return{center:I.unproject(B.add(Z).div(2).sub(Zt)),zoom:je,bearing:v}}_cameraForBox(t,u,v,w,E){const I=this._extendCameraOptions(E);v=v||0,w=w||0,t=c.LngLat.convert(t),u=c.LngLat.convert(u);const k=this.transform.clone();k.padding=I.padding;const B=this.getFreeCameraOptions(),Z=new c.LngLat(.5*(t.lng+u.lng),.5*(t.lat+u.lat)),te=.5*(v+w);if(k._camera.position[2]<c.mercatorZfromAltitude(te,Z.lat))return void c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");B.lookAtPoint(Z),k.setFreeCameraOptions(B);const se=c.MercatorCoordinate.fromLngLat(t),fe=c.MercatorCoordinate.fromLngLat(u),Se=k.pointRayIntersection(k.centerPoint,te),we=[(xe=k.rayIntersectionCoordinate(Se)).x,xe.y,xe.z];var xe;const $e=k.screenPointToMercatorRay(k.centerPoint),Ee="globe"!==k.projection.name;let ke,Re=0;do{const st=Math.floor(k.zoom),Ue=1<<st,je=Math.min(Ue*se.x,Ue*fe.x),bt=Math.min(Ue*se.y,Ue*fe.y),Ht=Math.max(Ue*se.x,Ue*fe.x),Zt=Math.max(Ue*se.y,Ue*fe.y),$t=new c.Aabb([je,bt,v],[Ht,Zt,w]),jt=c.Frustum.fromInvProjectionMatrix(k.invProjMatrix,k.worldSize,st,Ee);if(2!==$t.intersects(jt)){ke&&(k._camera.position=c.scaleAndAdd([],k._camera.position,$e.dir,-ke),k._updateStateFromCamera());break}const it=c.sub([],k._camera.position,we);ke=.5*c.length(it),k._camera.position=c.scaleAndAdd([],k._camera.position,$e.dir,ke);try{k._updateStateFromCamera()}catch{return void c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++Re<10);return{center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}}fitBounds(t,u,v){return"globe"===this.transform.projection.name&&c.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(t,u),u,v)}_raycastElevationBox(t,u){const v=this.transform.elevation;if(!v)return;const w=new c.pointGeometry(t.x,u.y),E=new c.pointGeometry(u.x,t.y),I=v.pointCoordinate(t);if(!I)return;const k=v.pointCoordinate(u);if(!k)return;const B=v.pointCoordinate(w);if(!B)return;const Z=v.pointCoordinate(E);if(!Z)return;const te=new c.MercatorCoordinate(I[0],I[1]).toLngLat(),se=new c.MercatorCoordinate(k[0],k[1]).toLngLat(),fe=new c.MercatorCoordinate(B[0],B[1]).toLngLat(),Se=new c.MercatorCoordinate(Z[0],Z[1]).toLngLat(),we=Math.min(te.lng,Math.min(se.lng,Math.min(fe.lng,Se.lng))),xe=Math.min(te.lat,Math.min(se.lat,Math.min(fe.lat,Se.lat))),$e=Math.max(te.lng,Math.max(se.lng,Math.max(fe.lng,Se.lng))),Ee=Math.max(te.lat,Math.max(se.lat,Math.max(fe.lat,Se.lat))),ke=Math.min(I[3],Math.min(k[3],Math.min(B[3],Z[3]))),Re=Math.max(I[3],Math.max(k[3],Math.max(B[3],Z[3])));return{minLngLat:new c.LngLat(we,xe),maxLngLat:new c.LngLat($e,Ee),minAltitude:ke,maxAltitude:Re}}fitScreenCoordinates(t,u,v,w,E){let I,k,B,Z;"globe"===this.transform.projection.name&&c.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const te=c.pointGeometry.convert(t),se=c.pointGeometry.convert(u),fe=this._raycastElevationBox(te,se);if(fe)I=fe.minLngLat,k=fe.maxLngLat,B=fe.minAltitude,Z=fe.maxAltitude;else{if(this.transform.anyCornerOffEdge(te,se))return this;I=this.transform.pointLocation(te),k=this.transform.pointLocation(se)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(c.pointGeometry.convert(t)),this.transform.pointLocation(c.pointGeometry.convert(u)),v,w):this._cameraForBox(I,k,B,Z,w),w,E)}_fitInternal(t,u,v){return t?(delete(u=c.extend(t,u)).padding,u.linear?this.easeTo(u,v):this.flyTo(u,v)):this}jumpTo(t,u){this.stop();const v=t.preloadOnly?this.transform.clone():this.transform;let w=!1,E=!1,I=!1;return"zoom"in t&&v.zoom!==+t.zoom&&(w=!0,v.zoom=+t.zoom),void 0!==t.center&&(v.center=c.LngLat.convert(t.center)),"bearing"in t&&v.bearing!==+t.bearing&&(E=!0,v.bearing=+t.bearing),"pitch"in t&&v.pitch!==+t.pitch&&(I=!0,v.pitch=+t.pitch),null==t.padding||v.isPaddingEqual(t.padding)||(v.padding=t.padding),t.preloadOnly?(this._preloadTiles(v),this):(this.fire(new c.Event("movestart",u)).fire(new c.Event("move",u)),w&&this.fire(new c.Event("zoomstart",u)).fire(new c.Event("zoom",u)).fire(new c.Event("zoomend",u)),E&&this.fire(new c.Event("rotatestart",u)).fire(new c.Event("rotate",u)).fire(new c.Event("rotateend",u)),I&&this.fire(new c.Event("pitchstart",u)).fire(new c.Event("pitch",u)).fire(new c.Event("pitchend",u)),this.fire(new c.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||c.warnOnce(F),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,u){const v=this.transform;if(!v.projection.supportsFreeCamera)return c.warnOnce(F),this;this.stop();const w=v.zoom,E=v.pitch,I=v.bearing;v.setFreeCameraOptions(t);const k=w!==v.zoom,B=E!==v.pitch,Z=I!==v.bearing;return this.fire(new c.Event("movestart",u)).fire(new c.Event("move",u)),k&&this.fire(new c.Event("zoomstart",u)).fire(new c.Event("zoom",u)).fire(new c.Event("zoomend",u)),Z&&this.fire(new c.Event("rotatestart",u)).fire(new c.Event("rotate",u)).fire(new c.Event("rotateend",u)),B&&this.fire(new c.Event("pitchstart",u)).fire(new c.Event("pitch",u)).fire(new c.Event("pitchend",u)),this.fire(new c.Event("moveend",u)),this}easeTo(t,u){this._stop(!1,t.easeId),(!1===(t=c.extend({offset:[0,0],duration:500,easing:c.ease},t)).animate||!t.essential&&c.exported.prefersReducedMotion)&&(t.duration=0);const v=this.transform,w=this.getZoom(),E=this.getBearing(),I=this.getPitch(),k=this.getPadding(),B="zoom"in t?+t.zoom:w,Z="bearing"in t?this._normalizeBearing(t.bearing,E):E,te="pitch"in t?+t.pitch:I,se="padding"in t?t.padding:v.padding,fe=c.pointGeometry.convert(t.offset);let Se,we,xe;if("globe"===v.projection.name){const Zt=c.MercatorCoordinate.fromLngLat(v.center),$t=fe.rotate(-v.angle);Zt.x+=$t.x/v.worldSize,Zt.y+=$t.y/v.worldSize;const jt=Zt.toLngLat(),it=c.LngLat.convert(t.center||jt);this._normalizeCenter(it),Se=v.centerPoint.add($t),we=new c.pointGeometry(Zt.x,Zt.y).mult(v.worldSize),xe=new c.pointGeometry(c.mercatorXfromLng(it.lng),c.mercatorYfromLat(it.lat)).mult(v.worldSize).sub(we)}else{Se=v.centerPoint.add(fe);const Zt=v.pointLocation(Se),$t=c.LngLat.convert(t.center||Zt);this._normalizeCenter($t),we=v.project(Zt),xe=v.project($t).sub(we)}const $e=v.zoomScale(B-w);let Ee,ke;t.around&&(Ee=c.LngLat.convert(t.around),ke=v.locationPoint(Ee));const Re=this._zooming||B!==w,st=this._rotating||E!==Z,Ue=this._pitching||te!==I,je=!v.isPaddingEqual(se),bt=Zt=>$t=>{if(Re&&(Zt.zoom=c.number(w,B,$t)),st&&(Zt.bearing=c.number(E,Z,$t)),Ue&&(Zt.pitch=c.number(I,te,$t)),je&&(Zt.interpolatePadding(k,se,$t),Se=Zt.centerPoint.add(fe)),Ee)Zt.setLocationAtPoint(Ee,ke);else{const jt=Zt.zoomScale(Zt.zoom-w),it=B>w?Math.min(2,$e):Math.max(.5,$e),pn=Math.pow(it,1-$t),hn=Zt.unproject(we.add(xe.mult($t*pn)).mult(jt));Zt.setLocationAtPoint(Zt.renderWorldCopies?hn.wrap():hn,Se)}return t.preloadOnly||this._fireMoveEvents(u),Zt};if(t.preloadOnly){const Zt=this._emulate(bt,t.duration,v);return this._preloadTiles(Zt),this}const Ht={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Re,this._rotating=st,this._pitching=Ue,this._padding=je,this._easeId=t.easeId,this._prepareEase(u,t.noMoveStart,Ht),this._ease(bt(v),Zt=>{v.recenterOnTerrain(),this._afterEase(u,Zt)},t),this}_prepareEase(t,u,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||v.moving||this.fire(new c.Event("movestart",t)),this._zooming&&!v.zooming&&this.fire(new c.Event("zoomstart",t)),this._rotating&&!v.rotating&&this.fire(new c.Event("rotatestart",t)),this._pitching&&!v.pitching&&this.fire(new c.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new c.Event("move",t)),this._zooming&&this.fire(new c.Event("zoom",t)),this._rotating&&this.fire(new c.Event("rotate",t)),this._pitching&&this.fire(new c.Event("pitch",t))}_afterEase(t,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new c.Event("zoomend",t)),w&&this.fire(new c.Event("rotateend",t)),E&&this.fire(new c.Event("pitchend",t)),this.fire(new c.Event("moveend",t))}flyTo(t,u){if(!t.essential&&c.exported.prefersReducedMotion){const Vn=c.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Vn,u)}this.stop(),t=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},t);const v=this.transform,w=this.getZoom(),E=this.getBearing(),I=this.getPitch(),k=this.getPadding(),B="zoom"in t?c.clamp(+t.zoom,v.minZoom,v.maxZoom):w,Z="bearing"in t?this._normalizeBearing(t.bearing,E):E,te="pitch"in t?+t.pitch:I,se="padding"in t?t.padding:v.padding,fe=v.zoomScale(B-w),Se=c.pointGeometry.convert(t.offset);let we=v.centerPoint.add(Se);const xe=v.pointLocation(we),$e=c.LngLat.convert(t.center||xe);this._normalizeCenter($e);const Ee=v.project(xe),ke=v.project($e).sub(Ee);let Re=t.curve;const st=Math.max(v.width,v.height),Ue=st/fe,je=ke.mag();if("minZoom"in t){const Vn=c.clamp(Math.min(t.minZoom,w,B),v.minZoom,v.maxZoom),In=st/v.zoomScale(Vn-w);Re=Math.sqrt(In/je*2)}const bt=Re*Re;function Ht(Vn){const In=(Ue*Ue-st*st+(Vn?-1:1)*bt*bt*je*je)/(2*(Vn?Ue:st)*bt*je);return Math.log(Math.sqrt(In*In+1)-In)}function Zt(Vn){return(Math.exp(Vn)-Math.exp(-Vn))/2}function $t(Vn){return(Math.exp(Vn)+Math.exp(-Vn))/2}const jt=Ht(0);let it=function(Vn){return $t(jt)/$t(jt+Re*Vn)},pn=function(Vn){return st*(($t(jt)*(Zt(In=jt+Re*Vn)/$t(In))-Zt(jt))/bt)/je;var In},hn=(Ht(1)-jt)/Re;if(Math.abs(je)<1e-6||!isFinite(hn)){if(Math.abs(st-Ue)<1e-6)return this.easeTo(t,u);const Vn=Ue<st?-1:1;hn=Math.abs(Math.log(Ue/st))/Re,pn=function(){return 0},it=function(In){return Math.exp(Vn*Re*In)}}t.duration="duration"in t?+t.duration:1e3*hn/("screenSpeed"in t?+t.screenSpeed/Re:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const Un=E!==Z,tn=te!==I,ci=!v.isPaddingEqual(se),Fn=Vn=>In=>{const Nn=In*hn,Si=1/it(Nn);Vn.zoom=1===In?B:w+Vn.scaleZoom(Si),Un&&(Vn.bearing=c.number(E,Z,In)),tn&&(Vn.pitch=c.number(I,te,In)),ci&&(Vn.interpolatePadding(k,se,In),we=Vn.centerPoint.add(Se));const bi=1===In?$e:Vn.unproject(Ee.add(ke.mult(pn(Nn))).mult(Si));return Vn.setLocationAtPoint(Vn.renderWorldCopies?bi.wrap():bi,we),Vn._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(u),Vn};if(t.preloadOnly){const Vn=this._emulate(Fn,t.duration,v);return this._preloadTiles(Vn),this}return this._zooming=!0,this._rotating=Un,this._pitching=tn,this._padding=ci,this._prepareEase(u,!1),this._ease(Fn(v),()=>this._afterEase(u),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,u)}if(!t){const v=this.handlers;v&&v.stop(!1)}return this}_ease(t,u,v){!1===v.animate||0===v.duration?(t(1),u()):(this._easeStart=c.exported.now(),this._easeOptions=v,this._onEaseFrame=t,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((c.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,u){t=c.wrap(t,-180,180);const v=Math.abs(t-u);return Math.abs(t-360-u)<v&&(t-=360),Math.abs(t+360-u)<v&&(t+=360),t}_normalizeCenter(t){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const v=t.lng-u.center.lng;t.lng+=v>180?-360:v<-180?360:0}_emulate(t,u,v){const w=Math.ceil(15*u/1e3),E=[],I=t(v.clone());for(let k=0;k<=w;k++){const B=I(k/w);E.push(B.clone())}return E}}class O{constructor(t={}){this.options=t,c.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const u=this.options&&this.options.compact;return this._map=t,this._container=Me("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Me("button","mapboxgl-ctrl-attrib-button",this._container),Me("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Me("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===u&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,u){const v=this._map._getUIString(`AttributionControl.${u}`);t.setAttribute("aria-label",v),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||c.config.ACCESS_TOKEN}];if(t){const v=u.reduce((w,E,I)=>(E.value&&(w+=`${E.key}=${E.value}${I<u.length-1?"&":""}`),w),"?");t.href=`${c.config.FEEDBACK_URL}/${v}${this._map._hash?this._map._hash.getHashString(!0):""}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const u=this._map.style._sourceCaches;for(const w in u){const E=u[w];if(E.used){const I=E.getSource();I.attribution&&t.indexOf(I.attribution)<0&&t.push(I.attribution)}}t.sort((w,E)=>w.length-E.length),t=t.filter((w,E)=>{for(let I=E+1;I<t.length;I++)if(t[I].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const v=t.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,t.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class H{constructor(){c.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Me("div","mapboxgl-ctrl");const u=Me("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const u in t){const v=t[u].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const u=t[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Q{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const u=++this._id;return this._queue.push({callback:t,id:u,cancelled:!1}),u}remove(t){const u=this._currentlyRunning,v=u?this._queue.concat(u):this._queue;for(const w of v)if(w.id===t)return void(w.cancelled=!0)}run(t=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const v of u)if(!v.cancelled&&(v.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ge(f,t,u){if(f=new c.LngLat(f.lng,f.lat),t){const v=new c.LngLat(f.lng-360,f.lat),w=new c.LngLat(f.lng+360,f.lat),E=360*Math.ceil(Math.abs(f.lng-u.center.lng)/360),I=u.locationPoint(f).distSqr(t),k=t.x<0||t.y<0||t.x>u.width||t.y>u.height;u.locationPoint(v).distSqr(t)<I&&(k||Math.abs(v.lng-u.center.lng)<E)?f=v:u.locationPoint(w).distSqr(t)<I&&(k||Math.abs(w.lng-u.center.lng)<E)&&(f=w)}for(;Math.abs(f.lng-u.center.lng)>180;){const v=u.locationPoint(f);if(v.x>=0&&v.y>=0&&v.x<=u.width&&v.y<=u.height)break;f.lng>u.center.lng?f.lng-=360:f.lng+=360}return f}const qe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class pt extends c.Evented{constructor(t,u){if(super(),(t instanceof c.window.HTMLElement||u)&&(t=c.extend({element:t},u)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),t&&t.element)this._element=t.element,this._offset=c.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Me("div");const w=41,E=27,I=Ye("svg",{display:"block",height:w*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${w}`},this._element),k=Ye("radialGradient",{id:"shadowGradient"},Ye("defs",{},I));Ye("stop",{offset:"10%","stop-opacity":.4},k),Ye("stop",{offset:"100%","stop-opacity":.05},k),Ye("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),Ye("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),Ye("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),Ye("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=c.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const v=this._element.classList;for(const w in qe)v.remove(`mapboxgl-marker-anchor-${w}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(24.6+w)],"bottom-right":[-w,-1*(24.6+w)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const u=t.code,v=t.charCode||t.keyCode;"Space"!==u&&"Enter"!==u&&32!==v&&13!==v||this.togglePopup()}_onMapClick(t){const u=t.originalEvent.target,v=this._element;this._popup&&(u===v||v.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map;if(!t)return!1;const u=t.unproject(this._pos),v=t.getFreeCameraOptions();if(!v.position)return!1;const w=v.position.toLngLat();return w.distanceTo(u)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const u=this._pos;if(!u||u.x<0||u.x>t.transform.width||u.y<0||u.y>t.transform.height)return void this._clearFadeTimer();const v=t.unproject(u);let w;t._usingGlobe()&&c.isLngLatBehindGlobe(t.transform,this._lngLat)?w=0:(w=1-t._queryFogOpacity(v),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(w*=.2)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const u=this._calculateXYTransform()+this._calculateZTransform(),v=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px) ${qe[this._anchor]}\n            ${u}\n            translate(${v.x}px,${v.y}px)\n        `}_calculateXYTransform(){const t=this._pos,u=this._map;if("map"!==this.getPitchAlignment()||!u||!t)return"";if(!u._usingGlobe()){const B=u.getPitch();return B?`rotateX(${B}deg)`:""}const v=c.radToDeg(c.globeTiltAtLngLat(u.transform,this._lngLat)),w=t.sub(c.globeCenterToScreenPoint(u.transform)),E=v/(Math.abs(w.x)+Math.abs(w.y)),I=w.x*E,k=-w.y*E;return k||I?`rotateX(${k}deg) rotateY(${I}deg)`:""}_calculateZTransform(){const t=this._calculateRotation();return t?`rotateZ(${t}deg)`:""}_calculateRotation(){if("viewport"===this._rotationAlignment||"auto"===this._rotationAlignment)return this._rotation;if(this._map&&"map"===this._rotationAlignment){const t=this._map;if(this._pos&&t&&t._usingGlobe()){const u=t.project(new c.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),v=t.project(new c.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(u);return this._rotation+c.radToDeg(Math.atan2(v.y,v.x))-90}return this._rotation-this._map.getBearing()}return 0}_update(t){c.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=ge(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),!0===t?this._updateFrameId=c.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._usingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=c.pointGeometry.convert(t),this._update(),this}_onMove(t){const u=this._map;if(u){if(!this._isDragging){const v=this._clickTolerance||u._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new c.Event("dragend")),this._state="inactive"}_addDragHandler(t){const u=this._map;u&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos),this._pointerdownPos=t.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const u=this._map;return u&&(t?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}}class an{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const u=c.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,u,v){this._start=this.getValue(u),this._end=t,this._startTime=u,this._endTime=u+v}}const ni={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ur={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function di(f){f.parentNode&&f.parentNode.removeChild(f)}const rr={showCompass:!0,showZoom:!0,visualizePitch:!1};class Jo{constructor(t,u,v=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Es({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,v&&(this.mousePitch=new cu({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(t,u){this.mouseRotate.mousedown(t,u),this.mousePitch&&this.mousePitch.mousedown(t,u),gt()}move(t,u){const v=this.map,w=this.mouseRotate.mousemoveWindow(t,u),E=w&&w.bearingDelta;if(E&&v.setBearing(v.getBearing()+E),this.mousePitch){const I=this.mousePitch.mousemoveWindow(t,u),k=I&&I.pitchDelta;k&&v.setPitch(v.getPitch()+k)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){et(),c.window.removeEventListener("mousemove",this.mousemove),c.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(c.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),St(this.element,t)),c.window.addEventListener("mousemove",this.mousemove),c.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,St(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=Pn(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=Pn(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ms={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Vl={maxWidth:100,unit:"metric"};function Rs(f,t,u){const v=hu(t),w=v/t,E={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[u];this._map._requestDomTask(()=>{this._container.style.width=f*w+"px",this._container.innerHTML=`${v}&nbsp;${E}`})}function hu(f){const t=Math.pow(10,`${Math.floor(f)}`.length-1);let u=f/t;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(v){const w=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*w)/w}(u),t*u}const Ul={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ku=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wl(f=new c.pointGeometry(0,0),t="bottom"){if("number"==typeof f){const u=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(t){case"top":return new c.pointGeometry(0,f);case"top-left":return new c.pointGeometry(u,u);case"top-right":return new c.pointGeometry(-u,u);case"bottom":return new c.pointGeometry(0,-f);case"bottom-left":return new c.pointGeometry(u,-u);case"bottom-right":return new c.pointGeometry(-u,-u);case"left":return new c.pointGeometry(f,0);case"right":return new c.pointGeometry(-f,0)}return new c.pointGeometry(0,0)}return f instanceof c.pointGeometry||Array.isArray(f)?c.pointGeometry.convert(f):c.pointGeometry.convert(f[t]||[0,0])}const Bd={version:c.version,supported:Ve,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:class extends L{constructor(f){if(null!=(f=c.extend({},ur,f)).minZoom&&null!=f.maxZoom&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=f.minPitch&&null!=f.maxPitch&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=f.minPitch&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=f.maxPitch&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&c.isSafariWithAntialiasingBug(c.window)&&(f.antialias=!1,c.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Oc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language="auto"===f.language?c.window.navigator.language:f.language,this._worldview=f.worldview,this._renderTaskQueue=new Q,this._domRenderTaskQueue=new Q,this._controls=[],this._markers=[],this._mapId=c.uniqueId(),this._locale=c.extend({},ni,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new an(0),this._explicitProjection=null,this._requestManager=new c.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,"string"==typeof f.container){if(this._container=c.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof c.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&c.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==c.window&&(c.window.addEventListener("online",this._onWindowOnline,!1),c.window.addEventListener("resize",this._onWindowResize,!1),c.window.addEventListener("orientationchange",this._onWindowResize,!1),c.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Fd(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new su("string"==typeof f.hash&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new O({customAttribution:f.customAttribution})),this._logoControl=new H,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new c.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new c.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(f,t){if(void 0===t&&(t=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=f.onAdd(this);this._controls.push(f);const v=this._controlPositions[t];return-1!==t.indexOf("bottom")?v.insertBefore(u,v.firstChild):v.appendChild(u),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(f);return t>-1&&this._controls.splice(t,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new c.Event("movestart",f)).fire(new c.Event("move",f)),this.fire(new c.Event("resize",f)),t&&this.fire(new c.Event("moveend",f)),this}getBounds(){return"globe"===this.transform.projection.name&&c.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(c.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new c.Event("zoomstart")).fire(new c.Event("zoom")).fire(new c.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new c.Event("zoomstart")).fire(new c.Event("zoom")).fire(new c.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new c.Event("pitchstart")).fire(new c.Event("pitch")).fire(new c.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new c.Event("pitchstart")).fire(new c.Event("pitch")).fire(new c.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}getLanguage(){return this._language}setLanguage(f){if(this._language="auto"===f?c.window.navigator.language:f,this.style)for(const t in this.style._sourceCaches){const u=this.style._sourceCaches[t]._source;u._setLanguage&&u._setLanguage(this._language)}for(const t of this._controls)t._setLanguage&&t._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){if(this._worldview=f,this.style)for(const t in this.style._sourceCaches){const u=this.style._sourceCaches[t]._source;u._setWorldview&&u._setWorldview(f)}return this}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}_usingGlobe(){return"globe"===this.transform.projection.name}setProjection(f){return this._lazyInitEmptyStyle(),f?"string"==typeof f&&(f={name:f}):f=null,this._updateProjection(f)}_updateProjection(f){const t=this.getProjection();null===f&&(this._explicitProjection=null);const u=f||this.getProjection();let v;if(u&&"globe"===u.name&&this.transform.zoom>=c.GLOBE_ZOOM_THRESHOLD_MAX?(v=this.transform.setProjection({name:"mercator"}),this.transform.mercatorFromTransition=!0):(v=this.transform.setProjection(u),this.transform.mercatorFromTransition=!1),f&&(this._explicitProjection="globe"===f.name?{name:"globe",center:[0,0]}:this.transform.getProjection()),this.style.applyProjectionUpdate(),v){if("globe"===t.name&&"globe"===this.getProjection().name)this.style._forceSymbolLayerUpdate();else{this.painter.clearBackgroundTiles();for(const w in this.style._sourceCaches)this.style._sourceCaches[w].clearTiles()}this._update(!0)}return this}project(f){return this.transform.locationPoint3D(c.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(c.pointGeometry.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(f,t,u){if("mouseenter"===f||"mouseover"===f){let v=!1;const w=I=>{const k=t.filter(Z=>this.getLayer(Z)),B=k.length?this.queryRenderedFeatures(I.point,{layers:k}):[];B.length?v||(v=!0,u.call(this,new ps(f,this,I.originalEvent,{features:B}))):v=!1},E=()=>{v=!1};return{layers:new Set(t),listener:u,delegates:{mousemove:w,mouseout:E}}}if("mouseleave"===f||"mouseout"===f){let v=!1;const w=I=>{const k=t.filter(B=>this.getLayer(B));(k.length?this.queryRenderedFeatures(I.point,{layers:k}):[]).length?v=!0:v&&(v=!1,u.call(this,new ps(f,this,I.originalEvent)))},E=I=>{v&&(v=!1,u.call(this,new ps(f,this,I.originalEvent)))};return{layers:new Set(t),listener:u,delegates:{mousemove:w,mouseout:E}}}{const v=w=>{const E=t.filter(k=>this.getLayer(k)),I=E.length?this.queryRenderedFeatures(w.point,{layers:E}):[];I.length&&(w.features=I,u.call(this,w),delete w.features)};return{layers:new Set(t),listener:u,delegates:{[f]:v}}}}on(f,t,u){if(void 0===u)return super.on(f,t);Array.isArray(t)||(t=[t]);const v=this._createDelegatedListener(f,t,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(v);for(const w in v.delegates)this.on(w,v.delegates[w]);return this}once(f,t,u){if(void 0===u)return super.once(f,t);Array.isArray(t)||(t=[t]);const v=this._createDelegatedListener(f,t,u);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(f,t,u){if(void 0===u)return super.off(f,t);t=new Set(Array.isArray(t)?t:[t]);const v=(E,I)=>{if(E.size!==I.size)return!1;for(const k of E)if(!I.has(k))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[f]:void 0;return w&&(E=>{for(let I=0;I<E.length;I++){const k=E[I];if(k.listener===u&&v(k.layers,t)){for(const B in k.delegates)this.off(B,k.delegates[B]);return E.splice(I,1),this}}})(w),this}queryRenderedFeatures(f,t){return this.style?(void 0!==t||void 0===f||f instanceof c.pointGeometry||Array.isArray(f)||(t=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(f,t){return this.style.querySourceFeatures(f,t)}queryTerrainElevation(f,t){const u=this.transform.elevation;return u?(t=c.extend({},{exaggerated:!0},t),u.getAtPoint(c.MercatorCoordinate.fromLngLat(f),null,t.exaggerated)):null}setStyle(f,t){return!1!==(t=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(f,t))}_getUIString(f){const t=this._locale[f];if(null==t)throw new Error(`Missing UI string '${f}'`);return t}_updateStyle(f,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Bo(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof f?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Bo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,t){if("string"==typeof f){const u=this._requestManager.normalizeStyleURL(f),v=this._requestManager.transformRequest(u,c.ResourceType.Style);c.getJSON(v,(w,E)=>{w?this.fire(new c.ErrorEvent(w)):E&&this._updateDiff(E,t)})}else"object"==typeof f&&this._updateDiff(f,t)}_updateDiff(f,t){try{this.style.setState(f)&&this._update(!0)}catch(u){c.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(f,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(c.warnOnce("There is no style added to the map."),!1)}addSource(f,t){return this._lazyInitEmptyStyle(),this.style.addSource(f,t),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const t in f){const u=f[t]._tiles;for(const v in u){const w=u[v];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0}addSourceType(f,t,u){this._lazyInitEmptyStyle(),this.style.addSourceType(f,t,u)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,t,{pixelRatio:u=1,sdf:v=!1,stretchX:w,stretchY:E,content:I}={}){if(this._lazyInitEmptyStyle(),t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap){const{width:k,height:B,data:Z}=c.exported.getImageData(t);this.style.addImage(f,{data:new c.RGBAImage({width:k,height:B},Z),pixelRatio:u,stretchX:w,stretchY:E,content:I,sdf:v,version:0})}else if(void 0===t.width||void 0===t.height)this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:B}=t,Z=t;this.style.addImage(f,{data:new c.RGBAImage({width:k,height:B},new Uint8Array(Z.data)),pixelRatio:u,stretchX:w,stretchY:E,content:I,sdf:v,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,f)}}updateImage(f,t){const u=this.style.getImage(f);if(!u)return void this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap?c.exported.getImageData(t):t,{width:w,height:E}=v;void 0!==w&&void 0!==E?w===u.data.width&&E===u.data.height?(u.data.replace(v.data,!(t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap)),this.style.updateImage(f,u)):this.fire(new c.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${E})\n                must be that same as the previous version of the image\n                (${u.data.width}, ${u.data.height})`))):this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,t){c.getImage(this._requestManager.transformRequest(f,c.ResourceType.Image),(u,v)=>{t(u,v instanceof c.window.HTMLImageElement?c.exported.getImageData(v):v)})}listImages(){return this.style.listImages()}addLayer(f,t){return this._lazyInitEmptyStyle(),this.style.addLayer(f,t),this._update(!0)}moveLayer(f,t){return this.style.moveLayer(f,t),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,t,u){return this.style.setLayerZoomRange(f,t,u),this._update(!0)}setFilter(f,t,u={}){return this.style.setFilter(f,t,u),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,t,u,v={}){return this.style.setPaintProperty(f,t,u,v),this._update(!0)}getPaintProperty(f,t){return this.style.getPaintProperty(f,t)}setLayoutProperty(f,t,u,v={}){return this.style.setLayoutProperty(f,t,u,v),this._update(!0)}getLayoutProperty(f,t){return this.style.getLayoutProperty(f,t)}setLight(f,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(c.LngLat.convert(f),this.transform):0}setFeatureState(f,t){return this.style.setFeatureState(f,t),this._update()}removeFeatureState(f,t){return this.style.removeFeatureState(f,t),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let u,v,w,E=this._container;for(;E&&(!v||!w);){const I=c.window.getComputedStyle(E).transform;I&&"none"!==I&&(u=I.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&"0"!==u[0]&&"1"!==u[0]&&(v=u[0]),u[3]&&"0"!==u[3]&&"1"!==u[3]&&(w=u[3])),E=E.parentElement}this._containerWidth=v?Math.abs(f/v):f,this._containerHeight=w?Math.abs(t/w):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==c.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&c.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=Me("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Me("div","mapboxgl-canvas-container",f);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Me("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=Me("div","mapboxgl-control-container",f),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=Me("div",`mapboxgl-ctrl-${w}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,t){const u=c.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(f),this._canvas.height=u*Math.ceil(t),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${t}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const t=this._markers.indexOf(f);-1!==t&&this._markers.splice(t,1)}_setupPainter(){const f=c.extend({},Ve.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);t?(c.storeAuthState(t,!0),this.painter=new vl(t,this.transform),this.on("data",u=>{"source"===u.dataType&&this.painter.setTileLoadedFlag(!0)}),c.exported$1.testSupport(t)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let t;const u=this.painter.context.extTimerQuery,v=c.exported.now();if(this.listens("gpu-timing-frame")&&(t=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;"globe"===this.getProjection().name&&(this.transform.zoom>=c.GLOBE_ZOOM_THRESHOLD_MAX?"globe"===this.transform.projection.name&&this._updateProjection():"mercator"===this.transform.projection.name&&this._updateProjection());let w=!1;const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,Z=this.transform.pitch,te=c.exported.now();this.style.zoomHistory.update(B,te);const se=new c.EvaluationParameters(B,{now:te,fadeDuration:E,pitch:Z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),fe=se.crossFadingFactor();1===fe&&fe===this._crossFadingFactor||(w=!0,this._crossFadingFactor=fe),this.style.update(se)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(v),this.style._updateSources(this.transform),this._forceMarkerUpdate()):I=this._updateAverageElevation(v),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const B=c.exported.now()-v;u.endQueryEXT(u.TIME_ELAPSED_EXT,t),setTimeout(()=>{const Z=u.getQueryObjectEXT(t,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(t),this.fire(new c.Event("gpu-timing-frame",{cpuTime:B,gpuTime:Z})),c.window.performance.mark("frame-gpu",{startTime:v,detail:{gpuTime:Z}})},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(B);this.fire(new c.Event("gpu-timing-layer",{layerTimes:Z}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Z=this.painter.queryGpuTimeDeferredRender(B);this.fire(new c.Event("gpu-timing-deferred-render",{gpuTime:Z}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(k||this._repaint)this.triggerRepaint();else{const B=!this.isMoving()&&this.loaded();if(B&&(I=this._updateAverageElevation(v,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new c.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new c.Event("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const f of this._markers)f._update()}_updateAverageElevation(f,t=!1){const u=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&u(0);if((t||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const v=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=f;const I=Math.abs(v-w);if(I>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(w),u(w);this._averageElevation.easeTo(w,f,300)}else if(I>1e-4)return this._averageElevation.jumpTo(w),u(w)}return!!this._averageElevation.isEasing(f)&&u(this._averageElevation.getValue(f))}_authenticate(){c.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===c.AUTH_ERR_MSG||401===f.status)){const t=this.painter.context.gl;c.storeAuthState(t,!1),this._logoControl instanceof H&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new c.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),c.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const u=this.painter.context.gl,v=u.createFramebuffer();function w(E){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,E,0);const I=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,I),I}return u.bindFramebuffer(u.FRAMEBUFFER,v),this._canvasPixelComparison(w(f),t.canvasCopies.map(w),t.timeStamps)}_canvasPixelComparison(f,t,u){let v=u[1]-u[0];const w=f.length/4;for(let E=0;E<t.length;E++){const I=t[E];let k=0;for(let B=0;B<I.length;B+=4)I[B]===f[B]&&I[B+1]===f[B+1]&&I[B+2]===f[B+2]&&I[B+3]===f[B+3]&&(k+=1);v+=(u[E+2]-u[E+1])*(1-k/w)}return v}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==c.window&&(c.window.removeEventListener("resize",this._onWindowResize,!1),c.window.removeEventListener("orientationchange",this._onWindowResize,!1),c.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),c.window.removeEventListener("online",this._onWindowOnline,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),di(this._canvasContainer),di(this._controlContainer),di(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),c.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new c.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=c.exported.frame(t=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(t)}))}_preloadTiles(f){const t=this.style?Object.values(this.style._sourceCaches):[];return c.asyncAll(t,(u,v)=>u._preloadTiles(f,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}_setCacheLimits(f,t){c.setCacheLimits(f,t)}get version(){return c.version}},NavigationControl:class{constructor(f){this.options=c.extend({},rr,f),this._container=Me("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Me("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Me("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:t}):u.resetNorth({},{originalEvent:t}))}),this._compassIcon=Me("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const t=f.getZoom(),u=t===f.getMaxZoom(),v=t===f.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jo(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,t){const u=Me("button",f,this._container);return u.type="button",u.addEventListener("click",t),u}_setButtonTitle(f,t){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${t}`);f.setAttribute("aria-label",u),f.firstElementChild&&f.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends c.Evented{constructor(f){super(),this.options=c.extend({geolocation:c.window.navigator.geolocation},ms,f),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=bl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=Me("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){void 0!==this._supportsGeolocation?f(this._supportsGeolocation):void 0!==c.window.navigator.permissions?c.window.navigator.permissions.query({name:"geolocation"}).then(t=>{this._supportsGeolocation="denied"!==t.state,f(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,f(this._supportsGeolocation))}_isOutOfMapMaxBounds(f){const t=this._map.getMaxBounds(),u=f.coords;return!!t&&(u.longitude<t.getWest()||u.longitude>t.getEast()||u.latitude<t.getSouth()||u.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(f),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",f)),this._finish()}}_updateCamera(f){const t=new c.LngLat(f.coords.longitude,f.coords.latitude),u=f.coords.accuracy,v=this._map.getBearing(),w=c.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(u),w,{geolocateSource:!0})}_updateMarker(f){if(f){const t=new c.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,t=c.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,u=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(1===f.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===f.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Me("button","mapboxgl-ctrl-geolocate",this._container),Me("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===f){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Me("div","mapboxgl-user-location"),this._dotElement.appendChild(Me("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Me("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new pt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Me("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new c.Event("trackuserlocationend")))})}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:!0===f.absolute&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{c.window.addEventListener("ondeviceorientationabsolute"in c.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==c.window.DeviceMotionEvent&&"function"==typeof c.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),c.window.removeEventListener("deviceorientation",this._onDeviceOrientation),c.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:O,ScaleControl:class{constructor(f){this.options=c.extend({},Vl,f),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Rs.bind(this)),c.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,t=this._map,u=t._containerHeight/2,v=t._containerWidth/2-f/2,w=t.unproject([v,u]),E=t.unproject([v+f,u]),I=w.distanceTo(E);if("imperial"===this.options.unit){const k=3.2808*I;k>5280?this._setScale(f,k/5280,"mile"):this._setScale(f,k,"foot")}else"nautical"===this.options.unit?this._setScale(f,I/1852,"nautical-mile"):I>=1e3?this._setScale(f,I/1e3,"kilometer"):this._setScale(f,I,"meter")}_setScale(f,t,u){const v=hu(t),w=v/t;this._map._requestDomTask(()=>{this._container.style.width=f*w+"px",this._container.innerHTML="nautical-mile"!==u?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:u}).format(v):`${v}&nbsp;nm`})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=Me("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof c.window.HTMLElement?this._container=f.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in c.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in c.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=Me("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,c.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!c.window.document.fullscreenEnabled&&!c.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=Me("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Me("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),c.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(c.window.document.fullscreenElement||c.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?c.window.document.exitFullscreen?c.window.document.exitFullscreen():c.window.document.webkitCancelFullScreen&&c.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends c.Evented{constructor(f){super(),this.options=c.extend(Object.create(Ul),f),c.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new c.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new c.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=c.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(c.window.document.createTextNode(f))}setHTML(f){const t=c.window.document.createDocumentFragment(),u=c.window.document.createElement("body");let v;for(u.innerHTML=f;v=u.firstChild,v;)t.appendChild(v);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Me("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(f),this.options.closeButton){const u=this._closeButton=Me("button","mapboxgl-popup-close-button",t);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let t;return this._classList.delete(f)?t=!1:(this._classList.add(f),t=!0),this._updateClassList(),t}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const t=this._map,u=this._container,v=this._pos;if(!t||!u||!v)return"bottom";const w=u.offsetWidth,E=u.offsetHeight,I=v.x<w/2,k=v.x>t.transform.width-w/2;if(v.y+f<E)return I?"top-left":k?"top-right":"top";if(v.y>t.transform.height-E){if(I)return"bottom-left";if(k)return"bottom-right"}return I?"left":k?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),f.className=t.join(" ")}_update(f){const t=this._map,u=this._content;if(!t||!this._lngLat&&!this._trackPointer||!u)return;let v=this._container;if(v||(v=this._container=Me("div","mapboxgl-popup",t.getContainer()),this._tip=Me("div","mapboxgl-popup-tip",v),v.appendChild(u)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ge(this._lngLat,this._pos,t.transform)),!this._trackPointer||f){const w=this._pos=this._trackPointer&&f?f:t.project(this._lngLat),E=wl(this.options.offset),I=this._anchor=this._getAnchor(E.y),k=wl(this.options.offset,I),B=w.add(k).round();t._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${qe[I]} translate(${B.x}px,${B.y}px)`)})}if(!this._marker&&t._usingGlobe()){const w=c.isLngLatBehindGlobe(t.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Ku);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:pt,Style:Bo,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.pointGeometry,MercatorCoordinate:c.MercatorCoordinate,FreeCameraOptions:sc,Evented:c.Evented,config:c.config,prewarm:function(){ti().acquire(tt)},clearPrewarmedResources:function(){const f=bn;f&&(f.isPreloaded()&&1===f.numActive()?(f.release(tt),bn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return c.config.ACCESS_TOKEN},set accessToken(f){c.config.ACCESS_TOKEN=f},get baseApiUrl(){return c.config.API_URL},set baseApiUrl(f){c.config.API_URL=f},get workerCount(){return Nt.workerCount},set workerCount(f){Nt.workerCount=f},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){c.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){c.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:c.exported.setNow,restoreNow:c.exported.restoreNow};return Bd}),T}()},1135:(Bn,kt,j)=>{"use strict";j.d(kt,{X:()=>d});var T=j(7579);class d extends T.x{constructor(c){super(),this._value=c}get value(){return this.getValue()}_subscribe(c){const Ce=super._subscribe(c);return!Ce.closed&&c.next(this._value),Ce}getValue(){const{hasError:c,thrownError:Ce,_value:Ve}=this;if(c)throw Ce;return this._throwIfClosed(),Ve}next(c){super.next(this._value=c)}}},9751:(Bn,kt,j)=>{"use strict";j.d(kt,{y:()=>ye});var T=j(930),d=j(727),W=j(8822),c=j(9635),Ce=j(2416),Ve=j(576),Je=j(2806);let ye=(()=>{class Pe{constructor(gt){gt&&(this._subscribe=gt)}lift(gt){const et=new Pe;return et.source=this,et.operator=gt,et}subscribe(gt,et,Ut){const Ft=function ft(Pe){return Pe&&Pe instanceof T.Lv||function Ye(Pe){return Pe&&(0,Ve.m)(Pe.next)&&(0,Ve.m)(Pe.error)&&(0,Ve.m)(Pe.complete)}(Pe)&&(0,d.Nn)(Pe)}(gt)?gt:new T.Hp(gt,et,Ut);return(0,Je.x)(()=>{const{operator:St,source:Pn}=this;Ft.add(St?St.call(Ft,Pn):Pn?this._subscribe(Ft):this._trySubscribe(Ft))}),Ft}_trySubscribe(gt){try{return this._subscribe(gt)}catch(et){gt.error(et)}}forEach(gt,et){return new(et=Me(et))((Ut,Ft)=>{const St=new T.Hp({next:Pn=>{try{gt(Pn)}catch(Xn){Ft(Xn),St.unsubscribe()}},error:Ft,complete:Ut});this.subscribe(St)})}_subscribe(gt){var et;return null===(et=this.source)||void 0===et?void 0:et.subscribe(gt)}[W.L](){return this}pipe(...gt){return(0,c.U)(gt)(this)}toPromise(gt){return new(gt=Me(gt))((et,Ut)=>{let Ft;this.subscribe(St=>Ft=St,St=>Ut(St),()=>et(Ft))})}}return Pe.create=ut=>new Pe(ut),Pe})();function Me(Pe){var ut;return null!==(ut=Pe??Ce.v.Promise)&&void 0!==ut?ut:Promise}},7579:(Bn,kt,j)=>{"use strict";j.d(kt,{x:()=>Je});var T=j(9751),d=j(727);const c=(0,j(3888).d)(Me=>function(){Me(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ce=j(8737),Ve=j(2806);let Je=(()=>{class Me extends T.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ft){const Pe=new ye(this,this);return Pe.operator=ft,Pe}_throwIfClosed(){if(this.closed)throw new c}next(ft){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Pe of this.currentObservers)Pe.next(ft)}})}error(ft){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ft;const{observers:Pe}=this;for(;Pe.length;)Pe.shift().error(ft)}})}complete(){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ft}=this;for(;ft.length;)ft.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ft;return(null===(ft=this.observers)||void 0===ft?void 0:ft.length)>0}_trySubscribe(ft){return this._throwIfClosed(),super._trySubscribe(ft)}_subscribe(ft){return this._throwIfClosed(),this._checkFinalizedStatuses(ft),this._innerSubscribe(ft)}_innerSubscribe(ft){const{hasError:Pe,isStopped:ut,observers:gt}=this;return Pe||ut?d.Lc:(this.currentObservers=null,gt.push(ft),new d.w0(()=>{this.currentObservers=null,(0,Ce.P)(gt,ft)}))}_checkFinalizedStatuses(ft){const{hasError:Pe,thrownError:ut,isStopped:gt}=this;Pe?ft.error(ut):gt&&ft.complete()}asObservable(){const ft=new T.y;return ft.source=this,ft}}return Me.create=(Ye,ft)=>new ye(Ye,ft),Me})();class ye extends Je{constructor(Ye,ft){super(),this.destination=Ye,this.source=ft}next(Ye){var ft,Pe;null===(Pe=null===(ft=this.destination)||void 0===ft?void 0:ft.next)||void 0===Pe||Pe.call(ft,Ye)}error(Ye){var ft,Pe;null===(Pe=null===(ft=this.destination)||void 0===ft?void 0:ft.error)||void 0===Pe||Pe.call(ft,Ye)}complete(){var Ye,ft;null===(ft=null===(Ye=this.destination)||void 0===Ye?void 0:Ye.complete)||void 0===ft||ft.call(Ye)}_subscribe(Ye){var ft,Pe;return null!==(Pe=null===(ft=this.source)||void 0===ft?void 0:ft.subscribe(Ye))&&void 0!==Pe?Pe:d.Lc}}},930:(Bn,kt,j)=>{"use strict";j.d(kt,{Hp:()=>Ut,Lv:()=>Pe});var T=j(576),d=j(727),W=j(2416),c=j(7849),Ce=j(5032);const Ve=Me("C",void 0,void 0);function Me(Xt,Fe,Qe){return{kind:Xt,value:Fe,error:Qe}}var Ye=j(3410),ft=j(2806);class Pe extends d.w0{constructor(Fe){super(),this.isStopped=!1,Fe?(this.destination=Fe,(0,d.Nn)(Fe)&&Fe.add(this)):this.destination=Xn}static create(Fe,Qe,fn){return new Ut(Fe,Qe,fn)}next(Fe){this.isStopped?Pn(function ye(Xt){return Me("N",Xt,void 0)}(Fe),this):this._next(Fe)}error(Fe){this.isStopped?Pn(function Je(Xt){return Me("E",void 0,Xt)}(Fe),this):(this.isStopped=!0,this._error(Fe))}complete(){this.isStopped?Pn(Ve,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Fe){this.destination.next(Fe)}_error(Fe){try{this.destination.error(Fe)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ut=Function.prototype.bind;function gt(Xt,Fe){return ut.call(Xt,Fe)}class et{constructor(Fe){this.partialObserver=Fe}next(Fe){const{partialObserver:Qe}=this;if(Qe.next)try{Qe.next(Fe)}catch(fn){Ft(fn)}}error(Fe){const{partialObserver:Qe}=this;if(Qe.error)try{Qe.error(Fe)}catch(fn){Ft(fn)}else Ft(Fe)}complete(){const{partialObserver:Fe}=this;if(Fe.complete)try{Fe.complete()}catch(Qe){Ft(Qe)}}}class Ut extends Pe{constructor(Fe,Qe,fn){let Jt;if(super(),(0,T.m)(Fe)||!Fe)Jt={next:Fe??void 0,error:Qe??void 0,complete:fn??void 0};else{let rn;this&&W.v.useDeprecatedNextContext?(rn=Object.create(Fe),rn.unsubscribe=()=>this.unsubscribe(),Jt={next:Fe.next&&gt(Fe.next,rn),error:Fe.error&&gt(Fe.error,rn),complete:Fe.complete&&gt(Fe.complete,rn)}):Jt=Fe}this.destination=new et(Jt)}}function Ft(Xt){W.v.useDeprecatedSynchronousErrorHandling?(0,ft.O)(Xt):(0,c.h)(Xt)}function Pn(Xt,Fe){const{onStoppedNotification:Qe}=W.v;Qe&&Ye.z.setTimeout(()=>Qe(Xt,Fe))}const Xn={closed:!0,next:Ce.Z,error:function St(Xt){throw Xt},complete:Ce.Z}},727:(Bn,kt,j)=>{"use strict";j.d(kt,{Lc:()=>Ve,w0:()=>Ce,Nn:()=>Je});var T=j(576);const W=(0,j(3888).d)(Me=>function(ft){Me(this),this.message=ft?`${ft.length} errors occurred during unsubscription:\n${ft.map((Pe,ut)=>`${ut+1}) ${Pe.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ft});var c=j(8737);class Ce{constructor(Ye){this.initialTeardown=Ye,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ye;if(!this.closed){this.closed=!0;const{_parentage:ft}=this;if(ft)if(this._parentage=null,Array.isArray(ft))for(const gt of ft)gt.remove(this);else ft.remove(this);const{initialTeardown:Pe}=this;if((0,T.m)(Pe))try{Pe()}catch(gt){Ye=gt instanceof W?gt.errors:[gt]}const{_finalizers:ut}=this;if(ut){this._finalizers=null;for(const gt of ut)try{ye(gt)}catch(et){Ye=Ye??[],et instanceof W?Ye=[...Ye,...et.errors]:Ye.push(et)}}if(Ye)throw new W(Ye)}}add(Ye){var ft;if(Ye&&Ye!==this)if(this.closed)ye(Ye);else{if(Ye instanceof Ce){if(Ye.closed||Ye._hasParent(this))return;Ye._addParent(this)}(this._finalizers=null!==(ft=this._finalizers)&&void 0!==ft?ft:[]).push(Ye)}}_hasParent(Ye){const{_parentage:ft}=this;return ft===Ye||Array.isArray(ft)&&ft.includes(Ye)}_addParent(Ye){const{_parentage:ft}=this;this._parentage=Array.isArray(ft)?(ft.push(Ye),ft):ft?[ft,Ye]:Ye}_removeParent(Ye){const{_parentage:ft}=this;ft===Ye?this._parentage=null:Array.isArray(ft)&&(0,c.P)(ft,Ye)}remove(Ye){const{_finalizers:ft}=this;ft&&(0,c.P)(ft,Ye),Ye instanceof Ce&&Ye._removeParent(this)}}Ce.EMPTY=(()=>{const Me=new Ce;return Me.closed=!0,Me})();const Ve=Ce.EMPTY;function Je(Me){return Me instanceof Ce||Me&&"closed"in Me&&(0,T.m)(Me.remove)&&(0,T.m)(Me.add)&&(0,T.m)(Me.unsubscribe)}function ye(Me){(0,T.m)(Me)?Me():Me.unsubscribe()}},2416:(Bn,kt,j)=>{"use strict";j.d(kt,{v:()=>T});const T={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},9841:(Bn,kt,j)=>{"use strict";j.d(kt,{a:()=>Ye});var T=j(9751),d=j(4742),W=j(2076),c=j(4671),Ce=j(3268),Ve=j(3269),Je=j(1810),ye=j(5403),Me=j(9672);function Ye(...ut){const gt=(0,Ve.yG)(ut),et=(0,Ve.jO)(ut),{args:Ut,keys:Ft}=(0,d.D)(ut);if(0===Ut.length)return(0,W.D)([],gt);const St=new T.y(function ft(ut,gt,et=c.y){return Ut=>{Pe(gt,()=>{const{length:Ft}=ut,St=new Array(Ft);let Pn=Ft,Xn=Ft;for(let Xt=0;Xt<Ft;Xt++)Pe(gt,()=>{const Fe=(0,W.D)(ut[Xt],gt);let Qe=!1;Fe.subscribe((0,ye.x)(Ut,fn=>{St[Xt]=fn,Qe||(Qe=!0,Xn--),Xn||Ut.next(et(St.slice()))},()=>{--Pn||Ut.complete()}))},Ut)},Ut)}}(Ut,gt,Ft?Pn=>(0,Je.n)(Ft,Pn):c.y));return et?St.pipe((0,Ce.Z)(et)):St}function Pe(ut,gt,et){ut?(0,Me.f)(et,ut,gt):gt()}},7272:(Bn,kt,j)=>{"use strict";j.d(kt,{z:()=>Ce});var T=j(8189),W=j(3269),c=j(2076);function Ce(...Ve){return function d(){return(0,T.J)(1)}()((0,c.D)(Ve,(0,W.yG)(Ve)))}},9770:(Bn,kt,j)=>{"use strict";j.d(kt,{P:()=>W});var T=j(9751),d=j(8421);function W(c){return new T.y(Ce=>{(0,d.Xf)(c()).subscribe(Ce)})}},515:(Bn,kt,j)=>{"use strict";j.d(kt,{E:()=>d});const d=new(j(9751).y)(Ce=>Ce.complete())},4128:(Bn,kt,j)=>{"use strict";j.d(kt,{D:()=>ye});var T=j(9751),d=j(4742),W=j(8421),c=j(3269),Ce=j(5403),Ve=j(3268),Je=j(1810);function ye(...Me){const Ye=(0,c.jO)(Me),{args:ft,keys:Pe}=(0,d.D)(Me),ut=new T.y(gt=>{const{length:et}=ft;if(!et)return void gt.complete();const Ut=new Array(et);let Ft=et,St=et;for(let Pn=0;Pn<et;Pn++){let Xn=!1;(0,W.Xf)(ft[Pn]).subscribe((0,Ce.x)(gt,Xt=>{Xn||(Xn=!0,St--),Ut[Pn]=Xt},()=>Ft--,void 0,()=>{(!Ft||!Xn)&&(St||gt.next(Pe?(0,Je.n)(Pe,Ut):Ut),gt.complete())}))}});return Ye?ut.pipe((0,Ve.Z)(Ye)):ut}},2076:(Bn,kt,j)=>{"use strict";j.d(kt,{D:()=>fn});var T=j(8421),d=j(9672),W=j(4482),c=j(5403);function Ce(Jt,rn=0){return(0,W.e)((vn,xt)=>{vn.subscribe((0,c.x)(xt,Tt=>(0,d.f)(xt,Jt,()=>xt.next(Tt),rn),()=>(0,d.f)(xt,Jt,()=>xt.complete(),rn),Tt=>(0,d.f)(xt,Jt,()=>xt.error(Tt),rn)))})}function Ve(Jt,rn=0){return(0,W.e)((vn,xt)=>{xt.add(Jt.schedule(()=>vn.subscribe(xt),rn))})}var Me=j(9751),ft=j(2202),Pe=j(576);function gt(Jt,rn){if(!Jt)throw new Error("Iterable cannot be null");return new Me.y(vn=>{(0,d.f)(vn,rn,()=>{const xt=Jt[Symbol.asyncIterator]();(0,d.f)(vn,rn,()=>{xt.next().then(Tt=>{Tt.done?vn.complete():vn.next(Tt.value)})},0,!0)})})}var et=j(3670),Ut=j(8239),Ft=j(1144),St=j(6495),Pn=j(2206),Xn=j(4532),Xt=j(3260);function fn(Jt,rn){return rn?function Qe(Jt,rn){if(null!=Jt){if((0,et.c)(Jt))return function Je(Jt,rn){return(0,T.Xf)(Jt).pipe(Ve(rn),Ce(rn))}(Jt,rn);if((0,Ft.z)(Jt))return function Ye(Jt,rn){return new Me.y(vn=>{let xt=0;return rn.schedule(function(){xt===Jt.length?vn.complete():(vn.next(Jt[xt++]),vn.closed||this.schedule())})})}(Jt,rn);if((0,Ut.t)(Jt))return function ye(Jt,rn){return(0,T.Xf)(Jt).pipe(Ve(rn),Ce(rn))}(Jt,rn);if((0,Pn.D)(Jt))return gt(Jt,rn);if((0,St.T)(Jt))return function ut(Jt,rn){return new Me.y(vn=>{let xt;return(0,d.f)(vn,rn,()=>{xt=Jt[ft.h](),(0,d.f)(vn,rn,()=>{let Tt,Gt;try{({value:Tt,done:Gt}=xt.next())}catch(Bt){return void vn.error(Bt)}Gt?vn.complete():vn.next(Tt)},0,!0)}),()=>(0,Pe.m)(xt?.return)&&xt.return()})}(Jt,rn);if((0,Xt.L)(Jt))return function Fe(Jt,rn){return gt((0,Xt.Q)(Jt),rn)}(Jt,rn)}throw(0,Xn.z)(Jt)}(Jt,rn):(0,T.Xf)(Jt)}},4968:(Bn,kt,j)=>{"use strict";j.d(kt,{R:()=>Ye});var T=j(8421),d=j(9751),W=j(5577),c=j(1144),Ce=j(576),Ve=j(3268);const Je=["addListener","removeListener"],ye=["addEventListener","removeEventListener"],Me=["on","off"];function Ye(et,Ut,Ft,St){if((0,Ce.m)(Ft)&&(St=Ft,Ft=void 0),St)return Ye(et,Ut,Ft).pipe((0,Ve.Z)(St));const[Pn,Xn]=function gt(et){return(0,Ce.m)(et.addEventListener)&&(0,Ce.m)(et.removeEventListener)}(et)?ye.map(Xt=>Fe=>et[Xt](Ut,Fe,Ft)):function Pe(et){return(0,Ce.m)(et.addListener)&&(0,Ce.m)(et.removeListener)}(et)?Je.map(ft(et,Ut)):function ut(et){return(0,Ce.m)(et.on)&&(0,Ce.m)(et.off)}(et)?Me.map(ft(et,Ut)):[];if(!Pn&&(0,c.z)(et))return(0,W.z)(Xt=>Ye(Xt,Ut,Ft))((0,T.Xf)(et));if(!Pn)throw new TypeError("Invalid event target");return new d.y(Xt=>{const Fe=(...Qe)=>Xt.next(1<Qe.length?Qe:Qe[0]);return Pn(Fe),()=>Xn(Fe)})}function ft(et,Ut){return Ft=>St=>et[Ft](Ut,St)}},8421:(Bn,kt,j)=>{"use strict";j.d(kt,{Xf:()=>ut});var T=j(655),d=j(1144),W=j(8239),c=j(9751),Ce=j(3670),Ve=j(2206),Je=j(4532),ye=j(6495),Me=j(3260),Ye=j(576),ft=j(7849),Pe=j(8822);function ut(Xt){if(Xt instanceof c.y)return Xt;if(null!=Xt){if((0,Ce.c)(Xt))return function gt(Xt){return new c.y(Fe=>{const Qe=Xt[Pe.L]();if((0,Ye.m)(Qe.subscribe))return Qe.subscribe(Fe);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Xt);if((0,d.z)(Xt))return function et(Xt){return new c.y(Fe=>{for(let Qe=0;Qe<Xt.length&&!Fe.closed;Qe++)Fe.next(Xt[Qe]);Fe.complete()})}(Xt);if((0,W.t)(Xt))return function Ut(Xt){return new c.y(Fe=>{Xt.then(Qe=>{Fe.closed||(Fe.next(Qe),Fe.complete())},Qe=>Fe.error(Qe)).then(null,ft.h)})}(Xt);if((0,Ve.D)(Xt))return St(Xt);if((0,ye.T)(Xt))return function Ft(Xt){return new c.y(Fe=>{for(const Qe of Xt)if(Fe.next(Qe),Fe.closed)return;Fe.complete()})}(Xt);if((0,Me.L)(Xt))return function Pn(Xt){return St((0,Me.Q)(Xt))}(Xt)}throw(0,Je.z)(Xt)}function St(Xt){return new c.y(Fe=>{(function Xn(Xt,Fe){var Qe,fn,Jt,rn;return(0,T.mG)(this,void 0,void 0,function*(){try{for(Qe=(0,T.KL)(Xt);!(fn=yield Qe.next()).done;)if(Fe.next(fn.value),Fe.closed)return}catch(vn){Jt={error:vn}}finally{try{fn&&!fn.done&&(rn=Qe.return)&&(yield rn.call(Qe))}finally{if(Jt)throw Jt.error}}Fe.complete()})})(Xt,Fe).catch(Qe=>Fe.error(Qe))})}},6451:(Bn,kt,j)=>{"use strict";j.d(kt,{T:()=>Ve});var T=j(8189),d=j(8421),W=j(515),c=j(3269),Ce=j(2076);function Ve(...Je){const ye=(0,c.yG)(Je),Me=(0,c._6)(Je,1/0),Ye=Je;return Ye.length?1===Ye.length?(0,d.Xf)(Ye[0]):(0,T.J)(Me)((0,Ce.D)(Ye,ye)):W.E}},9646:(Bn,kt,j)=>{"use strict";j.d(kt,{of:()=>W});var T=j(3269),d=j(2076);function W(...c){const Ce=(0,T.yG)(c);return(0,d.D)(c,Ce)}},2843:(Bn,kt,j)=>{"use strict";j.d(kt,{_:()=>W});var T=j(9751),d=j(576);function W(c,Ce){const Ve=(0,d.m)(c)?c:()=>c,Je=ye=>ye.error(Ve());return new T.y(Ce?ye=>Ce.schedule(Je,0,ye):Je)}},5963:(Bn,kt,j)=>{"use strict";j.d(kt,{H:()=>Ce});var T=j(9751),d=j(4986),W=j(3532);function Ce(Ve=0,Je,ye=d.P){let Me=-1;return null!=Je&&((0,W.K)(Je)?ye=Je:Me=Je),new T.y(Ye=>{let ft=function c(Ve){return Ve instanceof Date&&!isNaN(Ve)}(Ve)?+Ve-ye.now():Ve;ft<0&&(ft=0);let Pe=0;return ye.schedule(function(){Ye.closed||(Ye.next(Pe++),0<=Me?this.schedule(void 0,Me):Ye.complete())},ft)})}},5403:(Bn,kt,j)=>{"use strict";j.d(kt,{x:()=>d});var T=j(930);function d(c,Ce,Ve,Je,ye){return new W(c,Ce,Ve,Je,ye)}class W extends T.Lv{constructor(Ce,Ve,Je,ye,Me,Ye){super(Ce),this.onFinalize=Me,this.shouldUnsubscribe=Ye,this._next=Ve?function(ft){try{Ve(ft)}catch(Pe){Ce.error(Pe)}}:super._next,this._error=ye?function(ft){try{ye(ft)}catch(Pe){Ce.error(Pe)}finally{this.unsubscribe()}}:super._error,this._complete=Je?function(){try{Je()}catch(ft){Ce.error(ft)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ve}=this;super.unsubscribe(),!Ve&&(null===(Ce=this.onFinalize)||void 0===Ce||Ce.call(this))}}}},262:(Bn,kt,j)=>{"use strict";j.d(kt,{K:()=>c});var T=j(8421),d=j(5403),W=j(4482);function c(Ce){return(0,W.e)((Ve,Je)=>{let Ye,ye=null,Me=!1;ye=Ve.subscribe((0,d.x)(Je,void 0,void 0,ft=>{Ye=(0,T.Xf)(Ce(ft,c(Ce)(Ve))),ye?(ye.unsubscribe(),ye=null,Ye.subscribe(Je)):Me=!0})),Me&&(ye.unsubscribe(),ye=null,Ye.subscribe(Je))})}},4351:(Bn,kt,j)=>{"use strict";j.d(kt,{b:()=>W});var T=j(5577),d=j(576);function W(c,Ce){return(0,d.m)(Ce)?(0,T.z)(c,Ce,1):(0,T.z)(c,1)}},8372:(Bn,kt,j)=>{"use strict";j.d(kt,{b:()=>c});var T=j(4986),d=j(4482),W=j(5403);function c(Ce,Ve=T.z){return(0,d.e)((Je,ye)=>{let Me=null,Ye=null,ft=null;const Pe=()=>{if(Me){Me.unsubscribe(),Me=null;const gt=Ye;Ye=null,ye.next(gt)}};function ut(){const gt=ft+Ce,et=Ve.now();if(et<gt)return Me=this.schedule(void 0,gt-et),void ye.add(Me);Pe()}Je.subscribe((0,W.x)(ye,gt=>{Ye=gt,ft=Ve.now(),Me||(Me=Ve.schedule(ut,Ce),ye.add(Me))},()=>{Pe(),ye.complete()},void 0,()=>{Ye=Me=null}))})}},6590:(Bn,kt,j)=>{"use strict";j.d(kt,{d:()=>W});var T=j(4482),d=j(5403);function W(c){return(0,T.e)((Ce,Ve)=>{let Je=!1;Ce.subscribe((0,d.x)(Ve,ye=>{Je=!0,Ve.next(ye)},()=>{Je||Ve.next(c),Ve.complete()}))})}},1884:(Bn,kt,j)=>{"use strict";j.d(kt,{x:()=>c});var T=j(4671),d=j(4482),W=j(5403);function c(Ve,Je=T.y){return Ve=Ve??Ce,(0,d.e)((ye,Me)=>{let Ye,ft=!0;ye.subscribe((0,W.x)(Me,Pe=>{const ut=Je(Pe);(ft||!Ve(Ye,ut))&&(ft=!1,Ye=ut,Me.next(Pe))}))})}function Ce(Ve,Je){return Ve===Je}},9300:(Bn,kt,j)=>{"use strict";j.d(kt,{h:()=>W});var T=j(4482),d=j(5403);function W(c,Ce){return(0,T.e)((Ve,Je)=>{let ye=0;Ve.subscribe((0,d.x)(Je,Me=>c.call(Ce,Me,ye++)&&Je.next(Me)))})}},8746:(Bn,kt,j)=>{"use strict";j.d(kt,{x:()=>d});var T=j(4482);function d(W){return(0,T.e)((c,Ce)=>{try{c.subscribe(Ce)}finally{Ce.add(W)}})}},590:(Bn,kt,j)=>{"use strict";j.d(kt,{P:()=>Je});var T=j(6805),d=j(9300),W=j(5698),c=j(6590),Ce=j(8068),Ve=j(4671);function Je(ye,Me){const Ye=arguments.length>=2;return ft=>ft.pipe(ye?(0,d.h)((Pe,ut)=>ye(Pe,ut,ft)):Ve.y,(0,W.q)(1),Ye?(0,c.d)(Me):(0,Ce.T)(()=>new T.K))}},4004:(Bn,kt,j)=>{"use strict";j.d(kt,{U:()=>W});var T=j(4482),d=j(5403);function W(c,Ce){return(0,T.e)((Ve,Je)=>{let ye=0;Ve.subscribe((0,d.x)(Je,Me=>{Je.next(c.call(Ce,Me,ye++))}))})}},9718:(Bn,kt,j)=>{"use strict";j.d(kt,{h:()=>d});var T=j(4004);function d(W){return(0,T.U)(()=>W)}},8189:(Bn,kt,j)=>{"use strict";j.d(kt,{J:()=>W});var T=j(5577),d=j(4671);function W(c=1/0){return(0,T.z)(d.y,c)}},5577:(Bn,kt,j)=>{"use strict";j.d(kt,{z:()=>ye});var T=j(4004),d=j(8421),W=j(4482),c=j(9672),Ce=j(5403),Je=j(576);function ye(Me,Ye,ft=1/0){return(0,Je.m)(Ye)?ye((Pe,ut)=>(0,T.U)((gt,et)=>Ye(Pe,gt,ut,et))((0,d.Xf)(Me(Pe,ut))),ft):("number"==typeof Ye&&(ft=Ye),(0,W.e)((Pe,ut)=>function Ve(Me,Ye,ft,Pe,ut,gt,et,Ut){const Ft=[];let St=0,Pn=0,Xn=!1;const Xt=()=>{Xn&&!Ft.length&&!St&&Ye.complete()},Fe=fn=>St<Pe?Qe(fn):Ft.push(fn),Qe=fn=>{gt&&Ye.next(fn),St++;let Jt=!1;(0,d.Xf)(ft(fn,Pn++)).subscribe((0,Ce.x)(Ye,rn=>{ut?.(rn),gt?Fe(rn):Ye.next(rn)},()=>{Jt=!0},void 0,()=>{if(Jt)try{for(St--;Ft.length&&St<Pe;){const rn=Ft.shift();et?(0,c.f)(Ye,et,()=>Qe(rn)):Qe(rn)}Xt()}catch(rn){Ye.error(rn)}}))};return Me.subscribe((0,Ce.x)(Ye,Fe,()=>{Xn=!0,Xt()})),()=>{Ut?.()}}(Pe,ut,Me,ft)))}},3099:(Bn,kt,j)=>{"use strict";j.d(kt,{B:()=>Ce});var T=j(8421),d=j(7579),W=j(930),c=j(4482);function Ce(Je={}){const{connector:ye=(()=>new d.x),resetOnError:Me=!0,resetOnComplete:Ye=!0,resetOnRefCountZero:ft=!0}=Je;return Pe=>{let ut,gt,et,Ut=0,Ft=!1,St=!1;const Pn=()=>{gt?.unsubscribe(),gt=void 0},Xn=()=>{Pn(),ut=et=void 0,Ft=St=!1},Xt=()=>{const Fe=ut;Xn(),Fe?.unsubscribe()};return(0,c.e)((Fe,Qe)=>{Ut++,!St&&!Ft&&Pn();const fn=et=et??ye();Qe.add(()=>{Ut--,0===Ut&&!St&&!Ft&&(gt=Ve(Xt,ft))}),fn.subscribe(Qe),!ut&&Ut>0&&(ut=new W.Hp({next:Jt=>fn.next(Jt),error:Jt=>{St=!0,Pn(),gt=Ve(Xn,Me,Jt),fn.error(Jt)},complete:()=>{Ft=!0,Pn(),gt=Ve(Xn,Ye),fn.complete()}}),(0,T.Xf)(Fe).subscribe(ut))})(Pe)}}function Ve(Je,ye,...Me){if(!0===ye)return void Je();if(!1===ye)return;const Ye=new W.Hp({next:()=>{Ye.unsubscribe(),Je()}});return ye(...Me).subscribe(Ye)}},3151:(Bn,kt,j)=>{"use strict";j.d(kt,{d:()=>Ce});var T=j(7579),d=j(6063);class W extends T.x{constructor(Je=1/0,ye=1/0,Me=d.l){super(),this._bufferSize=Je,this._windowTime=ye,this._timestampProvider=Me,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=ye===1/0,this._bufferSize=Math.max(1,Je),this._windowTime=Math.max(1,ye)}next(Je){const{isStopped:ye,_buffer:Me,_infiniteTimeWindow:Ye,_timestampProvider:ft,_windowTime:Pe}=this;ye||(Me.push(Je),!Ye&&Me.push(ft.now()+Pe)),this._trimBuffer(),super.next(Je)}_subscribe(Je){this._throwIfClosed(),this._trimBuffer();const ye=this._innerSubscribe(Je),{_infiniteTimeWindow:Me,_buffer:Ye}=this,ft=Ye.slice();for(let Pe=0;Pe<ft.length&&!Je.closed;Pe+=Me?1:2)Je.next(ft[Pe]);return this._checkFinalizedStatuses(Je),ye}_trimBuffer(){const{_bufferSize:Je,_timestampProvider:ye,_buffer:Me,_infiniteTimeWindow:Ye}=this,ft=(Ye?1:2)*Je;if(Je<1/0&&ft<Me.length&&Me.splice(0,Me.length-ft),!Ye){const Pe=ye.now();let ut=0;for(let gt=1;gt<Me.length&&Me[gt]<=Pe;gt+=2)ut=gt;ut&&Me.splice(0,ut+1)}}}var c=j(3099);function Ce(Ve,Je,ye){let Me,Ye=!1;return Ve&&"object"==typeof Ve?({bufferSize:Me=1/0,windowTime:Je=1/0,refCount:Ye=!1,scheduler:ye}=Ve):Me=Ve??1/0,(0,c.B)({connector:()=>new W(Me,Je,ye),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Ye})}},5684:(Bn,kt,j)=>{"use strict";j.d(kt,{T:()=>d});var T=j(9300);function d(W){return(0,T.h)((c,Ce)=>W<=Ce)}},8675:(Bn,kt,j)=>{"use strict";j.d(kt,{O:()=>c});var T=j(7272),d=j(3269),W=j(4482);function c(...Ce){const Ve=(0,d.yG)(Ce);return(0,W.e)((Je,ye)=>{(Ve?(0,T.z)(Ce,Je,Ve):(0,T.z)(Ce,Je)).subscribe(ye)})}},3900:(Bn,kt,j)=>{"use strict";j.d(kt,{w:()=>c});var T=j(8421),d=j(4482),W=j(5403);function c(Ce,Ve){return(0,d.e)((Je,ye)=>{let Me=null,Ye=0,ft=!1;const Pe=()=>ft&&!Me&&ye.complete();Je.subscribe((0,W.x)(ye,ut=>{Me?.unsubscribe();let gt=0;const et=Ye++;(0,T.Xf)(Ce(ut,et)).subscribe(Me=(0,W.x)(ye,Ut=>ye.next(Ve?Ve(ut,Ut,et,gt++):Ut),()=>{Me=null,Pe()}))},()=>{ft=!0,Pe()}))})}},5698:(Bn,kt,j)=>{"use strict";j.d(kt,{q:()=>c});var T=j(515),d=j(4482),W=j(5403);function c(Ce){return Ce<=0?()=>T.E:(0,d.e)((Ve,Je)=>{let ye=0;Ve.subscribe((0,W.x)(Je,Me=>{++ye<=Ce&&(Je.next(Me),Ce<=ye&&Je.complete())}))})}},2722:(Bn,kt,j)=>{"use strict";j.d(kt,{R:()=>Ce});var T=j(4482),d=j(5403),W=j(8421),c=j(5032);function Ce(Ve){return(0,T.e)((Je,ye)=>{(0,W.Xf)(Ve).subscribe((0,d.x)(ye,()=>ye.complete(),c.Z)),!ye.closed&&Je.subscribe(ye)})}},2529:(Bn,kt,j)=>{"use strict";j.d(kt,{o:()=>W});var T=j(4482),d=j(5403);function W(c,Ce=!1){return(0,T.e)((Ve,Je)=>{let ye=0;Ve.subscribe((0,d.x)(Je,Me=>{const Ye=c(Me,ye++);(Ye||Ce)&&Je.next(Me),!Ye&&Je.complete()}))})}},8505:(Bn,kt,j)=>{"use strict";j.d(kt,{b:()=>Ce});var T=j(576),d=j(4482),W=j(5403),c=j(4671);function Ce(Ve,Je,ye){const Me=(0,T.m)(Ve)||Je||ye?{next:Ve,error:Je,complete:ye}:Ve;return Me?(0,d.e)((Ye,ft)=>{var Pe;null===(Pe=Me.subscribe)||void 0===Pe||Pe.call(Me);let ut=!0;Ye.subscribe((0,W.x)(ft,gt=>{var et;null===(et=Me.next)||void 0===et||et.call(Me,gt),ft.next(gt)},()=>{var gt;ut=!1,null===(gt=Me.complete)||void 0===gt||gt.call(Me),ft.complete()},gt=>{var et;ut=!1,null===(et=Me.error)||void 0===et||et.call(Me,gt),ft.error(gt)},()=>{var gt,et;ut&&(null===(gt=Me.unsubscribe)||void 0===gt||gt.call(Me)),null===(et=Me.finalize)||void 0===et||et.call(Me)}))}):c.y}},8068:(Bn,kt,j)=>{"use strict";j.d(kt,{T:()=>c});var T=j(6805),d=j(4482),W=j(5403);function c(Ve=Ce){return(0,d.e)((Je,ye)=>{let Me=!1;Je.subscribe((0,W.x)(ye,Ye=>{Me=!0,ye.next(Ye)},()=>Me?ye.complete():ye.error(Ve())))})}function Ce(){return new T.K}},4408:(Bn,kt,j)=>{"use strict";j.d(kt,{o:()=>Ce});var T=j(727);class d extends T.w0{constructor(Je,ye){super()}schedule(Je,ye=0){return this}}const W={setInterval(Ve,Je,...ye){const{delegate:Me}=W;return Me?.setInterval?Me.setInterval(Ve,Je,...ye):setInterval(Ve,Je,...ye)},clearInterval(Ve){const{delegate:Je}=W;return(Je?.clearInterval||clearInterval)(Ve)},delegate:void 0};var c=j(8737);class Ce extends d{constructor(Je,ye){super(Je,ye),this.scheduler=Je,this.work=ye,this.pending=!1}schedule(Je,ye=0){if(this.closed)return this;this.state=Je;const Me=this.id,Ye=this.scheduler;return null!=Me&&(this.id=this.recycleAsyncId(Ye,Me,ye)),this.pending=!0,this.delay=ye,this.id=this.id||this.requestAsyncId(Ye,this.id,ye),this}requestAsyncId(Je,ye,Me=0){return W.setInterval(Je.flush.bind(Je,this),Me)}recycleAsyncId(Je,ye,Me=0){if(null!=Me&&this.delay===Me&&!1===this.pending)return ye;W.clearInterval(ye)}execute(Je,ye){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Me=this._execute(Je,ye);if(Me)return Me;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Je,ye){let Ye,Me=!1;try{this.work(Je)}catch(ft){Me=!0,Ye=ft||new Error("Scheduled action threw falsy error")}if(Me)return this.unsubscribe(),Ye}unsubscribe(){if(!this.closed){const{id:Je,scheduler:ye}=this,{actions:Me}=ye;this.work=this.state=this.scheduler=null,this.pending=!1,(0,c.P)(Me,this),null!=Je&&(this.id=this.recycleAsyncId(ye,Je,null)),this.delay=null,super.unsubscribe()}}}},7565:(Bn,kt,j)=>{"use strict";j.d(kt,{v:()=>W});var T=j(6063);class d{constructor(Ce,Ve=d.now){this.schedulerActionCtor=Ce,this.now=Ve}schedule(Ce,Ve=0,Je){return new this.schedulerActionCtor(this,Ce).schedule(Je,Ve)}}d.now=T.l.now;class W extends d{constructor(Ce,Ve=d.now){super(Ce,Ve),this.actions=[],this._active=!1,this._scheduled=void 0}flush(Ce){const{actions:Ve}=this;if(this._active)return void Ve.push(Ce);let Je;this._active=!0;do{if(Je=Ce.execute(Ce.state,Ce.delay))break}while(Ce=Ve.shift());if(this._active=!1,Je){for(;Ce=Ve.shift();)Ce.unsubscribe();throw Je}}}},4986:(Bn,kt,j)=>{"use strict";j.d(kt,{P:()=>c,z:()=>W});var T=j(4408);const W=new(j(7565).v)(T.o),c=W},6063:(Bn,kt,j)=>{"use strict";j.d(kt,{l:()=>T});const T={now:()=>(T.delegate||Date).now(),delegate:void 0}},3410:(Bn,kt,j)=>{"use strict";j.d(kt,{z:()=>T});const T={setTimeout(d,W,...c){const{delegate:Ce}=T;return Ce?.setTimeout?Ce.setTimeout(d,W,...c):setTimeout(d,W,...c)},clearTimeout(d){const{delegate:W}=T;return(W?.clearTimeout||clearTimeout)(d)},delegate:void 0}},2202:(Bn,kt,j)=>{"use strict";j.d(kt,{h:()=>d});const d=function T(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Bn,kt,j)=>{"use strict";j.d(kt,{L:()=>T});const T="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(Bn,kt,j)=>{"use strict";j.d(kt,{K:()=>d});const d=(0,j(3888).d)(W=>function(){W(this),this.name="EmptyError",this.message="no elements in sequence"})},3269:(Bn,kt,j)=>{"use strict";j.d(kt,{_6:()=>Ve,jO:()=>c,yG:()=>Ce});var T=j(576),d=j(3532);function W(Je){return Je[Je.length-1]}function c(Je){return(0,T.m)(W(Je))?Je.pop():void 0}function Ce(Je){return(0,d.K)(W(Je))?Je.pop():void 0}function Ve(Je,ye){return"number"==typeof W(Je)?Je.pop():ye}},4742:(Bn,kt,j)=>{"use strict";j.d(kt,{D:()=>Ce});const{isArray:T}=Array,{getPrototypeOf:d,prototype:W,keys:c}=Object;function Ce(Je){if(1===Je.length){const ye=Je[0];if(T(ye))return{args:ye,keys:null};if(function Ve(Je){return Je&&"object"==typeof Je&&d(Je)===W}(ye)){const Me=c(ye);return{args:Me.map(Ye=>ye[Ye]),keys:Me}}}return{args:Je,keys:null}}},8737:(Bn,kt,j)=>{"use strict";function T(d,W){if(d){const c=d.indexOf(W);0<=c&&d.splice(c,1)}}j.d(kt,{P:()=>T})},3888:(Bn,kt,j)=>{"use strict";function T(d){const c=d(Ce=>{Error.call(Ce),Ce.stack=(new Error).stack});return c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c}j.d(kt,{d:()=>T})},1810:(Bn,kt,j)=>{"use strict";function T(d,W){return d.reduce((c,Ce,Ve)=>(c[Ce]=W[Ve],c),{})}j.d(kt,{n:()=>T})},2806:(Bn,kt,j)=>{"use strict";j.d(kt,{O:()=>c,x:()=>W});var T=j(2416);let d=null;function W(Ce){if(T.v.useDeprecatedSynchronousErrorHandling){const Ve=!d;if(Ve&&(d={errorThrown:!1,error:null}),Ce(),Ve){const{errorThrown:Je,error:ye}=d;if(d=null,Je)throw ye}}else Ce()}function c(Ce){T.v.useDeprecatedSynchronousErrorHandling&&d&&(d.errorThrown=!0,d.error=Ce)}},9672:(Bn,kt,j)=>{"use strict";function T(d,W,c,Ce=0,Ve=!1){const Je=W.schedule(function(){c(),Ve?d.add(this.schedule(null,Ce)):this.unsubscribe()},Ce);if(d.add(Je),!Ve)return Je}j.d(kt,{f:()=>T})},4671:(Bn,kt,j)=>{"use strict";function T(d){return d}j.d(kt,{y:()=>T})},1144:(Bn,kt,j)=>{"use strict";j.d(kt,{z:()=>T});const T=d=>d&&"number"==typeof d.length&&"function"!=typeof d},2206:(Bn,kt,j)=>{"use strict";j.d(kt,{D:()=>d});var T=j(576);function d(W){return Symbol.asyncIterator&&(0,T.m)(W?.[Symbol.asyncIterator])}},576:(Bn,kt,j)=>{"use strict";function T(d){return"function"==typeof d}j.d(kt,{m:()=>T})},3670:(Bn,kt,j)=>{"use strict";j.d(kt,{c:()=>W});var T=j(8822),d=j(576);function W(c){return(0,d.m)(c[T.L])}},6495:(Bn,kt,j)=>{"use strict";j.d(kt,{T:()=>W});var T=j(2202),d=j(576);function W(c){return(0,d.m)(c?.[T.h])}},8239:(Bn,kt,j)=>{"use strict";j.d(kt,{t:()=>d});var T=j(576);function d(W){return(0,T.m)(W?.then)}},3260:(Bn,kt,j)=>{"use strict";j.d(kt,{L:()=>c,Q:()=>W});var T=j(655),d=j(576);function W(Ce){return(0,T.FC)(this,arguments,function*(){const Je=Ce.getReader();try{for(;;){const{value:ye,done:Me}=yield(0,T.qq)(Je.read());if(Me)return yield(0,T.qq)(void 0);yield yield(0,T.qq)(ye)}}finally{Je.releaseLock()}})}function c(Ce){return(0,d.m)(Ce?.getReader)}},3532:(Bn,kt,j)=>{"use strict";j.d(kt,{K:()=>d});var T=j(576);function d(W){return W&&(0,T.m)(W.schedule)}},4482:(Bn,kt,j)=>{"use strict";j.d(kt,{A:()=>d,e:()=>W});var T=j(576);function d(c){return(0,T.m)(c?.lift)}function W(c){return Ce=>{if(d(Ce))return Ce.lift(function(Ve){try{return c(Ve,this)}catch(Je){this.error(Je)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Bn,kt,j)=>{"use strict";j.d(kt,{Z:()=>c});var T=j(4004);const{isArray:d}=Array;function c(Ce){return(0,T.U)(Ve=>function W(Ce,Ve){return d(Ve)?Ce(...Ve):Ce(Ve)}(Ce,Ve))}},5032:(Bn,kt,j)=>{"use strict";function T(){}j.d(kt,{Z:()=>T})},9635:(Bn,kt,j)=>{"use strict";j.d(kt,{U:()=>W,z:()=>d});var T=j(4671);function d(...c){return W(c)}function W(c){return 0===c.length?T.y:1===c.length?c[0]:function(Ve){return c.reduce((Je,ye)=>ye(Je),Ve)}}},7849:(Bn,kt,j)=>{"use strict";j.d(kt,{h:()=>W});var T=j(2416),d=j(3410);function W(c){d.z.setTimeout(()=>{const{onUnhandledError:Ce}=T.v;if(!Ce)throw c;Ce(c)})}},4532:(Bn,kt,j)=>{"use strict";function T(d){return new TypeError(`You provided ${null!==d&&"object"==typeof d?"an invalid object":`'${d}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}j.d(kt,{z:()=>T})},655:(Bn,kt,j)=>{"use strict";function ye(xt,Tt,Gt,Bt){return new(Gt||(Gt=Promise))(function(mn,oi){function Yn(Di){try{On(Bt.next(Di))}catch(Ui){oi(Ui)}}function fi(Di){try{On(Bt.throw(Di))}catch(Ui){oi(Ui)}}function On(Di){Di.done?mn(Di.value):function Cn(mn){return mn instanceof Gt?mn:new Gt(function(oi){oi(mn)})}(Di.value).then(Yn,fi)}On((Bt=Bt.apply(xt,Tt||[])).next())})}function Ft(xt){return this instanceof Ft?(this.v=xt,this):new Ft(xt)}function St(xt,Tt,Gt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Cn,Bt=Gt.apply(xt,Tt||[]),mn=[];return Cn={},oi("next"),oi("throw"),oi("return"),Cn[Symbol.asyncIterator]=function(){return this},Cn;function oi(Pi){Bt[Pi]&&(Cn[Pi]=function(Ln){return new Promise(function(Zn,Rt){mn.push([Pi,Ln,Zn,Rt])>1||Yn(Pi,Ln)})})}function Yn(Pi,Ln){try{!function fi(Pi){Pi.value instanceof Ft?Promise.resolve(Pi.value.v).then(On,Di):Ui(mn[0][2],Pi)}(Bt[Pi](Ln))}catch(Zn){Ui(mn[0][3],Zn)}}function On(Pi){Yn("next",Pi)}function Di(Pi){Yn("throw",Pi)}function Ui(Pi,Ln){Pi(Ln),mn.shift(),mn.length&&Yn(mn[0][0],mn[0][1])}}function Xn(xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Gt,Tt=xt[Symbol.asyncIterator];return Tt?Tt.call(xt):(xt=function Pe(xt){var Tt="function"==typeof Symbol&&Symbol.iterator,Gt=Tt&&xt[Tt],Bt=0;if(Gt)return Gt.call(xt);if(xt&&"number"==typeof xt.length)return{next:function(){return xt&&Bt>=xt.length&&(xt=void 0),{value:xt&&xt[Bt++],done:!xt}}};throw new TypeError(Tt?"Object is not iterable.":"Symbol.iterator is not defined.")}(xt),Gt={},Bt("next"),Bt("throw"),Bt("return"),Gt[Symbol.asyncIterator]=function(){return this},Gt);function Bt(mn){Gt[mn]=xt[mn]&&function(oi){return new Promise(function(Yn,fi){!function Cn(mn,oi,Yn,fi){Promise.resolve(fi).then(function(On){mn({value:On,done:Yn})},oi)}(Yn,fi,(oi=xt[mn](oi)).done,oi.value)})}}}j.d(kt,{FC:()=>St,KL:()=>Xn,mG:()=>ye,qq:()=>Ft})},7340:(Bn,kt,j)=>{"use strict";j.d(kt,{F4:()=>Ye,IO:()=>et,LC:()=>d,SB:()=>Me,X$:()=>c,ZE:()=>Pn,ZN:()=>St,_j:()=>T,eR:()=>ft,jt:()=>Ce,k1:()=>Xn,l3:()=>W,oB:()=>ye,pV:()=>ut,vP:()=>Je});class T{}class d{}const W="*";function c(Xt,Fe){return{type:7,name:Xt,definitions:Fe,options:{}}}function Ce(Xt,Fe=null){return{type:4,styles:Fe,timings:Xt}}function Je(Xt,Fe=null){return{type:2,steps:Xt,options:Fe}}function ye(Xt){return{type:6,styles:Xt,offset:null}}function Me(Xt,Fe,Qe){return{type:0,name:Xt,styles:Fe,options:Qe}}function Ye(Xt){return{type:5,steps:Xt}}function ft(Xt,Fe,Qe=null){return{type:1,expr:Xt,animation:Fe,options:Qe}}function ut(Xt=null){return{type:9,options:Xt}}function et(Xt,Fe,Qe=null){return{type:11,selector:Xt,animation:Fe,options:Qe}}function Ft(Xt){Promise.resolve(null).then(Xt)}class St{constructor(Fe=0,Qe=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Fe+Qe}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Fe=>Fe()),this._onDoneFns=[])}onStart(Fe){this._originalOnStartFns.push(Fe),this._onStartFns.push(Fe)}onDone(Fe){this._originalOnDoneFns.push(Fe),this._onDoneFns.push(Fe)}onDestroy(Fe){this._onDestroyFns.push(Fe)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Ft(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Fe=>Fe()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Fe=>Fe()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Fe){this._position=this.totalTime?Fe*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Fe){const Qe="start"==Fe?this._onStartFns:this._onDoneFns;Qe.forEach(fn=>fn()),Qe.length=0}}class Pn{constructor(Fe){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Fe;let Qe=0,fn=0,Jt=0;const rn=this.players.length;0==rn?Ft(()=>this._onFinish()):this.players.forEach(vn=>{vn.onDone(()=>{++Qe==rn&&this._onFinish()}),vn.onDestroy(()=>{++fn==rn&&this._onDestroy()}),vn.onStart(()=>{++Jt==rn&&this._onStart()})}),this.totalTime=this.players.reduce((vn,xt)=>Math.max(vn,xt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Fe=>Fe()),this._onDoneFns=[])}init(){this.players.forEach(Fe=>Fe.init())}onStart(Fe){this._onStartFns.push(Fe)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Fe=>Fe()),this._onStartFns=[])}onDone(Fe){this._onDoneFns.push(Fe)}onDestroy(Fe){this._onDestroyFns.push(Fe)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Fe=>Fe.play())}pause(){this.players.forEach(Fe=>Fe.pause())}restart(){this.players.forEach(Fe=>Fe.restart())}finish(){this._onFinish(),this.players.forEach(Fe=>Fe.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Fe=>Fe.destroy()),this._onDestroyFns.forEach(Fe=>Fe()),this._onDestroyFns=[])}reset(){this.players.forEach(Fe=>Fe.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Fe){const Qe=Fe*this.totalTime;this.players.forEach(fn=>{const Jt=fn.totalTime?Math.min(1,Qe/fn.totalTime):1;fn.setPosition(Jt)})}getPosition(){const Fe=this.players.reduce((Qe,fn)=>null===Qe||fn.totalTime>Qe.totalTime?fn:Qe,null);return null!=Fe?Fe.getPosition():0}beforeDestroy(){this.players.forEach(Fe=>{Fe.beforeDestroy&&Fe.beforeDestroy()})}triggerCallback(Fe){const Qe="start"==Fe?this._onStartFns:this._onDoneFns;Qe.forEach(fn=>fn()),Qe.length=0}}const Xn="!"},2687:(Bn,kt,j)=>{"use strict";j.d(kt,{$s:()=>xt,Em:()=>mn,Kd:()=>ht,X6:()=>ct,ic:()=>Yn,qV:()=>Ei,qm:()=>mt,rt:()=>_t,s1:()=>Cn,tE:()=>ii,yG:()=>K});var T=j(6895),d=j(4650),W=j(3353),c=j(7579),Ce=j(727),Ve=j(1135),Je=j(9646),ye=j(9521),Me=j(8505),Ye=j(8372),ft=j(9300),Pe=j(4004),ut=j(5698),gt=j(5684),et=j(1884),Ut=j(2722),Ft=j(1281),St=j(9643),Pn=j(2289);function Qe(Ke,nt){return(Ke.getAttribute(nt)||"").match(/\S+/g)||[]}const Jt="cdk-describedby-message",rn="cdk-describedby-host";let vn=0,xt=(()=>{class Ke{constructor(Be,Dt){this._platform=Dt,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+vn++,this._document=Be,this._id=(0,d.f3M)(d.AFp)+"-"+vn++}describe(Be,Dt,ae){if(!this._canBeDescribed(Be,Dt))return;const Y=Tt(Dt,ae);"string"!=typeof Dt?(Gt(Dt,this._id),this._messageRegistry.set(Y,{messageElement:Dt,referenceCount:0})):this._messageRegistry.has(Y)||this._createMessageElement(Dt,ae),this._isElementDescribedByMessage(Be,Y)||this._addMessageReference(Be,Y)}removeDescription(Be,Dt,ae){if(!Dt||!this._isElementNode(Be))return;const Y=Tt(Dt,ae);if(this._isElementDescribedByMessage(Be,Y)&&this._removeMessageReference(Be,Y),"string"==typeof Dt){const le=this._messageRegistry.get(Y);le&&0===le.referenceCount&&this._deleteMessageElement(Y)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const Be=this._document.querySelectorAll(`[${rn}="${this._id}"]`);for(let Dt=0;Dt<Be.length;Dt++)this._removeCdkDescribedByReferenceIds(Be[Dt]),Be[Dt].removeAttribute(rn);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(Be,Dt){const ae=this._document.createElement("div");Gt(ae,this._id),ae.textContent=Be,Dt&&ae.setAttribute("role",Dt),this._createMessagesContainer(),this._messagesContainer.appendChild(ae),this._messageRegistry.set(Tt(Be,Dt),{messageElement:ae,referenceCount:0})}_deleteMessageElement(Be){this._messageRegistry.get(Be)?.messageElement?.remove(),this._messageRegistry.delete(Be)}_createMessagesContainer(){if(this._messagesContainer)return;const Be="cdk-describedby-message-container",Dt=this._document.querySelectorAll(`.${Be}[platform="server"]`);for(let Y=0;Y<Dt.length;Y++)Dt[Y].remove();const ae=this._document.createElement("div");ae.style.visibility="hidden",ae.classList.add(Be),ae.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&ae.setAttribute("platform","server"),this._document.body.appendChild(ae),this._messagesContainer=ae}_removeCdkDescribedByReferenceIds(Be){const Dt=Qe(Be,"aria-describedby").filter(ae=>0!=ae.indexOf(Jt));Be.setAttribute("aria-describedby",Dt.join(" "))}_addMessageReference(Be,Dt){const ae=this._messageRegistry.get(Dt);(function Xt(Ke,nt,Be){const Dt=Qe(Ke,nt);Dt.some(ae=>ae.trim()==Be.trim())||(Dt.push(Be.trim()),Ke.setAttribute(nt,Dt.join(" ")))})(Be,"aria-describedby",ae.messageElement.id),Be.setAttribute(rn,this._id),ae.referenceCount++}_removeMessageReference(Be,Dt){const ae=this._messageRegistry.get(Dt);ae.referenceCount--,function Fe(Ke,nt,Be){const ae=Qe(Ke,nt).filter(Y=>Y!=Be.trim());ae.length?Ke.setAttribute(nt,ae.join(" ")):Ke.removeAttribute(nt)}(Be,"aria-describedby",ae.messageElement.id),Be.removeAttribute(rn)}_isElementDescribedByMessage(Be,Dt){const ae=Qe(Be,"aria-describedby"),Y=this._messageRegistry.get(Dt),le=Y&&Y.messageElement.id;return!!le&&-1!=ae.indexOf(le)}_canBeDescribed(Be,Dt){if(!this._isElementNode(Be))return!1;if(Dt&&"object"==typeof Dt)return!0;const ae=null==Dt?"":`${Dt}`.trim(),Y=Be.getAttribute("aria-label");return!(!ae||Y&&Y.trim()===ae)}_isElementNode(Be){return Be.nodeType===this._document.ELEMENT_NODE}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(T.K0),d.LFG(W.t4))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();function Tt(Ke,nt){return"string"==typeof Ke?`${nt||""}/${Ke}`:Ke}function Gt(Ke,nt){Ke.id||(Ke.id=`${Jt}-${nt}-${vn++}`)}class Bt{constructor(nt){this._items=nt,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new c.x,this._typeaheadSubscription=Ce.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=Be=>Be.disabled,this._pressedLetters=[],this.tabOut=new c.x,this.change=new c.x,nt instanceof d.n_E&&nt.changes.subscribe(Be=>{if(this._activeItem){const ae=Be.toArray().indexOf(this._activeItem);ae>-1&&ae!==this._activeItemIndex&&(this._activeItemIndex=ae)}})}skipPredicate(nt){return this._skipPredicateFn=nt,this}withWrap(nt=!0){return this._wrap=nt,this}withVerticalOrientation(nt=!0){return this._vertical=nt,this}withHorizontalOrientation(nt){return this._horizontal=nt,this}withAllowedModifierKeys(nt){return this._allowedModifierKeys=nt,this}withTypeAhead(nt=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,Me.b)(Be=>this._pressedLetters.push(Be)),(0,Ye.b)(nt),(0,ft.h)(()=>this._pressedLetters.length>0),(0,Pe.U)(()=>this._pressedLetters.join(""))).subscribe(Be=>{const Dt=this._getItemsArray();for(let ae=1;ae<Dt.length+1;ae++){const Y=(this._activeItemIndex+ae)%Dt.length,le=Dt[Y];if(!this._skipPredicateFn(le)&&0===le.getLabel().toUpperCase().trim().indexOf(Be)){this.setActiveItem(Y);break}}this._pressedLetters=[]}),this}withHomeAndEnd(nt=!0){return this._homeAndEnd=nt,this}setActiveItem(nt){const Be=this._activeItem;this.updateActiveItem(nt),this._activeItem!==Be&&this.change.next(this._activeItemIndex)}onKeydown(nt){const Be=nt.keyCode,ae=["altKey","ctrlKey","metaKey","shiftKey"].every(Y=>!nt[Y]||this._allowedModifierKeys.indexOf(Y)>-1);switch(Be){case ye.Mf:return void this.tabOut.next();case ye.JH:if(this._vertical&&ae){this.setNextItemActive();break}return;case ye.LH:if(this._vertical&&ae){this.setPreviousItemActive();break}return;case ye.SV:if(this._horizontal&&ae){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case ye.oh:if(this._horizontal&&ae){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case ye.Sd:if(this._homeAndEnd&&ae){this.setFirstItemActive();break}return;case ye.uR:if(this._homeAndEnd&&ae){this.setLastItemActive();break}return;default:return void((ae||(0,ye.Vb)(nt,"shiftKey"))&&(nt.key&&1===nt.key.length?this._letterKeyStream.next(nt.key.toLocaleUpperCase()):(Be>=ye.A&&Be<=ye.Z||Be>=ye.xE&&Be<=ye.aO)&&this._letterKeyStream.next(String.fromCharCode(Be))))}this._pressedLetters=[],nt.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(nt){const Be=this._getItemsArray(),Dt="number"==typeof nt?nt:Be.indexOf(nt);this._activeItem=Be[Dt]??null,this._activeItemIndex=Dt}_setActiveItemByDelta(nt){this._wrap?this._setActiveInWrapMode(nt):this._setActiveInDefaultMode(nt)}_setActiveInWrapMode(nt){const Be=this._getItemsArray();for(let Dt=1;Dt<=Be.length;Dt++){const ae=(this._activeItemIndex+nt*Dt+Be.length)%Be.length;if(!this._skipPredicateFn(Be[ae]))return void this.setActiveItem(ae)}}_setActiveInDefaultMode(nt){this._setActiveItemByIndex(this._activeItemIndex+nt,nt)}_setActiveItemByIndex(nt,Be){const Dt=this._getItemsArray();if(Dt[nt]){for(;this._skipPredicateFn(Dt[nt]);)if(!Dt[nt+=Be])return;this.setActiveItem(nt)}}_getItemsArray(){return this._items instanceof d.n_E?this._items.toArray():this._items}}class Cn extends Bt{setActiveItem(nt){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(nt),this.activeItem&&this.activeItem.setActiveStyles()}}class mn extends Bt{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(nt){return this._origin=nt,this}setActiveItem(nt){super.setActiveItem(nt),this.activeItem&&this.activeItem.focus(this._origin)}}let Yn=(()=>{class Ke{constructor(Be){this._platform=Be}isDisabled(Be){return Be.hasAttribute("disabled")}isVisible(Be){return function On(Ke){return!!(Ke.offsetWidth||Ke.offsetHeight||"function"==typeof Ke.getClientRects&&Ke.getClientRects().length)}(Be)&&"visible"===getComputedStyle(Be).visibility}isTabbable(Be){if(!this._platform.isBrowser)return!1;const Dt=function fi(Ke){try{return Ke.frameElement}catch{return null}}(function gn(Ke){return Ke.ownerDocument&&Ke.ownerDocument.defaultView||window}(Be));if(Dt&&(-1===Kt(Dt)||!this.isVisible(Dt)))return!1;let ae=Be.nodeName.toLowerCase(),Y=Kt(Be);return Be.hasAttribute("contenteditable")?-1!==Y:!("iframe"===ae||"object"===ae||this._platform.WEBKIT&&this._platform.IOS&&!function kn(Ke){let nt=Ke.nodeName.toLowerCase(),Be="input"===nt&&Ke.type;return"text"===Be||"password"===Be||"select"===nt||"textarea"===nt}(Be))&&("audio"===ae?!!Be.hasAttribute("controls")&&-1!==Y:"video"===ae?-1!==Y&&(null!==Y||this._platform.FIREFOX||Be.hasAttribute("controls")):Be.tabIndex>=0)}isFocusable(Be,Dt){return function zn(Ke){return!function Ui(Ke){return function Ln(Ke){return"input"==Ke.nodeName.toLowerCase()}(Ke)&&"hidden"==Ke.type}(Ke)&&(function Di(Ke){let nt=Ke.nodeName.toLowerCase();return"input"===nt||"select"===nt||"button"===nt||"textarea"===nt}(Ke)||function Pi(Ke){return function Zn(Ke){return"a"==Ke.nodeName.toLowerCase()}(Ke)&&Ke.hasAttribute("href")}(Ke)||Ke.hasAttribute("contenteditable")||Rt(Ke))}(Be)&&!this.isDisabled(Be)&&(Dt?.ignoreVisibility||this.isVisible(Be))}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(W.t4))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();function Rt(Ke){if(!Ke.hasAttribute("tabindex")||void 0===Ke.tabIndex)return!1;let nt=Ke.getAttribute("tabindex");return!(!nt||isNaN(parseInt(nt,10)))}function Kt(Ke){if(!Rt(Ke))return null;const nt=parseInt(Ke.getAttribute("tabindex")||"",10);return isNaN(nt)?-1:nt}class wi{constructor(nt,Be,Dt,ae,Y=!1){this._element=nt,this._checker=Be,this._ngZone=Dt,this._document=ae,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,Y||this.attachAnchors()}get enabled(){return this._enabled}set enabled(nt){this._enabled=nt,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(nt,this._startAnchor),this._toggleAnchorTabIndex(nt,this._endAnchor))}destroy(){const nt=this._startAnchor,Be=this._endAnchor;nt&&(nt.removeEventListener("focus",this.startAnchorListener),nt.remove()),Be&&(Be.removeEventListener("focus",this.endAnchorListener),Be.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(nt){return new Promise(Be=>{this._executeOnStable(()=>Be(this.focusInitialElement(nt)))})}focusFirstTabbableElementWhenReady(nt){return new Promise(Be=>{this._executeOnStable(()=>Be(this.focusFirstTabbableElement(nt)))})}focusLastTabbableElementWhenReady(nt){return new Promise(Be=>{this._executeOnStable(()=>Be(this.focusLastTabbableElement(nt)))})}_getRegionBoundary(nt){const Be=this._element.querySelectorAll(`[cdk-focus-region-${nt}], [cdkFocusRegion${nt}], [cdk-focus-${nt}]`);return"start"==nt?Be.length?Be[0]:this._getFirstTabbableElement(this._element):Be.length?Be[Be.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(nt){const Be=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(Be){if(!this._checker.isFocusable(Be)){const Dt=this._getFirstTabbableElement(Be);return Dt?.focus(nt),!!Dt}return Be.focus(nt),!0}return this.focusFirstTabbableElement(nt)}focusFirstTabbableElement(nt){const Be=this._getRegionBoundary("start");return Be&&Be.focus(nt),!!Be}focusLastTabbableElement(nt){const Be=this._getRegionBoundary("end");return Be&&Be.focus(nt),!!Be}hasAttached(){return this._hasAttached}_getFirstTabbableElement(nt){if(this._checker.isFocusable(nt)&&this._checker.isTabbable(nt))return nt;const Be=nt.children;for(let Dt=0;Dt<Be.length;Dt++){const ae=Be[Dt].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(Be[Dt]):null;if(ae)return ae}return null}_getLastTabbableElement(nt){if(this._checker.isFocusable(nt)&&this._checker.isTabbable(nt))return nt;const Be=nt.children;for(let Dt=Be.length-1;Dt>=0;Dt--){const ae=Be[Dt].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(Be[Dt]):null;if(ae)return ae}return null}_createAnchor(){const nt=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,nt),nt.classList.add("cdk-visually-hidden"),nt.classList.add("cdk-focus-trap-anchor"),nt.setAttribute("aria-hidden","true"),nt}_toggleAnchorTabIndex(nt,Be){nt?Be.setAttribute("tabindex","0"):Be.removeAttribute("tabindex")}toggleAnchors(nt){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(nt,this._startAnchor),this._toggleAnchorTabIndex(nt,this._endAnchor))}_executeOnStable(nt){this._ngZone.isStable?nt():this._ngZone.onStable.pipe((0,ut.q)(1)).subscribe(nt)}}let Ei=(()=>{class Ke{constructor(Be,Dt,ae){this._checker=Be,this._ngZone=Dt,this._document=ae}create(Be,Dt=!1){return new wi(Be,this._checker,this._ngZone,this._document,Dt)}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(Yn),d.LFG(d.R0b),d.LFG(T.K0))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();function ct(Ke){return 0===Ke.buttons||0===Ke.offsetX&&0===Ke.offsetY}function K(Ke){const nt=Ke.touches&&Ke.touches[0]||Ke.changedTouches&&Ke.changedTouches[0];return!(!nt||-1!==nt.identifier||null!=nt.radiusX&&1!==nt.radiusX||null!=nt.radiusY&&1!==nt.radiusY)}const ie=new d.OlP("cdk-input-modality-detector-options"),De={ignoreKeys:[ye.zL,ye.jx,ye.b2,ye.MW,ye.JU]},ze=(0,W.i$)({passive:!0,capture:!0});let he=(()=>{class Ke{constructor(Be,Dt,ae,Y){this._platform=Be,this._mostRecentTarget=null,this._modality=new Ve.X(null),this._lastTouchMs=0,this._onKeydown=le=>{this._options?.ignoreKeys?.some(Te=>Te===le.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,W.sA)(le))},this._onMousedown=le=>{Date.now()-this._lastTouchMs<650||(this._modality.next(ct(le)?"keyboard":"mouse"),this._mostRecentTarget=(0,W.sA)(le))},this._onTouchstart=le=>{K(le)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,W.sA)(le))},this._options={...De,...Y},this.modalityDetected=this._modality.pipe((0,gt.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,et.x)()),Be.isBrowser&&Dt.runOutsideAngular(()=>{ae.addEventListener("keydown",this._onKeydown,ze),ae.addEventListener("mousedown",this._onMousedown,ze),ae.addEventListener("touchstart",this._onTouchstart,ze)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ze),document.removeEventListener("mousedown",this._onMousedown,ze),document.removeEventListener("touchstart",this._onTouchstart,ze))}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(W.t4),d.LFG(d.R0b),d.LFG(T.K0),d.LFG(ie,8))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();const ce=new d.OlP("liveAnnouncerElement",{providedIn:"root",factory:function de(){return null}}),We=new d.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let ht=(()=>{class Ke{constructor(Be,Dt,ae,Y){this._ngZone=Dt,this._defaultOptions=Y,this._document=ae,this._liveElement=Be||this._createLiveElement()}announce(Be,...Dt){const ae=this._defaultOptions;let Y,le;return 1===Dt.length&&"number"==typeof Dt[0]?le=Dt[0]:[Y,le]=Dt,this.clear(),clearTimeout(this._previousTimeout),Y||(Y=ae&&ae.politeness?ae.politeness:"polite"),null==le&&ae&&(le=ae.duration),this._liveElement.setAttribute("aria-live",Y),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(Te=>this._currentResolve=Te)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=Be,"number"==typeof le&&(this._previousTimeout=setTimeout(()=>this.clear(),le)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const Be="cdk-live-announcer-element",Dt=this._document.getElementsByClassName(Be),ae=this._document.createElement("div");for(let Y=0;Y<Dt.length;Y++)Dt[Y].remove();return ae.classList.add(Be),ae.classList.add("cdk-visually-hidden"),ae.setAttribute("aria-atomic","true"),ae.setAttribute("aria-live","polite"),this._document.body.appendChild(ae),ae}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(ce,8),d.LFG(d.R0b),d.LFG(T.K0),d.LFG(We,8))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();const _n=new d.OlP("cdk-focus-monitor-default-options"),An=(0,W.i$)({passive:!0,capture:!0});let ii=(()=>{class Ke{constructor(Be,Dt,ae,Y,le){this._ngZone=Be,this._platform=Dt,this._inputModalityDetector=ae,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new c.x,this._rootNodeFocusAndBlurListener=Te=>{for(let Xe=(0,W.sA)(Te);Xe;Xe=Xe.parentElement)"focus"===Te.type?this._onFocus(Te,Xe):this._onBlur(Te,Xe)},this._document=Y,this._detectionMode=le?.detectionMode||0}monitor(Be,Dt=!1){const ae=(0,Ft.fI)(Be);if(!this._platform.isBrowser||1!==ae.nodeType)return(0,Je.of)(null);const Y=(0,W.kV)(ae)||this._getDocument(),le=this._elementInfo.get(ae);if(le)return Dt&&(le.checkChildren=!0),le.subject;const Te={checkChildren:Dt,subject:new c.x,rootNode:Y};return this._elementInfo.set(ae,Te),this._registerGlobalListeners(Te),Te.subject}stopMonitoring(Be){const Dt=(0,Ft.fI)(Be),ae=this._elementInfo.get(Dt);ae&&(ae.subject.complete(),this._setClasses(Dt),this._elementInfo.delete(Dt),this._removeGlobalListeners(ae))}focusVia(Be,Dt,ae){const Y=(0,Ft.fI)(Be);Y===this._getDocument().activeElement?this._getClosestElementsInfo(Y).forEach(([Te,He])=>this._originChanged(Te,Dt,He)):(this._setOrigin(Dt),"function"==typeof Y.focus&&Y.focus(ae))}ngOnDestroy(){this._elementInfo.forEach((Be,Dt)=>this.stopMonitoring(Dt))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(Be){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(Be)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:Be&&this._isLastInteractionFromInputLabel(Be)?"mouse":"program"}_shouldBeAttributedToTouch(Be){return 1===this._detectionMode||!!Be?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(Be,Dt){Be.classList.toggle("cdk-focused",!!Dt),Be.classList.toggle("cdk-touch-focused","touch"===Dt),Be.classList.toggle("cdk-keyboard-focused","keyboard"===Dt),Be.classList.toggle("cdk-mouse-focused","mouse"===Dt),Be.classList.toggle("cdk-program-focused","program"===Dt)}_setOrigin(Be,Dt=!1){this._ngZone.runOutsideAngular(()=>{this._origin=Be,this._originFromTouchInteraction="touch"===Be&&Dt,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(Be,Dt){const ae=this._elementInfo.get(Dt),Y=(0,W.sA)(Be);!ae||!ae.checkChildren&&Dt!==Y||this._originChanged(Dt,this._getFocusOrigin(Y),ae)}_onBlur(Be,Dt){const ae=this._elementInfo.get(Dt);!ae||ae.checkChildren&&Be.relatedTarget instanceof Node&&Dt.contains(Be.relatedTarget)||(this._setClasses(Dt),this._emitOrigin(ae,null))}_emitOrigin(Be,Dt){Be.subject.observers.length&&this._ngZone.run(()=>Be.subject.next(Dt))}_registerGlobalListeners(Be){if(!this._platform.isBrowser)return;const Dt=Be.rootNode,ae=this._rootNodeFocusListenerCount.get(Dt)||0;ae||this._ngZone.runOutsideAngular(()=>{Dt.addEventListener("focus",this._rootNodeFocusAndBlurListener,An),Dt.addEventListener("blur",this._rootNodeFocusAndBlurListener,An)}),this._rootNodeFocusListenerCount.set(Dt,ae+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,Ut.R)(this._stopInputModalityDetector)).subscribe(Y=>{this._setOrigin(Y,!0)}))}_removeGlobalListeners(Be){const Dt=Be.rootNode;if(this._rootNodeFocusListenerCount.has(Dt)){const ae=this._rootNodeFocusListenerCount.get(Dt);ae>1?this._rootNodeFocusListenerCount.set(Dt,ae-1):(Dt.removeEventListener("focus",this._rootNodeFocusAndBlurListener,An),Dt.removeEventListener("blur",this._rootNodeFocusAndBlurListener,An),this._rootNodeFocusListenerCount.delete(Dt))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(Be,Dt,ae){this._setClasses(Be,Dt),this._emitOrigin(ae,Dt),this._lastFocusOrigin=Dt}_getClosestElementsInfo(Be){const Dt=[];return this._elementInfo.forEach((ae,Y)=>{(Y===Be||ae.checkChildren&&Y.contains(Be))&&Dt.push([Y,ae])}),Dt}_isLastInteractionFromInputLabel(Be){const{_mostRecentTarget:Dt,mostRecentModality:ae}=this._inputModalityDetector;if("mouse"!==ae||!Dt||Dt===Be||"INPUT"!==Be.nodeName&&"TEXTAREA"!==Be.nodeName||Be.disabled)return!1;const Y=Be.labels;if(Y)for(let le=0;le<Y.length;le++)if(Y[le].contains(Dt))return!0;return!1}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(d.R0b),d.LFG(W.t4),d.LFG(he),d.LFG(T.K0,8),d.LFG(_n,8))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})();const gr="cdk-high-contrast-black-on-white",mi="cdk-high-contrast-white-on-black",zt="cdk-high-contrast-active";let mt=(()=>{class Ke{constructor(Be,Dt){this._platform=Be,this._document=Dt,this._breakpointSubscription=(0,d.f3M)(Pn.Yg).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const Be=this._document.createElement("div");Be.style.backgroundColor="rgb(1,2,3)",Be.style.position="absolute",this._document.body.appendChild(Be);const Dt=this._document.defaultView||window,ae=Dt&&Dt.getComputedStyle?Dt.getComputedStyle(Be):null,Y=(ae&&ae.backgroundColor||"").replace(/ /g,"");switch(Be.remove(),Y){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const Be=this._document.body.classList;Be.remove(zt,gr,mi),this._hasCheckedHighContrastMode=!0;const Dt=this.getHighContrastMode();1===Dt?Be.add(zt,gr):2===Dt&&Be.add(zt,mi)}}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(W.t4),d.LFG(T.K0))},Ke.\u0275prov=d.Yz7({token:Ke,factory:Ke.\u0275fac,providedIn:"root"}),Ke})(),_t=(()=>{class Ke{constructor(Be){Be._applyBodyHighContrastModeCssClasses()}}return Ke.\u0275fac=function(Be){return new(Be||Ke)(d.LFG(mt))},Ke.\u0275mod=d.oAB({type:Ke}),Ke.\u0275inj=d.cJS({imports:[St.Q8]}),Ke})()},445:(Bn,kt,j)=>{"use strict";j.d(kt,{Is:()=>Je,vT:()=>Me});var T=j(4650),d=j(6895);const W=new T.OlP("cdk-dir-doc",{providedIn:"root",factory:function c(){return(0,T.f3M)(d.K0)}}),Ce=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Je=(()=>{class Ye{constructor(Pe){if(this.value="ltr",this.change=new T.vpe,Pe){const gt=Pe.documentElement?Pe.documentElement.dir:null;this.value=function Ve(Ye){const ft=Ye?.toLowerCase()||"";return"auto"===ft&&typeof navigator<"u"&&navigator?.language?Ce.test(navigator.language)?"rtl":"ltr":"rtl"===ft?"rtl":"ltr"}((Pe.body?Pe.body.dir:null)||gt||"ltr")}}ngOnDestroy(){this.change.complete()}}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)(T.LFG(W,8))},Ye.\u0275prov=T.Yz7({token:Ye,factory:Ye.\u0275fac,providedIn:"root"}),Ye})(),Me=(()=>{class Ye{}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)},Ye.\u0275mod=T.oAB({type:Ye}),Ye.\u0275inj=T.cJS({}),Ye})()},1281:(Bn,kt,j)=>{"use strict";j.d(kt,{Eq:()=>Ce,HM:()=>Ve,Ig:()=>d,fI:()=>Je,su:()=>W});var T=j(4650);function d(Me){return null!=Me&&"false"!=`${Me}`}function W(Me,Ye=0){return function c(Me){return!isNaN(parseFloat(Me))&&!isNaN(Number(Me))}(Me)?Number(Me):Ye}function Ce(Me){return Array.isArray(Me)?Me:[Me]}function Ve(Me){return null==Me?"":"string"==typeof Me?Me:`${Me}px`}function Je(Me){return Me instanceof T.SBq?Me.nativeElement:Me}},5017:(Bn,kt,j)=>{"use strict";j.d(kt,{A8:()=>Ye,Ov:()=>ye});var T=j(7579),d=j(4650);class ye{constructor(ut=!1,gt,et=!0,Ut){this._multiple=ut,this._emitChanges=et,this.compareWith=Ut,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new T.x,gt&&gt.length&&(ut?gt.forEach(Ft=>this._markSelected(Ft)):this._markSelected(gt[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...ut){this._verifyValueAssignment(ut),ut.forEach(et=>this._markSelected(et));const gt=this._hasQueuedChanges();return this._emitChangeEvent(),gt}deselect(...ut){this._verifyValueAssignment(ut),ut.forEach(et=>this._unmarkSelected(et));const gt=this._hasQueuedChanges();return this._emitChangeEvent(),gt}setSelection(...ut){this._verifyValueAssignment(ut);const gt=this.selected,et=new Set(ut);ut.forEach(Ft=>this._markSelected(Ft)),gt.filter(Ft=>!et.has(Ft)).forEach(Ft=>this._unmarkSelected(Ft));const Ut=this._hasQueuedChanges();return this._emitChangeEvent(),Ut}toggle(ut){return this.isSelected(ut)?this.deselect(ut):this.select(ut)}clear(ut=!0){this._unmarkAll();const gt=this._hasQueuedChanges();return ut&&this._emitChangeEvent(),gt}isSelected(ut){if(this.compareWith){for(const gt of this._selection)if(this.compareWith(gt,ut))return!0;return!1}return this._selection.has(ut)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(ut){this._multiple&&this.selected&&this._selected.sort(ut)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(ut){this.isSelected(ut)||(this._multiple||this._unmarkAll(),this.isSelected(ut)||this._selection.add(ut),this._emitChanges&&this._selectedToEmit.push(ut))}_unmarkSelected(ut){this.isSelected(ut)&&(this._selection.delete(ut),this._emitChanges&&this._deselectedToEmit.push(ut))}_unmarkAll(){this.isEmpty()||this._selection.forEach(ut=>this._unmarkSelected(ut))}_verifyValueAssignment(ut){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}}let Ye=(()=>{class Pe{constructor(){this._listeners=[]}notify(gt,et){for(let Ut of this._listeners)Ut(gt,et)}listen(gt){return this._listeners.push(gt),()=>{this._listeners=this._listeners.filter(et=>gt!==et)}}ngOnDestroy(){this._listeners=[]}}return Pe.\u0275fac=function(gt){return new(gt||Pe)},Pe.\u0275prov=d.Yz7({token:Pe,factory:Pe.\u0275fac,providedIn:"root"}),Pe})()},9521:(Bn,kt,j)=>{"use strict";j.d(kt,{A:()=>Ui,JH:()=>Xn,JU:()=>Ve,K5:()=>Ce,LH:()=>St,L_:()=>Pe,MW:()=>We,Mf:()=>W,SV:()=>Pn,Sd:()=>Ut,Vb:()=>yr,Z:()=>de,aO:()=>oi,b2:()=>zr,hY:()=>ft,jx:()=>Je,oh:()=>Ft,uR:()=>et,xE:()=>Jt,zL:()=>ye});const W=9,Ce=13,Ve=16,Je=17,ye=18,ft=27,Pe=32,et=35,Ut=36,Ft=37,St=38,Pn=39,Xn=40,Jt=48,oi=57,Ui=65,de=90,We=91,zr=224;function yr(Xi,...Gr){return Gr.length?Gr.some(ao=>Xi[ao]):Xi.altKey||Xi.shiftKey||Xi.ctrlKey||Xi.metaKey}},2289:(Bn,kt,j)=>{"use strict";j.d(kt,{Yg:()=>Xn,u3:()=>Fe});var T=j(4650),d=j(1281),W=j(7579),c=j(9841),Ce=j(7272),Ve=j(9751),Je=j(5698),ye=j(5684),Me=j(8372),Ye=j(4004),ft=j(8675),Pe=j(2722),ut=j(3353);const et=new Set;let Ut,Ft=(()=>{class Qe{constructor(Jt){this._platform=Jt,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Pn}matchMedia(Jt){return(this._platform.WEBKIT||this._platform.BLINK)&&function St(Qe){if(!et.has(Qe))try{Ut||(Ut=document.createElement("style"),Ut.setAttribute("type","text/css"),document.head.appendChild(Ut)),Ut.sheet&&(Ut.sheet.insertRule(`@media ${Qe} {body{ }}`,0),et.add(Qe))}catch(fn){console.error(fn)}}(Jt),this._matchMedia(Jt)}}return Qe.\u0275fac=function(Jt){return new(Jt||Qe)(T.LFG(ut.t4))},Qe.\u0275prov=T.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"}),Qe})();function Pn(Qe){return{matches:"all"===Qe||""===Qe,media:Qe,addListener:()=>{},removeListener:()=>{}}}let Xn=(()=>{class Qe{constructor(Jt,rn){this._mediaMatcher=Jt,this._zone=rn,this._queries=new Map,this._destroySubject=new W.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(Jt){return Xt((0,d.Eq)(Jt)).some(vn=>this._registerQuery(vn).mql.matches)}observe(Jt){const vn=Xt((0,d.Eq)(Jt)).map(Tt=>this._registerQuery(Tt).observable);let xt=(0,c.a)(vn);return xt=(0,Ce.z)(xt.pipe((0,Je.q)(1)),xt.pipe((0,ye.T)(1),(0,Me.b)(0))),xt.pipe((0,Ye.U)(Tt=>{const Gt={matches:!1,breakpoints:{}};return Tt.forEach(({matches:Bt,query:Cn})=>{Gt.matches=Gt.matches||Bt,Gt.breakpoints[Cn]=Bt}),Gt}))}_registerQuery(Jt){if(this._queries.has(Jt))return this._queries.get(Jt);const rn=this._mediaMatcher.matchMedia(Jt),xt={observable:new Ve.y(Tt=>{const Gt=Bt=>this._zone.run(()=>Tt.next(Bt));return rn.addListener(Gt),()=>{rn.removeListener(Gt)}}).pipe((0,ft.O)(rn),(0,Ye.U)(({matches:Tt})=>({query:Jt,matches:Tt})),(0,Pe.R)(this._destroySubject)),mql:rn};return this._queries.set(Jt,xt),xt}}return Qe.\u0275fac=function(Jt){return new(Jt||Qe)(T.LFG(Ft),T.LFG(T.R0b))},Qe.\u0275prov=T.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"}),Qe})();function Xt(Qe){return Qe.map(fn=>fn.split(",")).reduce((fn,Jt)=>fn.concat(Jt)).map(fn=>fn.trim())}const Fe={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"}},9643:(Bn,kt,j)=>{"use strict";j.d(kt,{Q8:()=>Me,wD:()=>ye});var T=j(1281),d=j(4650),W=j(9751),c=j(7579),Ce=j(8372);let Ve=(()=>{class Ye{create(Pe){return typeof MutationObserver>"u"?null:new MutationObserver(Pe)}}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)},Ye.\u0275prov=d.Yz7({token:Ye,factory:Ye.\u0275fac,providedIn:"root"}),Ye})(),Je=(()=>{class Ye{constructor(Pe){this._mutationObserverFactory=Pe,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((Pe,ut)=>this._cleanupObserver(ut))}observe(Pe){const ut=(0,T.fI)(Pe);return new W.y(gt=>{const Ut=this._observeElement(ut).subscribe(gt);return()=>{Ut.unsubscribe(),this._unobserveElement(ut)}})}_observeElement(Pe){if(this._observedElements.has(Pe))this._observedElements.get(Pe).count++;else{const ut=new c.x,gt=this._mutationObserverFactory.create(et=>ut.next(et));gt&&gt.observe(Pe,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(Pe,{observer:gt,stream:ut,count:1})}return this._observedElements.get(Pe).stream}_unobserveElement(Pe){this._observedElements.has(Pe)&&(this._observedElements.get(Pe).count--,this._observedElements.get(Pe).count||this._cleanupObserver(Pe))}_cleanupObserver(Pe){if(this._observedElements.has(Pe)){const{observer:ut,stream:gt}=this._observedElements.get(Pe);ut&&ut.disconnect(),gt.complete(),this._observedElements.delete(Pe)}}}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)(d.LFG(Ve))},Ye.\u0275prov=d.Yz7({token:Ye,factory:Ye.\u0275fac,providedIn:"root"}),Ye})(),ye=(()=>{class Ye{constructor(Pe,ut,gt){this._contentObserver=Pe,this._elementRef=ut,this._ngZone=gt,this.event=new d.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(Pe){this._disabled=(0,T.Ig)(Pe),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(Pe){this._debounce=(0,T.su)(Pe),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const Pe=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?Pe.pipe((0,Ce.b)(this.debounce)):Pe).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)(d.Y36(Je),d.Y36(d.SBq),d.Y36(d.R0b))},Ye.\u0275dir=d.lG2({type:Ye,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),Ye})(),Me=(()=>{class Ye{}return Ye.\u0275fac=function(Pe){return new(Pe||Ye)},Ye.\u0275mod=d.oAB({type:Ye}),Ye.\u0275inj=d.cJS({providers:[Ve]}),Ye})()},8184:(Bn,kt,j)=>{"use strict";j.d(kt,{U8:()=>Wi,aV:()=>gn,pI:()=>or,xu:()=>Ii});var T=j(8605),d=j(6895),W=j(4650),c=j(1281),Ce=j(3353),Ve=j(445),Je=j(4080),ye=j(7579),Me=j(727),Ye=j(6451),ft=j(5698),Pe=j(2722),ut=j(2529),gt=j(9521);const et=(0,Ce.Mq)();class Ut{constructor(K,ie){this._viewportRuler=K,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=ie}attach(){}enable(){if(this._canBeEnabled()){const K=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=K.style.left||"",this._previousHTMLStyles.top=K.style.top||"",K.style.left=(0,c.HM)(-this._previousScrollPosition.left),K.style.top=(0,c.HM)(-this._previousScrollPosition.top),K.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const K=this._document.documentElement,De=K.style,dt=this._document.body.style,ze=De.scrollBehavior||"",he=dt.scrollBehavior||"";this._isEnabled=!1,De.left=this._previousHTMLStyles.left,De.top=this._previousHTMLStyles.top,K.classList.remove("cdk-global-scrollblock"),et&&(De.scrollBehavior=dt.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),et&&(De.scrollBehavior=ze,dt.scrollBehavior=he)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const ie=this._document.body,De=this._viewportRuler.getViewportSize();return ie.scrollHeight>De.height||ie.scrollWidth>De.width}}class St{constructor(K,ie,De,dt){this._scrollDispatcher=K,this._ngZone=ie,this._viewportRuler=De,this._config=dt,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(K){this._overlayRef=K}enable(){if(this._scrollSubscription)return;const K=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=K.subscribe(()=>{const ie=this._viewportRuler.getViewportScrollPosition().top;Math.abs(ie-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=K.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Pn{enable(){}disable(){}attach(){}}function Xn(ct,K){return K.some(ie=>ct.bottom<ie.top||ct.top>ie.bottom||ct.right<ie.left||ct.left>ie.right)}function Xt(ct,K){return K.some(ie=>ct.top<ie.top||ct.bottom>ie.bottom||ct.left<ie.left||ct.right>ie.right)}class Fe{constructor(K,ie,De,dt){this._scrollDispatcher=K,this._viewportRuler=ie,this._ngZone=De,this._config=dt,this._scrollSubscription=null}attach(K){this._overlayRef=K}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const ie=this._overlayRef.overlayElement.getBoundingClientRect(),{width:De,height:dt}=this._viewportRuler.getViewportSize();Xn(ie,[{width:De,height:dt,bottom:dt,right:De,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Qe=(()=>{class ct{constructor(ie,De,dt,ze){this._scrollDispatcher=ie,this._viewportRuler=De,this._ngZone=dt,this.noop=()=>new Pn,this.close=he=>new St(this._scrollDispatcher,this._ngZone,this._viewportRuler,he),this.block=()=>new Ut(this._viewportRuler,this._document),this.reposition=he=>new Fe(this._scrollDispatcher,this._viewportRuler,this._ngZone,he),this._document=ze}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(T.mF),W.LFG(T.rL),W.LFG(W.R0b),W.LFG(d.K0))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})();class fn{constructor(K){if(this.scrollStrategy=new Pn,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,K){const ie=Object.keys(K);for(const De of ie)void 0!==K[De]&&(this[De]=K[De])}}}class vn{constructor(K,ie){this.connectionPair=K,this.scrollableViewProperties=ie}}let Gt=(()=>{class ct{constructor(ie){this._attachedOverlays=[],this._document=ie}ngOnDestroy(){this.detach()}add(ie){this.remove(ie),this._attachedOverlays.push(ie)}remove(ie){const De=this._attachedOverlays.indexOf(ie);De>-1&&this._attachedOverlays.splice(De,1),0===this._attachedOverlays.length&&this.detach()}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(d.K0))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})(),Bt=(()=>{class ct extends Gt{constructor(ie,De){super(ie),this._ngZone=De,this._keydownListener=dt=>{const ze=this._attachedOverlays;for(let he=ze.length-1;he>-1;he--)if(ze[he]._keydownEvents.observers.length>0){const ce=ze[he]._keydownEvents;this._ngZone?this._ngZone.run(()=>ce.next(dt)):ce.next(dt);break}}}add(ie){super.add(ie),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(d.K0),W.LFG(W.R0b,8))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})(),Cn=(()=>{class ct extends Gt{constructor(ie,De,dt){super(ie),this._platform=De,this._ngZone=dt,this._cursorStyleIsSet=!1,this._pointerDownListener=ze=>{this._pointerDownEventTarget=(0,Ce.sA)(ze)},this._clickListener=ze=>{const he=(0,Ce.sA)(ze),ce="click"===ze.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:he;this._pointerDownEventTarget=null;const de=this._attachedOverlays.slice();for(let We=de.length-1;We>-1;We--){const ht=de[We];if(ht._outsidePointerEvents.observers.length<1||!ht.hasAttached())continue;if(ht.overlayElement.contains(he)||ht.overlayElement.contains(ce))break;const Qt=ht._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>Qt.next(ze)):Qt.next(ze)}}}add(ie){if(super.add(ie),!this._isAttached){const De=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(De)):this._addEventListeners(De),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=De.style.cursor,De.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const ie=this._document.body;ie.removeEventListener("pointerdown",this._pointerDownListener,!0),ie.removeEventListener("click",this._clickListener,!0),ie.removeEventListener("auxclick",this._clickListener,!0),ie.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(ie.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(ie){ie.addEventListener("pointerdown",this._pointerDownListener,!0),ie.addEventListener("click",this._clickListener,!0),ie.addEventListener("auxclick",this._clickListener,!0),ie.addEventListener("contextmenu",this._clickListener,!0)}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(d.K0),W.LFG(Ce.t4),W.LFG(W.R0b,8))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})(),mn=(()=>{class ct{constructor(ie,De){this._platform=De,this._document=ie}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const ie="cdk-overlay-container";if(this._platform.isBrowser||(0,Ce.Oy)()){const dt=this._document.querySelectorAll(`.${ie}[platform="server"], .${ie}[platform="test"]`);for(let ze=0;ze<dt.length;ze++)dt[ze].remove()}const De=this._document.createElement("div");De.classList.add(ie),(0,Ce.Oy)()?De.setAttribute("platform","test"):this._platform.isBrowser||De.setAttribute("platform","server"),this._document.body.appendChild(De),this._containerElement=De}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(d.K0),W.LFG(Ce.t4))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})();class oi{constructor(K,ie,De,dt,ze,he,ce,de,We,ht=!1){this._portalOutlet=K,this._host=ie,this._pane=De,this._config=dt,this._ngZone=ze,this._keyboardDispatcher=he,this._document=ce,this._location=de,this._outsideClickDispatcher=We,this._animationsDisabled=ht,this._backdropElement=null,this._backdropClick=new ye.x,this._attachments=new ye.x,this._detachments=new ye.x,this._locationChanges=Me.w0.EMPTY,this._backdropClickHandler=Qt=>this._backdropClick.next(Qt),this._backdropTransitionendHandler=Qt=>{this._disposeBackdrop(Qt.target)},this._keydownEvents=new ye.x,this._outsidePointerEvents=new ye.x,dt.scrollStrategy&&(this._scrollStrategy=dt.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=dt.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(K){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const ie=this._portalOutlet.attach(K);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,ft.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof ie?.onDestroy&&ie.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),ie}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const K=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),K}dispose(){const K=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,K&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(K){K!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=K,this.hasAttached()&&(K.attach(this),this.updatePosition()))}updateSize(K){this._config={...this._config,...K},this._updateElementSize()}setDirection(K){this._config={...this._config,direction:K},this._updateElementDirection()}addPanelClass(K){this._pane&&this._toggleClasses(this._pane,K,!0)}removePanelClass(K){this._pane&&this._toggleClasses(this._pane,K,!1)}getDirection(){const K=this._config.direction;return K?"string"==typeof K?K:K.value:"ltr"}updateScrollStrategy(K){K!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=K,this.hasAttached()&&(K.attach(this),K.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const K=this._pane.style;K.width=(0,c.HM)(this._config.width),K.height=(0,c.HM)(this._config.height),K.minWidth=(0,c.HM)(this._config.minWidth),K.minHeight=(0,c.HM)(this._config.minHeight),K.maxWidth=(0,c.HM)(this._config.maxWidth),K.maxHeight=(0,c.HM)(this._config.maxHeight)}_togglePointerEvents(K){this._pane.style.pointerEvents=K?"":"none"}_attachBackdrop(){const K="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(K)})}):this._backdropElement.classList.add(K)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const K=this._backdropElement;if(K){if(this._animationsDisabled)return void this._disposeBackdrop(K);K.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{K.addEventListener("transitionend",this._backdropTransitionendHandler)}),K.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(K)},500))}}_toggleClasses(K,ie,De){const dt=(0,c.Eq)(ie||[]).filter(ze=>!!ze);dt.length&&(De?K.classList.add(...dt):K.classList.remove(...dt))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const K=this._ngZone.onStable.pipe((0,Pe.R)((0,Ye.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),K.unsubscribe())})})}_disposeScrollStrategy(){const K=this._scrollStrategy;K&&(K.disable(),K.detach&&K.detach())}_disposeBackdrop(K){K&&(K.removeEventListener("click",this._backdropClickHandler),K.removeEventListener("transitionend",this._backdropTransitionendHandler),K.remove(),this._backdropElement===K&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Yn="cdk-overlay-connected-position-bounding-box",fi=/([A-Za-z%]+)$/;class On{constructor(K,ie,De,dt,ze){this._viewportRuler=ie,this._document=De,this._platform=dt,this._overlayContainer=ze,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ye.x,this._resizeSubscription=Me.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(K)}get positions(){return this._preferredPositions}attach(K){this._validatePositions(),K.hostElement.classList.add(Yn),this._overlayRef=K,this._boundingBox=K.hostElement,this._pane=K.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const K=this._originRect,ie=this._overlayRect,De=this._viewportRect,dt=this._containerRect,ze=[];let he;for(let ce of this._preferredPositions){let de=this._getOriginPoint(K,dt,ce),We=this._getOverlayPoint(de,ie,ce),ht=this._getOverlayFit(We,ie,De,ce);if(ht.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(ce,de);this._canFitWithFlexibleDimensions(ht,We,De)?ze.push({position:ce,origin:de,overlayRect:ie,boundingBoxRect:this._calculateBoundingBoxRect(de,ce)}):(!he||he.overlayFit.visibleArea<ht.visibleArea)&&(he={overlayFit:ht,overlayPoint:We,originPoint:de,position:ce,overlayRect:ie})}if(ze.length){let ce=null,de=-1;for(const We of ze){const ht=We.boundingBoxRect.width*We.boundingBoxRect.height*(We.position.weight||1);ht>de&&(de=ht,ce=We)}return this._isPushed=!1,void this._applyPosition(ce.position,ce.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(he.position,he.originPoint);this._applyPosition(he.position,he.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Di(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Yn),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const K=this._lastPosition;if(K){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const ie=this._getOriginPoint(this._originRect,this._containerRect,K);this._applyPosition(K,ie)}else this.apply()}withScrollableContainers(K){return this._scrollables=K,this}withPositions(K){return this._preferredPositions=K,-1===K.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(K){return this._viewportMargin=K,this}withFlexibleDimensions(K=!0){return this._hasFlexibleDimensions=K,this}withGrowAfterOpen(K=!0){return this._growAfterOpen=K,this}withPush(K=!0){return this._canPush=K,this}withLockedPosition(K=!0){return this._positionLocked=K,this}setOrigin(K){return this._origin=K,this}withDefaultOffsetX(K){return this._offsetX=K,this}withDefaultOffsetY(K){return this._offsetY=K,this}withTransformOriginOn(K){return this._transformOriginSelector=K,this}_getOriginPoint(K,ie,De){let dt,ze;if("center"==De.originX)dt=K.left+K.width/2;else{const he=this._isRtl()?K.right:K.left,ce=this._isRtl()?K.left:K.right;dt="start"==De.originX?he:ce}return ie.left<0&&(dt-=ie.left),ze="center"==De.originY?K.top+K.height/2:"top"==De.originY?K.top:K.bottom,ie.top<0&&(ze-=ie.top),{x:dt,y:ze}}_getOverlayPoint(K,ie,De){let dt,ze;return dt="center"==De.overlayX?-ie.width/2:"start"===De.overlayX?this._isRtl()?-ie.width:0:this._isRtl()?0:-ie.width,ze="center"==De.overlayY?-ie.height/2:"top"==De.overlayY?0:-ie.height,{x:K.x+dt,y:K.y+ze}}_getOverlayFit(K,ie,De,dt){const ze=Pi(ie);let{x:he,y:ce}=K,de=this._getOffset(dt,"x"),We=this._getOffset(dt,"y");de&&(he+=de),We&&(ce+=We);let _n=0-ce,An=ce+ze.height-De.height,ii=this._subtractOverflows(ze.width,0-he,he+ze.width-De.width),qn=this._subtractOverflows(ze.height,_n,An),gr=ii*qn;return{visibleArea:gr,isCompletelyWithinViewport:ze.width*ze.height===gr,fitsInViewportVertically:qn===ze.height,fitsInViewportHorizontally:ii==ze.width}}_canFitWithFlexibleDimensions(K,ie,De){if(this._hasFlexibleDimensions){const dt=De.bottom-ie.y,ze=De.right-ie.x,he=Ui(this._overlayRef.getConfig().minHeight),ce=Ui(this._overlayRef.getConfig().minWidth),We=K.fitsInViewportHorizontally||null!=ce&&ce<=ze;return(K.fitsInViewportVertically||null!=he&&he<=dt)&&We}return!1}_pushOverlayOnScreen(K,ie,De){if(this._previousPushAmount&&this._positionLocked)return{x:K.x+this._previousPushAmount.x,y:K.y+this._previousPushAmount.y};const dt=Pi(ie),ze=this._viewportRect,he=Math.max(K.x+dt.width-ze.width,0),ce=Math.max(K.y+dt.height-ze.height,0),de=Math.max(ze.top-De.top-K.y,0),We=Math.max(ze.left-De.left-K.x,0);let ht=0,Qt=0;return ht=dt.width<=ze.width?We||-he:K.x<this._viewportMargin?ze.left-De.left-K.x:0,Qt=dt.height<=ze.height?de||-ce:K.y<this._viewportMargin?ze.top-De.top-K.y:0,this._previousPushAmount={x:ht,y:Qt},{x:K.x+ht,y:K.y+Qt}}_applyPosition(K,ie){if(this._setTransformOrigin(K),this._setOverlayElementStyles(ie,K),this._setBoundingBoxStyles(ie,K),K.panelClass&&this._addPanelClasses(K.panelClass),this._lastPosition=K,this._positionChanges.observers.length){const De=this._getScrollVisibility(),dt=new vn(K,De);this._positionChanges.next(dt)}this._isInitialRender=!1}_setTransformOrigin(K){if(!this._transformOriginSelector)return;const ie=this._boundingBox.querySelectorAll(this._transformOriginSelector);let De,dt=K.overlayY;De="center"===K.overlayX?"center":this._isRtl()?"start"===K.overlayX?"right":"left":"start"===K.overlayX?"left":"right";for(let ze=0;ze<ie.length;ze++)ie[ze].style.transformOrigin=`${De} ${dt}`}_calculateBoundingBoxRect(K,ie){const De=this._viewportRect,dt=this._isRtl();let ze,he,ce,ht,Qt,_n;if("top"===ie.overlayY)he=K.y,ze=De.height-he+this._viewportMargin;else if("bottom"===ie.overlayY)ce=De.height-K.y+2*this._viewportMargin,ze=De.height-ce+this._viewportMargin;else{const An=Math.min(De.bottom-K.y+De.top,K.y),ii=this._lastBoundingBoxSize.height;ze=2*An,he=K.y-An,ze>ii&&!this._isInitialRender&&!this._growAfterOpen&&(he=K.y-ii/2)}if("end"===ie.overlayX&&!dt||"start"===ie.overlayX&&dt)_n=De.width-K.x+this._viewportMargin,ht=K.x-this._viewportMargin;else if("start"===ie.overlayX&&!dt||"end"===ie.overlayX&&dt)Qt=K.x,ht=De.right-K.x;else{const An=Math.min(De.right-K.x+De.left,K.x),ii=this._lastBoundingBoxSize.width;ht=2*An,Qt=K.x-An,ht>ii&&!this._isInitialRender&&!this._growAfterOpen&&(Qt=K.x-ii/2)}return{top:he,left:Qt,bottom:ce,right:_n,width:ht,height:ze}}_setBoundingBoxStyles(K,ie){const De=this._calculateBoundingBoxRect(K,ie);!this._isInitialRender&&!this._growAfterOpen&&(De.height=Math.min(De.height,this._lastBoundingBoxSize.height),De.width=Math.min(De.width,this._lastBoundingBoxSize.width));const dt={};if(this._hasExactPosition())dt.top=dt.left="0",dt.bottom=dt.right=dt.maxHeight=dt.maxWidth="",dt.width=dt.height="100%";else{const ze=this._overlayRef.getConfig().maxHeight,he=this._overlayRef.getConfig().maxWidth;dt.height=(0,c.HM)(De.height),dt.top=(0,c.HM)(De.top),dt.bottom=(0,c.HM)(De.bottom),dt.width=(0,c.HM)(De.width),dt.left=(0,c.HM)(De.left),dt.right=(0,c.HM)(De.right),dt.alignItems="center"===ie.overlayX?"center":"end"===ie.overlayX?"flex-end":"flex-start",dt.justifyContent="center"===ie.overlayY?"center":"bottom"===ie.overlayY?"flex-end":"flex-start",ze&&(dt.maxHeight=(0,c.HM)(ze)),he&&(dt.maxWidth=(0,c.HM)(he))}this._lastBoundingBoxSize=De,Di(this._boundingBox.style,dt)}_resetBoundingBoxStyles(){Di(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Di(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(K,ie){const De={},dt=this._hasExactPosition(),ze=this._hasFlexibleDimensions,he=this._overlayRef.getConfig();if(dt){const ht=this._viewportRuler.getViewportScrollPosition();Di(De,this._getExactOverlayY(ie,K,ht)),Di(De,this._getExactOverlayX(ie,K,ht))}else De.position="static";let ce="",de=this._getOffset(ie,"x"),We=this._getOffset(ie,"y");de&&(ce+=`translateX(${de}px) `),We&&(ce+=`translateY(${We}px)`),De.transform=ce.trim(),he.maxHeight&&(dt?De.maxHeight=(0,c.HM)(he.maxHeight):ze&&(De.maxHeight="")),he.maxWidth&&(dt?De.maxWidth=(0,c.HM)(he.maxWidth):ze&&(De.maxWidth="")),Di(this._pane.style,De)}_getExactOverlayY(K,ie,De){let dt={top:"",bottom:""},ze=this._getOverlayPoint(ie,this._overlayRect,K);return this._isPushed&&(ze=this._pushOverlayOnScreen(ze,this._overlayRect,De)),"bottom"===K.overlayY?dt.bottom=this._document.documentElement.clientHeight-(ze.y+this._overlayRect.height)+"px":dt.top=(0,c.HM)(ze.y),dt}_getExactOverlayX(K,ie,De){let he,dt={left:"",right:""},ze=this._getOverlayPoint(ie,this._overlayRect,K);return this._isPushed&&(ze=this._pushOverlayOnScreen(ze,this._overlayRect,De)),he=this._isRtl()?"end"===K.overlayX?"left":"right":"end"===K.overlayX?"right":"left","right"===he?dt.right=this._document.documentElement.clientWidth-(ze.x+this._overlayRect.width)+"px":dt.left=(0,c.HM)(ze.x),dt}_getScrollVisibility(){const K=this._getOriginRect(),ie=this._pane.getBoundingClientRect(),De=this._scrollables.map(dt=>dt.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Xt(K,De),isOriginOutsideView:Xn(K,De),isOverlayClipped:Xt(ie,De),isOverlayOutsideView:Xn(ie,De)}}_subtractOverflows(K,...ie){return ie.reduce((De,dt)=>De-Math.max(dt,0),K)}_getNarrowedViewportRect(){const K=this._document.documentElement.clientWidth,ie=this._document.documentElement.clientHeight,De=this._viewportRuler.getViewportScrollPosition();return{top:De.top+this._viewportMargin,left:De.left+this._viewportMargin,right:De.left+K-this._viewportMargin,bottom:De.top+ie-this._viewportMargin,width:K-2*this._viewportMargin,height:ie-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(K,ie){return"x"===ie?K.offsetX??this._offsetX:K.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(K){this._pane&&(0,c.Eq)(K).forEach(ie=>{""!==ie&&-1===this._appliedPanelClasses.indexOf(ie)&&(this._appliedPanelClasses.push(ie),this._pane.classList.add(ie))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(K=>{this._pane.classList.remove(K)}),this._appliedPanelClasses=[])}_getOriginRect(){const K=this._origin;if(K instanceof W.SBq)return K.nativeElement.getBoundingClientRect();if(K instanceof Element)return K.getBoundingClientRect();const ie=K.width||0,De=K.height||0;return{top:K.y,bottom:K.y+De,left:K.x,right:K.x+ie,height:De,width:ie}}}function Di(ct,K){for(let ie in K)K.hasOwnProperty(ie)&&(ct[ie]=K[ie]);return ct}function Ui(ct){if("number"!=typeof ct&&null!=ct){const[K,ie]=ct.split(fi);return ie&&"px"!==ie?null:parseFloat(K)}return ct||null}function Pi(ct){return{top:Math.floor(ct.top),right:Math.floor(ct.right),bottom:Math.floor(ct.bottom),left:Math.floor(ct.left),width:Math.floor(ct.width),height:Math.floor(ct.height)}}const Rt="cdk-global-overlay-wrapper";class Kt{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(K){const ie=K.getConfig();this._overlayRef=K,this._width&&!ie.width&&K.updateSize({width:this._width}),this._height&&!ie.height&&K.updateSize({height:this._height}),K.hostElement.classList.add(Rt),this._isDisposed=!1}top(K=""){return this._bottomOffset="",this._topOffset=K,this._alignItems="flex-start",this}left(K=""){return this._xOffset=K,this._xPosition="left",this}bottom(K=""){return this._topOffset="",this._bottomOffset=K,this._alignItems="flex-end",this}right(K=""){return this._xOffset=K,this._xPosition="right",this}start(K=""){return this._xOffset=K,this._xPosition="start",this}end(K=""){return this._xOffset=K,this._xPosition="end",this}width(K=""){return this._overlayRef?this._overlayRef.updateSize({width:K}):this._width=K,this}height(K=""){return this._overlayRef?this._overlayRef.updateSize({height:K}):this._height=K,this}centerHorizontally(K=""){return this.left(K),this._xPosition="center",this}centerVertically(K=""){return this.top(K),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const K=this._overlayRef.overlayElement.style,ie=this._overlayRef.hostElement.style,De=this._overlayRef.getConfig(),{width:dt,height:ze,maxWidth:he,maxHeight:ce}=De,de=!("100%"!==dt&&"100vw"!==dt||he&&"100%"!==he&&"100vw"!==he),We=!("100%"!==ze&&"100vh"!==ze||ce&&"100%"!==ce&&"100vh"!==ce),ht=this._xPosition,Qt=this._xOffset,_n="rtl"===this._overlayRef.getConfig().direction;let An="",ii="",qn="";de?qn="flex-start":"center"===ht?(qn="center",_n?ii=Qt:An=Qt):_n?"left"===ht||"end"===ht?(qn="flex-end",An=Qt):("right"===ht||"start"===ht)&&(qn="flex-start",ii=Qt):"left"===ht||"start"===ht?(qn="flex-start",An=Qt):("right"===ht||"end"===ht)&&(qn="flex-end",ii=Qt),K.position=this._cssPosition,K.marginLeft=de?"0":An,K.marginTop=We?"0":this._topOffset,K.marginBottom=this._bottomOffset,K.marginRight=de?"0":ii,ie.justifyContent=qn,ie.alignItems=We?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const K=this._overlayRef.overlayElement.style,ie=this._overlayRef.hostElement,De=ie.style;ie.classList.remove(Rt),De.justifyContent=De.alignItems=K.marginTop=K.marginBottom=K.marginLeft=K.marginRight=K.position="",this._overlayRef=null,this._isDisposed=!0}}let kn=(()=>{class ct{constructor(ie,De,dt,ze){this._viewportRuler=ie,this._document=De,this._platform=dt,this._overlayContainer=ze}global(){return new Kt}flexibleConnectedTo(ie){return new On(ie,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(T.rL),W.LFG(d.K0),W.LFG(Ce.t4),W.LFG(mn))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac,providedIn:"root"}),ct})(),zn=0,gn=(()=>{class ct{constructor(ie,De,dt,ze,he,ce,de,We,ht,Qt,_n,An){this.scrollStrategies=ie,this._overlayContainer=De,this._componentFactoryResolver=dt,this._positionBuilder=ze,this._keyboardDispatcher=he,this._injector=ce,this._ngZone=de,this._document=We,this._directionality=ht,this._location=Qt,this._outsideClickDispatcher=_n,this._animationsModuleType=An}create(ie){const De=this._createHostElement(),dt=this._createPaneElement(De),ze=this._createPortalOutlet(dt),he=new fn(ie);return he.direction=he.direction||this._directionality.value,new oi(ze,De,dt,he,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(ie){const De=this._document.createElement("div");return De.id="cdk-overlay-"+zn++,De.classList.add("cdk-overlay-pane"),ie.appendChild(De),De}_createHostElement(){const ie=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(ie),ie}_createPortalOutlet(ie){return this._appRef||(this._appRef=this._injector.get(W.z2F)),new Je.u0(ie,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.LFG(Qe),W.LFG(mn),W.LFG(W._Vd),W.LFG(kn),W.LFG(Bt),W.LFG(W.zs3),W.LFG(W.R0b),W.LFG(d.K0),W.LFG(Ve.Is),W.LFG(d.Ye),W.LFG(Cn),W.LFG(W.QbO,8))},ct.\u0275prov=W.Yz7({token:ct,factory:ct.\u0275fac}),ct})();const wi=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Ei=new W.OlP("cdk-connected-overlay-scroll-strategy");let Ii=(()=>{class ct{constructor(ie){this.elementRef=ie}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.Y36(W.SBq))},ct.\u0275dir=W.lG2({type:ct,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),ct})(),or=(()=>{class ct{constructor(ie,De,dt,ze,he){this._overlay=ie,this._dir=he,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=Me.w0.EMPTY,this._attachSubscription=Me.w0.EMPTY,this._detachSubscription=Me.w0.EMPTY,this._positionSubscription=Me.w0.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new W.vpe,this.positionChange=new W.vpe,this.attach=new W.vpe,this.detach=new W.vpe,this.overlayKeydown=new W.vpe,this.overlayOutsideClick=new W.vpe,this._templatePortal=new Je.UE(De,dt),this._scrollStrategyFactory=ze,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(ie){this._offsetX=ie,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(ie){this._offsetY=ie,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(ie){this._hasBackdrop=(0,c.Ig)(ie)}get lockPosition(){return this._lockPosition}set lockPosition(ie){this._lockPosition=(0,c.Ig)(ie)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(ie){this._flexibleDimensions=(0,c.Ig)(ie)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(ie){this._growAfterOpen=(0,c.Ig)(ie)}get push(){return this._push}set push(ie){this._push=(0,c.Ig)(ie)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(ie){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),ie.origin&&this.open&&this._position.apply()),ie.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=wi);const ie=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=ie.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=ie.detachments().subscribe(()=>this.detach.emit()),ie.keydownEvents().subscribe(De=>{this.overlayKeydown.next(De),De.keyCode===gt.hY&&!this.disableClose&&!(0,gt.Vb)(De)&&(De.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(De=>{this.overlayOutsideClick.next(De)})}_buildConfig(){const ie=this._position=this.positionStrategy||this._createPositionStrategy(),De=new fn({direction:this._dir,positionStrategy:ie,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(De.width=this.width),(this.height||0===this.height)&&(De.height=this.height),(this.minWidth||0===this.minWidth)&&(De.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(De.minHeight=this.minHeight),this.backdropClass&&(De.backdropClass=this.backdropClass),this.panelClass&&(De.panelClass=this.panelClass),De}_updatePositionStrategy(ie){const De=this.positions.map(dt=>({originX:dt.originX,originY:dt.originY,overlayX:dt.overlayX,overlayY:dt.overlayY,offsetX:dt.offsetX||this.offsetX,offsetY:dt.offsetY||this.offsetY,panelClass:dt.panelClass||void 0}));return ie.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(De).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const ie=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(ie),ie}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof Ii?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(ie=>{this.backdropClick.emit(ie)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe((0,ut.o)(()=>this.positionChange.observers.length>0)).subscribe(ie=>{this.positionChange.emit(ie),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.Y36(gn),W.Y36(W.Rgc),W.Y36(W.s_b),W.Y36(Ei),W.Y36(Ve.Is,8))},ct.\u0275dir=W.lG2({type:ct,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[W.TTD]}),ct})();const En={provide:Ei,deps:[gn],useFactory:function Oi(ct){return()=>ct.scrollStrategies.reposition()}};let Wi=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275mod=W.oAB({type:ct}),ct.\u0275inj=W.cJS({providers:[gn,En],imports:[Ve.vT,Je.eL,T.Cl,T.Cl]}),ct})()},3353:(Bn,kt,j)=>{"use strict";j.d(kt,{Mq:()=>gt,Oy:()=>Xt,_i:()=>et,i$:()=>ft,kV:()=>St,qK:()=>ye,sA:()=>Xn,t4:()=>c});var T=j(4650),d=j(6895);let W;try{W=typeof Intl<"u"&&Intl.v8BreakIterator}catch{W=!1}let Ve,c=(()=>{class Fe{constructor(fn){this._platformId=fn,this.isBrowser=this._platformId?(0,d.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!W)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return Fe.\u0275fac=function(fn){return new(fn||Fe)(T.LFG(T.Lbi))},Fe.\u0275prov=T.Yz7({token:Fe,factory:Fe.\u0275fac,providedIn:"root"}),Fe})();const Je=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function ye(){if(Ve)return Ve;if("object"!=typeof document||!document)return Ve=new Set(Je),Ve;let Fe=document.createElement("input");return Ve=new Set(Je.filter(Qe=>(Fe.setAttribute("type",Qe),Fe.type===Qe))),Ve}let Me,Pe,ut,Ut;function ft(Fe){return function Ye(){if(null==Me&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Me=!0}))}finally{Me=Me||!1}return Me}()?Fe:!!Fe.capture}function gt(){if(null==ut){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ut=!1,ut;if("scrollBehavior"in document.documentElement.style)ut=!0;else{const Fe=Element.prototype.scrollTo;ut=!!Fe&&!/\{\s*\[native code\]\s*\}/.test(Fe.toString())}}return ut}function et(){if("object"!=typeof document||!document)return 0;if(null==Pe){const Fe=document.createElement("div"),Qe=Fe.style;Fe.dir="rtl",Qe.width="1px",Qe.overflow="auto",Qe.visibility="hidden",Qe.pointerEvents="none",Qe.position="absolute";const fn=document.createElement("div"),Jt=fn.style;Jt.width="2px",Jt.height="1px",Fe.appendChild(fn),document.body.appendChild(Fe),Pe=0,0===Fe.scrollLeft&&(Fe.scrollLeft=1,Pe=0===Fe.scrollLeft?1:2),Fe.remove()}return Pe}function St(Fe){if(function Ft(){if(null==Ut){const Fe=typeof document<"u"?document.head:null;Ut=!(!Fe||!Fe.createShadowRoot&&!Fe.attachShadow)}return Ut}()){const Qe=Fe.getRootNode?Fe.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&Qe instanceof ShadowRoot)return Qe}return null}function Xn(Fe){return Fe.composedPath?Fe.composedPath()[0]:Fe.target}function Xt(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},4080:(Bn,kt,j)=>{"use strict";j.d(kt,{C5:()=>Me,UE:()=>Ye,bH:()=>Ft,eL:()=>Xn,ig:()=>Ut,u0:()=>gt});var T=j(4650);class ye{attach(Qe){return this._attachedHost=Qe,Qe.attach(this)}detach(){let Qe=this._attachedHost;null!=Qe&&(this._attachedHost=null,Qe.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(Qe){this._attachedHost=Qe}}class Me extends ye{constructor(Qe,fn,Jt,rn){super(),this.component=Qe,this.viewContainerRef=fn,this.injector=Jt,this.componentFactoryResolver=rn}}class Ye extends ye{constructor(Qe,fn,Jt,rn){super(),this.templateRef=Qe,this.viewContainerRef=fn,this.context=Jt,this.injector=rn}get origin(){return this.templateRef.elementRef}attach(Qe,fn=this.context){return this.context=fn,super.attach(Qe)}detach(){return this.context=void 0,super.detach()}}class ft extends ye{constructor(Qe){super(),this.element=Qe instanceof T.SBq?Qe.nativeElement:Qe}}class gt extends class Pe{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(Qe){return Qe instanceof Me?(this._attachedPortal=Qe,this.attachComponentPortal(Qe)):Qe instanceof Ye?(this._attachedPortal=Qe,this.attachTemplatePortal(Qe)):this.attachDomPortal&&Qe instanceof ft?(this._attachedPortal=Qe,this.attachDomPortal(Qe)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(Qe){this._disposeFn=Qe}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}{constructor(Qe,fn,Jt,rn,vn){super(),this.outletElement=Qe,this._componentFactoryResolver=fn,this._appRef=Jt,this._defaultInjector=rn,this.attachDomPortal=xt=>{const Tt=xt.element,Gt=this._document.createComment("dom-portal");Tt.parentNode.insertBefore(Gt,Tt),this.outletElement.appendChild(Tt),this._attachedPortal=xt,super.setDisposeFn(()=>{Gt.parentNode&&Gt.parentNode.replaceChild(Tt,Gt)})},this._document=vn}attachComponentPortal(Qe){const Jt=(Qe.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(Qe.component);let rn;return Qe.viewContainerRef?(rn=Qe.viewContainerRef.createComponent(Jt,Qe.viewContainerRef.length,Qe.injector||Qe.viewContainerRef.injector),this.setDisposeFn(()=>rn.destroy())):(rn=Jt.create(Qe.injector||this._defaultInjector||T.zs3.NULL),this._appRef.attachView(rn.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(rn.hostView),rn.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(rn)),this._attachedPortal=Qe,rn}attachTemplatePortal(Qe){let fn=Qe.viewContainerRef,Jt=fn.createEmbeddedView(Qe.templateRef,Qe.context,{injector:Qe.injector});return Jt.rootNodes.forEach(rn=>this.outletElement.appendChild(rn)),Jt.detectChanges(),this.setDisposeFn(()=>{let rn=fn.indexOf(Jt);-1!==rn&&fn.remove(rn)}),this._attachedPortal=Qe,Jt}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(Qe){return Qe.hostView.rootNodes[0]}}let Ut=(()=>{class Fe extends Ye{constructor(fn,Jt){super(fn,Jt)}}return Fe.\u0275fac=function(fn){return new(fn||Fe)(T.Y36(T.Rgc),T.Y36(T.s_b))},Fe.\u0275dir=T.lG2({type:Fe,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[T.qOj]}),Fe})(),Ft=(()=>{class Fe extends Ut{}return Fe.\u0275fac=function(){let Qe;return function(Jt){return(Qe||(Qe=T.n5z(Fe)))(Jt||Fe)}}(),Fe.\u0275dir=T.lG2({type:Fe,selectors:[["","cdk-portal",""],["","portal",""]],exportAs:["cdkPortal"],features:[T._Bn([{provide:Ut,useExisting:Fe}]),T.qOj]}),Fe})(),Xn=(()=>{class Fe{}return Fe.\u0275fac=function(fn){return new(fn||Fe)},Fe.\u0275mod=T.oAB({type:Fe}),Fe.\u0275inj=T.cJS({}),Fe})()},8605:(Bn,kt,j)=>{"use strict";j.d(kt,{PQ:()=>wi,ZD:()=>dt,mF:()=>gn,Cl:()=>ze,rL:()=>Ii});var T=j(1281),d=j(4650),W=j(4408),c=j(727);const Ce={schedule(he){let ce=requestAnimationFrame,de=cancelAnimationFrame;const{delegate:We}=Ce;We&&(ce=We.requestAnimationFrame,de=We.cancelAnimationFrame);const ht=ce(Qt=>{de=void 0,he(Qt)});return new c.w0(()=>de?.(ht))},requestAnimationFrame(...he){const{delegate:ce}=Ce;return(ce?.requestAnimationFrame||requestAnimationFrame)(...he)},cancelAnimationFrame(...he){const{delegate:ce}=Ce;return(ce?.cancelAnimationFrame||cancelAnimationFrame)(...he)},delegate:void 0};var Je=j(7565);new class ye extends Je.v{flush(ce){this._active=!0;const de=this._scheduled;this._scheduled=void 0;const{actions:We}=this;let ht;ce=ce||We.shift();do{if(ht=ce.execute(ce.state,ce.delay))break}while((ce=We[0])&&ce.id===de&&We.shift());if(this._active=!1,ht){for(;(ce=We[0])&&ce.id===de&&We.shift();)ce.unsubscribe();throw ht}}}(class Ve extends W.o{constructor(ce,de){super(ce,de),this.scheduler=ce,this.work=de}requestAsyncId(ce,de,We=0){return null!==We&&We>0?super.requestAsyncId(ce,de,We):(ce.actions.push(this),ce._scheduled||(ce._scheduled=Ce.requestAnimationFrame(()=>ce.flush(void 0))))}recycleAsyncId(ce,de,We=0){if(null!=We&&We>0||null==We&&this.delay>0)return super.recycleAsyncId(ce,de,We);ce.actions.some(ht=>ht.id===de)||(Ce.cancelAnimationFrame(de),ce._scheduled=void 0)}});let Pe,ft=1;const ut={};function gt(he){return he in ut&&(delete ut[he],!0)}const et={setImmediate(he){const ce=ft++;return ut[ce]=!0,Pe||(Pe=Promise.resolve()),Pe.then(()=>gt(ce)&&he()),ce},clearImmediate(he){gt(he)}},{setImmediate:Ft,clearImmediate:St}=et,Pn={setImmediate(...he){const{delegate:ce}=Pn;return(ce?.setImmediate||Ft)(...he)},clearImmediate(he){const{delegate:ce}=Pn;return(ce?.clearImmediate||St)(he)},delegate:void 0};new class Xt extends Je.v{flush(ce){this._active=!0;const de=this._scheduled;this._scheduled=void 0;const{actions:We}=this;let ht;ce=ce||We.shift();do{if(ht=ce.execute(ce.state,ce.delay))break}while((ce=We[0])&&ce.id===de&&We.shift());if(this._active=!1,ht){for(;(ce=We[0])&&ce.id===de&&We.shift();)ce.unsubscribe();throw ht}}}(class Xn extends W.o{constructor(ce,de){super(ce,de),this.scheduler=ce,this.work=de}requestAsyncId(ce,de,We=0){return null!==We&&We>0?super.requestAsyncId(ce,de,We):(ce.actions.push(this),ce._scheduled||(ce._scheduled=Pn.setImmediate(ce.flush.bind(ce,void 0))))}recycleAsyncId(ce,de,We=0){if(null!=We&&We>0||null==We&&this.delay>0)return super.recycleAsyncId(ce,de,We);ce.actions.some(ht=>ht.id===de)||(Pn.clearImmediate(de),ce._scheduled=void 0)}});var fn=j(7579),Jt=j(9646),rn=j(9751),vn=j(4968),xt=j(4986),Tt=j(4482),Gt=j(8421),Bt=j(5403),mn=j(5963);function oi(he,ce=xt.z){return function Cn(he){return(0,Tt.e)((ce,de)=>{let We=!1,ht=null,Qt=null,_n=!1;const An=()=>{if(Qt?.unsubscribe(),Qt=null,We){We=!1;const qn=ht;ht=null,de.next(qn)}_n&&de.complete()},ii=()=>{Qt=null,_n&&de.complete()};ce.subscribe((0,Bt.x)(de,qn=>{We=!0,ht=qn,Qt||(0,Gt.Xf)(he(qn)).subscribe(Qt=(0,Bt.x)(de,An,ii))},()=>{_n=!0,(!We||!Qt||Qt.closed)&&de.complete()}))})}(()=>(0,mn.H)(he,ce))}var Yn=j(9300),fi=j(2722),On=j(3353),Di=j(6895),Ui=j(445);let gn=(()=>{class he{constructor(de,We,ht){this._ngZone=de,this._platform=We,this._scrolled=new fn.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=ht}register(de){this.scrollContainers.has(de)||this.scrollContainers.set(de,de.elementScrolled().subscribe(()=>this._scrolled.next(de)))}deregister(de){const We=this.scrollContainers.get(de);We&&(We.unsubscribe(),this.scrollContainers.delete(de))}scrolled(de=20){return this._platform.isBrowser?new rn.y(We=>{this._globalSubscription||this._addGlobalListener();const ht=de>0?this._scrolled.pipe(oi(de)).subscribe(We):this._scrolled.subscribe(We);return this._scrolledCount++,()=>{ht.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,Jt.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((de,We)=>this.deregister(We)),this._scrolled.complete()}ancestorScrolled(de,We){const ht=this.getAncestorScrollContainers(de);return this.scrolled(We).pipe((0,Yn.h)(Qt=>!Qt||ht.indexOf(Qt)>-1))}getAncestorScrollContainers(de){const We=[];return this.scrollContainers.forEach((ht,Qt)=>{this._scrollableContainsElement(Qt,de)&&We.push(Qt)}),We}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(de,We){let ht=(0,T.fI)(We),Qt=de.getElementRef().nativeElement;do{if(ht==Qt)return!0}while(ht=ht.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const de=this._getWindow();return(0,vn.R)(de.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return he.\u0275fac=function(de){return new(de||he)(d.LFG(d.R0b),d.LFG(On.t4),d.LFG(Di.K0,8))},he.\u0275prov=d.Yz7({token:he,factory:he.\u0275fac,providedIn:"root"}),he})(),wi=(()=>{class he{constructor(de,We,ht,Qt){this.elementRef=de,this.scrollDispatcher=We,this.ngZone=ht,this.dir=Qt,this._destroyed=new fn.x,this._elementScrolled=new rn.y(_n=>this.ngZone.runOutsideAngular(()=>(0,vn.R)(this.elementRef.nativeElement,"scroll").pipe((0,fi.R)(this._destroyed)).subscribe(_n)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(de){const We=this.elementRef.nativeElement,ht=this.dir&&"rtl"==this.dir.value;null==de.left&&(de.left=ht?de.end:de.start),null==de.right&&(de.right=ht?de.start:de.end),null!=de.bottom&&(de.top=We.scrollHeight-We.clientHeight-de.bottom),ht&&0!=(0,On._i)()?(null!=de.left&&(de.right=We.scrollWidth-We.clientWidth-de.left),2==(0,On._i)()?de.left=de.right:1==(0,On._i)()&&(de.left=de.right?-de.right:de.right)):null!=de.right&&(de.left=We.scrollWidth-We.clientWidth-de.right),this._applyScrollToOptions(de)}_applyScrollToOptions(de){const We=this.elementRef.nativeElement;(0,On.Mq)()?We.scrollTo(de):(null!=de.top&&(We.scrollTop=de.top),null!=de.left&&(We.scrollLeft=de.left))}measureScrollOffset(de){const We="left",Qt=this.elementRef.nativeElement;if("top"==de)return Qt.scrollTop;if("bottom"==de)return Qt.scrollHeight-Qt.clientHeight-Qt.scrollTop;const _n=this.dir&&"rtl"==this.dir.value;return"start"==de?de=_n?"right":We:"end"==de&&(de=_n?We:"right"),_n&&2==(0,On._i)()?de==We?Qt.scrollWidth-Qt.clientWidth-Qt.scrollLeft:Qt.scrollLeft:_n&&1==(0,On._i)()?de==We?Qt.scrollLeft+Qt.scrollWidth-Qt.clientWidth:-Qt.scrollLeft:de==We?Qt.scrollLeft:Qt.scrollWidth-Qt.clientWidth-Qt.scrollLeft}}return he.\u0275fac=function(de){return new(de||he)(d.Y36(d.SBq),d.Y36(gn),d.Y36(d.R0b),d.Y36(Ui.Is,8))},he.\u0275dir=d.lG2({type:he,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),he})(),Ii=(()=>{class he{constructor(de,We,ht){this._platform=de,this._change=new fn.x,this._changeListener=Qt=>{this._change.next(Qt)},this._document=ht,We.runOutsideAngular(()=>{if(de.isBrowser){const Qt=this._getWindow();Qt.addEventListener("resize",this._changeListener),Qt.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const de=this._getWindow();de.removeEventListener("resize",this._changeListener),de.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const de={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),de}getViewportRect(){const de=this.getViewportScrollPosition(),{width:We,height:ht}=this.getViewportSize();return{top:de.top,left:de.left,bottom:de.top+ht,right:de.left+We,height:ht,width:We}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const de=this._document,We=this._getWindow(),ht=de.documentElement,Qt=ht.getBoundingClientRect();return{top:-Qt.top||de.body.scrollTop||We.scrollY||ht.scrollTop||0,left:-Qt.left||de.body.scrollLeft||We.scrollX||ht.scrollLeft||0}}change(de=20){return de>0?this._change.pipe(oi(de)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const de=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:de.innerWidth,height:de.innerHeight}:{width:0,height:0}}}return he.\u0275fac=function(de){return new(de||he)(d.LFG(On.t4),d.LFG(d.R0b),d.LFG(Di.K0,8))},he.\u0275prov=d.Yz7({token:he,factory:he.\u0275fac,providedIn:"root"}),he})(),dt=(()=>{class he{}return he.\u0275fac=function(de){return new(de||he)},he.\u0275mod=d.oAB({type:he}),he.\u0275inj=d.cJS({}),he})(),ze=(()=>{class he{}return he.\u0275fac=function(de){return new(de||he)},he.\u0275mod=d.oAB({type:he}),he.\u0275inj=d.cJS({imports:[Ui.vT,dt,Ui.vT,dt]}),he})()},6895:(Bn,kt,j)=>{"use strict";j.d(kt,{Do:()=>Xn,ED:()=>Ko,EM:()=>Ws,HT:()=>Ce,JF:()=>Li,K0:()=>Je,Mx:()=>ri,NF:()=>Zs,O5:()=>Xi,Ov:()=>sa,PC:()=>ra,RF:()=>ys,S$:()=>Ft,V_:()=>Ye,Ye:()=>Xt,b0:()=>Pn,bD:()=>ca,ez:()=>La,mk:()=>ki,n9:()=>Vs,q:()=>W,sg:()=>Go,tP:()=>lo,w_:()=>Ve});var T=j(4650);let d=null;function W(){return d}function Ce(X){d||(d=X)}class Ve{}const Je=new T.OlP("DocumentToken");let ye=(()=>{class X{historyGo(J){throw new Error("Not implemented")}}return X.\u0275fac=function(J){return new(J||X)},X.\u0275prov=T.Yz7({token:X,factory:function(){return function Me(){return(0,T.LFG)(ft)}()},providedIn:"platform"}),X})();const Ye=new T.OlP("Location Initialized");let ft=(()=>{class X extends ye{constructor(J){super(),this._doc=J,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return W().getBaseHref(this._doc)}onPopState(J){const Ae=W().getGlobalEventTarget(this._doc,"window");return Ae.addEventListener("popstate",J,!1),()=>Ae.removeEventListener("popstate",J)}onHashChange(J){const Ae=W().getGlobalEventTarget(this._doc,"window");return Ae.addEventListener("hashchange",J,!1),()=>Ae.removeEventListener("hashchange",J)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(J){this.location.pathname=J}pushState(J,Ae,vt){Pe()?this._history.pushState(J,Ae,vt):this.location.hash=vt}replaceState(J,Ae,vt){Pe()?this._history.replaceState(J,Ae,vt):this.location.hash=vt}forward(){this._history.forward()}back(){this._history.back()}historyGo(J=0){this._history.go(J)}getState(){return this._history.state}}return X.\u0275fac=function(J){return new(J||X)(T.LFG(Je))},X.\u0275prov=T.Yz7({token:X,factory:function(){return function ut(){return new ft((0,T.LFG)(Je))}()},providedIn:"platform"}),X})();function Pe(){return!!window.history.pushState}function gt(X,be){if(0==X.length)return be;if(0==be.length)return X;let J=0;return X.endsWith("/")&&J++,be.startsWith("/")&&J++,2==J?X+be.substring(1):1==J?X+be:X+"/"+be}function et(X){const be=X.match(/#|\?|$/),J=be&&be.index||X.length;return X.slice(0,J-("/"===X[J-1]?1:0))+X.slice(J)}function Ut(X){return X&&"?"!==X[0]?"?"+X:X}let Ft=(()=>{class X{historyGo(J){throw new Error("Not implemented")}}return X.\u0275fac=function(J){return new(J||X)},X.\u0275prov=T.Yz7({token:X,factory:function(){return(0,T.f3M)(Pn)},providedIn:"root"}),X})();const St=new T.OlP("appBaseHref");let Pn=(()=>{class X extends Ft{constructor(J,Ae){super(),this._platformLocation=J,this._removeListenerFns=[],this._baseHref=Ae??this._platformLocation.getBaseHrefFromDOM()??(0,T.f3M)(Je).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(J){this._removeListenerFns.push(this._platformLocation.onPopState(J),this._platformLocation.onHashChange(J))}getBaseHref(){return this._baseHref}prepareExternalUrl(J){return gt(this._baseHref,J)}path(J=!1){const Ae=this._platformLocation.pathname+Ut(this._platformLocation.search),vt=this._platformLocation.hash;return vt&&J?`${Ae}${vt}`:Ae}pushState(J,Ae,vt,sn){const xn=this.prepareExternalUrl(vt+Ut(sn));this._platformLocation.pushState(J,Ae,xn)}replaceState(J,Ae,vt,sn){const xn=this.prepareExternalUrl(vt+Ut(sn));this._platformLocation.replaceState(J,Ae,xn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(J=0){this._platformLocation.historyGo?.(J)}}return X.\u0275fac=function(J){return new(J||X)(T.LFG(ye),T.LFG(St,8))},X.\u0275prov=T.Yz7({token:X,factory:X.\u0275fac,providedIn:"root"}),X})(),Xn=(()=>{class X extends Ft{constructor(J,Ae){super(),this._platformLocation=J,this._baseHref="",this._removeListenerFns=[],null!=Ae&&(this._baseHref=Ae)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(J){this._removeListenerFns.push(this._platformLocation.onPopState(J),this._platformLocation.onHashChange(J))}getBaseHref(){return this._baseHref}path(J=!1){let Ae=this._platformLocation.hash;return null==Ae&&(Ae="#"),Ae.length>0?Ae.substring(1):Ae}prepareExternalUrl(J){const Ae=gt(this._baseHref,J);return Ae.length>0?"#"+Ae:Ae}pushState(J,Ae,vt,sn){let xn=this.prepareExternalUrl(vt+Ut(sn));0==xn.length&&(xn=this._platformLocation.pathname),this._platformLocation.pushState(J,Ae,xn)}replaceState(J,Ae,vt,sn){let xn=this.prepareExternalUrl(vt+Ut(sn));0==xn.length&&(xn=this._platformLocation.pathname),this._platformLocation.replaceState(J,Ae,xn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(J=0){this._platformLocation.historyGo?.(J)}}return X.\u0275fac=function(J){return new(J||X)(T.LFG(ye),T.LFG(St,8))},X.\u0275prov=T.Yz7({token:X,factory:X.\u0275fac}),X})(),Xt=(()=>{class X{constructor(J){this._subject=new T.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=J;const Ae=this._locationStrategy.getBaseHref();this._baseHref=et(fn(Ae)),this._locationStrategy.onPopState(vt=>{this._subject.emit({url:this.path(!0),pop:!0,state:vt.state,type:vt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(J=!1){return this.normalize(this._locationStrategy.path(J))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(J,Ae=""){return this.path()==this.normalize(J+Ut(Ae))}normalize(J){return X.stripTrailingSlash(function Qe(X,be){return X&&be.startsWith(X)?be.substring(X.length):be}(this._baseHref,fn(J)))}prepareExternalUrl(J){return J&&"/"!==J[0]&&(J="/"+J),this._locationStrategy.prepareExternalUrl(J)}go(J,Ae="",vt=null){this._locationStrategy.pushState(vt,"",J,Ae),this._notifyUrlChangeListeners(this.prepareExternalUrl(J+Ut(Ae)),vt)}replaceState(J,Ae="",vt=null){this._locationStrategy.replaceState(vt,"",J,Ae),this._notifyUrlChangeListeners(this.prepareExternalUrl(J+Ut(Ae)),vt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(J=0){this._locationStrategy.historyGo?.(J)}onUrlChange(J){return this._urlChangeListeners.push(J),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Ae=>{this._notifyUrlChangeListeners(Ae.url,Ae.state)})),()=>{const Ae=this._urlChangeListeners.indexOf(J);this._urlChangeListeners.splice(Ae,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(J="",Ae){this._urlChangeListeners.forEach(vt=>vt(J,Ae))}subscribe(J,Ae,vt){return this._subject.subscribe({next:J,error:Ae,complete:vt})}}return X.normalizeQueryParams=Ut,X.joinWithSlash=gt,X.stripTrailingSlash=et,X.\u0275fac=function(J){return new(J||X)(T.LFG(Ft))},X.\u0275prov=T.Yz7({token:X,factory:function(){return function Fe(){return new Xt((0,T.LFG)(Ft))}()},providedIn:"root"}),X})();function fn(X){return X.replace(/\/index.html$/,"")}function ri(X,be){be=encodeURIComponent(be);for(const J of X.split(";")){const Ae=J.indexOf("="),[vt,sn]=-1==Ae?[J,""]:[J.slice(0,Ae),J.slice(Ae+1)];if(vt.trim()===be)return decodeURIComponent(sn)}return null}let ki=(()=>{class X{constructor(J,Ae,vt,sn){this._iterableDiffers=J,this._keyValueDiffers=Ae,this._ngEl=vt,this._renderer=sn,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(J){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof J?J.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(J){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof J?J.split(/\s+/):J,this._rawClass&&((0,T.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const J=this._iterableDiffer.diff(this._rawClass);J&&this._applyIterableChanges(J)}else if(this._keyValueDiffer){const J=this._keyValueDiffer.diff(this._rawClass);J&&this._applyKeyValueChanges(J)}}_applyKeyValueChanges(J){J.forEachAddedItem(Ae=>this._toggleClass(Ae.key,Ae.currentValue)),J.forEachChangedItem(Ae=>this._toggleClass(Ae.key,Ae.currentValue)),J.forEachRemovedItem(Ae=>{Ae.previousValue&&this._toggleClass(Ae.key,!1)})}_applyIterableChanges(J){J.forEachAddedItem(Ae=>{if("string"!=typeof Ae.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,T.AaK)(Ae.item)}`);this._toggleClass(Ae.item,!0)}),J.forEachRemovedItem(Ae=>this._toggleClass(Ae.item,!1))}_applyClasses(J){J&&(Array.isArray(J)||J instanceof Set?J.forEach(Ae=>this._toggleClass(Ae,!0)):Object.keys(J).forEach(Ae=>this._toggleClass(Ae,!!J[Ae])))}_removeClasses(J){J&&(Array.isArray(J)||J instanceof Set?J.forEach(Ae=>this._toggleClass(Ae,!1)):Object.keys(J).forEach(Ae=>this._toggleClass(Ae,!1)))}_toggleClass(J,Ae){(J=J.trim())&&J.split(/\s+/g).forEach(vt=>{Ae?this._renderer.addClass(this._ngEl.nativeElement,vt):this._renderer.removeClass(this._ngEl.nativeElement,vt)})}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.ZZ4),T.Y36(T.aQg),T.Y36(T.SBq),T.Y36(T.Qsj))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),X})();class so{constructor(be,J,Ae,vt){this.$implicit=be,this.ngForOf=J,this.index=Ae,this.count=vt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Go=(()=>{class X{constructor(J,Ae,vt){this._viewContainer=J,this._template=Ae,this._differs=vt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(J){this._ngForOf=J,this._ngForOfDirty=!0}set ngForTrackBy(J){this._trackByFn=J}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(J){J&&(this._template=J)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const J=this._ngForOf;!this._differ&&J&&(this._differ=this._differs.find(J).create(this.ngForTrackBy))}if(this._differ){const J=this._differ.diff(this._ngForOf);J&&this._applyChanges(J)}}_applyChanges(J){const Ae=this._viewContainer;J.forEachOperation((vt,sn,xn)=>{if(null==vt.previousIndex)Ae.createEmbeddedView(this._template,new so(vt.item,this._ngForOf,-1,-1),null===xn?void 0:xn);else if(null==xn)Ae.remove(null===sn?void 0:sn);else if(null!==sn){const nn=Ae.get(sn);Ae.move(nn,xn),zr(nn,vt)}});for(let vt=0,sn=Ae.length;vt<sn;vt++){const nn=Ae.get(vt).context;nn.index=vt,nn.count=sn,nn.ngForOf=this._ngForOf}J.forEachIdentityChange(vt=>{zr(Ae.get(vt.currentIndex),vt)})}static ngTemplateContextGuard(J,Ae){return!0}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(T.ZZ4))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),X})();function zr(X,be){X.context.$implicit=be.item}let Xi=(()=>{class X{constructor(J,Ae){this._viewContainer=J,this._context=new Gr,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Ae}set ngIf(J){this._context.$implicit=this._context.ngIf=J,this._updateView()}set ngIfThen(J){ao("ngIfThen",J),this._thenTemplateRef=J,this._thenViewRef=null,this._updateView()}set ngIfElse(J){ao("ngIfElse",J),this._elseTemplateRef=J,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(J,Ae){return!0}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.s_b),T.Y36(T.Rgc))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),X})();class Gr{constructor(){this.$implicit=null,this.ngIf=null}}function ao(X,be){if(be&&!be.createEmbeddedView)throw new Error(`${X} must be a TemplateRef, but received '${(0,T.AaK)(be)}'.`)}class xa{constructor(be,J){this._viewContainerRef=be,this._templateRef=J,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(be){be&&!this._created?this.create():!be&&this._created&&this.destroy()}}let ys=(()=>{class X{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(J){this._ngSwitch=J,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(J){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(J)}_matchCase(J){const Ae=J==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||Ae,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),Ae}_updateDefaultCases(J){if(this._defaultViews&&J!==this._defaultUsed){this._defaultUsed=J;for(let Ae=0;Ae<this._defaultViews.length;Ae++)this._defaultViews[Ae].enforceState(J)}}}return X.\u0275fac=function(J){return new(J||X)},X.\u0275dir=T.lG2({type:X,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),X})(),Vs=(()=>{class X{constructor(J,Ae,vt){this.ngSwitch=vt,vt._addCase(),this._view=new xa(J,Ae)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(ys,9))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),X})(),Ko=(()=>{class X{constructor(J,Ae,vt){vt._addDefault(new xa(J,Ae))}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(ys,9))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngSwitchDefault",""]],standalone:!0}),X})(),ra=(()=>{class X{constructor(J,Ae,vt){this._ngEl=J,this._differs=Ae,this._renderer=vt,this._ngStyle=null,this._differ=null}set ngStyle(J){this._ngStyle=J,!this._differ&&J&&(this._differ=this._differs.find(J).create())}ngDoCheck(){if(this._differ){const J=this._differ.diff(this._ngStyle);J&&this._applyChanges(J)}}_setStyle(J,Ae){const[vt,sn]=J.split("."),xn=-1===vt.indexOf("-")?void 0:T.JOm.DashCase;null!=Ae?this._renderer.setStyle(this._ngEl.nativeElement,vt,sn?`${Ae}${sn}`:Ae,xn):this._renderer.removeStyle(this._ngEl.nativeElement,vt,xn)}_applyChanges(J){J.forEachRemovedItem(Ae=>this._setStyle(Ae.key,null)),J.forEachAddedItem(Ae=>this._setStyle(Ae.key,Ae.currentValue)),J.forEachChangedItem(Ae=>this._setStyle(Ae.key,Ae.currentValue))}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.SBq),T.Y36(T.aQg),T.Y36(T.Qsj))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),X})(),lo=(()=>{class X{constructor(J){this._viewContainerRef=J,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(J){if(J.ngTemplateOutlet||J.ngTemplateOutletInjector){const Ae=this._viewContainerRef;if(this._viewRef&&Ae.remove(Ae.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:vt,ngTemplateOutletContext:sn,ngTemplateOutletInjector:xn}=this;this._viewRef=Ae.createEmbeddedView(vt,sn,xn?{injector:xn}:void 0)}else this._viewRef=null}else this._viewRef&&J.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.s_b))},X.\u0275dir=T.lG2({type:X,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[T.TTD]}),X})();class el{createSubscription(be,J){return be.subscribe({next:J,error:Ae=>{throw Ae}})}dispose(be){be.unsubscribe()}}class Wr{createSubscription(be,J){return be.then(J,Ae=>{throw Ae})}dispose(be){}}const oa=new Wr,Oa=new el;let sa=(()=>{class X{constructor(J){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=J}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(J){return this._obj?J!==this._obj?(this._dispose(),this.transform(J)):this._latestValue:(J&&this._subscribe(J),this._latestValue)}_subscribe(J){this._obj=J,this._strategy=this._selectStrategy(J),this._subscription=this._strategy.createSubscription(J,Ae=>this._updateLatestValue(J,Ae))}_selectStrategy(J){if((0,T.QGY)(J))return oa;if((0,T.F4k)(J))return Oa;throw function Ho(X,be){return new T.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(J,Ae){J===this._obj&&(this._latestValue=Ae,this._ref.markForCheck())}}return X.\u0275fac=function(J){return new(J||X)(T.Y36(T.sBO,16))},X.\u0275pipe=T.Yjl({name:"async",type:X,pure:!1,standalone:!0}),X})(),La=(()=>{class X{}return X.\u0275fac=function(J){return new(J||X)},X.\u0275mod=T.oAB({type:X}),X.\u0275inj=T.cJS({}),X})();const ca="browser";function Zs(X){return X===ca}let Ws=(()=>{class X{}return X.\u0275prov=(0,T.Yz7)({token:X,providedIn:"root",factory:()=>new ua((0,T.LFG)(Je),window)}),X})();class ua{constructor(be,J){this.document=be,this.window=J,this.offset=()=>[0,0]}setOffset(be){this.offset=Array.isArray(be)?()=>be:be}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(be){this.supportsScrolling()&&this.window.scrollTo(be[0],be[1])}scrollToAnchor(be){if(!this.supportsScrolling())return;const J=function Co(X,be){const J=X.getElementById(be)||X.getElementsByName(be)[0];if(J)return J;if("function"==typeof X.createTreeWalker&&X.body&&(X.body.createShadowRoot||X.body.attachShadow)){const Ae=X.createTreeWalker(X.body,NodeFilter.SHOW_ELEMENT);let vt=Ae.currentNode;for(;vt;){const sn=vt.shadowRoot;if(sn){const xn=sn.getElementById(be)||sn.querySelector(`[name="${be}"]`);if(xn)return xn}vt=Ae.nextNode()}}return null}(this.document,be);J&&(this.scrollToElement(J),J.focus())}setHistoryScrollRestoration(be){if(this.supportScrollRestoration()){const J=this.window.history;J&&J.scrollRestoration&&(J.scrollRestoration=be)}}scrollToElement(be){const J=be.getBoundingClientRect(),Ae=J.left+this.window.pageXOffset,vt=J.top+this.window.pageYOffset,sn=this.offset();this.window.scrollTo(Ae-sn[0],vt-sn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const be=vo(this.window.history)||vo(Object.getPrototypeOf(this.window.history));return!(!be||!be.writable&&!be.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function vo(X){return Object.getOwnPropertyDescriptor(X,"scrollRestoration")}class Li{}},529:(Bn,kt,j)=>{"use strict";j.d(kt,{JF:()=>ie,eN:()=>mn});var T=j(6895),d=j(4650),W=j(9646),c=j(9751),Ce=j(4351),Ve=j(9300),Je=j(4004);class ye{}class Me{}class Ye{constructor(he){this.normalizedNames=new Map,this.lazyUpdate=null,he?this.lazyInit="string"==typeof he?()=>{this.headers=new Map,he.split("\n").forEach(ce=>{const de=ce.indexOf(":");if(de>0){const We=ce.slice(0,de),ht=We.toLowerCase(),Qt=ce.slice(de+1).trim();this.maybeSetNormalizedName(We,ht),this.headers.has(ht)?this.headers.get(ht).push(Qt):this.headers.set(ht,[Qt])}})}:()=>{this.headers=new Map,Object.keys(he).forEach(ce=>{let de=he[ce];const We=ce.toLowerCase();"string"==typeof de&&(de=[de]),de.length>0&&(this.headers.set(We,de),this.maybeSetNormalizedName(ce,We))})}:this.headers=new Map}has(he){return this.init(),this.headers.has(he.toLowerCase())}get(he){this.init();const ce=this.headers.get(he.toLowerCase());return ce&&ce.length>0?ce[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(he){return this.init(),this.headers.get(he.toLowerCase())||null}append(he,ce){return this.clone({name:he,value:ce,op:"a"})}set(he,ce){return this.clone({name:he,value:ce,op:"s"})}delete(he,ce){return this.clone({name:he,value:ce,op:"d"})}maybeSetNormalizedName(he,ce){this.normalizedNames.has(ce)||this.normalizedNames.set(ce,he)}init(){this.lazyInit&&(this.lazyInit instanceof Ye?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(he=>this.applyUpdate(he)),this.lazyUpdate=null))}copyFrom(he){he.init(),Array.from(he.headers.keys()).forEach(ce=>{this.headers.set(ce,he.headers.get(ce)),this.normalizedNames.set(ce,he.normalizedNames.get(ce))})}clone(he){const ce=new Ye;return ce.lazyInit=this.lazyInit&&this.lazyInit instanceof Ye?this.lazyInit:this,ce.lazyUpdate=(this.lazyUpdate||[]).concat([he]),ce}applyUpdate(he){const ce=he.name.toLowerCase();switch(he.op){case"a":case"s":let de=he.value;if("string"==typeof de&&(de=[de]),0===de.length)return;this.maybeSetNormalizedName(he.name,ce);const We=("a"===he.op?this.headers.get(ce):void 0)||[];We.push(...de),this.headers.set(ce,We);break;case"d":const ht=he.value;if(ht){let Qt=this.headers.get(ce);if(!Qt)return;Qt=Qt.filter(_n=>-1===ht.indexOf(_n)),0===Qt.length?(this.headers.delete(ce),this.normalizedNames.delete(ce)):this.headers.set(ce,Qt)}else this.headers.delete(ce),this.normalizedNames.delete(ce)}}forEach(he){this.init(),Array.from(this.normalizedNames.keys()).forEach(ce=>he(this.normalizedNames.get(ce),this.headers.get(ce)))}}class Pe{encodeKey(he){return Ut(he)}encodeValue(he){return Ut(he)}decodeKey(he){return decodeURIComponent(he)}decodeValue(he){return decodeURIComponent(he)}}const gt=/%(\d[a-f0-9])/gi,et={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ut(ze){return encodeURIComponent(ze).replace(gt,(he,ce)=>et[ce]??he)}function Ft(ze){return`${ze}`}class St{constructor(he={}){if(this.updates=null,this.cloneFrom=null,this.encoder=he.encoder||new Pe,he.fromString){if(he.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ut(ze,he){const ce=new Map;return ze.length>0&&ze.replace(/^\?/,"").split("&").forEach(We=>{const ht=We.indexOf("="),[Qt,_n]=-1==ht?[he.decodeKey(We),""]:[he.decodeKey(We.slice(0,ht)),he.decodeValue(We.slice(ht+1))],An=ce.get(Qt)||[];An.push(_n),ce.set(Qt,An)}),ce}(he.fromString,this.encoder)}else he.fromObject?(this.map=new Map,Object.keys(he.fromObject).forEach(ce=>{const de=he.fromObject[ce],We=Array.isArray(de)?de.map(Ft):[Ft(de)];this.map.set(ce,We)})):this.map=null}has(he){return this.init(),this.map.has(he)}get(he){this.init();const ce=this.map.get(he);return ce?ce[0]:null}getAll(he){return this.init(),this.map.get(he)||null}keys(){return this.init(),Array.from(this.map.keys())}append(he,ce){return this.clone({param:he,value:ce,op:"a"})}appendAll(he){const ce=[];return Object.keys(he).forEach(de=>{const We=he[de];Array.isArray(We)?We.forEach(ht=>{ce.push({param:de,value:ht,op:"a"})}):ce.push({param:de,value:We,op:"a"})}),this.clone(ce)}set(he,ce){return this.clone({param:he,value:ce,op:"s"})}delete(he,ce){return this.clone({param:he,value:ce,op:"d"})}toString(){return this.init(),this.keys().map(he=>{const ce=this.encoder.encodeKey(he);return this.map.get(he).map(de=>ce+"="+this.encoder.encodeValue(de)).join("&")}).filter(he=>""!==he).join("&")}clone(he){const ce=new St({encoder:this.encoder});return ce.cloneFrom=this.cloneFrom||this,ce.updates=(this.updates||[]).concat(he),ce}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(he=>this.map.set(he,this.cloneFrom.map.get(he))),this.updates.forEach(he=>{switch(he.op){case"a":case"s":const ce=("a"===he.op?this.map.get(he.param):void 0)||[];ce.push(Ft(he.value)),this.map.set(he.param,ce);break;case"d":if(void 0===he.value){this.map.delete(he.param);break}{let de=this.map.get(he.param)||[];const We=de.indexOf(Ft(he.value));-1!==We&&de.splice(We,1),de.length>0?this.map.set(he.param,de):this.map.delete(he.param)}}}),this.cloneFrom=this.updates=null)}}class Xn{constructor(){this.map=new Map}set(he,ce){return this.map.set(he,ce),this}get(he){return this.map.has(he)||this.map.set(he,he.defaultValue()),this.map.get(he)}delete(he){return this.map.delete(he),this}has(he){return this.map.has(he)}keys(){return this.map.keys()}}function Fe(ze){return typeof ArrayBuffer<"u"&&ze instanceof ArrayBuffer}function Qe(ze){return typeof Blob<"u"&&ze instanceof Blob}function fn(ze){return typeof FormData<"u"&&ze instanceof FormData}class rn{constructor(he,ce,de,We){let ht;if(this.url=ce,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=he.toUpperCase(),function Xt(ze){switch(ze){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||We?(this.body=void 0!==de?de:null,ht=We):ht=de,ht&&(this.reportProgress=!!ht.reportProgress,this.withCredentials=!!ht.withCredentials,ht.responseType&&(this.responseType=ht.responseType),ht.headers&&(this.headers=ht.headers),ht.context&&(this.context=ht.context),ht.params&&(this.params=ht.params)),this.headers||(this.headers=new Ye),this.context||(this.context=new Xn),this.params){const Qt=this.params.toString();if(0===Qt.length)this.urlWithParams=ce;else{const _n=ce.indexOf("?");this.urlWithParams=ce+(-1===_n?"?":_n<ce.length-1?"&":"")+Qt}}else this.params=new St,this.urlWithParams=ce}serializeBody(){return null===this.body?null:Fe(this.body)||Qe(this.body)||fn(this.body)||function Jt(ze){return typeof URLSearchParams<"u"&&ze instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof St?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||fn(this.body)?null:Qe(this.body)?this.body.type||null:Fe(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof St?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(he={}){const ce=he.method||this.method,de=he.url||this.url,We=he.responseType||this.responseType,ht=void 0!==he.body?he.body:this.body,Qt=void 0!==he.withCredentials?he.withCredentials:this.withCredentials,_n=void 0!==he.reportProgress?he.reportProgress:this.reportProgress;let An=he.headers||this.headers,ii=he.params||this.params;const qn=he.context??this.context;return void 0!==he.setHeaders&&(An=Object.keys(he.setHeaders).reduce((gr,mi)=>gr.set(mi,he.setHeaders[mi]),An)),he.setParams&&(ii=Object.keys(he.setParams).reduce((gr,mi)=>gr.set(mi,he.setParams[mi]),ii)),new rn(ce,de,ht,{params:ii,headers:An,context:qn,reportProgress:_n,responseType:We,withCredentials:Qt})}}var vn=(()=>((vn=vn||{})[vn.Sent=0]="Sent",vn[vn.UploadProgress=1]="UploadProgress",vn[vn.ResponseHeader=2]="ResponseHeader",vn[vn.DownloadProgress=3]="DownloadProgress",vn[vn.Response=4]="Response",vn[vn.User=5]="User",vn))();class xt{constructor(he,ce=200,de="OK"){this.headers=he.headers||new Ye,this.status=void 0!==he.status?he.status:ce,this.statusText=he.statusText||de,this.url=he.url||null,this.ok=this.status>=200&&this.status<300}}class Tt extends xt{constructor(he={}){super(he),this.type=vn.ResponseHeader}clone(he={}){return new Tt({headers:he.headers||this.headers,status:void 0!==he.status?he.status:this.status,statusText:he.statusText||this.statusText,url:he.url||this.url||void 0})}}class Gt extends xt{constructor(he={}){super(he),this.type=vn.Response,this.body=void 0!==he.body?he.body:null}clone(he={}){return new Gt({body:void 0!==he.body?he.body:this.body,headers:he.headers||this.headers,status:void 0!==he.status?he.status:this.status,statusText:he.statusText||this.statusText,url:he.url||this.url||void 0})}}class Bt extends xt{constructor(he){super(he,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${he.url||"(unknown url)"}`:`Http failure response for ${he.url||"(unknown url)"}: ${he.status} ${he.statusText}`,this.error=he.error||null}}function Cn(ze,he){return{body:he,headers:ze.headers,context:ze.context,observe:ze.observe,params:ze.params,reportProgress:ze.reportProgress,responseType:ze.responseType,withCredentials:ze.withCredentials}}let mn=(()=>{class ze{constructor(ce){this.handler=ce}request(ce,de,We={}){let ht;if(ce instanceof rn)ht=ce;else{let An,ii;An=We.headers instanceof Ye?We.headers:new Ye(We.headers),We.params&&(ii=We.params instanceof St?We.params:new St({fromObject:We.params})),ht=new rn(ce,de,void 0!==We.body?We.body:null,{headers:An,context:We.context,params:ii,reportProgress:We.reportProgress,responseType:We.responseType||"json",withCredentials:We.withCredentials})}const Qt=(0,W.of)(ht).pipe((0,Ce.b)(An=>this.handler.handle(An)));if(ce instanceof rn||"events"===We.observe)return Qt;const _n=Qt.pipe((0,Ve.h)(An=>An instanceof Gt));switch(We.observe||"body"){case"body":switch(ht.responseType){case"arraybuffer":return _n.pipe((0,Je.U)(An=>{if(null!==An.body&&!(An.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return An.body}));case"blob":return _n.pipe((0,Je.U)(An=>{if(null!==An.body&&!(An.body instanceof Blob))throw new Error("Response is not a Blob.");return An.body}));case"text":return _n.pipe((0,Je.U)(An=>{if(null!==An.body&&"string"!=typeof An.body)throw new Error("Response is not a string.");return An.body}));default:return _n.pipe((0,Je.U)(An=>An.body))}case"response":return _n;default:throw new Error(`Unreachable: unhandled observe type ${We.observe}}`)}}delete(ce,de={}){return this.request("DELETE",ce,de)}get(ce,de={}){return this.request("GET",ce,de)}head(ce,de={}){return this.request("HEAD",ce,de)}jsonp(ce,de){return this.request("JSONP",ce,{params:(new St).append(de,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ce,de={}){return this.request("OPTIONS",ce,de)}patch(ce,de,We={}){return this.request("PATCH",ce,Cn(We,de))}post(ce,de,We={}){return this.request("POST",ce,Cn(We,de))}put(ce,de,We={}){return this.request("PUT",ce,Cn(We,de))}}return ze.\u0275fac=function(ce){return new(ce||ze)(d.LFG(ye))},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})();class oi{constructor(he,ce){this.next=he,this.interceptor=ce}handle(he){return this.interceptor.intercept(he,this.next)}}const Yn=new d.OlP("HTTP_INTERCEPTORS");let fi=(()=>{class ze{intercept(ce,de){return de.handle(ce)}}return ze.\u0275fac=function(ce){return new(ce||ze)},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})();const zn=/^\)\]\}',?\n/;let wi=(()=>{class ze{constructor(ce){this.xhrFactory=ce}handle(ce){if("JSONP"===ce.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new c.y(de=>{const We=this.xhrFactory.build();if(We.open(ce.method,ce.urlWithParams),ce.withCredentials&&(We.withCredentials=!0),ce.headers.forEach((zt,mt)=>We.setRequestHeader(zt,mt.join(","))),ce.headers.has("Accept")||We.setRequestHeader("Accept","application/json, text/plain, */*"),!ce.headers.has("Content-Type")){const zt=ce.detectContentTypeHeader();null!==zt&&We.setRequestHeader("Content-Type",zt)}if(ce.responseType){const zt=ce.responseType.toLowerCase();We.responseType="json"!==zt?zt:"text"}const ht=ce.serializeBody();let Qt=null;const _n=()=>{if(null!==Qt)return Qt;const zt=We.statusText||"OK",mt=new Ye(We.getAllResponseHeaders()),_t=function gn(ze){return"responseURL"in ze&&ze.responseURL?ze.responseURL:/^X-Request-URL:/m.test(ze.getAllResponseHeaders())?ze.getResponseHeader("X-Request-URL"):null}(We)||ce.url;return Qt=new Tt({headers:mt,status:We.status,statusText:zt,url:_t}),Qt},An=()=>{let{headers:zt,status:mt,statusText:_t,url:Ke}=_n(),nt=null;204!==mt&&(nt=typeof We.response>"u"?We.responseText:We.response),0===mt&&(mt=nt?200:0);let Be=mt>=200&&mt<300;if("json"===ce.responseType&&"string"==typeof nt){const Dt=nt;nt=nt.replace(zn,"");try{nt=""!==nt?JSON.parse(nt):null}catch(ae){nt=Dt,Be&&(Be=!1,nt={error:ae,text:nt})}}Be?(de.next(new Gt({body:nt,headers:zt,status:mt,statusText:_t,url:Ke||void 0})),de.complete()):de.error(new Bt({error:nt,headers:zt,status:mt,statusText:_t,url:Ke||void 0}))},ii=zt=>{const{url:mt}=_n(),_t=new Bt({error:zt,status:We.status||0,statusText:We.statusText||"Unknown Error",url:mt||void 0});de.error(_t)};let qn=!1;const gr=zt=>{qn||(de.next(_n()),qn=!0);let mt={type:vn.DownloadProgress,loaded:zt.loaded};zt.lengthComputable&&(mt.total=zt.total),"text"===ce.responseType&&!!We.responseText&&(mt.partialText=We.responseText),de.next(mt)},mi=zt=>{let mt={type:vn.UploadProgress,loaded:zt.loaded};zt.lengthComputable&&(mt.total=zt.total),de.next(mt)};return We.addEventListener("load",An),We.addEventListener("error",ii),We.addEventListener("timeout",ii),We.addEventListener("abort",ii),ce.reportProgress&&(We.addEventListener("progress",gr),null!==ht&&We.upload&&We.upload.addEventListener("progress",mi)),We.send(ht),de.next({type:vn.Sent}),()=>{We.removeEventListener("error",ii),We.removeEventListener("abort",ii),We.removeEventListener("load",An),We.removeEventListener("timeout",ii),ce.reportProgress&&(We.removeEventListener("progress",gr),null!==ht&&We.upload&&We.upload.removeEventListener("progress",mi)),We.readyState!==We.DONE&&We.abort()}})}}return ze.\u0275fac=function(ce){return new(ce||ze)(d.LFG(T.JF))},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})();const Ei=new d.OlP("XSRF_COOKIE_NAME"),Ii=new d.OlP("XSRF_HEADER_NAME");class or{}let Oi=(()=>{class ze{constructor(ce,de,We){this.doc=ce,this.platform=de,this.cookieName=We,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ce=this.doc.cookie||"";return ce!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,T.Mx)(ce,this.cookieName),this.lastCookieString=ce),this.lastToken}}return ze.\u0275fac=function(ce){return new(ce||ze)(d.LFG(T.K0),d.LFG(d.Lbi),d.LFG(Ei))},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})(),En=(()=>{class ze{constructor(ce,de){this.tokenService=ce,this.headerName=de}intercept(ce,de){const We=ce.url.toLowerCase();if("GET"===ce.method||"HEAD"===ce.method||We.startsWith("http://")||We.startsWith("https://"))return de.handle(ce);const ht=this.tokenService.getToken();return null!==ht&&!ce.headers.has(this.headerName)&&(ce=ce.clone({headers:ce.headers.set(this.headerName,ht)})),de.handle(ce)}}return ze.\u0275fac=function(ce){return new(ce||ze)(d.LFG(or),d.LFG(Ii))},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})(),Wi=(()=>{class ze{constructor(ce,de){this.backend=ce,this.injector=de,this.chain=null}handle(ce){if(null===this.chain){const de=this.injector.get(Yn,[]);this.chain=de.reduceRight((We,ht)=>new oi(We,ht),this.backend)}return this.chain.handle(ce)}}return ze.\u0275fac=function(ce){return new(ce||ze)(d.LFG(Me),d.LFG(d.zs3))},ze.\u0275prov=d.Yz7({token:ze,factory:ze.\u0275fac}),ze})(),K=(()=>{class ze{static disable(){return{ngModule:ze,providers:[{provide:En,useClass:fi}]}}static withOptions(ce={}){return{ngModule:ze,providers:[ce.cookieName?{provide:Ei,useValue:ce.cookieName}:[],ce.headerName?{provide:Ii,useValue:ce.headerName}:[]]}}}return ze.\u0275fac=function(ce){return new(ce||ze)},ze.\u0275mod=d.oAB({type:ze}),ze.\u0275inj=d.cJS({providers:[En,{provide:Yn,useExisting:En,multi:!0},{provide:or,useClass:Oi},{provide:Ei,useValue:"XSRF-TOKEN"},{provide:Ii,useValue:"X-XSRF-TOKEN"}]}),ze})(),ie=(()=>{class ze{}return ze.\u0275fac=function(ce){return new(ce||ze)},ze.\u0275mod=d.oAB({type:ze}),ze.\u0275inj=d.cJS({providers:[mn,{provide:ye,useClass:Wi},wi,{provide:Me,useExisting:wi}],imports:[K.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),ze})()},4650:(Bn,kt,j)=>{"use strict";j.d(kt,{$8M:()=>ks,$Z:()=>pm,AFp:()=>Pb,ALo:()=>H0,AaK:()=>ye,Akn:()=>Jc,BQk:()=>er,CHM:()=>Eo,CRH:()=>nb,CZH:()=>j_,CqO:()=>Yr,D6c:()=>DC,DdM:()=>R0,EJc:()=>j1,EiD:()=>mp,EpF:()=>Nr,F$t:()=>na,F4k:()=>Or,FYo:()=>vu,FiY:()=>bt,G48:()=>lC,Gf:()=>eb,GfV:()=>Uc,GkF:()=>pr,Gpc:()=>ft,Gre:()=>qy,Hsn:()=>_i,Ikx:()=>Yy,JOm:()=>Ta,JVY:()=>Qu,Jf7:()=>xg,KtG:()=>rl,L6k:()=>yf,LAX:()=>vf,LFG:()=>we,LSH:()=>Af,Lbi:()=>V1,Lck:()=>rw,MAs:()=>qi,MMx:()=>S_,NdJ:()=>Kr,O4$:()=>ou,OlP:()=>fr,Oqu:()=>Zy,PXZ:()=>iu,Q6J:()=>gi,QGY:()=>Pr,QP$:()=>ff,QbO:()=>$w,Qsj:()=>wp,R0b:()=>_e,RDi:()=>no,Rgc:()=>qm,SBq:()=>El,Sil:()=>Ww,Suo:()=>tb,TTD:()=>Xo,TgZ:()=>$i,Tol:()=>Iv,Udp:()=>Gy,VKq:()=>L0,WFA:()=>ts,WLB:()=>F0,XFs:()=>En,Xpm:()=>_t,Xts:()=>zc,Y36:()=>vd,YKP:()=>av,YNc:()=>$n,Yjl:()=>He,Yz7:()=>Ln,ZZ4:()=>Jw,_Bn:()=>sv,_UZ:()=>Oo,_Vd:()=>Ls,_c5:()=>EC,_uU:()=>Bv,aQg:()=>e1,c2e:()=>hr,cJS:()=>Rt,cg1:()=>Xy,d8E:()=>Ky,dDg:()=>Vr,dqk:()=>de,eBb:()=>ng,eFA:()=>Ni,ekj:()=>Hy,eoX:()=>Ro,f3M:()=>$e,g9A:()=>kb,h0i:()=>bh,hGG:()=>MC,hij:()=>E_,iGM:()=>J0,ifc:()=>ce,ip1:()=>Ib,kEZ:()=>pw,kL8:()=>t0,kcU:()=>Ic,lG2:()=>Te,lcZ:()=>$0,lqb:()=>od,lri:()=>Fi,mCW:()=>mc,n5z:()=>Ld,n_E:()=>O_,oAB:()=>ae,oJD:()=>Dh,oxw:()=>Mr,pB0:()=>ig,q3G:()=>qo,qLn:()=>$d,qOj:()=>sf,qZA:()=>ai,qzn:()=>Fc,rFY:()=>z0,rWj:()=>Ki,sBO:()=>cC,sIi:()=>n,s_b:()=>R_,soG:()=>G_,tb:()=>Rb,tp0:()=>Zt,uIk:()=>V,vHH:()=>et,vpe:()=>Fu,wAp:()=>Yi,xp6:()=>nh,ynx:()=>ro,z2F:()=>ec,z3N:()=>fc,zSh:()=>Vc,zs3:()=>yd});var T=j(7579),d=j(727),W=j(9751),c=j(6451),Ce=j(3099);function Ve(r){for(let s in r)if(r[s]===Ve)return s;throw Error("Could not find renamed property on target object.")}function Je(r,s){for(const l in s)s.hasOwnProperty(l)&&!r.hasOwnProperty(l)&&(r[l]=s[l])}function ye(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(ye).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const s=r.toString();if(null==s)return""+s;const l=s.indexOf("\n");return-1===l?s:s.substring(0,l)}function Me(r,s){return null==r||""===r?null===s?"":s:null==s||""===s?r:r+" "+s}const Ye=Ve({__forward_ref__:Ve});function ft(r){return r.__forward_ref__=ft,r.toString=function(){return ye(this())},r}function Pe(r){return ut(r)?r():r}function ut(r){return"function"==typeof r&&r.hasOwnProperty(Ye)&&r.__forward_ref__===ft}class et extends Error{constructor(s,l){super(function Ut(r,s){return`NG0${Math.abs(r)}${s?": "+s.trim():""}`}(s,l)),this.code=s}}function Ft(r){return"string"==typeof r?r:null==r?"":String(r)}function Fe(r,s){throw new et(-201,!1)}function fi(r,s){null==r&&function On(r,s,l,m){throw new Error(`ASSERTION ERROR: ${r}`+(null==m?"":` [Expected=> ${l} ${m} ${s} <=Actual]`))}(s,r,null,"!=")}function Ln(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Rt(r){return{providers:r.providers||[],imports:r.imports||[]}}function Kt(r){return kn(r,Ei)||kn(r,or)}function kn(r,s){return r.hasOwnProperty(s)?r[s]:null}function wi(r){return r&&(r.hasOwnProperty(Ii)||r.hasOwnProperty(Oi))?r[Ii]:null}const Ei=Ve({\u0275prov:Ve}),Ii=Ve({\u0275inj:Ve}),or=Ve({ngInjectableDef:Ve}),Oi=Ve({ngInjectorDef:Ve});var En=(()=>((En=En||{})[En.Default=0]="Default",En[En.Host=1]="Host",En[En.Self=2]="Self",En[En.SkipSelf=4]="SkipSelf",En[En.Optional=8]="Optional",En))();let Wi;function ct(r){const s=Wi;return Wi=r,s}function K(r,s,l){const m=Kt(r);return m&&"root"==m.providedIn?void 0===m.value?m.value=m.factory():m.value:l&En.Optional?null:void 0!==s?s:void Fe(ye(r))}function De(r){return{toString:r}.toString()}var dt=(()=>((dt=dt||{})[dt.OnPush=0]="OnPush",dt[dt.Default=1]="Default",dt))(),ce=(()=>{return(r=ce||(ce={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",ce;var r})();const de=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Qt={},_n=[],An=Ve({\u0275cmp:Ve}),ii=Ve({\u0275dir:Ve}),qn=Ve({\u0275pipe:Ve}),gr=Ve({\u0275mod:Ve}),mi=Ve({\u0275fac:Ve}),zt=Ve({__NG_ELEMENT_ID__:Ve});let mt=0;function _t(r){return De(()=>{const l=!0===r.standalone,m={},x={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:m,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===dt.OnPush,directiveDefs:null,pipeDefs:null,standalone:l,dependencies:l&&r.dependencies||null,getStandaloneInjector:null,selectors:r.selectors||_n,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||ce.Emulated,id:"c"+mt++,styles:r.styles||_n,_:null,setInput:null,schemas:r.schemas||null,tView:null},M=r.dependencies,P=r.features;return x.inputs=le(r.inputs,m),x.outputs=le(r.outputs),P&&P.forEach(N=>N(x)),x.directiveDefs=M?()=>("function"==typeof M?M():M).map(nt).filter(Be):null,x.pipeDefs=M?()=>("function"==typeof M?M():M).map(Ct).filter(Be):null,x})}function nt(r){return Xe(r)||Mt(r)}function Be(r){return null!==r}const Dt={};function ae(r){return De(()=>{const s={type:r.type,bootstrap:r.bootstrap||_n,declarations:r.declarations||_n,imports:r.imports||_n,exports:r.exports||_n,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(Dt[r.id]=r.type),s})}function le(r,s){if(null==r)return Qt;const l={};for(const m in r)if(r.hasOwnProperty(m)){let x=r[m],M=x;Array.isArray(x)&&(M=x[1],x=x[0]),l[x]=m,s&&(s[x]=M)}return l}const Te=_t;function He(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Xe(r){return r[An]||null}function Mt(r){return r[ii]||null}function Ct(r){return r[qn]||null}function lt(r,s){const l=r[gr]||null;if(!l&&!0===s)throw new Error(`Type ${ye(r)} does not have '\u0275mod' property.`);return l}function Gr(r){return Array.isArray(r)&&"object"==typeof r[1]}function ao(r){return Array.isArray(r)&&!0===r[1]}function xa(r){return 0!=(8&r.flags)}function ys(r){return 2==(2&r.flags)}function Vs(r){return 1==(1&r.flags)}function Ko(r){return null!==r.template}function Jr(r){return 0!=(256&r[2])}function Fo(r,s){return r.hasOwnProperty(mi)?r[mi]:null}class $o{constructor(s,l,m){this.previousValue=s,this.currentValue=l,this.firstChange=m}isFirstChange(){return this.firstChange}}function Xo(){return aa}function aa(r){return r.type.prototype.ngOnChanges&&(r.setInput=ka),la}function la(){const r=_l(this),s=r?.current;if(s){const l=r.previous;if(l===Qt)r.previous=s;else for(let m in s)l[m]=s[m];r.current=null,this.ngOnChanges(s)}}function ka(r,s,l,m){const x=_l(r)||function Al(r,s){return r[Ra]=s}(r,{previous:Qt,current:null}),M=x.current||(x.current={}),P=x.previous,N=this.declaredInputs[l],G=P[N];M[N]=new $o(G&&G.currentValue,s,P===Qt),r[m]=s}Xo.ngInherit=!0;const Ra="__ngSimpleChanges__";function _l(r){return r[Ra]||null}function Qr(r){for(;Array.isArray(r);)r=r[0];return r}function ua(r,s){return Qr(s[r])}function vo(r,s){return Qr(s[r.index])}function da(r,s){return r.data[s]}function Li(r,s){return r[s]}function X(r,s){const l=s[r];return Gr(l)?l:l[0]}function be(r){return 4==(4&r[2])}function J(r){return 64==(64&r[2])}function vt(r,s){return null==s?null:r[s]}function sn(r){r[18]=0}function xn(r,s){r[5]+=s;let l=r,m=r[3];for(;null!==m&&(1===s&&1===l[5]||-1===s&&0===l[5]);)m[5]+=s,l=m,m=m[3]}const nn={lFrame:ds(null),bindingsEnabled:!0};function Dr(){return nn.bindingsEnabled}function yn(){return nn.lFrame.lView}function ji(){return nn.lFrame.tView}function Eo(r){return nn.lFrame.contextLView=r,r[8]}function rl(r){return nn.lFrame.contextLView=null,r}function qr(){let r=ol();for(;null!==r&&64===r.type;)r=r.parent;return r}function ol(){return nn.lFrame.currentTNode}function q(r,s){const l=nn.lFrame;l.currentTNode=r,l.isParent=s}function $(){return nn.lFrame.isParent}function me(){nn.lFrame.isParent=!1}function eo(){const r=nn.lFrame;let s=r.bindingRootIndex;return-1===s&&(s=r.bindingRootIndex=r.tView.bindingStartIndex),s}function sl(){return nn.lFrame.bindingIndex++}function al(r){const s=nn.lFrame,l=s.bindingIndex;return s.bindingIndex=s.bindingIndex+r,l}function Ac(r,s){const l=nn.lFrame;l.bindingIndex=l.bindingRootIndex=r,tc(s)}function tc(r){nn.lFrame.currentDirectiveIndex=r}function nc(r){const s=nn.lFrame.currentDirectiveIndex;return-1===s?null:r[s]}function Il(){return nn.lFrame.currentQueryIndex}function Pl(r){nn.lFrame.currentQueryIndex=r}function yl(r){const s=r[1];return 2===s.type?s.declTNode:1===s.type?r[6]:null}function Od(r,s,l){if(l&En.SkipSelf){let x=s,M=r;for(;!(x=x.parent,null!==x||l&En.Host||(x=yl(M),null===x||(M=M[15],10&x.type))););if(null===x)return!1;s=x,r=M}const m=nn.lFrame=kd();return m.currentTNode=s,m.lView=r,!0}function Vu(r){const s=kd(),l=r[1];nn.lFrame=s,s.currentTNode=l.firstChild,s.lView=r,s.tView=l,s.contextLView=r,s.bindingIndex=l.bindingStartIndex,s.inI18n=!1}function kd(){const r=nn.lFrame,s=null===r?null:r.child;return null===s?ds(r):s}function ds(r){const s={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=s),s}function ic(){const r=nn.lFrame;return nn.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const fo=ic;function to(){const r=ic();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Qo(){return nn.lFrame.selectedIndex}function xs(r){nn.lFrame.selectedIndex=r}function ir(){const r=nn.lFrame;return da(r.tView,r.selectedIndex)}function ou(){nn.lFrame.currentNamespace="svg"}function Ic(){!function zo(){nn.lFrame.currentNamespace=null}()}function Ol(r,s){for(let l=s.directiveStart,m=s.directiveEnd;l<m;l++){const M=r.data[l].type.prototype,{ngAfterContentInit:P,ngAfterContentChecked:N,ngAfterViewInit:G,ngAfterViewChecked:re,ngOnDestroy:ve}=M;P&&(r.contentHooks||(r.contentHooks=[])).push(-l,P),N&&((r.contentHooks||(r.contentHooks=[])).push(l,N),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(l,N)),G&&(r.viewHooks||(r.viewHooks=[])).push(-l,G),re&&((r.viewHooks||(r.viewHooks=[])).push(l,re),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(l,re)),null!=ve&&(r.destroyHooks||(r.destroyHooks=[])).push(l,ve)}}function Ea(r,s,l){Zo(r,s,3,l)}function Ma(r,s,l,m){(3&r[2])===l&&Zo(r,s,l,m)}function ws(r,s){let l=r[2];(3&l)===s&&(l&=2047,l+=1,r[2]=l)}function Zo(r,s,l,m){const M=m??-1,P=s.length-1;let N=0;for(let G=void 0!==m?65535&r[18]:0;G<P;G++)if("number"==typeof s[G+1]){if(N=s[G],null!=m&&N>=m)break}else s[G]<0&&(r[18]+=65536),(N<M||-1==M)&&(cr(r,l,s,G),r[18]=(4294901760&r[18])+G+2),G++}function cr(r,s,l,m){const x=l[m]<0,M=l[m+1],N=r[x?-l[m]:l[m]];if(x){if(r[2]>>11<r[18]>>16&&(3&r[2])===s){r[2]+=2048;try{M.call(N)}finally{}}}else try{M.call(N)}finally{}}class Rr{constructor(s,l,m){this.factory=s,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=m}}function Ua(r,s,l){let m=0;for(;m<l.length;){const x=l[m];if("number"==typeof x){if(0!==x)break;m++;const M=l[m++],P=l[m++],N=l[m++];r.setAttribute(s,P,N,M)}else{const M=x,P=l[++m];oc(M)?r.setProperty(s,M,P):r.setAttribute(s,M,P),m++}}return m}function kl(r){return 3===r||4===r||6===r}function oc(r){return 64===r.charCodeAt(0)}function Rl(r,s){if(null!==s&&0!==s.length)if(null===r||0===r.length)r=s.slice();else{let l=-1;for(let m=0;m<s.length;m++){const x=s[m];"number"==typeof x?l=x:0===l||sc(r,l,x,null,-1===l||2===l?s[++m]:null)}}return r}function sc(r,s,l,m,x){let M=0,P=r.length;if(-1===s)P=-1;else for(;M<r.length;){const N=r[M++];if("number"==typeof N){if(N===s){P=-1;break}if(N>s){P=M-1;break}}}for(;M<r.length;){const N=r[M];if("number"==typeof N)break;if(N===l){if(null===m)return void(null!==x&&(r[M+1]=x));if(m===r[M+1])return void(r[M+2]=x)}M++,null!==m&&M++,null!==x&&M++}-1!==P&&(r.splice(P,0,s),M=P+1),r.splice(M++,0,l),null!==m&&r.splice(M++,0,m),null!==x&&r.splice(M++,0,x)}function zi(r){return-1!==r}function Hn(r){return 32767&r}function hs(r,s){let l=function Ys(r){return r>>16}(r),m=s;for(;l>0;)m=m[15],l--;return m}let ja=!0;function ac(r){const s=ja;return ja=r,s}let su=0;const Wo={};function Fl(r,s){const l=lc(r,s);if(-1!==l)return l;const m=s[1];m.firstCreatePass&&(r.injectorIndex=s.length,Ga(m.data,r),Ga(s,null),Ga(m.blueprint,null));const x=kc(r,s),M=r.injectorIndex;if(zi(x)){const P=Hn(x),N=hs(x,s),G=N[1].data;for(let re=0;re<8;re++)s[M+re]=N[P+re]|G[P+re]}return s[M+8]=x,M}function Ga(r,s){r.push(0,0,0,0,0,0,0,0,s)}function lc(r,s){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===s[r.injectorIndex+8]?-1:r.injectorIndex}function kc(r,s){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let l=0,m=null,x=s;for(;null!==x;){if(m=pa(x),null===m)return-1;if(l++,x=x[15],-1!==m.injectorIndex)return m.injectorIndex|l<<16}return-1}function Ha(r,s,l){!function au(r,s,l){let m;"string"==typeof l?m=l.charCodeAt(0)||0:l.hasOwnProperty(zt)&&(m=l[zt]),null==m&&(m=l[zt]=su++);const x=255&m;s.data[r+(x>>5)]|=1<<x}(r,s,l)}function ps(r,s,l){if(l&En.Optional)return r;Fe()}function $a(r,s,l,m){if(l&En.Optional&&void 0===m&&(m=null),0==(l&(En.Self|En.Host))){const x=r[9],M=ct(void 0);try{return x?x.get(s,m,l&En.Optional):K(s,m,l&En.Optional)}finally{ct(M)}}return ps(m,0,l)}function Gu(r,s,l,m=En.Default,x){if(null!==r){if(1024&s[2]){const P=function cu(r,s,l,m,x){let M=r,P=s;for(;null!==M&&null!==P&&1024&P[2]&&!(256&P[2]);){const N=Do(M,P,l,m|En.Self,Wo);if(N!==Wo)return N;let G=M.parent;if(!G){const re=P[21];if(re){const ve=re.get(l,Wo,m);if(ve!==Wo)return ve}G=pa(P),P=P[15]}M=G}return x}(r,s,l,m,Wo);if(P!==Wo)return P}const M=Do(r,s,l,m,Wo);if(M!==Wo)return M}return $a(s,l,m,x)}function Do(r,s,l,m,x){const M=function lu(r){if("string"==typeof r)return r.charCodeAt(0)||0;const s=r.hasOwnProperty(zt)?r[zt]:void 0;return"number"==typeof s?s>=0?255&s:$u:s}(l);if("function"==typeof M){if(!Od(s,r,m))return m&En.Host?ps(x,0,m):$a(s,l,m,x);try{const P=M(m);if(null!=P||m&En.Optional)return P;Fe()}finally{fo()}}else if("number"==typeof M){let P=null,N=lc(r,s),G=-1,re=m&En.Host?s[16][6]:null;for((-1===N||m&En.SkipSelf)&&(G=-1===N?kc(r,s):s[N+8],-1!==G&&Hu(m,!1)?(P=s[1],N=Hn(G),s=hs(G,s)):N=-1);-1!==N;){const ve=s[1];if(zl(M,N,ve.data)){const Ze=Rd(N,s,l,P,m,re);if(Ze!==Wo)return Ze}G=s[N+8],-1!==G&&Hu(m,s[1].data[N+8]===re)&&zl(M,N,s)?(P=ve,N=Hn(G),s=hs(G,s)):N=-1}}return x}function Rd(r,s,l,m,x,M){const P=s[1],N=P.data[r+8],ve=Rc(N,P,l,null==m?ys(N)&&ja:m!=P&&0!=(3&N.type),x&En.Host&&M===N);return null!==ve?Za(s,P,ve,N):Wo}function Rc(r,s,l,m,x){const M=r.providerIndexes,P=s.data,N=1048575&M,G=r.directiveStart,ve=M>>20,Pt=x?N+ve:r.directiveEnd;for(let qt=m?N:N+ve;qt<Pt;qt++){const Mn=P[qt];if(qt<G&&l===Mn||qt>=G&&Mn.type===l)return qt}if(x){const qt=P[G];if(qt&&Ko(qt)&&qt.type===l)return G}return null}function Za(r,s,l,m){let x=r[l];const M=s.data;if(function Pc(r){return r instanceof Rr}(x)){const P=x;P.resolving&&function Pn(r,s){const l=s?`. Dependency path: ${s.join(" > ")} > ${r}`:"";throw new et(-200,`Circular dependency in DI detected for ${r}${l}`)}(function St(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Ft(r)}(M[l]));const N=ac(P.canSeeViewProviders);P.resolving=!0;const G=P.injectImpl?ct(P.injectImpl):null;Od(r,m,En.Default);try{x=r[l]=P.factory(void 0,M,r,m),s.firstCreatePass&&l>=m.directiveStart&&function Va(r,s,l){const{ngOnChanges:m,ngOnInit:x,ngDoCheck:M}=s.type.prototype;if(m){const P=aa(s);(l.preOrderHooks||(l.preOrderHooks=[])).push(r,P),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,P)}x&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-r,x),M&&((l.preOrderHooks||(l.preOrderHooks=[])).push(r,M),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,M))}(l,M[l],s)}finally{null!==G&&ct(G),ac(N),P.resolving=!1,fo()}}return x}function zl(r,s,l){return!!(l[s+(r>>5)]&1<<r)}function Hu(r,s){return!(r&En.Self||r&En.Host&&s)}class Ks{constructor(s,l){this._tNode=s,this._lView=l}get(s,l,m){return Gu(this._tNode,this._lView,s,m,l)}}function $u(){return new Ks(qr(),yn())}function Ld(r){return De(()=>{const s=r.prototype.constructor,l=s[mi]||Es(s),m=Object.prototype;let x=Object.getPrototypeOf(r.prototype).constructor;for(;x&&x!==m;){const M=x[mi]||Es(x);if(M&&M!==l)return M;x=Object.getPrototypeOf(x)}return M=>new M})}function Es(r){return ut(r)?()=>{const s=Es(Pe(r));return s&&s()}:Fo(r)}function pa(r){const s=r[1],l=s.type;return 2===l?s.declTNode:1===l?r[6]:null}function ks(r){return function Bl(r,s){if("class"===s)return r.classes;if("style"===s)return r.styles;const l=r.attrs;if(l){const m=l.length;let x=0;for(;x<m;){const M=l[x];if(kl(M))break;if(0===M)x+=2;else if("number"==typeof M)for(x++;x<m&&"string"==typeof l[x];)x++;else{if(M===s)return l[x+1];x+=2}}}return null}(qr(),r)}const xl="__parameters__";function fs(r,s,l){return De(()=>{const m=function Wu(r){return function(...l){if(r){const m=r(...l);for(const x in m)this[x]=m[x]}}}(s);function x(...M){if(this instanceof x)return m.apply(this,M),this;const P=new x(...M);return N.annotation=P,N;function N(G,re,ve){const Ze=G.hasOwnProperty(xl)?G[xl]:Object.defineProperty(G,xl,{value:[]})[xl];for(;Ze.length<=ve;)Ze.push(null);return(Ze[ve]=Ze[ve]||[]).push(P),G}}return l&&(x.prototype=Object.create(l.prototype)),x.prototype.ngMetadataName=r,x.annotationCls=x,x})}class fr{constructor(s,l){this._desc=s,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=Ln({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function L(r,s){void 0===s&&(s=r);for(let l=0;l<r.length;l++){let m=r[l];Array.isArray(m)?(s===r&&(s=r.slice(0,l)),L(m,s)):s!==r&&s.push(m)}return s}function O(r,s){r.forEach(l=>Array.isArray(l)?O(l,s):s(l))}function H(r,s,l){s>=r.length?r.push(l):r.splice(s,0,l)}function Q(r,s){return s>=r.length-1?r.pop():r.splice(s,1)[0]}function ge(r,s){const l=[];for(let m=0;m<r;m++)l.push(s);return l}function rr(r,s,l){let m=ms(r,s);return m>=0?r[1|m]=l:(m=~m,function an(r,s,l,m){let x=r.length;if(x==s)r.push(l,m);else if(1===x)r.push(m,r[0]),r[0]=l;else{for(x--,r.push(r[x-1],r[x]);x>s;)r[x]=r[x-2],x--;r[s]=l,r[s+1]=m}}(r,m,s,l)),m}function Jo(r,s){const l=ms(r,s);if(l>=0)return r[1|l]}function ms(r,s){return function Rs(r,s,l){let m=0,x=r.length>>l;for(;x!==m;){const M=m+(x-m>>1),P=r[M<<l];if(s===P)return M<<l;P>s?x=M:m=M+1}return~(x<<l)}(r,s,1)}const w={},E="__NG_DI_FLAG__",I="ngTempTokenPath",B=/\n/gm,te="__source";let se;function fe(r){const s=se;return se=r,s}function Se(r,s=En.Default){if(void 0===se)throw new et(-203,!1);return null===se?K(r,void 0,s):se.get(r,s&En.Optional?null:void 0,s)}function we(r,s=En.Default){return(function li(){return Wi}()||Se)(Pe(r),s)}function $e(r,s=En.Default){return"number"!=typeof s&&(s=0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)),we(r,s)}function Ee(r){const s=[];for(let l=0;l<r.length;l++){const m=Pe(r[l]);if(Array.isArray(m)){if(0===m.length)throw new et(900,!1);let x,M=En.Default;for(let P=0;P<m.length;P++){const N=m[P],G=Re(N);"number"==typeof G?-1===G?x=N.token:M|=G:x=N}s.push(we(x,M))}else s.push(we(m))}return s}function ke(r,s){return r[E]=s,r.prototype[E]=s,r}function Re(r){return r[E]}const bt=ke(fs("Optional"),8),Zt=ke(fs("SkipSelf"),4);let Hr,mo,jl;function no(r){Hr=r}function sr(r){return function es(){if(void 0===mo&&(mo=null,de.trustedTypes))try{mo=de.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return mo}()?.createHTML(r)||r}function Gl(r){return function pc(){if(void 0===jl&&(jl=null,de.trustedTypes))try{jl=de.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return jl}()?.createHTML(r)||r}class Xs{constructor(s){this.changingThisBreaksApplicationSecurity=s}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Xu extends Xs{getTypeName(){return"HTML"}}class eg extends Xs{getTypeName(){return"Style"}}class dp extends Xs{getTypeName(){return"Script"}}class hp extends Xs{getTypeName(){return"URL"}}class zd extends Xs{getTypeName(){return"ResourceURL"}}function fc(r){return r instanceof Xs?r.changingThisBreaksApplicationSecurity:r}function Fc(r,s){const l=function tg(r){return r instanceof Xs&&r.getTypeName()||null}(r);if(null!=l&&l!==s){if("ResourceURL"===l&&"URL"===s)return!0;throw new Error(`Required a safe ${s}, got a ${l} (see https://g.co/ng/security#xss)`)}return l===s}function Qu(r){return new Xu(r)}function yf(r){return new eg(r)}function ng(r){return new dp(r)}function vf(r){return new hp(r)}function ig(r){return new zd(r)}class rg{constructor(s){this.inertDocumentHelper=s}getInertBodyElement(s){s="<body><remove></remove>"+s;try{const l=(new window.DOMParser).parseFromString(sr(s),"text/html").body;return null===l?this.inertDocumentHelper.getInertBodyElement(s):(l.removeChild(l.firstChild),l)}catch{return null}}}class xf{constructor(s){if(this.defaultDoc=s,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const l=this.inertDocument.createElement("html");this.inertDocument.appendChild(l);const m=this.inertDocument.createElement("body");l.appendChild(m)}}getInertBodyElement(s){const l=this.inertDocument.createElement("template");if("content"in l)return l.innerHTML=sr(s),l;const m=this.inertDocument.createElement("body");return m.innerHTML=sr(s),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(m),m}stripCustomNsAttrs(s){const l=s.attributes;for(let x=l.length-1;0<x;x--){const P=l.item(x).name;("xmlns:ns1"===P||0===P.indexOf("ns1:"))&&s.removeAttribute(P)}let m=s.firstChild;for(;m;)m.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(m),m=m.nextSibling}}const $_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Z_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function mc(r){return(r=String(r)).match($_)||r.match(Z_)?r:"unsafe:"+r}function ul(r){const s={};for(const l of r.split(","))s[l]=!0;return s}function Nd(...r){const s={};for(const l of r)for(const m in l)l.hasOwnProperty(m)&&(s[m]=!0);return s}const pp=ul("area,br,col,hr,img,wbr"),Mh=ul("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),gc=ul("rp,rt"),Ju=Nd(pp,Nd(Mh,ul("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Nd(gc,ul("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Nd(gc,Mh)),Mf=ul("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Df=ul("srcset"),ed=Nd(Mf,Df,ul("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ul("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Bc=ul("script,style,template");class Hl{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(s){let l=s.firstChild,m=!0;for(;l;)if(l.nodeType===Node.ELEMENT_NODE?m=this.startElement(l):l.nodeType===Node.TEXT_NODE?this.chars(l.nodeValue):this.sanitizedSomething=!0,m&&l.firstChild)l=l.firstChild;else for(;l;){l.nodeType===Node.ELEMENT_NODE&&this.endElement(l);let x=this.checkClobberedElement(l,l.nextSibling);if(x){l=x;break}l=this.checkClobberedElement(l,l.parentNode)}return this.buf.join("")}startElement(s){const l=s.nodeName.toLowerCase();if(!Ju.hasOwnProperty(l))return this.sanitizedSomething=!0,!Bc.hasOwnProperty(l);this.buf.push("<"),this.buf.push(l);const m=s.attributes;for(let x=0;x<m.length;x++){const M=m.item(x),P=M.name,N=P.toLowerCase();if(!ed.hasOwnProperty(N)){this.sanitizedSomething=!0;continue}let G=M.value;Mf[N]&&(G=mc(G)),Df[N]&&(r=G,G=(r=String(r)).split(",").map(s=>mc(s.trim())).join(", ")),this.buf.push(" ",P,'="',mu(G),'"')}var r;return this.buf.push(">"),!0}endElement(s){const l=s.nodeName.toLowerCase();Ju.hasOwnProperty(l)&&!pp.hasOwnProperty(l)&&(this.buf.push("</"),this.buf.push(l),this.buf.push(">"))}chars(s){this.buf.push(mu(s))}checkClobberedElement(s,l){if(l&&(s.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${s.outerHTML}`);return l}}const pu=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,fu=/([^\#-~ |!])/g;function mu(r){return r.replace(/&/g,"&amp;").replace(pu,function(s){return"&#"+(1024*(s.charCodeAt(0)-55296)+(s.charCodeAt(1)-56320)+65536)+";"}).replace(fu,function(s){return"&#"+s.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let fp;function mp(r,s){let l=null;try{fp=fp||function bf(r){const s=new xf(r);return function H_(){try{return!!(new window.DOMParser).parseFromString(sr(""),"text/html")}catch{return!1}}()?new rg(s):s}(r);let m=s?String(s):"";l=fp.getInertBodyElement(m);let x=5,M=m;do{if(0===x)throw new Error("Failed to sanitize html because the input is unstable");x--,m=M,M=l.innerHTML,l=fp.getInertBodyElement(m)}while(m!==M);return sr((new Hl).sanitizeChildren(Sf(l)||l))}finally{if(l){const m=Sf(l)||l;for(;m.firstChild;)m.removeChild(m.firstChild)}}}function Sf(r){return"content"in r&&function gp(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var qo=(()=>((qo=qo||{})[qo.NONE=0]="NONE",qo[qo.HTML=1]="HTML",qo[qo.STYLE=2]="STYLE",qo[qo.SCRIPT=3]="SCRIPT",qo[qo.URL=4]="URL",qo[qo.RESOURCE_URL=5]="RESOURCE_URL",qo))();function Dh(r){const s=Zl();return s?Gl(s.sanitize(qo.HTML,r)||""):Fc(r,"HTML")?Gl(fc(r)):mp(function Cr(){return void 0!==Hr?Hr:typeof document<"u"?document:void 0}(),Ft(r))}function Af(r){const s=Zl();return s?s.sanitize(qo.URL,r)||"":Fc(r,"URL")?fc(r):mc(Ft(r))}function Zl(){const r=yn();return r&&r[12]}const zc=new fr("ENVIRONMENT_INITIALIZER"),dl=new fr("INJECTOR",-1),Qs=new fr("INJECTOR_DEF_TYPES");class No{get(s,l=w){if(l===w){const m=new Error(`NullInjectorError: No provider for ${ye(s)}!`);throw m.name="NullInjectorError",m}return l}}function lg(...r){return{\u0275providers:Wl(0,r)}}function Wl(r,...s){const l=[],m=new Set;let x;return O(s,M=>{const P=M;Sh(P,l,[],m)&&(x||(x=[]),x.push(P))}),void 0!==x&&td(x,l),l}function td(r,s){for(let l=0;l<r.length;l++){const{providers:x}=r[l];O(x,M=>{s.push(M)})}}function Sh(r,s,l,m){if(!(r=Pe(r)))return!1;let x=null,M=wi(r);const P=!M&&Xe(r);if(M||P){if(P&&!P.standalone)return!1;x=r}else{const G=r.ngModule;if(M=wi(G),!M)return!1;x=G}const N=m.has(x);if(P){if(N)return!1;if(m.add(x),P.dependencies){const G="function"==typeof P.dependencies?P.dependencies():P.dependencies;for(const re of G)Sh(re,s,l,m)}}else{if(!M)return!1;{if(null!=M.imports&&!N){let re;m.add(x);try{O(M.imports,ve=>{Sh(ve,s,l,m)&&(re||(re=[]),re.push(ve))})}finally{}void 0!==re&&td(re,s)}if(!N){const re=Fo(x)||(()=>new x);s.push({provide:x,useFactory:re,deps:_n},{provide:Qs,useValue:x,multi:!0},{provide:zc,useValue:()=>we(x),multi:!0})}const G=M.providers;null==G||N||O(G,ve=>{s.push(ve)})}}return x!==r&&void 0!==r.providers}const Pf=Ve({provide:String,useValue:Ve});function nd(r){return null!==r&&"object"==typeof r&&Pf in r}function id(r){return"function"==typeof r}const Vc=new fr("Set Injector scope."),rd={},yp={};let Ih;function Ph(){return void 0===Ih&&(Ih=new No),Ih}class od{}class kf extends od{constructor(s,l,m,x){super(),this.parent=l,this.source=m,this.scopes=x,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,yu(s,P=>this.processProvider(P)),this.records.set(dl,sd(void 0,this)),x.has("environment")&&this.records.set(od,sd(void 0,this));const M=this.records.get(Vc);null!=M&&"string"==typeof M.value&&this.scopes.add(M.value),this.injectorDefTypes=new Set(this.get(Qs.multi,_n,En.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const s of this._ngOnDestroyHooks)s.ngOnDestroy();for(const s of this._onDestroyHooks)s()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(s){this._onDestroyHooks.push(s)}runInContext(s){this.assertNotDestroyed();const l=fe(this),m=ct(void 0);try{return s()}finally{fe(l),ct(m)}}get(s,l=w,m=En.Default){this.assertNotDestroyed();const x=fe(this),M=ct(void 0);try{if(!(m&En.SkipSelf)){let N=this.records.get(s);if(void 0===N){const G=function cg(r){return"function"==typeof r||"object"==typeof r&&r instanceof fr}(s)&&Kt(s);N=G&&this.injectableDefInScope(G)?sd(Rf(s),rd):null,this.records.set(s,N)}if(null!=N)return this.hydrate(s,N)}return(m&En.Self?Ph():this.parent).get(s,l=m&En.Optional&&l===w?null:l)}catch(P){if("NullInjectorError"===P.name){if((P[I]=P[I]||[]).unshift(ye(s)),x)throw P;return function st(r,s,l,m){const x=r[I];throw s[te]&&x.unshift(s[te]),r.message=function Ue(r,s,l,m=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let x=ye(s);if(Array.isArray(s))x=s.map(ye).join(" -> ");else if("object"==typeof s){let M=[];for(let P in s)if(s.hasOwnProperty(P)){let N=s[P];M.push(P+":"+("string"==typeof N?JSON.stringify(N):ye(N)))}x=`{${M.join(", ")}}`}return`${l}${m?"("+m+")":""}[${x}]: ${r.replace(B,"\n  ")}`}("\n"+r.message,x,l,m),r.ngTokenPath=x,r[I]=null,r}(P,s,"R3InjectorError",this.source)}throw P}finally{ct(M),fe(x)}}resolveInjectorInitializers(){const s=fe(this),l=ct(void 0);try{const m=this.get(zc.multi,_n,En.Self);for(const x of m)x()}finally{fe(s),ct(l)}}toString(){const s=[],l=this.records;for(const m of l.keys())s.push(ye(m));return`R3Injector[${s.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new et(205,!1)}processProvider(s){let l=id(s=Pe(s))?s:Pe(s&&s.provide);const m=function q_(r){return nd(r)?sd(void 0,r.useValue):sd(vp(r),rd)}(s);if(id(s)||!0!==s.multi)this.records.get(l);else{let x=this.records.get(l);x||(x=sd(void 0,rd,!0),x.factory=()=>Ee(x.multi),this.records.set(l,x)),l=s,x.multi.push(s)}this.records.set(l,m)}hydrate(s,l){return l.value===rd&&(l.value=yp,l.value=l.factory()),"object"==typeof l.value&&l.value&&function _u(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(l.value)&&this._ngOnDestroyHooks.add(l.value),l.value}injectableDefInScope(s){if(!s.providedIn)return!1;const l=Pe(s.providedIn);return"string"==typeof l?"any"===l||this.scopes.has(l):this.injectorDefTypes.has(l)}}function Rf(r){const s=Kt(r),l=null!==s?s.factory:Fo(r);if(null!==l)return l;if(r instanceof fr)throw new et(204,!1);if(r instanceof Function)return function Lf(r){const s=r.length;if(s>0)throw ge(s,"?"),new et(204,!1);const l=function zn(r){const s=r&&(r[Ei]||r[or]);if(s){const l=function gn(r){if(r.hasOwnProperty("name"))return r.name;const s=(""+r).match(/^function\s*([^\s(]+)/);return null===s?"":s[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${l}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${l}" class.`),s}return null}(r);return null!==l?()=>l.factory(r):()=>new r}(r);throw new et(204,!1)}function vp(r,s,l){let m;if(id(r)){const x=Pe(r);return Fo(x)||Rf(x)}if(nd(r))m=()=>Pe(r.useValue);else if(function Of(r){return!(!r||!r.useFactory)}(r))m=()=>r.useFactory(...Ee(r.deps||[]));else if(function _p(r){return!(!r||!r.useExisting)}(r))m=()=>we(Pe(r.useExisting));else{const x=Pe(r&&(r.useClass||r.provide));if(!function ad(r){return!!r.deps}(r))return Fo(x)||Rf(x);m=()=>new x(...Ee(r.deps))}return m}function sd(r,s,l=!1){return{factory:r,value:s,multi:l?[]:void 0}}function Y_(r){return!!r.\u0275providers}function yu(r,s){for(const l of r)Array.isArray(l)?yu(l,s):Y_(l)?yu(l.\u0275providers,s):s(l)}class Ff{}class xp{resolveComponentFactory(s){throw function Oh(r){const s=Error(`No component factory found for ${ye(r)}. Did you add it to @NgModule.entryComponents?`);return s.ngComponent=r,s}(s)}}let Ls=(()=>{class r{}return r.NULL=new xp,r})();function dg(){return Ms(qr(),yn())}function Ms(r,s){return new El(vo(r,s))}let El=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=dg,r})();function ld(r){return r instanceof El?r.nativeElement:r}class vu{}let wp=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function hg(){const r=yn(),l=X(qr().index,r);return(Gr(l)?l:r)[11]}(),r})(),K_=(()=>{class r{}return r.\u0275prov=Ln({token:r,providedIn:"root",factory:()=>null}),r})();class Uc{constructor(s){this.full=s,this.major=s.split(".")[0],this.minor=s.split(".")[1],this.patch=s.split(".").slice(2).join(".")}}const Ud=new Uc("14.1.1"),cd={};function Ep(r){return r.ngOriginalError}class $d{constructor(){this._console=console}handleError(s){const l=this._findOriginalError(s);this._console.error("ERROR",s),l&&this._console.error("ORIGINAL ERROR",l)}_findOriginalError(s){let l=s&&Ep(s);for(;l&&Ep(l);)l=Ep(l);return l||null}}const Dp=new Map;let J_=0;const Lh="__ngContext__";function Js(r,s){Gr(s)?(r[Lh]=s[20],function yg(r){Dp.set(r[20],r)}(s)):r[Lh]=s}function Fh(r){const s=r[Lh];return"number"==typeof s?function Tp(r){return Dp.get(r)||null}(s):s||null}function Gf(r){const s=Fh(r);return s?Gr(s)?s:s.lView:null}const ny=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(de))();function xg(r){return r.ownerDocument.defaultView}function Gc(r){return r instanceof Function?r():r}var Ta=(()=>((Ta=Ta||{})[Ta.Important=1]="Important",Ta[Ta.DashCase=2]="DashCase",Ta))();function Pp(r,s){return undefined(r,s)}function Mu(r){const s=r[3];return ao(s)?s[3]:s}function hd(r){return kp(r[13])}function Yf(r){return kp(r[4])}function kp(r){for(;null!==r&&!ao(r);)r=r[4];return r}function Ml(r,s,l,m,x){if(null!=m){let M,P=!1;ao(m)?M=m:Gr(m)&&(P=!0,m=m[0]);const N=Qr(m);0===r&&null!==l?null==x?Jf(s,l,N):fd(s,l,N,x||null,!0):1===r&&null!==l?fd(s,l,N,x||null,!0):2===r?function im(r,s,l){const m=Tu(r,s);m&&function jh(r,s,l,m){r.removeChild(s,l,m)}(r,m,s,l)}(s,N,P):3===r&&s.destroyNode(N),null!=M&&function py(r,s,l,m,x){const M=l[7];M!==Qr(l)&&Ml(s,r,m,M,x);for(let N=10;N<l.length;N++){const G=l[N];Jd(G[1],G,r,s,m,M)}}(s,r,M,l,x)}}function qd(r,s,l){return r.createElement(s,l)}function Eg(r,s){const l=r[9],m=l.indexOf(s),x=s[3];512&s[2]&&(s[2]&=-513,xn(x,-1)),l.splice(m,1)}function Xf(r,s){if(r.length<=10)return;const l=10+s,m=r[l];if(m){const x=m[17];null!==x&&x!==r&&Eg(x,m),s>0&&(r[l-1][4]=m[4]);const M=Q(r,10+s);!function ay(r,s){Jd(r,s,s[11],2,null,null),s[0]=null,s[6]=null}(m[1],m);const P=M[19];null!==P&&P.detachView(M[1]),m[3]=null,m[4]=null,m[2]&=-65}return m}function Qf(r,s){if(!(128&s[2])){const l=s[11];l.destroyNode&&Jd(r,s,l,3,null,null),function cy(r){let s=r[13];if(!s)return Rp(r[1],r);for(;s;){let l=null;if(Gr(s))l=s[13];else{const m=s[10];m&&(l=m)}if(!l){for(;s&&!s[4]&&s!==r;)Gr(s)&&Rp(s[1],s),s=s[3];null===s&&(s=r),Gr(s)&&Rp(s[1],s),l=s&&s[4]}s=l}}(s)}}function Rp(r,s){if(!(128&s[2])){s[2]&=-65,s[2]|=128,function Mg(r,s){let l;if(null!=r&&null!=(l=r.destroyHooks))for(let m=0;m<l.length;m+=2){const x=s[l[m]];if(!(x instanceof Rr)){const M=l[m+1];if(Array.isArray(M))for(let P=0;P<M.length;P+=2){const N=x[M[P]],G=M[P+1];try{G.call(N)}finally{}}else try{M.call(x)}finally{}}}}(r,s),function uy(r,s){const l=r.cleanup,m=s[7];let x=-1;if(null!==l)for(let M=0;M<l.length-1;M+=2)if("string"==typeof l[M]){const P=l[M+1],N="function"==typeof P?P(s):Qr(s[P]),G=m[x=l[M+2]],re=l[M+3];"boolean"==typeof re?N.removeEventListener(l[M],G,re):re>=0?m[x=re]():m[x=-re].unsubscribe(),M+=2}else{const P=m[x=l[M+1]];l[M].call(P)}if(null!==m){for(let M=x+1;M<m.length;M++)(0,m[M])();s[7]=null}}(r,s),1===s[1].type&&s[11].destroy();const l=s[17];if(null!==l&&ao(s[3])){l!==s[3]&&Eg(l,s);const m=s[19];null!==m&&m.detachView(r)}!function Sp(r){Dp.delete(r[20])}(s)}}function Du(r,s,l){return function Uh(r,s,l){let m=s;for(;null!==m&&40&m.type;)m=(s=m).parent;if(null===m)return l[0];if(2&m.flags){const x=r.data[m.directiveStart].encapsulation;if(x===ce.None||x===ce.Emulated)return null}return vo(m,l)}(r,s.parent,l)}function fd(r,s,l,m,x){r.insertBefore(s,l,m,x)}function Jf(r,s,l){r.appendChild(s,l)}function Yd(r,s,l,m,x){null!==m?fd(r,s,l,m,x):Jf(r,s,l)}function Tu(r,s){return r.parentNode(s)}function tm(r,s,l){return Dg(r,s,l)}let Dg=function nm(r,s,l){return 40&r.type?vo(r,l):null};function md(r,s,l,m){const x=Du(r,m,s),M=s[11],N=tm(m.parent||s[6],m,s);if(null!=x)if(Array.isArray(l))for(let G=0;G<l.length;G++)Yd(M,x,l[G],N,!1);else Yd(M,x,l,N,!1)}function Ds(r,s){if(null!==s){const l=s.type;if(3&l)return vo(s,r);if(4&l)return gd(-1,r[s.index]);if(8&l){const m=s.child;if(null!==m)return Ds(r,m);{const x=r[s.index];return ao(x)?gd(-1,x):Qr(x)}}if(32&l)return Pp(s,r)()||Qr(r[s.index]);{const m=Xd(r,s);return null!==m?Array.isArray(m)?m[0]:Ds(Mu(r[16]),m):Ds(r,s.next)}}return null}function Xd(r,s){return null!==s?r[16][6].projection[s.projection]:null}function gd(r,s){const l=10+r+1;if(l<s.length){const m=s[l],x=m[1].firstChild;if(null!==x)return Ds(m,x)}return s[7]}function Qd(r,s,l,m,x,M,P){for(;null!=l;){const N=m[l.index],G=l.type;if(P&&0===s&&(N&&Js(Qr(N),m),l.flags|=4),64!=(64&l.flags))if(8&G)Qd(r,s,l.child,m,x,M,!1),Ml(s,r,x,N,M);else if(32&G){const re=Pp(l,m);let ve;for(;ve=re();)Ml(s,r,x,ve,M);Ml(s,r,x,N,M)}else 16&G?Tg(r,s,m,l,x,M):Ml(s,r,x,N,M);l=P?l.projectionNext:l.next}}function Jd(r,s,l,m,x,M){Qd(l,m,r.firstChild,s,x,M,!1)}function Tg(r,s,l,m,x,M){const P=l[16],G=P[6].projection[m.projection];if(Array.isArray(G))for(let re=0;re<G.length;re++)Ml(s,r,x,G[re],M);else Qd(r,s,G,P[3],x,M,!0)}function Sg(r,s,l){r.setAttribute(s,"style",l)}function Lp(r,s,l){""===l?r.removeAttribute(s,"class"):r.setAttribute(s,"class",l)}function eh(r,s,l){let m=r.length;for(;;){const x=r.indexOf(s,l);if(-1===x)return x;if(0===x||r.charCodeAt(x-1)<=32){const M=s.length;if(x+M===m||r.charCodeAt(x+M)<=32)return x}l=x+1}}const rm="ng-template";function Ag(r,s,l){let m=0;for(;m<r.length;){let x=r[m++];if(l&&"class"===x){if(x=r[m],-1!==eh(x.toLowerCase(),s,0))return!0}else if(1===x){for(;m<r.length&&"string"==typeof(x=r[m++]);)if(x.toLowerCase()===s)return!0;return!1}}return!1}function om(r){return 4===r.type&&r.value!==rm}function gy(r,s,l){return s===(4!==r.type||l?r.value:rm)}function Ig(r,s,l){let m=4;const x=r.attrs||[],M=function Og(r){for(let s=0;s<r.length;s++)if(kl(r[s]))return s;return r.length}(x);let P=!1;for(let N=0;N<s.length;N++){const G=s[N];if("number"!=typeof G){if(!P)if(4&m){if(m=2|1&m,""!==G&&!gy(r,G,l)||""===G&&1===s.length){if(Yl(m))return!1;P=!0}}else{const re=8&m?G:s[++N];if(8&m&&null!==r.attrs){if(!Ag(r.attrs,re,l)){if(Yl(m))return!1;P=!0}continue}const Ze=_y(8&m?"class":G,x,om(r),l);if(-1===Ze){if(Yl(m))return!1;P=!0;continue}if(""!==re){let Pt;Pt=Ze>M?"":x[Ze+1].toLowerCase();const qt=8&m?Pt:null;if(qt&&-1!==eh(qt,re,0)||2&m&&re!==Pt){if(Yl(m))return!1;P=!0}}}}else{if(!P&&!Yl(m)&&!Yl(G))return!1;if(P&&Yl(G))continue;P=!1,m=G|1&m}}return Yl(m)||P}function Yl(r){return 0==(1&r)}function _y(r,s,l,m){if(null===s)return-1;let x=0;if(m||!l){let M=!1;for(;x<s.length;){const P=s[x];if(P===r)return x;if(3===P||6===P)M=!0;else{if(1===P||2===P){let N=s[++x];for(;"string"==typeof N;)N=s[++x];continue}if(4===P)break;if(0===P){x+=4;continue}}x+=M?1:2}return-1}return function Bs(r,s){let l=r.indexOf(4);if(l>-1)for(l++;l<r.length;){const m=r[l];if("number"==typeof m)return-1;if(m===s)return l;l++}return-1}(s,r)}function Hh(r,s,l=!1){for(let m=0;m<s.length;m++)if(Ig(r,s[m],l))return!0;return!1}function yc(r,s){e:for(let l=0;l<s.length;l++){const m=s[l];if(r.length===m.length){for(let x=0;x<r.length;x++)if(r[x]!==m[x])continue e;return!0}}return!1}function Fp(r,s){return r?":not("+s.trim()+")":s}function Bp(r){let s=r[0],l=1,m=2,x="",M=!1;for(;l<r.length;){let P=r[l];if("string"==typeof P)if(2&m){const N=r[++l];x+="["+P+(N.length>0?'="'+N+'"':"")+"]"}else 8&m?x+="."+P:4&m&&(x+=" "+P);else""!==x&&!Yl(P)&&(s+=Fp(M,x),x=""),m=P,M=M||!Yl(m);l++}return""!==x&&(s+=Fp(M,x)),s}const ar={};function nh(r){kg(ji(),yn(),Qo()+r,!1)}function kg(r,s,l,m){if(!m)if(3==(3&s[2])){const M=r.preOrderCheckHooks;null!==M&&Ea(s,M,l)}else{const M=r.preOrderHooks;null!==M&&Ma(s,M,0,l)}xs(l)}function _d(r,s=null,l=null,m){const x=sm(r,s,l,m);return x.resolveInjectorInitializers(),x}function sm(r,s=null,l=null,m,x=new Set){const M=[l||_n,lg(r)];return m=m||("object"==typeof r?void 0:ye(r)),new kf(M,s||Ph(),m||null,x)}let yd=(()=>{class r{static create(l,m){if(Array.isArray(l))return _d({name:""},m,l,"");{const x=l.name??"";return _d({name:x},l.parent,l.providers,x)}}}return r.THROW_IF_NOT_FOUND=w,r.NULL=new No,r.\u0275prov=Ln({token:r,providedIn:"any",factory:()=>we(dl)}),r.__NG_ELEMENT_ID__=-1,r})();function vd(r,s=En.Default){const l=yn();return null===l?we(r,s):Gu(qr(),l,Pe(r),s)}function pm(){throw new Error("invalid")}function Yh(r,s){return r<<17|s<<2}function Dl(r){return r>>17&32767}function mm(r){return 2|r}function bc(r){return(131068&r)>>2}function Up(r,s){return-131069&r|s<<2}function Au(r){return 1|r}function ea(r,s){const l=r.contentQueries;if(null!==l)for(let m=0;m<l.length;m+=2){const x=l[m],M=l[m+1];if(-1!==M){const P=r.data[M];Pl(x),P.contentQueries(2,s[M],M)}}}function Iu(r,s,l,m,x,M,P,N,G,re,ve){const Ze=s.blueprint.slice();return Ze[0]=x,Ze[2]=76|m,(null!==ve||r&&1024&r[2])&&(Ze[2]|=1024),sn(Ze),Ze[3]=Ze[15]=r,Ze[8]=l,Ze[10]=P||r&&r[10],Ze[11]=N||r&&r[11],Ze[12]=G||r&&r[12]||null,Ze[9]=re||r&&r[9]||null,Ze[6]=M,Ze[20]=function ey(){return J_++}(),Ze[21]=ve,Ze[16]=2==s.type?r[16]:Ze,Ze}function xd(r,s,l,m,x){let M=r.data[s];if(null===M)M=function Wp(r,s,l,m,x){const M=ol(),P=$(),G=r.data[s]=function Yp(r,s,l,m,x,M){return{type:l,index:m,insertBeforeIndex:null,injectorIndex:s?s.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:x,attrs:M,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:s,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,P?M:M&&M.parent,l,s,m,x);return null===r.firstChild&&(r.firstChild=G),null!==M&&(P?null==M.child&&null!==G.parent&&(M.child=G):null===M.next&&(M.next=G)),G}(r,s,l,m,x),function zu(){return nn.lFrame.inI18n}()&&(M.flags|=64);else if(64&M.type){M.type=l,M.value=m,M.attrs=x;const P=function ne(){const r=nn.lFrame,s=r.currentTNode;return r.isParent?s:s.parent}();M.injectorIndex=null===P?-1:P.injectorIndex}return q(M,!0),M}function Zc(r,s,l,m){if(0===l)return-1;const x=s.length;for(let M=0;M<l;M++)s.push(m),r.blueprint.push(m),r.data.push(null);return x}function Jh(r,s,l){Vu(s);try{const m=r.viewQuery;null!==m&&xo(1,m,l);const x=r.template;null!==x&&t_(r,s,x,1,l),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&ea(r,s),r.staticViewQueries&&xo(2,r.viewQuery,l);const M=r.components;null!==M&&function Zp(r,s){for(let l=0;l<s.length;l++)p_(r,s[l])}(s,M)}catch(m){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),m}finally{s[2]&=-5,to()}}function dh(r,s,l,m){const x=s[2];if(128!=(128&x)){Vu(s);try{sn(s),function ru(r){return nn.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==l&&t_(r,s,l,2,m);const P=3==(3&x);if(P){const re=r.preOrderCheckHooks;null!==re&&Ea(s,re,null)}else{const re=r.preOrderHooks;null!==re&&Ma(s,re,0,null),ws(s,0)}if(function zy(r){for(let s=hd(r);null!==s;s=Yf(s)){if(!s[2])continue;const l=s[9];for(let m=0;m<l.length;m++){const x=l[m],M=x[3];0==(512&x[2])&&xn(M,1),x[2]|=512}}}(s),function By(r){for(let s=hd(r);null!==s;s=Yf(s))for(let l=10;l<s.length;l++){const m=s[l],x=m[1];J(m)&&dh(x,m,x.template,m[8])}}(s),null!==r.contentQueries&&ea(r,s),P){const re=r.contentCheckHooks;null!==re&&Ea(s,re)}else{const re=r.contentHooks;null!==re&&Ma(s,re,1),ws(s,1)}!function Jg(r,s){const l=r.hostBindingOpCodes;if(null!==l)try{for(let m=0;m<l.length;m++){const x=l[m];if(x<0)xs(~x);else{const M=x,P=l[++m],N=l[++m];Ac(P,M),N(2,s[M])}}}finally{xs(-1)}}(r,s);const N=r.components;null!==N&&function e_(r,s){for(let l=0;l<s.length;l++)Ny(r,s[l])}(s,N);const G=r.viewQuery;if(null!==G&&xo(2,G,m),P){const re=r.viewCheckHooks;null!==re&&Ea(s,re)}else{const re=r.viewHooks;null!==re&&Ma(s,re,2),ws(s,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),s[2]&=-41,512&s[2]&&(s[2]&=-513,xn(s[3],-1))}finally{to()}}}function ky(r,s,l,m){const x=s[10],P=be(s);try{!P&&x.begin&&x.begin(),P&&Jh(r,s,m),dh(r,s,l,m)}finally{!P&&x.end&&x.end()}}function t_(r,s,l,m,x){const M=Qo(),P=2&m;try{xs(-1),P&&s.length>22&&kg(r,s,22,!1),l(m,x)}finally{xs(M)}}function Em(r,s,l){if(xa(s)){const x=s.directiveEnd;for(let M=s.directiveStart;M<x;M++){const P=r.data[M];P.contentQueries&&P.contentQueries(1,l[M],M)}}}function wc(r,s,l){!Dr()||(function Ly(r,s,l,m){const x=l.directiveStart,M=l.directiveEnd;r.firstCreatePass||Fl(l,s),Js(m,s);const P=l.initialInputs;for(let N=x;N<M;N++){const G=r.data[N],re=Ko(G);re&&Tm(s,l,G);const ve=Za(s,r,N,l);Js(ve,s),null!==P&&io(0,N-x,ve,G,0,P),re&&(X(l.index,s)[8]=ve)}}(r,s,l,vo(l,s)),128==(128&l.flags)&&function c_(r,s,l){const m=l.directiveStart,x=l.directiveEnd,M=l.index,P=function Nu(){return nn.lFrame.currentDirectiveIndex}();try{xs(M);for(let N=m;N<x;N++){const G=r.data[N],re=s[N];tc(N),(null!==G.hostBindings||0!==G.hostVars||null!==G.hostAttrs)&&u_(G,re)}}finally{xs(-1),tc(P)}}(r,s,l))}function Mm(r,s,l=vo){const m=s.localNames;if(null!==m){let x=s.index+1;for(let M=0;M<m.length;M+=2){const P=m[M+1],N=-1===P?l(s,r):r[P];r[x++]=N}}}function Wc(r){const s=r.tView;return null===s||s.incompleteFirstPass?r.tView=Dm(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):s}function Dm(r,s,l,m,x,M,P,N,G,re){const ve=22+m,Ze=ve+x,Pt=function ep(r,s){const l=[];for(let m=0;m<s;m++)l.push(m<r?null:ar);return l}(ve,Ze),qt="function"==typeof re?re():re;return Pt[1]={type:r,blueprint:Pt,template:l,queries:null,viewQuery:N,declTNode:s,data:Pt.slice().fill(null,ve),bindingStartIndex:ve,expandoStartIndex:Ze,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof M?M():M,pipeRegistry:"function"==typeof P?P():P,firstChild:null,schemas:G,consts:qt,incompleteFirstPass:!1}}function ph(r,s,l,m){const x=Ai(s);null===l?x.push(m):(x.push(l),r.firstCreatePass&&Ji(r).push(m,x.length-1))}function n_(r,s,l){for(let m in r)if(r.hasOwnProperty(m)){const x=r[m];(l=null===l?{}:l).hasOwnProperty(m)?l[m].push(s,x):l[m]=[s,x]}return l}function i_(r,s){const m=s.directiveEnd,x=r.data,M=s.attrs,P=[];let N=null,G=null;for(let re=s.directiveStart;re<m;re++){const ve=x[re],Ze=ve.inputs,Pt=null===M||om(s)?null:np(Ze,M);P.push(Pt),N=n_(Ze,re,N),G=n_(ve.outputs,re,G)}null!==N&&(N.hasOwnProperty("class")&&(s.flags|=16),N.hasOwnProperty("style")&&(s.flags|=32)),s.initialInputs=P,s.inputs=N,s.outputs=G}function ya(r,s,l,m,x,M,P,N){const G=vo(s,l);let ve,re=s.inputs;!N&&null!=re&&(ve=re[m])?(Aa(r,l,ve,m,x),ys(s)&&r_(l,s.index)):3&s.type&&(m=function wd(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(m),x=null!=P?P(x,s.value||"",m):x,M.setProperty(G,m,x))}function r_(r,s){const l=X(s,r);16&l[2]||(l[2]|=32)}function Kp(r,s,l,m){let x=!1;if(Dr()){const M=function Fy(r,s,l){const m=r.directiveRegistry;let x=null;if(m)for(let M=0;M<m.length;M++){const P=m[M];Hh(l,P.selectors,!1)&&(x||(x=[]),Ha(Fl(l,s),r,P.type),Ko(P)?(tp(r,l),x.unshift(P)):x.push(P))}return x}(r,s,l),P=null===m?null:{"":-1};if(null!==M){x=!0,d_(l,r.data.length,M.length);for(let ve=0;ve<M.length;ve++){const Ze=M[ve];Ze.providersResolver&&Ze.providersResolver(Ze)}let N=!1,G=!1,re=Zc(r,s,M.length,null);for(let ve=0;ve<M.length;ve++){const Ze=M[ve];l.mergedAttrs=Rl(l.mergedAttrs,Ze.hostAttrs),Jp(r,l,s,re,Ze),Qp(re,Ze,P),null!==Ze.contentQueries&&(l.flags|=8),(null!==Ze.hostBindings||null!==Ze.hostAttrs||0!==Ze.hostVars)&&(l.flags|=128);const Pt=Ze.type.prototype;!N&&(Pt.ngOnChanges||Pt.ngOnInit||Pt.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(l.index),N=!0),!G&&(Pt.ngOnChanges||Pt.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(l.index),G=!0),re++}i_(r,l)}P&&function Xp(r,s,l){if(s){const m=r.localNames=[];for(let x=0;x<s.length;x+=2){const M=l[s[x+1]];if(null==M)throw new et(-301,!1);m.push(s[x],M)}}}(l,m,P)}return l.mergedAttrs=Rl(l.mergedAttrs,l.attrs),x}function a_(r,s,l,m,x,M){const P=M.hostBindings;if(P){let N=r.hostBindingOpCodes;null===N&&(N=r.hostBindingOpCodes=[]);const G=~s.index;(function l_(r){let s=r.length;for(;s>0;){const l=r[--s];if("number"==typeof l&&l<0)return l}return 0})(N)!=G&&N.push(G),N.push(m,x,P)}}function u_(r,s){null!==r.hostBindings&&r.hostBindings(1,s)}function tp(r,s){s.flags|=2,(r.components||(r.components=[])).push(s.index)}function Qp(r,s,l){if(l){if(s.exportAs)for(let m=0;m<s.exportAs.length;m++)l[s.exportAs[m]]=r;Ko(s)&&(l[""]=r)}}function d_(r,s,l){r.flags|=1,r.directiveStart=s,r.directiveEnd=s+l,r.providerIndexes=s}function Jp(r,s,l,m,x){r.data[m]=x;const M=x.factory||(x.factory=Fo(x.type)),P=new Rr(M,Ko(x),vd);r.blueprint[m]=P,l[m]=P,a_(r,s,0,m,Zc(r,l,x.hostVars,ar),x)}function Tm(r,s,l){const m=vo(s,r),x=Wc(l),M=r[10],P=qc(r,Iu(r,x,null,l.onPush?32:16,m,s,M,M.createRenderer(m,l),null,null,null));r[s.index]=P}function ta(r,s,l,m,x,M){const P=vo(r,s);!function Sm(r,s,l,m,x,M,P){if(null==M)r.removeAttribute(s,x,l);else{const N=null==P?Ft(M):P(M,m||"",x);r.setAttribute(s,x,N,l)}}(s[11],P,M,r.value,l,m,x)}function io(r,s,l,m,x,M){const P=M[s];if(null!==P){const N=m.setInput;for(let G=0;G<P.length;){const re=P[G++],ve=P[G++],Ze=P[G++];null!==N?m.setInput(l,Ze,re,ve):l[ve]=Ze}}}function np(r,s){let l=null,m=0;for(;m<s.length;){const x=s[m];if(0!==x)if(5!==x){if("number"==typeof x)break;r.hasOwnProperty(x)&&(null===l&&(l=[]),l.push(x,r[x],s[m+1])),m+=2}else m+=2;else m+=4}return l}function h_(r,s,l,m){return new Array(r,!0,!1,s,null,0,m,l,null,null)}function Ny(r,s){const l=X(s,r);if(J(l)){const m=l[1];48&l[2]?dh(m,l,m.template,l[8]):l[5]>0&&fh(l)}}function fh(r){for(let m=hd(r);null!==m;m=Yf(m))for(let x=10;x<m.length;x++){const M=m[x];if(512&M[2]){const P=M[1];dh(P,M,P.template,M[8])}else M[5]>0&&fh(M)}const l=r[1].components;if(null!==l)for(let m=0;m<l.length;m++){const x=X(l[m],r);J(x)&&x[5]>0&&fh(x)}}function p_(r,s){const l=X(s,r),m=l[1];(function Cd(r,s){for(let l=s.length;l<r.blueprint.length;l++)s.push(r.blueprint[l])})(m,l),Jh(m,l,l[8])}function qc(r,s){return r[13]?r[14][4]=s:r[13]=s,r[14]=s,s}function ef(r){for(;r;){r[2]|=32;const s=Mu(r);if(Jr(r)&&!s)return r;r=s}return null}function Om(r){!function Im(r){for(let s=0;s<r.components.length;s++){const l=r.components[s],m=Gf(l);if(null!==m){const x=m[1];ky(x,m,x.template,l)}}}(r[8])}function xo(r,s,l){Pl(0),s(r,l)}const Qa=(()=>Promise.resolve(null))();function Ai(r){return r[7]||(r[7]=[])}function Ji(r){return r.cleanup||(r.cleanup=[])}function ml(r,s,l){return(null===r||Ko(r))&&(l=function za(r){for(;Array.isArray(r);){if("object"==typeof r[1])return r;r=r[0]}return null}(l[s.index])),l[11]}function mh(r,s){const l=r[9],m=l?l.get($d,null):null;m&&m.handleError(s)}function Aa(r,s,l,m,x){for(let M=0;M<l.length;){const P=l[M++],N=l[M++],G=s[P],re=r.data[P];null!==re.setInput?re.setInput(G,x,m,N):G[N]=x}}function ip(r,s,l){let m=l?r.styles:null,x=l?r.classes:null,M=0;if(null!==s)for(let P=0;P<s.length;P++){const N=s[P];"number"==typeof N?M=N:1==M?x=Me(x,N):2==M&&(m=Me(m,N+": "+s[++P]+";"))}l?r.styles=m:r.stylesWithoutHost=m,l?r.classes=x:r.classesWithoutHost=x}function Ed(r,s,l,m,x=!1){for(;null!==l;){const M=s[l.index];if(null!==M&&m.push(Qr(M)),ao(M))for(let N=10;N<M.length;N++){const G=M[N],re=G[1].firstChild;null!==re&&Ed(G[1],G,re,m)}const P=l.type;if(8&P)Ed(r,s,l.child,m);else if(32&P){const N=Pp(l,s);let G;for(;G=N();)m.push(G)}else if(16&P){const N=Xd(s,l);if(Array.isArray(N))m.push(...N);else{const G=Mu(s[16]);Ed(G[1],G,N,m,!0)}}l=x?l.projectionNext:l.next}return m}class Md{constructor(s,l){this._lView=s,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const s=this._lView,l=s[1];return Ed(l,s,l.firstChild,[])}get context(){return this._lView[8]}set context(s){this._lView[8]=s}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const s=this._lView[3];if(ao(s)){const l=s[8],m=l?l.indexOf(this):-1;m>-1&&(Xf(s,m),Q(l,m))}this._attachedToViewContainer=!1}Qf(this._lView[1],this._lView)}onDestroy(s){ph(this._lView[1],this._lView,null,s)}markForCheck(){ef(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function Pm(r,s,l){const m=s[10];m.begin&&m.begin();try{dh(r,s,r.template,l)}catch(x){throw mh(s,x),x}finally{m.end&&m.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new et(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ly(r,s){Jd(r,s,s[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(s){if(this._attachedToViewContainer)throw new et(902,!1);this._appRef=s}}class m_ extends Md{constructor(s){super(s),this._view=s}detectChanges(){Om(this._view)}checkNoChanges(){}get context(){return null}}class tf extends Ls{constructor(s){super(),this.ngModule=s}resolveComponentFactory(s){const l=Xe(s);return new gh(l,this.ngModule)}}function km(r){const s=[];for(let l in r)r.hasOwnProperty(l)&&s.push({propName:r[l],templateName:l});return s}class Pu{constructor(s,l){this.injector=s,this.parentInjector=l}get(s,l,m){const x=this.injector.get(s,cd,m);return x!==cd||l===cd?x:this.parentInjector.get(s,l,m)}}class gh extends Ff{constructor(s,l){super(),this.componentDef=s,this.ngModule=l,this.componentType=s.type,this.selector=function th(r){return r.map(Bp).join(",")}(s.selectors),this.ngContentSelectors=s.ngContentSelectors?s.ngContentSelectors:[],this.isBoundToModule=!!l}get inputs(){return km(this.componentDef.inputs)}get outputs(){return km(this.componentDef.outputs)}create(s,l,m,x){let M=(x=x||this.ngModule)instanceof od?x:x?.injector;M&&null!==this.componentDef.getStandaloneInjector&&(M=this.componentDef.getStandaloneInjector(M)||M);const P=M?new Pu(s,M):s,N=P.get(vu,null);if(null===N)throw new et(407,!1);const G=P.get(K_,null),re=N.createRenderer(null,this.componentDef),ve=this.componentDef.selectors[0][0]||"div",Ze=m?function hh(r,s,l){return r.selectRootElement(s,l===ce.ShadowDom)}(re,m,this.componentDef.encapsulation):qd(N.createRenderer(null,this.componentDef),ve,function g_(r){const s=r.toLowerCase();return"svg"===s?"svg":"math"===s?"math":null}(ve)),Pt=this.componentDef.onPush?288:272,qt=function nf(r,s){return{components:[],scheduler:r||ny,clean:Qa,playerHandler:s||null,flags:0}}(),Mn=Dm(0,null,null,1,0,null,null,null,null,null),Wn=Iu(null,Mn,qt,Pt,null,null,N,re,G,P,null);let ui,Mi;Vu(Wn);try{const tr=function Lm(r,s,l,m,x,M){const P=l[1];l[22]=r;const G=xd(P,22,2,"#host",null),re=G.mergedAttrs=s.hostAttrs;null!==re&&(ip(G,re,!0),null!==r&&(Ua(x,r,re),null!==G.classes&&Lp(x,r,G.classes),null!==G.styles&&Sg(x,r,G.styles)));const ve=m.createRenderer(r,s),Ze=Iu(l,Wc(s),null,s.onPush?32:16,l[22],G,m,ve,M||null,null,null);return P.firstCreatePass&&(Ha(Fl(G,l),P,s.type),tp(P,G),d_(G,l.length,1)),qc(l,Ze),l[22]=Ze}(Ze,this.componentDef,Wn,N,re);if(Ze)if(m)Ua(re,Ze,["ng-version",Ud.full]);else{const{attrs:Rn,classes:Zi}=function yy(r){const s=[],l=[];let m=1,x=2;for(;m<r.length;){let M=r[m];if("string"==typeof M)2===x?""!==M&&s.push(M,r[++m]):8===x&&l.push(M);else{if(!Yl(x))break;x=M}m++}return{attrs:s,classes:l}}(this.componentDef.selectors[0]);Rn&&Ua(re,Ze,Rn),Zi&&Zi.length>0&&Lp(re,Ze,Zi.join(" "))}if(Mi=da(Mn,22),void 0!==l){const Rn=Mi.projection=[];for(let Zi=0;Zi<this.ngContentSelectors.length;Zi++){const Ur=l[Zi];Rn.push(null!=Ur?Array.from(Ur):null)}}ui=function Ec(r,s,l,m,x){const M=l[1],P=function Ry(r,s,l){const m=qr();r.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),Jp(r,m,s,Zc(r,s,1,null),l),i_(r,m));const x=Za(s,r,m.directiveStart,m);Js(x,s);const M=vo(m,s);return M&&Js(M,s),x}(M,l,s);if(m.components.push(P),r[8]=P,null!==x)for(const G of x)G(P,s);if(s.contentQueries){const G=qr();s.contentQueries(1,P,G.directiveStart)}const N=qr();return!M.firstCreatePass||null===s.hostBindings&&null===s.hostAttrs||(xs(N.index),a_(l[1],N,0,N.directiveStart,N.directiveEnd,s),u_(s,P)),P}(tr,this.componentDef,Wn,qt,[rf]),Jh(Mn,Wn,null)}finally{to()}return new Dd(this.componentType,ui,Ms(Mi,Wn),Wn,Mi)}}class Dd extends class bp{}{constructor(s,l,m,x,M){super(),this.location=m,this._rootLView=x,this._tNode=M,this.instance=l,this.hostView=this.changeDetectorRef=new m_(x),this.componentType=s}setInput(s,l){const m=this._tNode.inputs;let x;if(null!==m&&(x=m[s])){const M=this._rootLView;Aa(M[1],M,x,s,l),r_(M,this._tNode.index)}}get injector(){return new Ks(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(s){this.hostView.onDestroy(s)}}function rf(){const r=qr();Ol(yn()[1],r)}function sf(r){let s=function Xc(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),l=!0;const m=[r];for(;s;){let x;if(Ko(r))x=s.\u0275cmp||s.\u0275dir;else{if(s.\u0275cmp)throw new et(903,!1);x=s.\u0275dir}if(x){if(l){m.push(x);const P=r;P.inputs=Td(r.inputs),P.declaredInputs=Td(r.declaredInputs),P.outputs=Td(r.outputs);const N=x.hostBindings;N&&Fm(r,N);const G=x.viewQuery,re=x.contentQueries;if(G&&af(r,G),re&&y_(r,re),Je(r.inputs,x.inputs),Je(r.declaredInputs,x.declaredInputs),Je(r.outputs,x.outputs),Ko(x)&&x.data.animation){const ve=r.data;ve.animation=(ve.animation||[]).concat(x.data.animation)}}const M=x.features;if(M)for(let P=0;P<M.length;P++){const N=M[P];N&&N.ngInherit&&N(r),N===sf&&(l=!1)}}s=Object.getPrototypeOf(s)}!function __(r){let s=0,l=null;for(let m=r.length-1;m>=0;m--){const x=r[m];x.hostVars=s+=x.hostVars,x.hostAttrs=Rl(x.hostAttrs,l=Rl(l,x.hostAttrs))}}(m)}function Td(r){return r===Qt?{}:r===_n?[]:r}function af(r,s){const l=r.viewQuery;r.viewQuery=l?(m,x)=>{s(m,x),l(m,x)}:s}function y_(r,s){const l=r.contentQueries;r.contentQueries=l?(m,x,M)=>{s(m,x,M),l(m,x,M)}:s}function Fm(r,s){const l=r.hostBindings;r.hostBindings=l?(m,x)=>{s(m,x),l(m,x)}:s}let _h=null;function Qc(){if(!_h){const r=de.Symbol;if(r&&r.iterator)_h=r.iterator;else{const s=Object.getOwnPropertyNames(Map.prototype);for(let l=0;l<s.length;++l){const m=s[l];"entries"!==m&&"size"!==m&&Map.prototype[m]===Map.prototype.entries&&(_h=m)}}}return _h}function n(r){return!!a(r)&&(Array.isArray(r)||!(r instanceof Map)&&Qc()in r)}function a(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function g(r,s,l){return r[s]=l}function C(r,s,l){return!Object.is(r[s],l)&&(r[s]=l,!0)}function D(r,s,l,m){const x=C(r,s,l);return C(r,s+1,m)||x}function V(r,s,l,m){const x=yn();return C(x,sl(),s)&&(ji(),ta(ir(),x,r,s,l,m)),V}function ee(r,s,l,m){return C(r,sl(),l)?s+Ft(l)+m:ar}function $n(r,s,l,m,x,M,P,N){const G=yn(),re=ji(),ve=r+22,Ze=re.firstCreatePass?function wn(r,s,l,m,x,M,P,N,G){const re=s.consts,ve=xd(s,r,4,P||null,vt(re,N));Kp(s,l,ve,vt(re,G)),Ol(s,ve);const Ze=ve.tViews=Dm(2,ve,m,x,M,s.directiveRegistry,s.pipeRegistry,null,s.schemas,re);return null!==s.queries&&(s.queries.template(s,ve),Ze.queries=s.queries.embeddedTView(ve)),ve}(ve,re,G,s,l,m,x,M,P):re.data[ve];q(Ze,!1);const Pt=G[11].createComment("");md(re,G,Pt,Ze),Js(Pt,G),qc(G,G[ve]=h_(Pt,G,Pt,Ze)),Vs(Ze)&&wc(re,G,Ze),null!=P&&Mm(G,Ze,N)}function qi(r){return Li(function Ci(){return nn.lFrame.contextLView}(),22+r)}function gi(r,s,l){const m=yn();return C(m,sl(),s)&&ya(ji(),ir(),m,r,s,m[11],l,!1),gi}function Qn(r,s,l,m,x){const P=x?"class":"style";Aa(r,l,s.inputs[P],P,m)}function $i(r,s,l,m){const x=yn(),M=ji(),P=22+r,N=x[11],G=x[P]=qd(N,s,function ll(){return nn.lFrame.currentNamespace}()),re=M.firstCreatePass?function lr(r,s,l,m,x,M,P){const N=s.consts,re=xd(s,r,2,x,vt(N,M));return Kp(s,l,re,vt(N,P)),null!==re.attrs&&ip(re,re.attrs,!1),null!==re.mergedAttrs&&ip(re,re.mergedAttrs,!0),null!==s.queries&&s.queries.elementStart(s,re),re}(P,M,x,0,s,l,m):M.data[P];q(re,!0);const ve=re.mergedAttrs;null!==ve&&Ua(N,G,ve);const Ze=re.classes;null!==Ze&&Lp(N,G,Ze);const Pt=re.styles;return null!==Pt&&Sg(N,G,Pt),64!=(64&re.flags)&&md(M,x,G,re),0===function _r(){return nn.lFrame.elementDepthCount}()&&Js(G,x),function Vi(){nn.lFrame.elementDepthCount++}(),Vs(re)&&(wc(M,x,re),Em(M,re,x)),null!==m&&Mm(x,re),$i}function ai(){let r=qr();$()?me():(r=r.parent,q(r,!1));const s=r;!function kr(){nn.lFrame.elementDepthCount--}();const l=ji();return l.firstCreatePass&&(Ol(l,r),xa(r)&&l.queries.elementEnd(r)),null!=s.classesWithoutHost&&function bo(r){return 0!=(16&r.flags)}(s)&&Qn(l,s,yn(),s.classesWithoutHost,!0),null!=s.stylesWithoutHost&&function ju(r){return 0!=(32&r.flags)}(s)&&Qn(l,s,yn(),s.stylesWithoutHost,!1),ai}function Oo(r,s,l,m){return $i(r,s,l,m),ai(),Oo}function ro(r,s,l){const m=yn(),x=ji(),M=r+22,P=x.firstCreatePass?function ko(r,s,l,m,x){const M=s.consts,P=vt(M,m),N=xd(s,r,8,"ng-container",P);return null!==P&&ip(N,P,!0),Kp(s,l,N,vt(M,x)),null!==s.queries&&s.queries.elementStart(s,N),N}(M,x,m,s,l):x.data[M];q(P,!0);const N=m[M]=m[11].createComment("");return md(x,m,N,P),Js(N,m),Vs(P)&&(wc(x,m,P),Em(x,P,m)),null!=l&&Mm(m,P),ro}function er(){let r=qr();const s=ji();return $()?me():(r=r.parent,q(r,!1)),s.firstCreatePass&&(Ol(s,r),xa(r)&&s.queries.elementEnd(r)),er}function pr(r,s,l){return ro(r,s,l),er(),pr}function Nr(){return yn()}function Pr(r){return!!r&&"function"==typeof r.then}function Or(r){return!!r&&"function"==typeof r.subscribe}const Yr=Or;function Kr(r,s,l,m){const x=yn(),M=ji(),P=qr();return dr(M,x,x[11],P,r,s,0,m),Kr}function ts(r,s){const l=qr(),m=yn(),x=ji();return dr(x,m,ml(nc(x.data),l,m),l,r,s),ts}function dr(r,s,l,m,x,M,P,N){const G=Vs(m),ve=r.firstCreatePass&&Ji(r),Ze=s[8],Pt=Ai(s);let qt=!0;if(3&m.type||N){const ui=vo(m,s),Mi=N?N(ui):ui,tr=Pt.length,Rn=N?Ur=>N(Qr(Ur[m.index])):m.index;let Zi=null;if(!N&&G&&(Zi=function Ia(r,s,l,m){const x=r.cleanup;if(null!=x)for(let M=0;M<x.length-1;M+=2){const P=x[M];if(P===l&&x[M+1]===m){const N=s[7],G=x[M+2];return N.length>G?N[G]:null}"string"==typeof P&&(M+=2)}return null}(r,s,x,m.index)),null!==Zi)(Zi.__ngLastListenerFn__||Zi).__ngNextListenerFn__=M,Zi.__ngLastListenerFn__=M,qt=!1;else{M=zs(m,s,Ze,M,!1);const Ur=l.listen(Mi,x,M);Pt.push(M,Ur),ve&&ve.push(x,Rn,tr,tr+1)}}else M=zs(m,s,Ze,M,!1);const Mn=m.outputs;let Wn;if(qt&&null!==Mn&&(Wn=Mn[x])){const ui=Wn.length;if(ui)for(let Mi=0;Mi<ui;Mi+=2){const ss=s[Wn[Mi]][Wn[Mi+1]].subscribe(M),Jm=Pt.length;Pt.push(M,ss),ve&&ve.push(x,m.index,Jm,-(Jm+1))}}}function go(r,s,l,m){try{return!1!==l(m)}catch(x){return mh(r,x),!1}}function zs(r,s,l,m,x){return function M(P){if(P===Function)return m;ef(2&r.flags?X(r.index,s):s);let G=go(s,0,m,P),re=M.__ngNextListenerFn__;for(;re;)G=go(s,0,re,P)&&G,re=re.__ngNextListenerFn__;return x&&!1===G&&(P.preventDefault(),P.returnValue=!1),G}}function Mr(r=1){return function rc(r){return(nn.lFrame.contextLView=function Na(r,s){for(;r>0;)s=s[15],r--;return s}(r,nn.lFrame.contextLView))[8]}(r)}function ho(r,s){let l=null;const m=function Pg(r){const s=r.attrs;if(null!=s){const l=s.indexOf(5);if(0==(1&l))return s[l+1]}return null}(r);for(let x=0;x<s.length;x++){const M=s[x];if("*"!==M){if(null===m?Hh(r,M,!0):yc(m,M))return x}else l=x}return l}function na(r){const s=yn()[16][6];if(!s.projection){const m=s.projection=ge(r?r.length:1,null),x=m.slice();let M=s.child;for(;null!==M;){const P=r?ho(M,r):0;null!==P&&(x[P]?x[P].projectionNext=M:m[P]=M,x[P]=M),M=M.next}}}function _i(r,s=0,l){const m=yn(),x=ji(),M=xd(x,22+r,16,null,l||null);null===M.projection&&(M.projection=s),me(),64!=(64&M.flags)&&function hy(r,s,l){Tg(s[11],0,s,l,Du(r,l,s),tm(l.parent||s[6],l,s))}(x,m,M)}function lf(r,s,l,m,x){const M=r[l+1],P=null===s;let N=m?Dl(M):bc(M),G=!1;for(;0!==N&&(!1===G||P);){const ve=r[N+1];Bm(r[N],s)&&(G=!0,r[N+1]=m?Au(ve):mm(ve)),N=m?Dl(ve):bc(ve)}G&&(r[l+1]=m?mm(M):Au(M))}function Bm(r,s){return null===r||null==s||(Array.isArray(r)?r[1]:r)===s||!(!Array.isArray(r)||"string"!=typeof s)&&ms(r,s)>=0}const oo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function zm(r){return r.substring(oo.key,oo.keyEnd)}function Id(r){return r.substring(oo.value,oo.valueEnd)}function cf(r,s){const l=oo.textEnd;return l===s?-1:(s=oo.keyEnd=function va(r,s,l){for(;s<l&&r.charCodeAt(s)>32;)s++;return s}(r,oo.key=s,l),Ss(r,s,l))}function uf(r,s){const l=oo.textEnd;let m=oo.key=Ss(r,s,l);return l===m?-1:(m=oo.keyEnd=function op(r,s,l){let m;for(;s<l&&(45===(m=r.charCodeAt(s))||95===m||(-33&m)>=65&&(-33&m)<=90||m>=48&&m<=57);)s++;return s}(r,m,l),m=vh(r,m,l),m=oo.value=Ss(r,m,l),m=oo.valueEnd=function w_(r,s,l){let m=-1,x=-1,M=-1,P=s,N=P;for(;P<l;){const G=r.charCodeAt(P++);if(59===G)return N;34===G||39===G?N=P=Ru(r,G,P,l):s===P-4&&85===M&&82===x&&76===m&&40===G?N=P=Ru(r,41,P,l):G>32&&(N=P),M=x,x=m,m=-33&G}return N}(r,m,l),vh(r,m,l))}function x_(r){oo.key=0,oo.keyEnd=0,oo.value=0,oo.valueEnd=0,oo.textEnd=r.length}function Ss(r,s,l){for(;s<l&&r.charCodeAt(s)<=32;)s++;return s}function vh(r,s,l,m){return(s=Ss(r,s,l))<l&&s++,s}function Ru(r,s,l,m){let x=-1,M=l;for(;M<m;){const P=r.charCodeAt(M++);if(P==s&&92!==x)return M;x=92==P&&92===x?0:P}throw new Error}function Gy(r,s,l){return eu(r,s,l,!1),Gy}function Hy(r,s){return eu(r,s,null,!0),Hy}function Jc(r){tu(kv,Bb,r,!1)}function Bb(r,s){for(let l=function ku(r){return x_(r),uf(r,Ss(r,0,oo.textEnd))}(s);l>=0;l=uf(s,l))kv(r,zm(s),Id(s))}function Iv(r){tu(rr,Lu,r,!0)}function Lu(r,s){for(let l=function Nm(r){return x_(r),cf(r,Ss(r,0,oo.textEnd))}(s);l>=0;l=cf(s,l))rr(r,zm(s),!0)}function eu(r,s,l,m){const x=yn(),M=ji(),P=al(2);M.firstUpdatePass&&Ov(M,r,P,m),s!==ar&&C(x,P,s)&&Rv(M,M.data[Qo()],x,x[11],r,x[P+1]=function Hb(r,s){return null==r||("string"==typeof s?r+=s:"object"==typeof r&&(r=ye(fc(r)))),r}(s,l),m,P)}function tu(r,s,l,m){const x=ji(),M=al(2);x.firstUpdatePass&&Ov(x,null,M,m);const P=yn();if(l!==ar&&C(P,M,l)){const N=x.data[Qo()];if(Fv(N,m)&&!Pv(x,M)){let G=m?N.classesWithoutHost:N.stylesWithoutHost;null!==G&&(l=Me(G,l||"")),Qn(x,N,P,l,m)}else!function Gb(r,s,l,m,x,M,P,N){x===ar&&(x=_n);let G=0,re=0,ve=0<x.length?x[0]:null,Ze=0<M.length?M[0]:null;for(;null!==ve||null!==Ze;){const Pt=G<x.length?x[G+1]:void 0,qt=re<M.length?M[re+1]:void 0;let Wn,Mn=null;ve===Ze?(G+=2,re+=2,Pt!==qt&&(Mn=Ze,Wn=qt)):null===Ze||null!==ve&&ve<Ze?(G+=2,Mn=ve):(re+=2,Mn=Ze,Wn=qt),null!==Mn&&Rv(r,s,l,m,Mn,Wn,P,N),ve=G<x.length?x[G]:null,Ze=re<M.length?M[re]:null}}(x,N,P,P[11],P[M+1],P[M+1]=function jb(r,s,l){if(null==l||""===l)return _n;const m=[],x=fc(l);if(Array.isArray(x))for(let M=0;M<x.length;M++)r(m,x[M],!0);else if("object"==typeof x)for(const M in x)x.hasOwnProperty(M)&&r(m,M,x[M]);else"string"==typeof x&&s(m,x);return m}(r,s,l),m,M)}}function Pv(r,s){return s>=r.expandoStartIndex}function Ov(r,s,l,m){const x=r.data;if(null===x[l+1]){const M=x[Qo()],P=Pv(r,l);Fv(M,m)&&null===s&&!P&&(s=!1),s=function zb(r,s,l,m){const x=nc(r);let M=m?s.residualClasses:s.residualStyles;if(null===x)0===(m?s.classBindings:s.styleBindings)&&(l=Vm(l=$y(null,r,s,l,m),s.attrs,m),M=null);else{const P=s.directiveStylingLast;if(-1===P||r[P]!==x)if(l=$y(x,r,s,l,m),null===M){let G=function Nb(r,s,l){const m=l?s.classBindings:s.styleBindings;if(0!==bc(m))return r[Dl(m)]}(r,s,m);void 0!==G&&Array.isArray(G)&&(G=$y(null,r,s,G[1],m),G=Vm(G,s.attrs,m),function Vb(r,s,l,m){r[Dl(l?s.classBindings:s.styleBindings)]=m}(r,s,m,G))}else M=function Ub(r,s,l){let m;const x=s.directiveEnd;for(let M=1+s.directiveStylingLast;M<x;M++)m=Vm(m,r[M].hostAttrs,l);return Vm(m,s.attrs,l)}(r,s,m)}return void 0!==M&&(m?s.residualClasses=M:s.residualStyles=M),l}(x,M,s,m),function v_(r,s,l,m,x,M){let P=M?s.classBindings:s.styleBindings,N=Dl(P),G=bc(P);r[m]=l;let ve,re=!1;if(Array.isArray(l)){const Ze=l;ve=Ze[1],(null===ve||ms(Ze,ve)>0)&&(re=!0)}else ve=l;if(x)if(0!==G){const Pt=Dl(r[N+1]);r[m+1]=Yh(Pt,N),0!==Pt&&(r[Pt+1]=Up(r[Pt+1],m)),r[N+1]=function Wg(r,s){return 131071&r|s<<17}(r[N+1],m)}else r[m+1]=Yh(N,0),0!==N&&(r[N+1]=Up(r[N+1],m)),N=m;else r[m+1]=Yh(G,0),0===N?N=m:r[G+1]=Up(r[G+1],m),G=m;re&&(r[m+1]=mm(r[m+1])),lf(r,ve,m,!0),lf(r,ve,m,!1),function b_(r,s,l,m,x){const M=x?r.residualClasses:r.residualStyles;null!=M&&"string"==typeof s&&ms(M,s)>=0&&(l[m+1]=Au(l[m+1]))}(s,ve,r,m,M),P=Yh(N,G),M?s.classBindings=P:s.styleBindings=P}(x,M,s,l,P,m)}}function $y(r,s,l,m,x){let M=null;const P=l.directiveEnd;let N=l.directiveStylingLast;for(-1===N?N=l.directiveStart:N++;N<P&&(M=s[N],m=Vm(m,M.hostAttrs,x),M!==r);)N++;return null!==r&&(l.directiveStylingLast=N),m}function Vm(r,s,l){const m=l?1:2;let x=-1;if(null!==s)for(let M=0;M<s.length;M++){const P=s[M];"number"==typeof P?x=P:x===m&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),rr(r,P,!!l||s[++M]))}return void 0===r?null:r}function kv(r,s,l){rr(r,s,fc(l))}function Rv(r,s,l,m,x,M,P,N){if(!(3&s.type))return;const G=r.data,re=G[N+1];C_(function gm(r){return 1==(1&r)}(re)?Lv(G,s,l,x,bc(re),P):void 0)||(C_(M)||function fm(r){return 2==(2&r)}(re)&&(M=Lv(G,null,l,x,N,P)),function fy(r,s,l,m,x){if(s)x?r.addClass(l,m):r.removeClass(l,m);else{let M=-1===m.indexOf("-")?void 0:Ta.DashCase;null==x?r.removeStyle(l,m,M):("string"==typeof x&&x.endsWith("!important")&&(x=x.slice(0,-10),M|=Ta.Important),r.setStyle(l,m,x,M))}}(m,P,ua(Qo(),l),x,M))}function Lv(r,s,l,m,x,M){const P=null===s;let N;for(;x>0;){const G=r[x],re=Array.isArray(G),ve=re?G[1]:G,Ze=null===ve;let Pt=l[x+1];Pt===ar&&(Pt=Ze?_n:void 0);let qt=Ze?Jo(Pt,m):ve===m?Pt:void 0;if(re&&!C_(qt)&&(qt=Jo(G,m)),C_(qt)&&(N=qt,P))return N;const Mn=r[x+1];x=P?Dl(Mn):bc(Mn)}if(null!==s){let G=M?s.residualClasses:s.residualStyles;null!=G&&(N=Jo(G,m))}return N}function C_(r){return void 0!==r}function Fv(r,s){return 0!=(r.flags&(s?16:32))}function Bv(r,s=""){const l=yn(),m=ji(),x=r+22,M=m.firstCreatePass?xd(m,x,1,s,null):m.data[x],P=l[x]=function Vh(r,s){return r.createText(s)}(l[11],s);md(m,l,P,M),q(M,!1)}function Zy(r){return E_("",r,""),Zy}function E_(r,s,l){const m=yn(),x=ee(m,r,s,l);return x!==ar&&function Kc(r,s,l){const m=ua(s,r);!function Wd(r,s,l){r.setValue(s,l)}(r[11],m,l)}(m,Qo(),x),E_}function qy(r,s,l){tu(rr,Lu,ee(yn(),r,s,l),!0)}function Yy(r,s,l){const m=yn();return C(m,sl(),s)&&ya(ji(),ir(),m,r,s,m[11],l,!0),Yy}function Ky(r,s,l){const m=yn();if(C(m,sl(),s)){const M=ji(),P=ir();ya(M,P,m,r,s,ml(nc(M.data),P,m),l,!0)}return Ky}const ap=void 0;var ax=["en",[["a","p"],["AM","PM"],ap],[["AM","PM"],ap,ap],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ap,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ap,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ap,"{1} 'at' {0}",ap],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function sx(r){const l=Math.floor(Math.abs(r)),m=r.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===m?1:5}];let df={};function Xy(r){const s=function m1(r){return r.toLowerCase().replace(/_/g,"-")}(r);let l=n0(s);if(l)return l;const m=s.split("-")[0];if(l=n0(m),l)return l;if("en"===m)return ax;throw new et(701,!1)}function t0(r){return Xy(r)[Yi.PluralCase]}function n0(r){return r in df||(df[r]=de.ng&&de.ng.common&&de.ng.common.locales&&de.ng.common.locales[r]),df[r]}var Yi=(()=>((Yi=Yi||{})[Yi.LocaleId=0]="LocaleId",Yi[Yi.DayPeriodsFormat=1]="DayPeriodsFormat",Yi[Yi.DayPeriodsStandalone=2]="DayPeriodsStandalone",Yi[Yi.DaysFormat=3]="DaysFormat",Yi[Yi.DaysStandalone=4]="DaysStandalone",Yi[Yi.MonthsFormat=5]="MonthsFormat",Yi[Yi.MonthsStandalone=6]="MonthsStandalone",Yi[Yi.Eras=7]="Eras",Yi[Yi.FirstDayOfWeek=8]="FirstDayOfWeek",Yi[Yi.WeekendRange=9]="WeekendRange",Yi[Yi.DateFormat=10]="DateFormat",Yi[Yi.TimeFormat=11]="TimeFormat",Yi[Yi.DateTimeFormat=12]="DateTimeFormat",Yi[Yi.NumberSymbols=13]="NumberSymbols",Yi[Yi.NumberFormats=14]="NumberFormats",Yi[Yi.CurrencyCode=15]="CurrencyCode",Yi[Yi.CurrencySymbol=16]="CurrencySymbol",Yi[Yi.CurrencyName=17]="CurrencyName",Yi[Yi.Currencies=18]="Currencies",Yi[Yi.Directionality=19]="Directionality",Yi[Yi.PluralCase=20]="PluralCase",Yi[Yi.ExtraData=21]="ExtraData",Yi))();const Um="en-US";let lx=Um;function T_(r,s,l,m,x){if(r=Pe(r),Array.isArray(r))for(let M=0;M<r.length;M++)T_(r[M],s,l,m,x);else{const M=ji(),P=yn();let N=id(r)?r:Pe(r.provide),G=vp(r);const re=qr(),ve=1048575&re.providerIndexes,Ze=re.directiveStart,Pt=re.providerIndexes>>20;if(id(r)||!r.multi){const qt=new Rr(G,x,vd),Mn=rv(N,s,x?ve:ve+Pt,Ze);-1===Mn?(Ha(Fl(re,P),M,N),iv(M,r,s.length),s.push(N),re.directiveStart++,re.directiveEnd++,x&&(re.providerIndexes+=1048576),l.push(qt),P.push(qt)):(l[Mn]=qt,P[Mn]=qt)}else{const qt=rv(N,s,ve+Pt,Ze),Mn=rv(N,s,ve,ve+Pt),Wn=qt>=0&&l[qt],ui=Mn>=0&&l[Mn];if(x&&!ui||!x&&!Wn){Ha(Fl(re,P),M,N);const Mi=function iw(r,s,l,m,x){const M=new Rr(r,l,vd);return M.multi=[],M.index=s,M.componentProviders=0,E0(M,x,m&&!l),M}(x?nw:tw,l.length,x,m,G);!x&&ui&&(l[Mn].providerFactory=Mi),iv(M,r,s.length,0),s.push(N),re.directiveStart++,re.directiveEnd++,x&&(re.providerIndexes+=1048576),l.push(Mi),P.push(Mi)}else iv(M,r,qt>-1?qt:Mn,E0(l[x?Mn:qt],G,!x&&m));!x&&m&&ui&&l[Mn].componentProviders++}}}function iv(r,s,l,m){const x=id(s),M=function Nc(r){return!!r.useClass}(s);if(x||M){const G=(M?Pe(s.useClass):s).prototype.ngOnDestroy;if(G){const re=r.destroyHooks||(r.destroyHooks=[]);if(!x&&s.multi){const ve=re.indexOf(l);-1===ve?re.push(l,[m,G]):re[ve+1].push(m,G)}else re.push(l,G)}}}function E0(r,s,l){return l&&r.componentProviders++,r.multi.push(s)-1}function rv(r,s,l,m){for(let x=l;x<m;x++)if(s[x]===r)return x;return-1}function tw(r,s,l,m){return ov(this.multi,[])}function nw(r,s,l,m){const x=this.multi;let M;if(this.providerFactory){const P=this.providerFactory.componentProviders,N=Za(l,l[1],this.providerFactory.index,m);M=N.slice(0,P),ov(x,M);for(let G=P;G<N.length;G++)M.push(N[G])}else M=[],ov(x,M);return M}function ov(r,s){for(let l=0;l<r.length;l++)s.push((0,r[l])());return s}function sv(r,s=[]){return l=>{l.providersResolver=(m,x)=>function ew(r,s,l){const m=ji();if(m.firstCreatePass){const x=Ko(r);T_(l,m.data,m.blueprint,x,!0),T_(s,m.data,m.blueprint,x,!1)}}(m,x?x(r):r,s)}}class bh{}class av{}function rw(r,s){return new M0(r,s??null)}class M0 extends bh{constructor(s,l){super(),this._parent=l,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tf(this);const m=lt(s);this._bootstrapComponents=Gc(m.bootstrap),this._r3Injector=sm(s,l,[{provide:bh,useValue:this},{provide:Ls,useValue:this.componentFactoryResolver}],ye(s),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(s)}get injector(){return this._r3Injector}destroy(){const s=this._r3Injector;!s.destroyed&&s.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(s){this.destroyCbs.push(s)}}class D0 extends av{constructor(s){super(),this.moduleType=s}create(s){return new M0(this.moduleType,s)}}class T0 extends bh{constructor(s,l,m){super(),this.componentFactoryResolver=new tf(this),this.instance=null;const x=new kf([...s,{provide:bh,useValue:this},{provide:Ls,useValue:this.componentFactoryResolver}],l||Ph(),m,new Set(["environment"]));this.injector=x,x.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(s){this.injector.onDestroy(s)}}function S_(r,s,l=null){return new T0(r,s,l).injector}function R0(r,s,l){const m=eo()+r,x=yn();return x[m]===ar?g(x,m,l?s.call(l):s()):function b(r,s){return r[s]}(x,m)}function L0(r,s,l,m){return N0(yn(),eo(),r,s,l,m)}function F0(r,s,l,m,x){return function V0(r,s,l,m,x,M,P){const N=s+l;return D(r,N,x,M)?g(r,N+2,P?m.call(P,x,M):m(x,M)):Zm(r,N+2)}(yn(),eo(),r,s,l,m,x)}function pw(r,s,l,m,x,M){return function U0(r,s,l,m,x,M,P,N){const G=s+l;return function S(r,s,l,m,x){const M=D(r,s,l,m);return C(r,s+2,x)||M}(r,G,x,M,P)?g(r,G+3,N?m.call(N,x,M,P):m(x,M,P)):Zm(r,G+3)}(yn(),eo(),r,s,l,m,x,M)}function z0(r,s,l,m){return function G0(r,s,l,m,x,M){let P=s+l,N=!1;for(let G=0;G<x.length;G++)C(r,P++,x[G])&&(N=!0);return N?g(r,P,m.apply(M,x)):Zm(r,P)}(yn(),eo(),r,s,l,m)}function Zm(r,s){const l=r[s];return l===ar?void 0:l}function N0(r,s,l,m,x,M){const P=s+l;return C(r,P,x)?g(r,P+1,M?m.call(M,x):m(x)):Zm(r,P+1)}function H0(r,s){const l=ji();let m;const x=r+22;l.firstCreatePass?(m=function yw(r,s){if(s)for(let l=s.length-1;l>=0;l--){const m=s[l];if(r===m.name)return m}}(s,l.pipeRegistry),l.data[x]=m,m.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(x,m.onDestroy)):m=l.data[x];const M=m.factory||(m.factory=Fo(m.type)),P=ct(vd);try{const N=ac(!1),G=M();return ac(N),function Hi(r,s,l,m){l>=r.data.length&&(r.data[l]=null,r.blueprint[l]=null),s[l]=m}(l,yn(),x,G),G}finally{ct(P)}}function $0(r,s,l){const m=r+22,x=yn(),M=Li(x,m);return function Wm(r,s){return r[1].data[s].pure}(x,m)?N0(x,eo(),s,M.transform,l,M):M.transform(l)}function lv(r){return s=>{setTimeout(r,void 0,s)}}const Fu=class xw extends T.x{constructor(s=!1){super(),this.__isAsync=s}emit(s){super.next(s)}subscribe(s,l,m){let x=s,M=l||(()=>null),P=m;if(s&&"object"==typeof s){const G=s;x=G.next?.bind(G),M=G.error?.bind(G),P=G.complete?.bind(G)}this.__isAsync&&(M=lv(M),x&&(x=lv(x)),P&&(P=lv(P)));const N=super.subscribe({next:x,error:M,complete:P});return s instanceof d.w0&&s.add(N),N}};function ww(){return this._results[Qc()]()}class O_{constructor(s=!1){this._emitDistinctChangesOnly=s,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=Qc(),m=O_.prototype;m[l]||(m[l]=ww)}get changes(){return this._changes||(this._changes=new Fu)}get(s){return this._results[s]}map(s){return this._results.map(s)}filter(s){return this._results.filter(s)}find(s){return this._results.find(s)}reduce(s,l){return this._results.reduce(s,l)}forEach(s){this._results.forEach(s)}some(s){return this._results.some(s)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(s,l){const m=this;m.dirty=!1;const x=L(s);(this._changesDetected=!function F(r,s,l){if(r.length!==s.length)return!1;for(let m=0;m<r.length;m++){let x=r[m],M=s[m];if(l&&(x=l(x),M=l(M)),M!==x)return!1}return!0}(m._results,x,l))&&(m._results=x,m.length=x.length,m.last=x[this.length-1],m.first=x[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let qm=(()=>{class r{}return r.__NG_ELEMENT_ID__=Mw,r})();const Cw=qm,Ew=class extends Cw{constructor(s,l,m){super(),this._declarationLView=s,this._declarationTContainer=l,this.elementRef=m}createEmbeddedView(s,l){const m=this._declarationTContainer.tViews,x=Iu(this._declarationLView,m,s,16,null,m.declTNode,null,null,null,null,l||null);x[17]=this._declarationLView[this._declarationTContainer.index];const P=this._declarationLView[19];return null!==P&&(x[19]=P.createEmbeddedView(m)),Jh(m,x,s),new Md(x)}};function Mw(){return k_(qr(),yn())}function k_(r,s){return 4&r.type?new Ew(s,r,Ms(r,s)):null}let R_=(()=>{class r{}return r.__NG_ELEMENT_ID__=Dw,r})();function Dw(){return Y0(qr(),yn())}const Tw=R_,W0=class extends Tw{constructor(s,l,m){super(),this._lContainer=s,this._hostTNode=l,this._hostLView=m}get element(){return Ms(this._hostTNode,this._hostLView)}get injector(){return new Ks(this._hostTNode,this._hostLView)}get parentInjector(){const s=kc(this._hostTNode,this._hostLView);if(zi(s)){const l=hs(s,this._hostLView),m=Hn(s);return new Ks(l[1].data[m+8],l)}return new Ks(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(s){const l=q0(this._lContainer);return null!==l&&l[s]||null}get length(){return this._lContainer.length-10}createEmbeddedView(s,l,m){let x,M;"number"==typeof m?x=m:null!=m&&(x=m.index,M=m.injector);const P=s.createEmbeddedView(l||{},M);return this.insert(P,x),P}createComponent(s,l,m,x,M){const P=s&&!function qa(r){return"function"==typeof r}(s);let N;if(P)N=l;else{const Ze=l||{};N=Ze.index,m=Ze.injector,x=Ze.projectableNodes,M=Ze.environmentInjector||Ze.ngModuleRef}const G=P?s:new gh(Xe(s)),re=m||this.parentInjector;if(!M&&null==G.ngModule){const Pt=(P?re:this.parentInjector).get(od,null);Pt&&(M=Pt)}const ve=G.create(re,x,void 0,M);return this.insert(ve.hostView,N),ve}insert(s,l){const m=s._lView,x=m[1];if(function Ae(r){return ao(r[3])}(m)){const ve=this.indexOf(s);if(-1!==ve)this.detach(ve);else{const Ze=m[3],Pt=new W0(Ze,Ze[6],Ze[3]);Pt.detach(Pt.indexOf(s))}}const M=this._adjustIndex(l),P=this._lContainer;!function Kf(r,s,l,m){const x=10+m,M=l.length;m>0&&(l[x-1][4]=s),m<M-10?(s[4]=l[x],H(l,10+m,s)):(l.push(s),s[4]=null),s[3]=l;const P=s[17];null!==P&&l!==P&&function pd(r,s){const l=r[9];s[16]!==s[3][3][16]&&(r[2]=!0),null===l?r[9]=[s]:l.push(s)}(P,s);const N=s[19];null!==N&&N.insertView(r),s[2]|=64}(x,m,P,M);const N=gd(M,P),G=m[11],re=Tu(G,P[7]);return null!==re&&function Cg(r,s,l,m,x,M){m[0]=x,m[6]=s,Jd(r,m,l,1,x,M)}(x,P[6],G,m,re,N),s.attachToViewContainerRef(),H(cv(P),M,s),s}move(s,l){return this.insert(s,l)}indexOf(s){const l=q0(this._lContainer);return null!==l?l.indexOf(s):-1}remove(s){const l=this._adjustIndex(s,-1),m=Xf(this._lContainer,l);m&&(Q(cv(this._lContainer),l),Qf(m[1],m))}detach(s){const l=this._adjustIndex(s,-1),m=Xf(this._lContainer,l);return m&&null!=Q(cv(this._lContainer),l)?new Md(m):null}_adjustIndex(s,l=0){return s??this.length+l}};function q0(r){return r[8]}function cv(r){return r[8]||(r[8]=[])}function Y0(r,s){let l;const m=s[r.index];if(ao(m))l=m;else{let x;if(8&r.type)x=Qr(m);else{const M=s[11];x=M.createComment("");const P=vo(r,s);fd(M,Tu(M,P),x,function em(r,s){return r.nextSibling(s)}(M,P),!1)}s[r.index]=l=h_(m,s,x,r),qc(s,l)}return new W0(l,r,s)}class L_{constructor(s){this.queryList=s,this.matches=null}clone(){return new L_(this.queryList)}setDirty(){this.queryList.setDirty()}}class uv{constructor(s=[]){this.queries=s}createEmbeddedView(s){const l=s.queries;if(null!==l){const m=null!==s.contentQueries?s.contentQueries[0]:l.length,x=[];for(let M=0;M<m;M++){const P=l.getByIndex(M);x.push(this.queries[P.indexInDeclarationView].clone())}return new uv(x)}return null}insertView(s){this.dirtyQueriesWithMatches(s)}detachView(s){this.dirtyQueriesWithMatches(s)}dirtyQueriesWithMatches(s){for(let l=0;l<this.queries.length;l++)null!==sb(s,l).matches&&this.queries[l].setDirty()}}class K0{constructor(s,l,m=null){this.predicate=s,this.flags=l,this.read=m}}class dv{constructor(s=[]){this.queries=s}elementStart(s,l){for(let m=0;m<this.queries.length;m++)this.queries[m].elementStart(s,l)}elementEnd(s){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(s)}embeddedTView(s){let l=null;for(let m=0;m<this.length;m++){const x=null!==l?l.length:0,M=this.getByIndex(m).embeddedTView(s,x);M&&(M.indexInDeclarationView=m,null!==l?l.push(M):l=[M])}return null!==l?new dv(l):null}template(s,l){for(let m=0;m<this.queries.length;m++)this.queries[m].template(s,l)}getByIndex(s){return this.queries[s]}get length(){return this.queries.length}track(s){this.queries.push(s)}}class hv{constructor(s,l=-1){this.metadata=s,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(s,l){this.isApplyingToNode(l)&&this.matchTNode(s,l)}elementEnd(s){this._declarationNodeIndex===s.index&&(this._appliesToNextNode=!1)}template(s,l){this.elementStart(s,l)}embeddedTView(s,l){return this.isApplyingToNode(s)?(this.crossesNgTemplate=!0,this.addMatch(-s.index,l),new hv(this.metadata)):null}isApplyingToNode(s){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let m=s.parent;for(;null!==m&&8&m.type&&m.index!==l;)m=m.parent;return l===(null!==m?m.index:-1)}return this._appliesToNextNode}matchTNode(s,l){const m=this.metadata.predicate;if(Array.isArray(m))for(let x=0;x<m.length;x++){const M=m[x];this.matchTNodeWithReadOption(s,l,Iw(l,M)),this.matchTNodeWithReadOption(s,l,Rc(l,s,M,!1,!1))}else m===qm?4&l.type&&this.matchTNodeWithReadOption(s,l,-1):this.matchTNodeWithReadOption(s,l,Rc(l,s,m,!1,!1))}matchTNodeWithReadOption(s,l,m){if(null!==m){const x=this.metadata.read;if(null!==x)if(x===El||x===R_||x===qm&&4&l.type)this.addMatch(l.index,-2);else{const M=Rc(l,s,x,!1,!1);null!==M&&this.addMatch(l.index,M)}else this.addMatch(l.index,m)}}addMatch(s,l){null===this.matches?this.matches=[s,l]:this.matches.push(s,l)}}function Iw(r,s){const l=r.localNames;if(null!==l)for(let m=0;m<l.length;m+=2)if(l[m]===s)return l[m+1];return null}function Pw(r,s,l,m){return-1===l?function X0(r,s){return 11&r.type?Ms(r,s):4&r.type?k_(r,s):null}(s,r):-2===l?function Ow(r,s,l){return l===El?Ms(s,r):l===qm?k_(s,r):l===R_?Y0(s,r):void 0}(r,s,m):Za(r,r[1],l,s)}function Q0(r,s,l,m){const x=s[19].queries[m];if(null===x.matches){const M=r.data,P=l.matches,N=[];for(let G=0;G<P.length;G+=2){const re=P[G];N.push(re<0?null:Pw(s,M[re],P[G+1],l.metadata.read))}x.matches=N}return x.matches}function pv(r,s,l,m){const x=r.queries.getByIndex(l),M=x.matches;if(null!==M){const P=Q0(r,s,x,l);for(let N=0;N<M.length;N+=2){const G=M[N];if(G>0)m.push(P[N/2]);else{const re=M[N+1],ve=s[-G];for(let Ze=10;Ze<ve.length;Ze++){const Pt=ve[Ze];Pt[17]===Pt[3]&&pv(Pt[1],Pt,re,m)}if(null!==ve[9]){const Ze=ve[9];for(let Pt=0;Pt<Ze.length;Pt++){const qt=Ze[Pt];pv(qt[1],qt,re,m)}}}}}return m}function J0(r){const s=yn(),l=ji(),m=Il();Pl(m+1);const x=sb(l,m);if(r.dirty&&be(s)===(2==(2&x.metadata.flags))){if(null===x.matches)r.reset([]);else{const M=x.crossesNgTemplate?pv(l,s,m,[]):Q0(l,s,x,m);r.reset(M,ld),r.notifyOnChanges()}return!0}return!1}function eb(r,s,l){const m=ji();m.firstCreatePass&&(fv(m,new K0(r,s,l),-1),2==(2&s)&&(m.staticViewQueries=!0)),rb(m,yn(),s)}function tb(r,s,l,m){const x=ji();if(x.firstCreatePass){const M=qr();fv(x,new K0(s,l,m),M.index),function ob(r,s){const l=r.contentQueries||(r.contentQueries=[]);s!==(l.length?l[l.length-1]:-1)&&l.push(r.queries.length-1,s)}(x,r),2==(2&l)&&(x.staticContentQueries=!0)}rb(x,yn(),l)}function nb(){return function ib(r,s){return r[19].queries[s].queryList}(yn(),Il())}function rb(r,s,l){const m=new O_(4==(4&l));ph(r,s,m,m.destroy),null===s[19]&&(s[19]=new uv),s[19].queries.push(new L_(m))}function fv(r,s,l){null===r.queries&&(r.queries=new dv),r.queries.track(new hv(s,l))}function sb(r,s){return r.queries.getByIndex(s)}function ff(r){const s=Xe(r)||Mt(r)||Ct(r);return null!==s&&s.standalone}function U_(...r){}const Ib=new fr("Application Initializer");let j_=(()=>{class r{constructor(l){this.appInits=l,this.resolve=U_,this.reject=U_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((m,x)=>{this.resolve=m,this.reject=x})}runInitializers(){if(this.initialized)return;const l=[],m=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let x=0;x<this.appInits.length;x++){const M=this.appInits[x]();if(Pr(M))l.push(M);else if(Yr(M)){const P=new Promise((N,G)=>{M.subscribe({complete:N,error:G})});l.push(P)}}Promise.all(l).then(()=>{m()}).catch(x=>{this.reject(x)}),0===l.length&&m(),this.initialized=!0}}return r.\u0275fac=function(l){return new(l||r)(we(Ib,8))},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const Pb=new fr("AppId",{providedIn:"root",factory:function Ob(){return`${nu()}${nu()}${nu()}`}});function nu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kb=new fr("Platform Initializer"),V1=new fr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Rb=new fr("appBootstrapListener"),$w=new fr("AnimationModuleType");let hr=(()=>{class r{log(l){console.log(l)}warn(l){console.warn(l)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const G_=new fr("LocaleId",{providedIn:"root",factory:()=>$e(G_,En.Optional|En.SkipSelf)||function xv(){return typeof $localize<"u"&&$localize.locale||Um}()}),j1=new fr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Zw{constructor(s,l){this.ngModuleFactory=s,this.componentFactories=l}}let Ww=(()=>{class r{compileModuleSync(l){return new D0(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const m=this.compileModuleSync(l),M=Gc(lt(l).declarations).reduce((P,N)=>{const G=Xe(N);return G&&P.push(new gh(G)),P},[]);return new Zw(m,M)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const A=(()=>Promise.resolve(0))();function z(r){typeof Zone>"u"?A.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class _e{constructor({enableLongStackTrace:s=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:m=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Fu(!1),this.onMicrotaskEmpty=new Fu(!1),this.onStable=new Fu(!1),this.onError=new Fu(!1),typeof Zone>"u")throw new et(908,!1);Zone.assertZonePatched();const x=this;if(x._nesting=0,x._outer=x._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const M=Zone.AsyncStackTaggingZoneSpec;x._inner=x._inner.fork(new M("Angular"))}Zone.TaskTrackingZoneSpec&&(x._inner=x._inner.fork(new Zone.TaskTrackingZoneSpec)),s&&Zone.longStackTraceZoneSpec&&(x._inner=x._inner.fork(Zone.longStackTraceZoneSpec)),x.shouldCoalesceEventChangeDetection=!m&&l,x.shouldCoalesceRunChangeDetection=m,x.lastRequestAnimationFrameId=-1,x.nativeRequestAnimationFrame=function ue(){let r=de.requestAnimationFrame,s=de.cancelAnimationFrame;if(typeof Zone<"u"&&r&&s){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const m=s[Zone.__symbol__("OriginalDelegate")];m&&(s=m)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function un(r){const s=()=>{!function ln(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(de,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,ei(r),r.isCheckStableRunning=!0,Lt(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),ei(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,m,x,M,P,N)=>{try{return yi(r),l.invokeTask(x,M,P,N)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===M.type||r.shouldCoalesceRunChangeDetection)&&s(),si(r)}},onInvoke:(l,m,x,M,P,N,G)=>{try{return yi(r),l.invoke(x,M,P,N,G)}finally{r.shouldCoalesceRunChangeDetection&&s(),si(r)}},onHasTask:(l,m,x,M)=>{l.hasTask(x,M),m===x&&("microTask"==M.change?(r._hasPendingMicrotasks=M.microTask,ei(r),Lt(r)):"macroTask"==M.change&&(r.hasPendingMacrotasks=M.macroTask))},onHandleError:(l,m,x,M)=>(l.handleError(x,M),r.runOutsideAngular(()=>r.onError.emit(M)),!1)})}(x)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_e.isInAngularZone())throw new et(909,!1)}static assertNotInAngularZone(){if(_e.isInAngularZone())throw new et(909,!1)}run(s,l,m){return this._inner.run(s,l,m)}runTask(s,l,m,x){const M=this._inner,P=M.scheduleEventTask("NgZoneEvent: "+x,s,rt,U_,U_);try{return M.runTask(P,l,m)}finally{M.cancelTask(P)}}runGuarded(s,l,m){return this._inner.runGuarded(s,l,m)}runOutsideAngular(s){return this._outer.run(s)}}const rt={};function Lt(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function ei(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function yi(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function si(r){r._nesting--,Lt(r)}class hi{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Fu,this.onMicrotaskEmpty=new Fu,this.onStable=new Fu,this.onError=new Fu}run(s,l,m){return s.apply(l,m)}runGuarded(s,l,m){return s.apply(l,m)}runOutsideAngular(s){return s()}runTask(s,l,m,x){return s.apply(l,m)}}const Fi=new fr(""),Ki=new fr("");let Pa,Vr=(()=>{class r{constructor(l,m,x){this._ngZone=l,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Pa||(function _o(r){Pa=r}(x),x.addToWindow(m)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_e.assertNotInAngularZone(),z(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())z(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(l)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,m,x){let M=-1;m&&m>0&&(M=setTimeout(()=>{this._callbacks=this._callbacks.filter(P=>P.timeoutId!==M),l(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:l,timeoutId:M,updateCb:x})}whenStable(l,m,x){if(x&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,m,x),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,m,x){return[]}}return r.\u0275fac=function(l){return new(l||r)(we(_e),we(Ro),we(Ki))},r.\u0275prov=Ln({token:r,factory:r.\u0275fac}),r})(),Ro=(()=>{class r{constructor(){this._applications=new Map}registerApplication(l,m){this._applications.set(l,m)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,m=!0){return Pa?.findTestabilityInTree(this,l,m)??null}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})(),gs=null;const yo=new fr("AllowMultipleToken"),os=new fr("PlatformDestroyListeners");class iu{constructor(s,l){this.name=s,this.token=l}}function Ni(r,s,l=[]){const m=`Platform: ${s}`,x=new fr(m);return(M=[])=>{let P=Ns();if(!P||P.injector.get(yo,!1)){const N=[...l,...M,{provide:x,useValue:!0}];r?r(N):function _f(r){if(gs&&!gs.get(yo,!1))throw new et(400,!1);gs=r;const s=r.get(Sl);(function xi(r){const s=r.get(kb,null);s&&s.forEach(l=>l())})(r)}(function Yo(r=[],s){return yd.create({name:s,providers:[{provide:Vc,useValue:"platform"},{provide:os,useValue:new Set([()=>gs=null])},...r]})}(N,m))}return function Tr(r){const s=Ns();if(!s)throw new et(401,!1);return s}()}}function Ns(){return gs?.get(Sl)??null}let Sl=(()=>{class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,m){const x=function Bu(r,s){let l;return l="noop"===r?new hi:("zone.js"===r?void 0:r)||new _e(s),l}(m?.ngZone,function Xr(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!r||!r.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!r||!r.ngZoneRunCoalescing)||!1}}(m)),M=[{provide:_e,useValue:x}];return x.run(()=>{const P=yd.create({providers:M,parent:this.injector,name:l.moduleType.name}),N=l.create(P),G=N.injector.get($d,null);if(!G)throw new et(402,!1);return x.runOutsideAngular(()=>{const re=x.onError.subscribe({next:ve=>{G.handleError(ve)}});N.onDestroy(()=>{ba(this._modules,N),re.unsubscribe()})}),function cp(r,s,l){try{const m=l();return Pr(m)?m.catch(x=>{throw s.runOutsideAngular(()=>r.handleError(x)),x}):m}catch(m){throw s.runOutsideAngular(()=>r.handleError(m)),m}}(G,x,()=>{const re=N.injector.get(j_);return re.runInitializers(),re.donePromise.then(()=>(function cx(r){fi(r,"Expected localeId to be defined"),"string"==typeof r&&(lx=r.toLowerCase().replace(/_/g,"-"))}(N.injector.get(G_,Um)||Um),this._moduleDoBootstrap(N),N))})})}bootstrapModule(l,m=[]){const x=_s({},m);return function Jl(r,s,l){const m=new D0(l);return Promise.resolve(m)}(0,0,l).then(M=>this.bootstrapModuleFactory(M,x))}_moduleDoBootstrap(l){const m=l.injector.get(ec);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(x=>m.bootstrap(x));else{if(!l.instance.ngDoBootstrap)throw new et(403,!1);l.instance.ngDoBootstrap(m)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new et(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const l=this._injector.get(os,null);l&&(l.forEach(m=>m()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(l){return new(l||r)(we(yd))},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function _s(r,s){return Array.isArray(s)?s.reduce(_s,r):{...r,...s}}let ec=(()=>{class r{constructor(l,m,x){this._zone=l,this._injector=m,this._exceptionHandler=x,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const M=new W.y(N=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{N.next(this._stable),N.complete()})}),P=new W.y(N=>{let G;this._zone.runOutsideAngular(()=>{G=this._zone.onStable.subscribe(()=>{_e.assertNotInAngularZone(),z(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,N.next(!0))})})});const re=this._zone.onUnstable.subscribe(()=>{_e.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{N.next(!1)}))});return()=>{G.unsubscribe(),re.unsubscribe()}});this.isStable=(0,c.T)(M,P.pipe((0,Ce.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,m){const x=l instanceof Ff;if(!this._injector.get(j_).done)throw!x&&ff(l),new et(405,false);let P;P=x?l:this._injector.get(Ls).resolveComponentFactory(l),this.componentTypes.push(P.componentType);const N=function Tc(r){return r.isBoundToModule}(P)?void 0:this._injector.get(bh),re=P.create(yd.NULL,[],m||P.selector,N),ve=re.location.nativeElement,Ze=re.injector.get(Fi,null);return Ze?.registerApplication(ve),re.onDestroy(()=>{this.detachView(re.hostView),ba(this.components,re),Ze?.unregisterApplication(ve)}),this._loadComponent(re),re}tick(){if(this._runningTick)throw new et(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const m=l;this._views.push(m),m.attachToAppRef(this)}detachView(l){const m=l;ba(this._views,m),m.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l),this._injector.get(Rb,[]).concat(this._bootstrapListeners).forEach(x=>x(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>ba(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new et(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return r.\u0275fac=function(l){return new(l||r)(we(_e),we(od),we($d))},r.\u0275prov=Ln({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function ba(r,s){const l=r.indexOf(s);l>-1&&r.splice(l,1)}let q1=!0;function lC(){q1=!1}let cC=(()=>{class r{}return r.__NG_ELEMENT_ID__=uC,r})();function uC(r){return function dC(r,s,l){if(ys(r)&&!l){const m=X(r.index,s);return new Md(m,m)}return 47&r.type?new Md(s[16],s):null}(qr(),yn(),16==(16&r))}class J1{constructor(){}supports(s){return n(s)}create(s){return new _C(s)}}const gC=(r,s)=>s;class _C{constructor(s){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=s||gC}forEachItem(s){let l;for(l=this._itHead;null!==l;l=l._next)s(l)}forEachOperation(s){let l=this._itHead,m=this._removalsHead,x=0,M=null;for(;l||m;){const P=!m||l&&l.currentIndex<tC(m,x,M)?l:m,N=tC(P,x,M),G=P.currentIndex;if(P===m)x--,m=m._nextRemoved;else if(l=l._next,null==P.previousIndex)x++;else{M||(M=[]);const re=N-x,ve=G-x;if(re!=ve){for(let Pt=0;Pt<re;Pt++){const qt=Pt<M.length?M[Pt]:M[Pt]=0,Mn=qt+Pt;ve<=Mn&&Mn<re&&(M[Pt]=qt+1)}M[P.previousIndex]=ve-re}}N!==G&&s(P,N,G)}}forEachPreviousItem(s){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)s(l)}forEachAddedItem(s){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)s(l)}forEachMovedItem(s){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)s(l)}forEachRemovedItem(s){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)s(l)}forEachIdentityChange(s){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)s(l)}diff(s){if(null==s&&(s=[]),!n(s))throw new et(900,!1);return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let x,M,P,l=this._itHead,m=!1;if(Array.isArray(s)){this.length=s.length;for(let N=0;N<this.length;N++)M=s[N],P=this._trackByFn(N,M),null!==l&&Object.is(l.trackById,P)?(m&&(l=this._verifyReinsertion(l,M,P,N)),Object.is(l.item,M)||this._addIdentityChange(l,M)):(l=this._mismatch(l,M,P,N),m=!0),l=l._next}else x=0,function i(r,s){if(Array.isArray(r))for(let l=0;l<r.length;l++)s(r[l]);else{const l=r[Qc()]();let m;for(;!(m=l.next()).done;)s(m.value)}}(s,N=>{P=this._trackByFn(x,N),null!==l&&Object.is(l.trackById,P)?(m&&(l=this._verifyReinsertion(l,N,P,x)),Object.is(l.item,N)||this._addIdentityChange(l,N)):(l=this._mismatch(l,N,P,x),m=!0),l=l._next,x++}),this.length=x;return this._truncate(l),this.collection=s,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let s;for(s=this._previousItHead=this._itHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._additionsHead;null!==s;s=s._nextAdded)s.previousIndex=s.currentIndex;for(this._additionsHead=this._additionsTail=null,s=this._movesHead;null!==s;s=s._nextMoved)s.previousIndex=s.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(s,l,m,x){let M;return null===s?M=this._itTail:(M=s._prev,this._remove(s)),null!==(s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null))?(Object.is(s.item,l)||this._addIdentityChange(s,l),this._reinsertAfter(s,M,x)):null!==(s=null===this._linkedRecords?null:this._linkedRecords.get(m,x))?(Object.is(s.item,l)||this._addIdentityChange(s,l),this._moveAfter(s,M,x)):s=this._addAfter(new yC(l,m),M,x),s}_verifyReinsertion(s,l,m,x){let M=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null);return null!==M?s=this._reinsertAfter(M,s._prev,x):s.currentIndex!=x&&(s.currentIndex=x,this._addToMoves(s,x)),s}_truncate(s){for(;null!==s;){const l=s._next;this._addToRemovals(this._unlink(s)),s=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(s,l,m){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(s);const x=s._prevRemoved,M=s._nextRemoved;return null===x?this._removalsHead=M:x._nextRemoved=M,null===M?this._removalsTail=x:M._prevRemoved=x,this._insertAfter(s,l,m),this._addToMoves(s,m),s}_moveAfter(s,l,m){return this._unlink(s),this._insertAfter(s,l,m),this._addToMoves(s,m),s}_addAfter(s,l,m){return this._insertAfter(s,l,m),this._additionsTail=null===this._additionsTail?this._additionsHead=s:this._additionsTail._nextAdded=s,s}_insertAfter(s,l,m){const x=null===l?this._itHead:l._next;return s._next=x,s._prev=l,null===x?this._itTail=s:x._prev=s,null===l?this._itHead=s:l._next=s,null===this._linkedRecords&&(this._linkedRecords=new eC),this._linkedRecords.put(s),s.currentIndex=m,s}_remove(s){return this._addToRemovals(this._unlink(s))}_unlink(s){null!==this._linkedRecords&&this._linkedRecords.remove(s);const l=s._prev,m=s._next;return null===l?this._itHead=m:l._next=m,null===m?this._itTail=l:m._prev=l,s}_addToMoves(s,l){return s.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=s:this._movesTail._nextMoved=s),s}_addToRemovals(s){return null===this._unlinkedRecords&&(this._unlinkedRecords=new eC),this._unlinkedRecords.put(s),s.currentIndex=null,s._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=s,s._prevRemoved=null):(s._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=s),s}_addIdentityChange(s,l){return s.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=s:this._identityChangesTail._nextIdentityChange=s,s}}class yC{constructor(s,l){this.item=s,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class vC{constructor(){this._head=null,this._tail=null}add(s){null===this._head?(this._head=this._tail=s,s._nextDup=null,s._prevDup=null):(this._tail._nextDup=s,s._prevDup=this._tail,s._nextDup=null,this._tail=s)}get(s,l){let m;for(m=this._head;null!==m;m=m._nextDup)if((null===l||l<=m.currentIndex)&&Object.is(m.trackById,s))return m;return null}remove(s){const l=s._prevDup,m=s._nextDup;return null===l?this._head=m:l._nextDup=m,null===m?this._tail=l:m._prevDup=l,null===this._head}}class eC{constructor(){this.map=new Map}put(s){const l=s.trackById;let m=this.map.get(l);m||(m=new vC,this.map.set(l,m)),m.add(s)}get(s,l){const x=this.map.get(s);return x?x.get(s,l):null}remove(s){const l=s.trackById;return this.map.get(l).remove(s)&&this.map.delete(l),s}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function tC(r,s,l){const m=r.previousIndex;if(null===m)return m;let x=0;return l&&m<l.length&&(x=l[m]),m+s+x}class nC{constructor(){}supports(s){return s instanceof Map||a(s)}create(){return new bC}}class bC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(s){let l;for(l=this._mapHead;null!==l;l=l._next)s(l)}forEachPreviousItem(s){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)s(l)}forEachChangedItem(s){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)s(l)}forEachAddedItem(s){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)s(l)}forEachRemovedItem(s){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)s(l)}diff(s){if(s){if(!(s instanceof Map||a(s)))throw new et(900,!1)}else s=new Map;return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(s,(m,x)=>{if(l&&l.key===x)this._maybeAddToChanges(l,m),this._appendAfter=l,l=l._next;else{const M=this._getOrCreateRecordForKey(x,m);l=this._insertBeforeOrAppend(l,M)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let m=l;null!==m;m=m._nextRemoved)m===this._mapHead&&(this._mapHead=null),this._records.delete(m.key),m._nextRemoved=m._next,m.previousValue=m.currentValue,m.currentValue=null,m._prev=null,m._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(s,l){if(s){const m=s._prev;return l._next=s,l._prev=m,s._prev=l,m&&(m._next=l),s===this._mapHead&&(this._mapHead=l),this._appendAfter=s,s}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(s,l){if(this._records.has(s)){const x=this._records.get(s);this._maybeAddToChanges(x,l);const M=x._prev,P=x._next;return M&&(M._next=P),P&&(P._prev=M),x._next=null,x._prev=null,x}const m=new xC(s);return this._records.set(s,m),m.currentValue=l,this._addToAdditions(m),m}_reset(){if(this.isDirty){let s;for(this._previousMapHead=this._mapHead,s=this._previousMapHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._changesHead;null!==s;s=s._nextChanged)s.previousValue=s.currentValue;for(s=this._additionsHead;null!=s;s=s._nextAdded)s.previousValue=s.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(s,l){Object.is(l,s.currentValue)||(s.previousValue=s.currentValue,s.currentValue=l,this._addToChanges(s))}_addToAdditions(s){null===this._additionsHead?this._additionsHead=this._additionsTail=s:(this._additionsTail._nextAdded=s,this._additionsTail=s)}_addToChanges(s){null===this._changesHead?this._changesHead=this._changesTail=s:(this._changesTail._nextChanged=s,this._changesTail=s)}_forEach(s,l){s instanceof Map?s.forEach(l):Object.keys(s).forEach(m=>l(s[m],m))}}class xC{constructor(s){this.key=s,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function iC(){return new Jw([new J1])}let Jw=(()=>{class r{constructor(l){this.factories=l}static create(l,m){if(null!=m){const x=m.factories.slice();l=l.concat(x)}return new r(l)}static extend(l){return{provide:r,useFactory:m=>r.create(l,m||iC()),deps:[[r,new Zt,new bt]]}}find(l){const m=this.factories.find(x=>x.supports(l));if(null!=m)return m;throw new et(901,!1)}}return r.\u0275prov=Ln({token:r,providedIn:"root",factory:iC}),r})();function rC(){return new e1([new nC])}let e1=(()=>{class r{constructor(l){this.factories=l}static create(l,m){if(m){const x=m.factories.slice();l=l.concat(x)}return new r(l)}static extend(l){return{provide:r,useFactory:m=>r.create(l,m||rC()),deps:[[r,new Zt,new bt]]}}find(l){const m=this.factories.find(x=>x.supports(l));if(m)return m;throw new et(901,!1)}}return r.\u0275prov=Ln({token:r,providedIn:"root",factory:rC}),r})();const EC=Ni(null,"core",[]);let MC=(()=>{class r{constructor(l){}}return r.\u0275fac=function(l){return new(l||r)(we(ec))},r.\u0275mod=ae({type:r}),r.\u0275inj=Rt({}),r})();function DC(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}},4006:(Bn,kt,j)=>{"use strict";j.d(kt,{Cf:()=>St,F:()=>vi,Fj:()=>gt,JJ:()=>Wi,JU:()=>ye,On:()=>ra,Zs:()=>Li,a5:()=>Ii,kI:()=>Xt,sg:()=>tl,u5:()=>kr});var T=j(4650),d=j(6895),W=j(2076),c=j(4128),Ce=j(4004);let Ve=(()=>{class ne{constructor($,me){this._renderer=$,this._elementRef=me,this.onChange=cn=>{},this.onTouched=()=>{}}setProperty($,me){this._renderer.setProperty(this._elementRef.nativeElement,$,me)}registerOnTouched($){this.onTouched=$}registerOnChange($){this.onChange=$}setDisabledState($){this.setProperty("disabled",$)}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(T.Qsj),T.Y36(T.SBq))},ne.\u0275dir=T.lG2({type:ne}),ne})(),Je=(()=>{class ne extends Ve{}return ne.\u0275fac=function(){let q;return function(me){return(q||(q=T.n5z(ne)))(me||ne)}}(),ne.\u0275dir=T.lG2({type:ne,features:[T.qOj]}),ne})();const ye=new T.OlP("NgValueAccessor"),ft={provide:ye,useExisting:(0,T.Gpc)(()=>gt),multi:!0},ut=new T.OlP("CompositionEventMode");let gt=(()=>{class ne extends Ve{constructor($,me,cn){super($,me),this._compositionMode=cn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Pe(){const ne=(0,d.q)()?(0,d.q)().getUserAgent():"";return/android (\d+)/.test(ne.toLowerCase())}())}writeValue($){this.setProperty("value",$??"")}_handleInput($){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange($)}_compositionStart(){this._composing=!0}_compositionEnd($){this._composing=!1,this._compositionMode&&this.onChange($)}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(T.Qsj),T.Y36(T.SBq),T.Y36(ut,8))},ne.\u0275dir=T.lG2({type:ne,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function($,me){1&$&&T.NdJ("input",function(Ci){return me._handleInput(Ci.target.value)})("blur",function(){return me.onTouched()})("compositionstart",function(){return me._compositionStart()})("compositionend",function(Ci){return me._compositionEnd(Ci.target.value)})},features:[T._Bn([ft]),T.qOj]}),ne})();function Ut(ne){return null==ne||("string"==typeof ne||Array.isArray(ne))&&0===ne.length}function Ft(ne){return null!=ne&&"number"==typeof ne.length}const St=new T.OlP("NgValidators"),Pn=new T.OlP("NgAsyncValidators"),Xn=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Xt{static min(q){return function Fe(ne){return q=>{if(Ut(q.value)||Ut(ne))return null;const $=parseFloat(q.value);return!isNaN($)&&$<ne?{min:{min:ne,actual:q.value}}:null}}(q)}static max(q){return function Qe(ne){return q=>{if(Ut(q.value)||Ut(ne))return null;const $=parseFloat(q.value);return!isNaN($)&&$>ne?{max:{max:ne,actual:q.value}}:null}}(q)}static required(q){return fn(q)}static requiredTrue(q){return Jt(q)}static email(q){return function rn(ne){return Ut(ne.value)||Xn.test(ne.value)?null:{email:!0}}(q)}static minLength(q){return function vn(ne){return q=>Ut(q.value)||!Ft(q.value)?null:q.value.length<ne?{minlength:{requiredLength:ne,actualLength:q.value.length}}:null}(q)}static maxLength(q){return function xt(ne){return q=>Ft(q.value)&&q.value.length>ne?{maxlength:{requiredLength:ne,actualLength:q.value.length}}:null}(q)}static pattern(q){return function Tt(ne){if(!ne)return Gt;let q,$;return"string"==typeof ne?($="","^"!==ne.charAt(0)&&($+="^"),$+=ne,"$"!==ne.charAt(ne.length-1)&&($+="$"),q=new RegExp($)):($=ne.toString(),q=ne),me=>{if(Ut(me.value))return null;const cn=me.value;return q.test(cn)?null:{pattern:{requiredPattern:$,actualValue:cn}}}}(q)}static nullValidator(q){return null}static compose(q){return On(q)}static composeAsync(q){return Ui(q)}}function fn(ne){return Ut(ne.value)?{required:!0}:null}function Jt(ne){return!0===ne.value?null:{required:!0}}function Gt(ne){return null}function Bt(ne){return null!=ne}function Cn(ne){return(0,T.QGY)(ne)?(0,W.D)(ne):ne}function mn(ne){let q={};return ne.forEach($=>{q=null!=$?{...q,...$}:q}),0===Object.keys(q).length?null:q}function oi(ne,q){return q.map($=>$(ne))}function fi(ne){return ne.map(q=>function Yn(ne){return!ne.validate}(q)?q:$=>q.validate($))}function On(ne){if(!ne)return null;const q=ne.filter(Bt);return 0==q.length?null:function($){return mn(oi($,q))}}function Di(ne){return null!=ne?On(fi(ne)):null}function Ui(ne){if(!ne)return null;const q=ne.filter(Bt);return 0==q.length?null:function($){const me=oi($,q).map(Cn);return(0,c.D)(me).pipe((0,Ce.U)(mn))}}function Pi(ne){return null!=ne?Ui(fi(ne)):null}function Ln(ne,q){return null===ne?[q]:Array.isArray(ne)?[...ne,q]:[ne,q]}function Zn(ne){return ne._rawValidators}function Rt(ne){return ne._rawAsyncValidators}function Kt(ne){return ne?Array.isArray(ne)?ne:[ne]:[]}function kn(ne,q){return Array.isArray(ne)?ne.includes(q):ne===q}function zn(ne,q){const $=Kt(q);return Kt(ne).forEach(cn=>{kn($,cn)||$.push(cn)}),$}function gn(ne,q){return Kt(q).filter($=>!kn(ne,$))}class wi{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(q){this._rawValidators=q||[],this._composedValidatorFn=Di(this._rawValidators)}_setAsyncValidators(q){this._rawAsyncValidators=q||[],this._composedAsyncValidatorFn=Pi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(q){this._onDestroyCallbacks.push(q)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(q=>q()),this._onDestroyCallbacks=[]}reset(q){this.control&&this.control.reset(q)}hasError(q,$){return!!this.control&&this.control.hasError(q,$)}getError(q,$){return this.control?this.control.getError(q,$):null}}class Ei extends wi{get formDirective(){return null}get path(){return null}}class Ii extends wi{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let Wi=(()=>{class ne extends class or{constructor(q){this._cd=q}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor($){super($)}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(Ii,2))},ne.\u0275dir=T.lG2({type:ne,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function($,me){2&$&&T.ekj("ng-untouched",me.isUntouched)("ng-touched",me.isTouched)("ng-pristine",me.isPristine)("ng-dirty",me.isDirty)("ng-valid",me.isValid)("ng-invalid",me.isInvalid)("ng-pending",me.isPending)},features:[T.qOj]}),ne})();const zt="VALID",mt="INVALID",_t="PENDING",Ke="DISABLED";function nt(ne){return(Y(ne)?ne.validators:ne)||null}function Be(ne){return Array.isArray(ne)?Di(ne):ne||null}function Dt(ne,q){return(Y(q)?q.asyncValidators:ne)||null}function ae(ne){return Array.isArray(ne)?Pi(ne):ne||null}function Y(ne){return null!=ne&&!Array.isArray(ne)&&"object"==typeof ne}class He{constructor(q,$){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=q,this._rawAsyncValidators=$,this._composedValidatorFn=Be(this._rawValidators),this._composedAsyncValidatorFn=ae(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(q){this._rawValidators=this._composedValidatorFn=q}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(q){this._rawAsyncValidators=this._composedAsyncValidatorFn=q}get parent(){return this._parent}get valid(){return this.status===zt}get invalid(){return this.status===mt}get pending(){return this.status==_t}get disabled(){return this.status===Ke}get enabled(){return this.status!==Ke}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(q){this._rawValidators=q,this._composedValidatorFn=Be(q)}setAsyncValidators(q){this._rawAsyncValidators=q,this._composedAsyncValidatorFn=ae(q)}addValidators(q){this.setValidators(zn(q,this._rawValidators))}addAsyncValidators(q){this.setAsyncValidators(zn(q,this._rawAsyncValidators))}removeValidators(q){this.setValidators(gn(q,this._rawValidators))}removeAsyncValidators(q){this.setAsyncValidators(gn(q,this._rawAsyncValidators))}hasValidator(q){return kn(this._rawValidators,q)}hasAsyncValidator(q){return kn(this._rawAsyncValidators,q)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(q={}){this.touched=!0,this._parent&&!q.onlySelf&&this._parent.markAsTouched(q)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(q=>q.markAllAsTouched())}markAsUntouched(q={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild($=>{$.markAsUntouched({onlySelf:!0})}),this._parent&&!q.onlySelf&&this._parent._updateTouched(q)}markAsDirty(q={}){this.pristine=!1,this._parent&&!q.onlySelf&&this._parent.markAsDirty(q)}markAsPristine(q={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild($=>{$.markAsPristine({onlySelf:!0})}),this._parent&&!q.onlySelf&&this._parent._updatePristine(q)}markAsPending(q={}){this.status=_t,!1!==q.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!q.onlySelf&&this._parent.markAsPending(q)}disable(q={}){const $=this._parentMarkedDirty(q.onlySelf);this.status=Ke,this.errors=null,this._forEachChild(me=>{me.disable({...q,onlySelf:!0})}),this._updateValue(),!1!==q.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...q,skipPristineCheck:$}),this._onDisabledChange.forEach(me=>me(!0))}enable(q={}){const $=this._parentMarkedDirty(q.onlySelf);this.status=zt,this._forEachChild(me=>{me.enable({...q,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:q.emitEvent}),this._updateAncestors({...q,skipPristineCheck:$}),this._onDisabledChange.forEach(me=>me(!1))}_updateAncestors(q){this._parent&&!q.onlySelf&&(this._parent.updateValueAndValidity(q),q.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(q){this._parent=q}getRawValue(){return this.value}updateValueAndValidity(q={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zt||this.status===_t)&&this._runAsyncValidator(q.emitEvent)),!1!==q.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!q.onlySelf&&this._parent.updateValueAndValidity(q)}_updateTreeValidity(q={emitEvent:!0}){this._forEachChild($=>$._updateTreeValidity(q)),this.updateValueAndValidity({onlySelf:!0,emitEvent:q.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ke:zt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(q){if(this.asyncValidator){this.status=_t,this._hasOwnPendingAsyncValidator=!0;const $=Cn(this.asyncValidator(this));this._asyncValidationSubscription=$.subscribe(me=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(me,{emitEvent:q})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(q,$={}){this.errors=q,this._updateControlsErrors(!1!==$.emitEvent)}get(q){let $=q;return null==$||(Array.isArray($)||($=$.split(".")),0===$.length)?null:$.reduce((me,cn)=>me&&me._find(cn),this)}getError(q,$){const me=$?this.get($):this;return me&&me.errors?me.errors[q]:null}hasError(q,$){return!!this.getError(q,$)}get root(){let q=this;for(;q._parent;)q=q._parent;return q}_updateControlsErrors(q){this.status=this._calculateStatus(),q&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(q)}_initObservables(){this.valueChanges=new T.vpe,this.statusChanges=new T.vpe}_calculateStatus(){return this._allControlsDisabled()?Ke:this.errors?mt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_t)?_t:this._anyControlsHaveStatus(mt)?mt:zt}_anyControlsHaveStatus(q){return this._anyControls($=>$.status===q)}_anyControlsDirty(){return this._anyControls(q=>q.dirty)}_anyControlsTouched(){return this._anyControls(q=>q.touched)}_updatePristine(q={}){this.pristine=!this._anyControlsDirty(),this._parent&&!q.onlySelf&&this._parent._updatePristine(q)}_updateTouched(q={}){this.touched=this._anyControlsTouched(),this._parent&&!q.onlySelf&&this._parent._updateTouched(q)}_registerOnCollectionChange(q){this._onCollectionChange=q}_setUpdateStrategy(q){Y(q)&&null!=q.updateOn&&(this._updateOn=q.updateOn)}_parentMarkedDirty(q){return!q&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(q){return null}}class Xe extends He{constructor(q,$,me){super(nt($),Dt(me,$)),this.controls=q,this._initObservables(),this._setUpdateStrategy($),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(q,$){return this.controls[q]?this.controls[q]:(this.controls[q]=$,$.setParent(this),$._registerOnCollectionChange(this._onCollectionChange),$)}addControl(q,$,me={}){this.registerControl(q,$),this.updateValueAndValidity({emitEvent:me.emitEvent}),this._onCollectionChange()}removeControl(q,$={}){this.controls[q]&&this.controls[q]._registerOnCollectionChange(()=>{}),delete this.controls[q],this.updateValueAndValidity({emitEvent:$.emitEvent}),this._onCollectionChange()}setControl(q,$,me={}){this.controls[q]&&this.controls[q]._registerOnCollectionChange(()=>{}),delete this.controls[q],$&&this.registerControl(q,$),this.updateValueAndValidity({emitEvent:me.emitEvent}),this._onCollectionChange()}contains(q){return this.controls.hasOwnProperty(q)&&this.controls[q].enabled}setValue(q,$={}){(function Te(ne,q,$){ne._forEachChild((me,cn)=>{if(void 0===$[cn])throw new T.vHH(1002,"")})})(this,0,q),Object.keys(q).forEach(me=>{(function le(ne,q,$){const me=ne.controls;if(!(q?Object.keys(me):me).length)throw new T.vHH(1e3,"");if(!me[$])throw new T.vHH(1001,"")})(this,!0,me),this.controls[me].setValue(q[me],{onlySelf:!0,emitEvent:$.emitEvent})}),this.updateValueAndValidity($)}patchValue(q,$={}){null!=q&&(Object.keys(q).forEach(me=>{const cn=this.controls[me];cn&&cn.patchValue(q[me],{onlySelf:!0,emitEvent:$.emitEvent})}),this.updateValueAndValidity($))}reset(q={},$={}){this._forEachChild((me,cn)=>{me.reset(q[cn],{onlySelf:!0,emitEvent:$.emitEvent})}),this._updatePristine($),this._updateTouched($),this.updateValueAndValidity($)}getRawValue(){return this._reduceChildren({},(q,$,me)=>(q[me]=$.getRawValue(),q))}_syncPendingControls(){let q=this._reduceChildren(!1,($,me)=>!!me._syncPendingControls()||$);return q&&this.updateValueAndValidity({onlySelf:!0}),q}_forEachChild(q){Object.keys(this.controls).forEach($=>{const me=this.controls[$];me&&q(me,$)})}_setUpControls(){this._forEachChild(q=>{q.setParent(this),q._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(q){for(const[$,me]of Object.entries(this.controls))if(this.contains($)&&q(me))return!0;return!1}_reduceValue(){return this._reduceChildren({},($,me,cn)=>((me.enabled||this.disabled)&&($[cn]=me.value),$))}_reduceChildren(q,$){let me=q;return this._forEachChild((cn,Ci)=>{me=$(me,cn,Ci)}),me}_allControlsDisabled(){for(const q of Object.keys(this.controls))if(this.controls[q].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(q){return this.controls.hasOwnProperty(q)?this.controls[q]:null}}function en(ne,q){tt(ne,q),q.valueAccessor.writeValue(ne.value),ne.disabled&&q.valueAccessor.setDisabledState?.(!0),function bn(ne,q){q.valueAccessor.registerOnChange($=>{ne._pendingValue=$,ne._pendingChange=!0,ne._pendingDirty=!0,"change"===ne.updateOn&&Ri(ne,q)})}(ne,q),function jn(ne,q){const $=(me,cn)=>{q.valueAccessor.writeValue(me),cn&&q.viewToModelUpdate(me)};ne.registerOnChange($),q._registerOnDestroy(()=>{ne._unregisterOnChange($)})}(ne,q),function ti(ne,q){q.valueAccessor.registerOnTouched(()=>{ne._pendingTouched=!0,"blur"===ne.updateOn&&ne._pendingChange&&Ri(ne,q),"submit"!==ne.updateOn&&ne.markAsTouched()})}(ne,q),function Oe(ne,q){if(q.valueAccessor.setDisabledState){const $=me=>{q.valueAccessor.setDisabledState(me)};ne.registerOnDisabledChange($),q._registerOnDestroy(()=>{ne._unregisterOnDisabledChange($)})}}(ne,q)}function Le(ne,q,$=!0){const me=()=>{};q.valueAccessor&&(q.valueAccessor.registerOnChange(me),q.valueAccessor.registerOnTouched(me)),Nt(ne,q),ne&&(q._invokeOnDestroyCallbacks(),ne._registerOnCollectionChange(()=>{}))}function Ge(ne,q){ne.forEach($=>{$.registerOnValidatorChange&&$.registerOnValidatorChange(q)})}function tt(ne,q){const $=Zn(ne);null!==q.validator?ne.setValidators(Ln($,q.validator)):"function"==typeof $&&ne.setValidators([$]);const me=Rt(ne);null!==q.asyncValidator?ne.setAsyncValidators(Ln(me,q.asyncValidator)):"function"==typeof me&&ne.setAsyncValidators([me]);const cn=()=>ne.updateValueAndValidity();Ge(q._rawValidators,cn),Ge(q._rawAsyncValidators,cn)}function Nt(ne,q){let $=!1;if(null!==ne){if(null!==q.validator){const cn=Zn(ne);if(Array.isArray(cn)&&cn.length>0){const Ci=cn.filter(Ar=>Ar!==q.validator);Ci.length!==cn.length&&($=!0,ne.setValidators(Ci))}}if(null!==q.asyncValidator){const cn=Rt(ne);if(Array.isArray(cn)&&cn.length>0){const Ci=cn.filter(Ar=>Ar!==q.asyncValidator);Ci.length!==cn.length&&($=!0,ne.setAsyncValidators(Ci))}}}const me=()=>{};return Ge(q._rawValidators,me),Ge(q._rawAsyncValidators,me),$}function Ri(ne,q){ne._pendingDirty&&ne.markAsDirty(),ne.setValue(ne._pendingValue,{emitModelToViewChange:!1}),q.viewToModelUpdate(ne._pendingValue),ne._pendingChange=!1}function At(ne,q){tt(ne,q)}function as(ne,q){ne._syncPendingControls(),q.forEach($=>{const me=$.control;"submit"===me.updateOn&&me._pendingChange&&($.viewToModelUpdate(me._pendingValue),me._pendingChange=!1)})}const ls={provide:Ei,useExisting:(0,T.Gpc)(()=>vi)},po=(()=>Promise.resolve(null))();let vi=(()=>{class ne extends Ei{constructor($,me){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new T.vpe,this.form=new Xe({},Di($),Pi(me))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl($){po.then(()=>{const me=this._findContainer($.path);$.control=me.registerControl($.name,$.control),en($.control,$),$.control.updateValueAndValidity({emitEvent:!1}),this._directives.add($)})}getControl($){return this.form.get($.path)}removeControl($){po.then(()=>{const me=this._findContainer($.path);me&&me.removeControl($.name),this._directives.delete($)})}addFormGroup($){po.then(()=>{const me=this._findContainer($.path),cn=new Xe({});At(cn,$),me.registerControl($.name,cn),cn.updateValueAndValidity({emitEvent:!1})})}removeFormGroup($){po.then(()=>{const me=this._findContainer($.path);me&&me.removeControl($.name)})}getFormGroup($){return this.form.get($.path)}updateModel($,me){po.then(()=>{this.form.get($.path).setValue(me)})}setValue($){this.control.setValue($)}onSubmit($){return this.submitted=!0,as(this.form,this._directives),this.ngSubmit.emit($),!1}onReset(){this.resetForm()}resetForm($){this.form.reset($),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer($){return $.pop(),$.length?this.form.get($):this.form}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(St,10),T.Y36(Pn,10))},ne.\u0275dir=T.lG2({type:ne,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function($,me){1&$&&T.NdJ("submit",function(Ci){return me.onSubmit(Ci)})("reset",function(){return me.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[T._Bn([ls]),T.qOj]}),ne})();function so(ne,q){const $=ne.indexOf(q);$>-1&&ne.splice($,1)}function Go(ne){return"object"==typeof ne&&null!==ne&&2===Object.keys(ne).length&&"value"in ne&&"disabled"in ne}const zr=class extends He{constructor(q=null,$,me){super(nt($),Dt(me,$)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(q),this._setUpdateStrategy($),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Y($)&&($.nonNullable||$.initialValueIsDefault)&&(this.defaultValue=Go(q)?q.value:q)}setValue(q,$={}){this.value=this._pendingValue=q,this._onChange.length&&!1!==$.emitModelToViewChange&&this._onChange.forEach(me=>me(this.value,!1!==$.emitViewToModelChange)),this.updateValueAndValidity($)}patchValue(q,$={}){this.setValue(q,$)}reset(q=this.defaultValue,$={}){this._applyFormState(q),this.markAsPristine($),this.markAsUntouched($),this.setValue(this.value,$),this._pendingChange=!1}_updateValue(){}_anyControls(q){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(q){this._onChange.push(q)}_unregisterOnChange(q){so(this._onChange,q)}registerOnDisabledChange(q){this._onDisabledChange.push(q)}_unregisterOnDisabledChange(q){so(this._onDisabledChange,q)}_forEachChild(q){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(q){Go(q)?(this.value=this._pendingValue=q.value,q.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=q}},xr={provide:Ii,useExisting:(0,T.Gpc)(()=>ra)},Lo=(()=>Promise.resolve(null))();let ra=(()=>{class ne extends Ii{constructor($,me,cn,Ci,Ar){super(),this._changeDetectorRef=Ar,this.control=new zr,this._registered=!1,this.update=new T.vpe,this._parent=$,this._setValidators(me),this._setAsyncValidators(cn),this.valueAccessor=function Gn(ne,q){if(!q)return null;let $,me,cn;return Array.isArray(q),q.forEach(Ci=>{Ci.constructor===gt?$=Ci:function jo(ne){return Object.getPrototypeOf(ne.constructor)===Je}(Ci)?me=Ci:cn=Ci}),cn||me||$||null}(0,Ci)}ngOnChanges($){if(this._checkForErrors(),!this._registered||"name"in $){if(this._registered&&(this._checkName(),this.formDirective)){const me=$.name.previousValue;this.formDirective.removeControl({name:me,path:this._getPath(me)})}this._setUpControl()}"isDisabled"in $&&this._updateDisabled($),function Uo(ne,q){if(!ne.hasOwnProperty("model"))return!1;const $=ne.model;return!!$.isFirstChange()||!Object.is(q,$.currentValue)}($,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate($){this.viewModel=$,this.update.emit($)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){en(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue($){Lo.then(()=>{this.control.setValue($,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled($){const me=$.isDisabled.currentValue,cn=0!==me&&(0,T.D6c)(me);Lo.then(()=>{cn&&!this.control.disabled?this.control.disable():!cn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath($){return this._parent?function Et(ne,q){return[...q.path,ne]}($,this._parent):[$]}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(Ei,9),T.Y36(St,10),T.Y36(Pn,10),T.Y36(ye,10),T.Y36(T.sBO,8))},ne.\u0275dir=T.lG2({type:ne,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[T._Bn([xr]),T.qOj,T.TTD]}),ne})(),oa=(()=>{class ne{}return ne.\u0275fac=function($){return new($||ne)},ne.\u0275mod=T.oAB({type:ne}),ne.\u0275inj=T.cJS({}),ne})();const Hs={provide:Ei,useExisting:(0,T.Gpc)(()=>tl)};let tl=(()=>{class ne extends Ei{constructor($,me){super(),this.validators=$,this.asyncValidators=me,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new T.vpe,this._setValidators($),this._setAsyncValidators(me)}ngOnChanges($){this._checkFormPresent(),$.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Nt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl($){const me=this.form.get($.path);return en(me,$),me.updateValueAndValidity({emitEvent:!1}),this.directives.push($),me}getControl($){return this.form.get($.path)}removeControl($){Le($.control||null,$,!1),function ri(ne,q){const $=ne.indexOf(q);$>-1&&ne.splice($,1)}(this.directives,$)}addFormGroup($){this._setUpFormContainer($)}removeFormGroup($){this._cleanUpFormContainer($)}getFormGroup($){return this.form.get($.path)}addFormArray($){this._setUpFormContainer($)}removeFormArray($){this._cleanUpFormContainer($)}getFormArray($){return this.form.get($.path)}updateModel($,me){this.form.get($.path).setValue(me)}onSubmit($){return this.submitted=!0,as(this.form,this.directives),this.ngSubmit.emit($),!1}onReset(){this.resetForm()}resetForm($){this.form.reset($),this.submitted=!1}_updateDomValue(){this.directives.forEach($=>{const me=$.control,cn=this.form.get($.path);me!==cn&&(Le(me||null,$),(ne=>ne instanceof zr)(cn)&&(en(cn,$),$.control=cn))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer($){const me=this.form.get($.path);At(me,$),me.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer($){if(this.form){const me=this.form.get($.path);me&&function nr(ne,q){return Nt(ne,q)}(me,$)&&me.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){tt(this.form,this),this._oldForm&&Nt(this._oldForm,this)}_checkFormPresent(){}}return ne.\u0275fac=function($){return new($||ne)(T.Y36(St,10),T.Y36(Pn,10))},ne.\u0275dir=T.lG2({type:ne,selectors:[["","formGroup",""]],hostBindings:function($,me){1&$&&T.NdJ("submit",function(Ci){return me.onSubmit(Ci)})("reset",function(){return me.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[T._Bn([Hs]),T.qOj,T.TTD]}),ne})(),Ca=(()=>{class ne{constructor(){this._validator=Gt}ngOnChanges($){if(this.inputName in $){const me=this.normalizeInput($[this.inputName].currentValue);this._enabled=this.enabled(me),this._validator=this._enabled?this.createValidator(me):Gt,this._onChange&&this._onChange()}}validate($){return this._validator($)}registerOnValidatorChange($){this._onChange=$}enabled($){return null!=$}}return ne.\u0275fac=function($){return new($||ne)},ne.\u0275dir=T.lG2({type:ne,features:[T.TTD]}),ne})();const vo={provide:St,useExisting:(0,T.Gpc)(()=>da),multi:!0},Co={provide:St,useExisting:(0,T.Gpc)(()=>Li),multi:!0};let da=(()=>{class ne extends Ca{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=T.D6c,this.createValidator=$=>fn}enabled($){return $}}return ne.\u0275fac=function(){let q;return function(me){return(q||(q=T.n5z(ne)))(me||ne)}}(),ne.\u0275dir=T.lG2({type:ne,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function($,me){2&$&&T.uIk("required",me._enabled?"":null)},inputs:{required:"required"},features:[T._Bn([vo]),T.qOj]}),ne})(),Li=(()=>{class ne extends da{constructor(){super(...arguments),this.createValidator=$=>Jt}}return ne.\u0275fac=function(){let q;return function(me){return(q||(q=T.n5z(ne)))(me||ne)}}(),ne.\u0275dir=T.lG2({type:ne,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function($,me){2&$&&T.uIk("required",me._enabled?"":null)},features:[T._Bn([Co]),T.qOj]}),ne})(),Vi=(()=>{class ne{}return ne.\u0275fac=function($){return new($||ne)},ne.\u0275mod=T.oAB({type:ne}),ne.\u0275inj=T.cJS({imports:[oa]}),ne})(),kr=(()=>{class ne{}return ne.\u0275fac=function($){return new($||ne)},ne.\u0275mod=T.oAB({type:ne}),ne.\u0275inj=T.cJS({imports:[Vi]}),ne})()},4859:(Bn,kt,j)=>{"use strict";j.d(kt,{lW:()=>Ye,ot:()=>Pe,zs:()=>ft});var T=j(4650),d=j(3238),W=j(2687);const c=["mat-button",""],Ce=["*"],ye=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],Me=(0,d.pj)((0,d.Id)((0,d.Kr)(class{constructor(ut){this._elementRef=ut}})));let Ye=(()=>{class ut extends Me{constructor(et,Ut,Ft){super(et),this._focusMonitor=Ut,this._animationMode=Ft,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const St of ye)this._hasHostAttributes(St)&&this._getHostElement().classList.add(St);et.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(et,Ut){et?this._focusMonitor.focusVia(this._getHostElement(),et,Ut):this._getHostElement().focus(Ut)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...et){return et.some(Ut=>this._getHostElement().hasAttribute(Ut))}}return ut.\u0275fac=function(et){return new(et||ut)(T.Y36(T.SBq),T.Y36(W.tE),T.Y36(T.QbO,8))},ut.\u0275cmp=T.Xpm({type:ut,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(et,Ut){if(1&et&&T.Gf(d.wG,5),2&et){let Ft;T.iGM(Ft=T.CRH())&&(Ut.ripple=Ft.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(et,Ut){2&et&&(T.uIk("disabled",Ut.disabled||null),T.ekj("_mat-animation-noopable","NoopAnimations"===Ut._animationMode)("mat-button-disabled",Ut.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[T.qOj],attrs:c,ngContentSelectors:Ce,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(et,Ut){1&et&&(T.F$t(),T.TgZ(0,"span",0),T.Hsn(1),T.qZA(),T._UZ(2,"span",1)(3,"span",2)),2&et&&(T.xp6(2),T.ekj("mat-button-ripple-round",Ut.isRoundButton||Ut.isIconButton),T.Q6J("matRippleDisabled",Ut._isRippleDisabled())("matRippleCentered",Ut.isIconButton)("matRippleTrigger",Ut._getHostElement()))},dependencies:[d.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),ut})(),ft=(()=>{class ut extends Ye{constructor(et,Ut,Ft,St){super(Ut,et,Ft),this._ngZone=St,this._haltDisabledEvents=Pn=>{this.disabled&&(Pn.preventDefault(),Pn.stopImmediatePropagation())}}ngAfterViewInit(){super.ngAfterViewInit(),this._ngZone?this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}):this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}}return ut.\u0275fac=function(et){return new(et||ut)(T.Y36(W.tE),T.Y36(T.SBq),T.Y36(T.QbO,8),T.Y36(T.R0b,8))},ut.\u0275cmp=T.Xpm({type:ut,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(et,Ut){2&et&&(T.uIk("tabindex",Ut.disabled?-1:Ut.tabIndex)("disabled",Ut.disabled||null)("aria-disabled",Ut.disabled.toString()),T.ekj("_mat-animation-noopable","NoopAnimations"===Ut._animationMode)("mat-button-disabled",Ut.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[T.qOj],attrs:c,ngContentSelectors:Ce,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(et,Ut){1&et&&(T.F$t(),T.TgZ(0,"span",0),T.Hsn(1),T.qZA(),T._UZ(2,"span",1)(3,"span",2)),2&et&&(T.xp6(2),T.ekj("mat-button-ripple-round",Ut.isRoundButton||Ut.isIconButton),T.Q6J("matRippleDisabled",Ut._isRippleDisabled())("matRippleCentered",Ut.isIconButton)("matRippleTrigger",Ut._getHostElement()))},dependencies:[d.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),ut})(),Pe=(()=>{class ut{}return ut.\u0275fac=function(et){return new(et||ut)},ut.\u0275mod=T.oAB({type:ut}),ut.\u0275inj=T.cJS({imports:[d.si,d.BQ,d.BQ]}),ut})()},3238:(Bn,kt,j)=>{"use strict";j.d(kt,{rD:()=>Rt,K7:()=>We,HF:()=>ze,BQ:()=>Fe,X2:()=>Kt,uc:()=>gn,ey:()=>ii,Ng:()=>mi,nP:()=>De,us:()=>dt,wG:()=>K,si:()=>ie,CB:()=>qn,jH:()=>gr,pj:()=>vn,Kr:()=>xt,Id:()=>rn,FD:()=>Gt,dB:()=>Bt,sb:()=>Tt,E0:()=>kn});var T=j(4650),d=j(2687),W=j(445),Ce=j(6895),Ve=j(3353),Je=j(1281),ye=j(9751),Me=j(7579),Ye=j(8675),ft=j(9521);function gt(zt,mt){if(1&zt&&T._UZ(0,"mat-pseudo-checkbox",4),2&zt){const _t=T.oxw();T.Q6J("state",_t.selected?"checked":"unchecked")("disabled",_t.disabled)}}function et(zt,mt){if(1&zt&&(T.TgZ(0,"span",5),T._uU(1),T.qZA()),2&zt){const _t=T.oxw();T.xp6(1),T.hij("(",_t.group.label,")")}}const Ut=["*"],Xt=new T.OlP("mat-sanity-checks",{providedIn:"root",factory:function Xn(){return!0}});let Fe=(()=>{class zt{constructor(_t,Ke,nt){this._sanityChecks=Ke,this._document=nt,this._hasDoneGlobalChecks=!1,_t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(_t){return!(0,Ve.Oy)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[_t])}}return zt.\u0275fac=function(_t){return new(_t||zt)(T.LFG(d.qm),T.LFG(Xt,8),T.LFG(Ce.K0))},zt.\u0275mod=T.oAB({type:zt}),zt.\u0275inj=T.cJS({imports:[W.vT,W.vT]}),zt})();function rn(zt){return class extends zt{constructor(...mt){super(...mt),this._disabled=!1}get disabled(){return this._disabled}set disabled(mt){this._disabled=(0,Je.Ig)(mt)}}}function vn(zt,mt){return class extends zt{constructor(..._t){super(..._t),this.defaultColor=mt,this.color=mt}get color(){return this._color}set color(_t){const Ke=_t||this.defaultColor;Ke!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),Ke&&this._elementRef.nativeElement.classList.add(`mat-${Ke}`),this._color=Ke)}}}function xt(zt){return class extends zt{constructor(...mt){super(...mt),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(mt){this._disableRipple=(0,Je.Ig)(mt)}}}function Tt(zt,mt=0){return class extends zt{constructor(..._t){super(..._t),this._tabIndex=mt,this.defaultTabIndex=mt}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(_t){this._tabIndex=null!=_t?(0,Je.su)(_t):this.defaultTabIndex}}}function Gt(zt){return class extends zt{constructor(...mt){super(...mt),this.errorState=!1}updateErrorState(){const mt=this.errorState,Be=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);Be!==mt&&(this.errorState=Be,this.stateChanges.next())}}}function Bt(zt){return class extends zt{constructor(...mt){super(...mt),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new ye.y(_t=>{this._isInitialized?this._notifySubscriber(_t):this._pendingSubscribers.push(_t)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(mt){mt.next(),mt.complete()}}}let Rt=(()=>{class zt{isErrorState(_t,Ke){return!!(_t&&_t.invalid&&(_t.touched||Ke&&Ke.submitted))}}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275prov=T.Yz7({token:zt,factory:zt.\u0275fac,providedIn:"root"}),zt})(),Kt=(()=>{class zt{}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275dir=T.lG2({type:zt,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),zt})();function kn(zt,mt,_t="mat"){zt.changes.pipe((0,Ye.O)(zt)).subscribe(({length:Ke})=>{zn(mt,`${_t}-2-line`,!1),zn(mt,`${_t}-3-line`,!1),zn(mt,`${_t}-multi-line`,!1),2===Ke||3===Ke?zn(mt,`${_t}-${Ke}-line`,!0):Ke>3&&zn(mt,`${_t}-multi-line`,!0)})}function zn(zt,mt,_t){zt.nativeElement.classList.toggle(mt,_t)}let gn=(()=>{class zt{}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275mod=T.oAB({type:zt}),zt.\u0275inj=T.cJS({imports:[Fe,Fe]}),zt})();class wi{constructor(mt,_t,Ke,nt=!1){this._renderer=mt,this.element=_t,this.config=Ke,this._animationForciblyDisabledThroughCss=nt,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const Ei={enterDuration:225,exitDuration:150},or=(0,Ve.i$)({passive:!0}),Oi=["mousedown","touchstart"],En=["mouseup","mouseleave","touchend","touchcancel"];class Wi{constructor(mt,_t,Ke,nt){this._target=mt,this._ngZone=_t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,nt.isBrowser&&(this._containerElement=(0,Je.fI)(Ke))}fadeInRipple(mt,_t,Ke={}){const nt=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),Be={...Ei,...Ke.animation};Ke.centered&&(mt=nt.left+nt.width/2,_t=nt.top+nt.height/2);const Dt=Ke.radius||function li(zt,mt,_t){const Ke=Math.max(Math.abs(zt-_t.left),Math.abs(zt-_t.right)),nt=Math.max(Math.abs(mt-_t.top),Math.abs(mt-_t.bottom));return Math.sqrt(Ke*Ke+nt*nt)}(mt,_t,nt),ae=mt-nt.left,Y=_t-nt.top,le=Be.enterDuration,Te=document.createElement("div");Te.classList.add("mat-ripple-element"),Te.style.left=ae-Dt+"px",Te.style.top=Y-Dt+"px",Te.style.height=2*Dt+"px",Te.style.width=2*Dt+"px",null!=Ke.color&&(Te.style.backgroundColor=Ke.color),Te.style.transitionDuration=`${le}ms`,this._containerElement.appendChild(Te);const He=window.getComputedStyle(Te),Mt=He.transitionDuration,Ct="none"===He.transitionProperty||"0s"===Mt||"0s, 0s"===Mt,lt=new wi(this,Te,Ke,Ct);Te.style.transform="scale3d(1, 1, 1)",lt.state=0,Ke.persistent||(this._mostRecentTransientRipple=lt);let Ot=null;return!Ct&&(le||Be.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Et=()=>this._finishRippleTransition(lt),en=()=>this._destroyRipple(lt);Te.addEventListener("transitionend",Et),Te.addEventListener("transitioncancel",en),Ot={onTransitionEnd:Et,onTransitionCancel:en}}),this._activeRipples.set(lt,Ot),(Ct||!le)&&this._finishRippleTransition(lt),lt}fadeOutRipple(mt){if(2===mt.state||3===mt.state)return;const _t=mt.element,Ke={...Ei,...mt.config.animation};_t.style.transitionDuration=`${Ke.exitDuration}ms`,_t.style.opacity="0",mt.state=2,(mt._animationForciblyDisabledThroughCss||!Ke.exitDuration)&&this._finishRippleTransition(mt)}fadeOutAll(){this._getActiveRipples().forEach(mt=>mt.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(mt=>{mt.config.persistent||mt.fadeOut()})}setupTriggerEvents(mt){const _t=(0,Je.fI)(mt);!_t||_t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=_t,this._registerEvents(Oi))}handleEvent(mt){"mousedown"===mt.type?this._onMousedown(mt):"touchstart"===mt.type?this._onTouchStart(mt):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(En),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(mt){0===mt.state?this._startFadeOutTransition(mt):2===mt.state&&this._destroyRipple(mt)}_startFadeOutTransition(mt){const _t=mt===this._mostRecentTransientRipple,{persistent:Ke}=mt.config;mt.state=1,!Ke&&(!_t||!this._isPointerDown)&&mt.fadeOut()}_destroyRipple(mt){const _t=this._activeRipples.get(mt)??null;this._activeRipples.delete(mt),this._activeRipples.size||(this._containerRect=null),mt===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),mt.state=3,null!==_t&&(mt.element.removeEventListener("transitionend",_t.onTransitionEnd),mt.element.removeEventListener("transitioncancel",_t.onTransitionCancel)),mt.element.remove()}_onMousedown(mt){const _t=(0,d.X6)(mt),Ke=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!_t&&!Ke&&(this._isPointerDown=!0,this.fadeInRipple(mt.clientX,mt.clientY,this._target.rippleConfig))}_onTouchStart(mt){if(!this._target.rippleDisabled&&!(0,d.yG)(mt)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const _t=mt.changedTouches;for(let Ke=0;Ke<_t.length;Ke++)this.fadeInRipple(_t[Ke].clientX,_t[Ke].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(mt=>{!mt.config.persistent&&(1===mt.state||mt.config.terminateOnPointerUp&&0===mt.state)&&mt.fadeOut()}))}_registerEvents(mt){this._ngZone.runOutsideAngular(()=>{mt.forEach(_t=>{this._triggerElement.addEventListener(_t,this,or)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(Oi.forEach(mt=>{this._triggerElement.removeEventListener(mt,this,or)}),this._pointerUpEventsRegistered&&En.forEach(mt=>{this._triggerElement.removeEventListener(mt,this,or)}))}}const ct=new T.OlP("mat-ripple-global-options");let K=(()=>{class zt{constructor(_t,Ke,nt,Be,Dt){this._elementRef=_t,this._animationMode=Dt,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=Be||{},this._rippleRenderer=new Wi(this,Ke,_t,nt)}get disabled(){return this._disabled}set disabled(_t){_t&&this.fadeOutAllNonPersistent(),this._disabled=_t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(_t){this._trigger=_t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(_t,Ke=0,nt){return"number"==typeof _t?this._rippleRenderer.fadeInRipple(_t,Ke,{...this.rippleConfig,...nt}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,..._t})}}return zt.\u0275fac=function(_t){return new(_t||zt)(T.Y36(T.SBq),T.Y36(T.R0b),T.Y36(Ve.t4),T.Y36(ct,8),T.Y36(T.QbO,8))},zt.\u0275dir=T.lG2({type:zt,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(_t,Ke){2&_t&&T.ekj("mat-ripple-unbounded",Ke.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),zt})(),ie=(()=>{class zt{}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275mod=T.oAB({type:zt}),zt.\u0275inj=T.cJS({imports:[Fe,Fe]}),zt})(),De=(()=>{class zt{constructor(_t){this._animationMode=_t,this.state="unchecked",this.disabled=!1}}return zt.\u0275fac=function(_t){return new(_t||zt)(T.Y36(T.QbO,8))},zt.\u0275cmp=T.Xpm({type:zt,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(_t,Ke){2&_t&&T.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===Ke.state)("mat-pseudo-checkbox-checked","checked"===Ke.state)("mat-pseudo-checkbox-disabled",Ke.disabled)("_mat-animation-noopable","NoopAnimations"===Ke._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(_t,Ke){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}'],encapsulation:2,changeDetection:0}),zt})(),dt=(()=>{class zt{}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275mod=T.oAB({type:zt}),zt.\u0275inj=T.cJS({imports:[Fe]}),zt})();const ze=new T.OlP("MAT_OPTION_PARENT_COMPONENT"),We=new T.OlP("MatOptgroup");let Qt=0;class _n{constructor(mt,_t=!1){this.source=mt,this.isUserInput=_t}}let An=(()=>{class zt{constructor(_t,Ke,nt,Be){this._element=_t,this._changeDetectorRef=Ke,this._parent=nt,this.group=Be,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Qt++,this.onSelectionChange=new T.vpe,this._stateChanges=new Me.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(_t){this._disabled=(0,Je.Ig)(_t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(_t,Ke){const nt=this._getHostElement();"function"==typeof nt.focus&&nt.focus(Ke)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(_t){(_t.keyCode===ft.K5||_t.keyCode===ft.L_)&&!(0,ft.Vb)(_t)&&(this._selectViaInteraction(),_t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const _t=this.viewValue;_t!==this._mostRecentViewValue&&(this._mostRecentViewValue=_t,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(_t=!1){this.onSelectionChange.emit(new _n(this,_t))}}return zt.\u0275fac=function(_t){T.$Z()},zt.\u0275dir=T.lG2({type:zt,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),zt})(),ii=(()=>{class zt extends An{constructor(_t,Ke,nt,Be){super(_t,Ke,nt,Be)}}return zt.\u0275fac=function(_t){return new(_t||zt)(T.Y36(T.SBq),T.Y36(T.sBO),T.Y36(ze,8),T.Y36(We,8))},zt.\u0275cmp=T.Xpm({type:zt,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(_t,Ke){1&_t&&T.NdJ("click",function(){return Ke._selectViaInteraction()})("keydown",function(Be){return Ke._handleKeydown(Be)}),2&_t&&(T.Ikx("id",Ke.id),T.uIk("tabindex",Ke._getTabIndex())("aria-selected",Ke._getAriaSelected())("aria-disabled",Ke.disabled.toString()),T.ekj("mat-selected",Ke.selected)("mat-option-multiple",Ke.multiple)("mat-active",Ke.active)("mat-option-disabled",Ke.disabled))},exportAs:["matOption"],features:[T.qOj],ngContentSelectors:Ut,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(_t,Ke){1&_t&&(T.F$t(),T.YNc(0,gt,1,2,"mat-pseudo-checkbox",0),T.TgZ(1,"span",1),T.Hsn(2),T.qZA(),T.YNc(3,et,2,1,"span",2),T._UZ(4,"div",3)),2&_t&&(T.Q6J("ngIf",Ke.multiple),T.xp6(3),T.Q6J("ngIf",Ke.group&&Ke.group._inert),T.xp6(1),T.Q6J("matRippleTrigger",Ke._getHostElement())("matRippleDisabled",Ke.disabled||Ke.disableRipple))},dependencies:[K,Ce.O5,De],styles:['.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.mat-option.mat-active::before{content:""}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{right:auto;left:16px}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}'],encapsulation:2,changeDetection:0}),zt})();function qn(zt,mt,_t){if(_t.length){let Ke=mt.toArray(),nt=_t.toArray(),Be=0;for(let Dt=0;Dt<zt+1;Dt++)Ke[Dt].group&&Ke[Dt].group===nt[Be]&&Be++;return Be}return 0}function gr(zt,mt,_t,Ke){return zt<_t?zt:zt+mt>_t+Ke?Math.max(0,zt-Ke+mt):_t}let mi=(()=>{class zt{}return zt.\u0275fac=function(_t){return new(_t||zt)},zt.\u0275mod=T.oAB({type:zt}),zt.\u0275inj=T.cJS({imports:[ie,Ce.ez,Fe,dt]}),zt})()},9549:(Bn,kt,j)=>{"use strict";j.d(kt,{Eo:()=>Yn,G_:()=>En,KE:()=>Wi,R9:()=>gn,lN:()=>li});var T=j(9643),d=j(6895),W=j(4650),c=j(3238),Ce=j(445),Ve=j(1281),Je=j(7579),ye=j(6451),Me=j(4968),Ye=j(8675),ft=j(2722),Pe=j(5698),ut=j(7340),gt=j(3353);const et=["connectionContainer"],Ut=["inputContainer"],Ft=["label"];function St(ct,K){1&ct&&(W.ynx(0),W.TgZ(1,"div",14),W._UZ(2,"div",15)(3,"div",16)(4,"div",17),W.qZA(),W.TgZ(5,"div",18),W._UZ(6,"div",15)(7,"div",16)(8,"div",17),W.qZA(),W.BQk())}function Pn(ct,K){if(1&ct){const ie=W.EpF();W.TgZ(0,"div",19),W.NdJ("cdkObserveContent",function(){W.CHM(ie);const dt=W.oxw();return W.KtG(dt.updateOutlineGap())}),W.Hsn(1,1),W.qZA()}if(2&ct){const ie=W.oxw();W.Q6J("cdkObserveContentDisabled","outline"!=ie.appearance)}}function Xn(ct,K){if(1&ct&&(W.ynx(0),W.Hsn(1,2),W.TgZ(2,"span"),W._uU(3),W.qZA(),W.BQk()),2&ct){const ie=W.oxw(2);W.xp6(3),W.Oqu(ie._control.placeholder)}}function Xt(ct,K){1&ct&&W.Hsn(0,3,["*ngSwitchCase","true"])}function Fe(ct,K){1&ct&&(W.TgZ(0,"span",23),W._uU(1," *"),W.qZA())}function Qe(ct,K){if(1&ct){const ie=W.EpF();W.TgZ(0,"label",20,21),W.NdJ("cdkObserveContent",function(){W.CHM(ie);const dt=W.oxw();return W.KtG(dt.updateOutlineGap())}),W.YNc(2,Xn,4,1,"ng-container",12),W.YNc(3,Xt,1,0,"ng-content",12),W.YNc(4,Fe,2,0,"span",22),W.qZA()}if(2&ct){const ie=W.oxw();W.ekj("mat-empty",ie._control.empty&&!ie._shouldAlwaysFloat())("mat-form-field-empty",ie._control.empty&&!ie._shouldAlwaysFloat())("mat-accent","accent"==ie.color)("mat-warn","warn"==ie.color),W.Q6J("cdkObserveContentDisabled","outline"!=ie.appearance)("id",ie._labelId)("ngSwitch",ie._hasLabel()),W.uIk("for",ie._control.id)("aria-owns",ie._control.id),W.xp6(2),W.Q6J("ngSwitchCase",!1),W.xp6(1),W.Q6J("ngSwitchCase",!0),W.xp6(1),W.Q6J("ngIf",!ie.hideRequiredMarker&&ie._control.required&&!ie._control.disabled)}}function fn(ct,K){1&ct&&(W.TgZ(0,"div",24),W.Hsn(1,4),W.qZA())}function Jt(ct,K){if(1&ct&&(W.TgZ(0,"div",25),W._UZ(1,"span",26),W.qZA()),2&ct){const ie=W.oxw();W.xp6(1),W.ekj("mat-accent","accent"==ie.color)("mat-warn","warn"==ie.color)}}function rn(ct,K){if(1&ct&&(W.TgZ(0,"div"),W.Hsn(1,5),W.qZA()),2&ct){const ie=W.oxw();W.Q6J("@transitionMessages",ie._subscriptAnimationState)}}function vn(ct,K){if(1&ct&&(W.TgZ(0,"div",30),W._uU(1),W.qZA()),2&ct){const ie=W.oxw(2);W.Q6J("id",ie._hintLabelId),W.xp6(1),W.Oqu(ie.hintLabel)}}function xt(ct,K){if(1&ct&&(W.TgZ(0,"div",27),W.YNc(1,vn,2,2,"div",28),W.Hsn(2,6),W._UZ(3,"div",29),W.Hsn(4,7),W.qZA()),2&ct){const ie=W.oxw();W.Q6J("@transitionMessages",ie._subscriptAnimationState),W.xp6(1),W.Q6J("ngIf",ie.hintLabel)}}const Tt=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Gt=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],Cn=new W.OlP("MatError"),oi={transitionMessages:(0,ut.X$)("transitionMessages",[(0,ut.SB)("enter",(0,ut.oB)({opacity:1,transform:"translateY(0%)"})),(0,ut.eR)("void => enter",[(0,ut.oB)({opacity:0,transform:"translateY(-5px)"}),(0,ut.jt)("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Yn=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275dir=W.lG2({type:ct}),ct})();const Pi=new W.OlP("MatHint");let Zn=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275dir=W.lG2({type:ct,selectors:[["mat-label"]]}),ct})(),Rt=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275dir=W.lG2({type:ct,selectors:[["mat-placeholder"]]}),ct})();const Kt=new W.OlP("MatPrefix"),zn=new W.OlP("MatSuffix");let gn=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275dir=W.lG2({type:ct,selectors:[["","matSuffix",""]],features:[W._Bn([{provide:zn,useExisting:ct}])]}),ct})(),wi=0;const or=(0,c.pj)(class{constructor(ct){this._elementRef=ct}},"primary"),Oi=new W.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),En=new W.OlP("MatFormField");let Wi=(()=>{class ct extends or{constructor(ie,De,dt,ze,he,ce,de){super(ie),this._changeDetectorRef=De,this._dir=dt,this._defaults=ze,this._platform=he,this._ngZone=ce,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Je.x,this._hideRequiredMarker=!1,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+wi++,this._labelId="mat-form-field-label-"+wi++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==de,this.appearance=ze?.appearance||"legacy",ze&&(this._hideRequiredMarker=Boolean(ze.hideRequiredMarker),ze.color&&(this.color=this.defaultColor=ze.color))}get appearance(){return this._appearance}set appearance(ie){const De=this._appearance;this._appearance=ie||this._defaults?.appearance||"legacy","outline"===this._appearance&&De!==ie&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(ie){this._hideRequiredMarker=(0,Ve.Ig)(ie)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(ie){this._hintLabel=ie,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(ie){ie!==this._floatLabel&&(this._floatLabel=ie||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(ie){this._explicitFormFieldControl=ie}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const ie=this._control;ie.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${ie.controlType}`),ie.stateChanges.pipe((0,Ye.O)(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),ie.ngControl&&ie.ngControl.valueChanges&&ie.ngControl.valueChanges.pipe((0,ft.R)(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,ft.R)(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,ye.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe((0,Ye.O)(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe((0,Ye.O)(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe((0,ft.R)(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(ie){const De=this._control?this._control.ngControl:null;return De&&De[ie]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,(0,Me.R)(this._label.nativeElement,"transitionend").pipe((0,Pe.q)(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let ie=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&ie.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const De=this._hintChildren?this._hintChildren.find(ze=>"start"===ze.align):null,dt=this._hintChildren?this._hintChildren.find(ze=>"end"===ze.align):null;De?ie.push(De.id):this._hintLabel&&ie.push(this._hintLabelId),dt&&ie.push(dt.id)}else this._errorChildren&&ie.push(...this._errorChildren.map(De=>De.id));this._control.setDescribedByIds(ie)}}_validateControlChild(){}updateOutlineGap(){const ie=this._label?this._label.nativeElement:null,De=this._connectionContainerRef.nativeElement,dt=".mat-form-field-outline-start",ze=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!ie||!ie.children.length||!ie.textContent.trim()){const ht=De.querySelectorAll(`${dt}, ${ze}`);for(let Qt=0;Qt<ht.length;Qt++)ht[Qt].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let he=0,ce=0;const de=De.querySelectorAll(dt),We=De.querySelectorAll(ze);if(this._label&&this._label.nativeElement.children.length){const ht=De.getBoundingClientRect();if(0===ht.width&&0===ht.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const Qt=this._getStartEnd(ht),_n=ie.children,An=this._getStartEnd(_n[0].getBoundingClientRect());let ii=0;for(let qn=0;qn<_n.length;qn++)ii+=_n[qn].offsetWidth;he=Math.abs(An-Qt)-5,ce=ii>0?.75*ii+10:0}for(let ht=0;ht<de.length;ht++)de[ht].style.width=`${he}px`;for(let ht=0;ht<We.length;ht++)We[ht].style.width=`${ce}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(ie){return this._dir&&"rtl"===this._dir.value?ie.right:ie.left}_isAttachedToDOM(){const ie=this._elementRef.nativeElement;if(ie.getRootNode){const De=ie.getRootNode();return De&&De!==ie}return document.documentElement.contains(ie)}}return ct.\u0275fac=function(ie){return new(ie||ct)(W.Y36(W.SBq),W.Y36(W.sBO),W.Y36(Ce.Is,8),W.Y36(Oi,8),W.Y36(gt.t4),W.Y36(W.R0b),W.Y36(W.QbO,8))},ct.\u0275cmp=W.Xpm({type:ct,selectors:[["mat-form-field"]],contentQueries:function(ie,De,dt){if(1&ie&&(W.Suo(dt,Yn,5),W.Suo(dt,Yn,7),W.Suo(dt,Zn,5),W.Suo(dt,Zn,7),W.Suo(dt,Rt,5),W.Suo(dt,Cn,5),W.Suo(dt,Pi,5),W.Suo(dt,Kt,5),W.Suo(dt,zn,5)),2&ie){let ze;W.iGM(ze=W.CRH())&&(De._controlNonStatic=ze.first),W.iGM(ze=W.CRH())&&(De._controlStatic=ze.first),W.iGM(ze=W.CRH())&&(De._labelChildNonStatic=ze.first),W.iGM(ze=W.CRH())&&(De._labelChildStatic=ze.first),W.iGM(ze=W.CRH())&&(De._placeholderChild=ze.first),W.iGM(ze=W.CRH())&&(De._errorChildren=ze),W.iGM(ze=W.CRH())&&(De._hintChildren=ze),W.iGM(ze=W.CRH())&&(De._prefixChildren=ze),W.iGM(ze=W.CRH())&&(De._suffixChildren=ze)}},viewQuery:function(ie,De){if(1&ie&&(W.Gf(et,7),W.Gf(Ut,5),W.Gf(Ft,5)),2&ie){let dt;W.iGM(dt=W.CRH())&&(De._connectionContainerRef=dt.first),W.iGM(dt=W.CRH())&&(De._inputContainerRef=dt.first),W.iGM(dt=W.CRH())&&(De._label=dt.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(ie,De){2&ie&&W.ekj("mat-form-field-appearance-standard","standard"==De.appearance)("mat-form-field-appearance-fill","fill"==De.appearance)("mat-form-field-appearance-outline","outline"==De.appearance)("mat-form-field-appearance-legacy","legacy"==De.appearance)("mat-form-field-invalid",De._control.errorState)("mat-form-field-can-float",De._canLabelFloat())("mat-form-field-should-float",De._shouldLabelFloat())("mat-form-field-has-label",De._hasFloatingLabel())("mat-form-field-hide-placeholder",De._hideControlPlaceholder())("mat-form-field-disabled",De._control.disabled)("mat-form-field-autofilled",De._control.autofilled)("mat-focused",De._control.focused)("ng-untouched",De._shouldForward("untouched"))("ng-touched",De._shouldForward("touched"))("ng-pristine",De._shouldForward("pristine"))("ng-dirty",De._shouldForward("dirty"))("ng-valid",De._shouldForward("valid"))("ng-invalid",De._shouldForward("invalid"))("ng-pending",De._shouldForward("pending"))("_mat-animation-noopable",!De._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[W._Bn([{provide:En,useExisting:ct}]),W.qOj],ngContentSelectors:Gt,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(ie,De){1&ie&&(W.F$t(Tt),W.TgZ(0,"div",0)(1,"div",1,2),W.NdJ("click",function(ze){return De._control.onContainerClick&&De._control.onContainerClick(ze)}),W.YNc(3,St,9,0,"ng-container",3),W.YNc(4,Pn,2,1,"div",4),W.TgZ(5,"div",5,6),W.Hsn(7),W.TgZ(8,"span",7),W.YNc(9,Qe,5,16,"label",8),W.qZA()(),W.YNc(10,fn,2,0,"div",9),W.qZA(),W.YNc(11,Jt,2,4,"div",10),W.TgZ(12,"div",11),W.YNc(13,rn,2,1,"div",12),W.YNc(14,xt,5,2,"div",13),W.qZA()()),2&ie&&(W.xp6(3),W.Q6J("ngIf","outline"==De.appearance),W.xp6(1),W.Q6J("ngIf",De._prefixChildren.length),W.xp6(5),W.Q6J("ngIf",De._hasFloatingLabel()),W.xp6(1),W.Q6J("ngIf",De._suffixChildren.length),W.xp6(1),W.Q6J("ngIf","outline"!=De.appearance),W.xp6(1),W.Q6J("ngSwitch",De._getDisplayedMessages()),W.xp6(1),W.Q6J("ngSwitchCase","error"),W.xp6(1),W.Q6J("ngSwitchCase","hint"))},dependencies:[d.O5,d.RF,d.n9,T.wD],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}','.mat-input-element{font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-input-element::placeholder{transition:none}._mat-animation-noopable .mat-input-element::-moz-placeholder{transition:none}._mat-animation-noopable .mat-input-element::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-input-element:-ms-input-placeholder{transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:rgba(0,0,0,0)}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],encapsulation:2,data:{animation:[oi.transitionMessages]},changeDetection:0}),ct})(),li=(()=>{class ct{}return ct.\u0275fac=function(ie){return new(ie||ct)},ct.\u0275mod=W.oAB({type:ct}),ct.\u0275inj=W.cJS({imports:[d.ez,c.BQ,T.Q8,c.BQ]}),ct})()},7392:(Bn,kt,j)=>{"use strict";j.d(kt,{Hw:()=>Ui,Ps:()=>Pi,jv:()=>rn});var T=j(4650),d=j(3238),W=j(1281),c=j(6895),Ce=j(9646),Ve=j(2843),Je=j(4128),ye=j(727),Me=j(8505),Ye=j(4004),ft=j(262),Pe=j(8746),ut=j(3099),gt=j(5698),et=j(529),Ut=j(1481);const Ft=["*"];let St;function Xn(Ln){return function Pn(){if(void 0===St&&(St=null,typeof window<"u")){const Ln=window;void 0!==Ln.trustedTypes&&(St=Ln.trustedTypes.createPolicy("angular#components",{createHTML:Zn=>Zn}))}return St}()?.createHTML(Ln)||Ln}function Xt(Ln){return Error(`Unable to find icon with the name "${Ln}"`)}function Qe(Ln){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${Ln}".`)}function fn(Ln){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${Ln}".`)}class Jt{constructor(Zn,Rt,Kt){this.url=Zn,this.svgText=Rt,this.options=Kt}}let rn=(()=>{class Ln{constructor(Rt,Kt,kn,zn){this._httpClient=Rt,this._sanitizer=Kt,this._errorHandler=zn,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=kn}addSvgIcon(Rt,Kt,kn){return this.addSvgIconInNamespace("",Rt,Kt,kn)}addSvgIconLiteral(Rt,Kt,kn){return this.addSvgIconLiteralInNamespace("",Rt,Kt,kn)}addSvgIconInNamespace(Rt,Kt,kn,zn){return this._addSvgIconConfig(Rt,Kt,new Jt(kn,null,zn))}addSvgIconResolver(Rt){return this._resolvers.push(Rt),this}addSvgIconLiteralInNamespace(Rt,Kt,kn,zn){const gn=this._sanitizer.sanitize(T.q3G.HTML,kn);if(!gn)throw fn(kn);const wi=Xn(gn);return this._addSvgIconConfig(Rt,Kt,new Jt("",wi,zn))}addSvgIconSet(Rt,Kt){return this.addSvgIconSetInNamespace("",Rt,Kt)}addSvgIconSetLiteral(Rt,Kt){return this.addSvgIconSetLiteralInNamespace("",Rt,Kt)}addSvgIconSetInNamespace(Rt,Kt,kn){return this._addSvgIconSetConfig(Rt,new Jt(Kt,null,kn))}addSvgIconSetLiteralInNamespace(Rt,Kt,kn){const zn=this._sanitizer.sanitize(T.q3G.HTML,Kt);if(!zn)throw fn(Kt);const gn=Xn(zn);return this._addSvgIconSetConfig(Rt,new Jt("",gn,kn))}registerFontClassAlias(Rt,Kt=Rt){return this._fontCssClassesByAlias.set(Rt,Kt),this}classNameForFontAlias(Rt){return this._fontCssClassesByAlias.get(Rt)||Rt}setDefaultFontSetClass(...Rt){return this._defaultFontSetClass=Rt,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(Rt){const Kt=this._sanitizer.sanitize(T.q3G.RESOURCE_URL,Rt);if(!Kt)throw Qe(Rt);const kn=this._cachedIconsByUrl.get(Kt);return kn?(0,Ce.of)(Tt(kn)):this._loadSvgIconFromConfig(new Jt(Rt,null)).pipe((0,Me.b)(zn=>this._cachedIconsByUrl.set(Kt,zn)),(0,Ye.U)(zn=>Tt(zn)))}getNamedSvgIcon(Rt,Kt=""){const kn=Gt(Kt,Rt);let zn=this._svgIconConfigs.get(kn);if(zn)return this._getSvgFromConfig(zn);if(zn=this._getIconConfigFromResolvers(Kt,Rt),zn)return this._svgIconConfigs.set(kn,zn),this._getSvgFromConfig(zn);const gn=this._iconSetConfigs.get(Kt);return gn?this._getSvgFromIconSetConfigs(Rt,gn):(0,Ve._)(Xt(kn))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(Rt){return Rt.svgText?(0,Ce.of)(Tt(this._svgElementFromConfig(Rt))):this._loadSvgIconFromConfig(Rt).pipe((0,Ye.U)(Kt=>Tt(Kt)))}_getSvgFromIconSetConfigs(Rt,Kt){const kn=this._extractIconWithNameFromAnySet(Rt,Kt);if(kn)return(0,Ce.of)(kn);const zn=Kt.filter(gn=>!gn.svgText).map(gn=>this._loadSvgIconSetFromConfig(gn).pipe((0,ft.K)(wi=>{const Ii=`Loading icon set URL: ${this._sanitizer.sanitize(T.q3G.RESOURCE_URL,gn.url)} failed: ${wi.message}`;return this._errorHandler.handleError(new Error(Ii)),(0,Ce.of)(null)})));return(0,Je.D)(zn).pipe((0,Ye.U)(()=>{const gn=this._extractIconWithNameFromAnySet(Rt,Kt);if(!gn)throw Xt(Rt);return gn}))}_extractIconWithNameFromAnySet(Rt,Kt){for(let kn=Kt.length-1;kn>=0;kn--){const zn=Kt[kn];if(zn.svgText&&zn.svgText.toString().indexOf(Rt)>-1){const gn=this._svgElementFromConfig(zn),wi=this._extractSvgIconFromSet(gn,Rt,zn.options);if(wi)return wi}}return null}_loadSvgIconFromConfig(Rt){return this._fetchIcon(Rt).pipe((0,Me.b)(Kt=>Rt.svgText=Kt),(0,Ye.U)(()=>this._svgElementFromConfig(Rt)))}_loadSvgIconSetFromConfig(Rt){return Rt.svgText?(0,Ce.of)(null):this._fetchIcon(Rt).pipe((0,Me.b)(Kt=>Rt.svgText=Kt))}_extractSvgIconFromSet(Rt,Kt,kn){const zn=Rt.querySelector(`[id="${Kt}"]`);if(!zn)return null;const gn=zn.cloneNode(!0);if(gn.removeAttribute("id"),"svg"===gn.nodeName.toLowerCase())return this._setSvgAttributes(gn,kn);if("symbol"===gn.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(gn),kn);const wi=this._svgElementFromString(Xn("<svg></svg>"));return wi.appendChild(gn),this._setSvgAttributes(wi,kn)}_svgElementFromString(Rt){const Kt=this._document.createElement("DIV");Kt.innerHTML=Rt;const kn=Kt.querySelector("svg");if(!kn)throw Error("<svg> tag not found");return kn}_toSvgElement(Rt){const Kt=this._svgElementFromString(Xn("<svg></svg>")),kn=Rt.attributes;for(let zn=0;zn<kn.length;zn++){const{name:gn,value:wi}=kn[zn];"id"!==gn&&Kt.setAttribute(gn,wi)}for(let zn=0;zn<Rt.childNodes.length;zn++)Rt.childNodes[zn].nodeType===this._document.ELEMENT_NODE&&Kt.appendChild(Rt.childNodes[zn].cloneNode(!0));return Kt}_setSvgAttributes(Rt,Kt){return Rt.setAttribute("fit",""),Rt.setAttribute("height","100%"),Rt.setAttribute("width","100%"),Rt.setAttribute("preserveAspectRatio","xMidYMid meet"),Rt.setAttribute("focusable","false"),Kt&&Kt.viewBox&&Rt.setAttribute("viewBox",Kt.viewBox),Rt}_fetchIcon(Rt){const{url:Kt,options:kn}=Rt,zn=kn?.withCredentials??!1;if(!this._httpClient)throw function Fe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==Kt)throw Error(`Cannot fetch icon from URL "${Kt}".`);const gn=this._sanitizer.sanitize(T.q3G.RESOURCE_URL,Kt);if(!gn)throw Qe(Kt);const wi=this._inProgressUrlFetches.get(gn);if(wi)return wi;const Ei=this._httpClient.get(gn,{responseType:"text",withCredentials:zn}).pipe((0,Ye.U)(Ii=>Xn(Ii)),(0,Pe.x)(()=>this._inProgressUrlFetches.delete(gn)),(0,ut.B)());return this._inProgressUrlFetches.set(gn,Ei),Ei}_addSvgIconConfig(Rt,Kt,kn){return this._svgIconConfigs.set(Gt(Rt,Kt),kn),this}_addSvgIconSetConfig(Rt,Kt){const kn=this._iconSetConfigs.get(Rt);return kn?kn.push(Kt):this._iconSetConfigs.set(Rt,[Kt]),this}_svgElementFromConfig(Rt){if(!Rt.svgElement){const Kt=this._svgElementFromString(Rt.svgText);this._setSvgAttributes(Kt,Rt.options),Rt.svgElement=Kt}return Rt.svgElement}_getIconConfigFromResolvers(Rt,Kt){for(let kn=0;kn<this._resolvers.length;kn++){const zn=this._resolvers[kn](Kt,Rt);if(zn)return Bt(zn)?new Jt(zn.url,null,zn.options):new Jt(zn,null)}}}return Ln.\u0275fac=function(Rt){return new(Rt||Ln)(T.LFG(et.eN,8),T.LFG(Ut.H7),T.LFG(c.K0,8),T.LFG(T.qLn))},Ln.\u0275prov=T.Yz7({token:Ln,factory:Ln.\u0275fac,providedIn:"root"}),Ln})();function Tt(Ln){return Ln.cloneNode(!0)}function Gt(Ln,Zn){return Ln+":"+Zn}function Bt(Ln){return!(!Ln.url||!Ln.options)}const Cn=(0,d.pj)(class{constructor(Ln){this._elementRef=Ln}}),mn=new T.OlP("MAT_ICON_DEFAULT_OPTIONS"),oi=new T.OlP("mat-icon-location",{providedIn:"root",factory:function Yn(){const Ln=(0,T.f3M)(c.K0),Zn=Ln?Ln.location:null;return{getPathname:()=>Zn?Zn.pathname+Zn.search:""}}}),fi=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],On=fi.map(Ln=>`[${Ln}]`).join(", "),Di=/^url\(['"]?#(.*?)['"]?\)$/;let Ui=(()=>{class Ln extends Cn{constructor(Rt,Kt,kn,zn,gn,wi){super(Rt),this._iconRegistry=Kt,this._location=zn,this._errorHandler=gn,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=ye.w0.EMPTY,wi&&(wi.color&&(this.color=this.defaultColor=wi.color),wi.fontSet&&(this.fontSet=wi.fontSet)),kn||Rt.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(Rt){this._inline=(0,W.Ig)(Rt)}get svgIcon(){return this._svgIcon}set svgIcon(Rt){Rt!==this._svgIcon&&(Rt?this._updateSvgIcon(Rt):this._svgIcon&&this._clearSvgElement(),this._svgIcon=Rt)}get fontSet(){return this._fontSet}set fontSet(Rt){const Kt=this._cleanupFontValue(Rt);Kt!==this._fontSet&&(this._fontSet=Kt,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(Rt){const Kt=this._cleanupFontValue(Rt);Kt!==this._fontIcon&&(this._fontIcon=Kt,this._updateFontIconClasses())}_splitIconName(Rt){if(!Rt)return["",""];const Kt=Rt.split(":");switch(Kt.length){case 1:return["",Kt[0]];case 2:return Kt;default:throw Error(`Invalid icon name: "${Rt}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const Rt=this._elementsWithExternalReferences;if(Rt&&Rt.size){const Kt=this._location.getPathname();Kt!==this._previousPath&&(this._previousPath=Kt,this._prependPathToReferences(Kt))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(Rt){this._clearSvgElement();const Kt=this._location.getPathname();this._previousPath=Kt,this._cacheChildrenWithExternalReferences(Rt),this._prependPathToReferences(Kt),this._elementRef.nativeElement.appendChild(Rt)}_clearSvgElement(){const Rt=this._elementRef.nativeElement;let Kt=Rt.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();Kt--;){const kn=Rt.childNodes[Kt];(1!==kn.nodeType||"svg"===kn.nodeName.toLowerCase())&&kn.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const Rt=this._elementRef.nativeElement,Kt=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(kn=>kn.length>0);this._previousFontSetClass.forEach(kn=>Rt.classList.remove(kn)),Kt.forEach(kn=>Rt.classList.add(kn)),this._previousFontSetClass=Kt,this.fontIcon!==this._previousFontIconClass&&!Kt.includes("mat-ligature-font")&&(this._previousFontIconClass&&Rt.classList.remove(this._previousFontIconClass),this.fontIcon&&Rt.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(Rt){return"string"==typeof Rt?Rt.trim().split(" ")[0]:Rt}_prependPathToReferences(Rt){const Kt=this._elementsWithExternalReferences;Kt&&Kt.forEach((kn,zn)=>{kn.forEach(gn=>{zn.setAttribute(gn.name,`url('${Rt}#${gn.value}')`)})})}_cacheChildrenWithExternalReferences(Rt){const Kt=Rt.querySelectorAll(On),kn=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let zn=0;zn<Kt.length;zn++)fi.forEach(gn=>{const wi=Kt[zn],Ei=wi.getAttribute(gn),Ii=Ei?Ei.match(Di):null;if(Ii){let or=kn.get(wi);or||(or=[],kn.set(wi,or)),or.push({name:gn,value:Ii[1]})}})}_updateSvgIcon(Rt){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),Rt){const[Kt,kn]=this._splitIconName(Rt);Kt&&(this._svgNamespace=Kt),kn&&(this._svgName=kn),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(kn,Kt).pipe((0,gt.q)(1)).subscribe(zn=>this._setSvgElement(zn),zn=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${Kt}:${kn}! ${zn.message}`))})}}}return Ln.\u0275fac=function(Rt){return new(Rt||Ln)(T.Y36(T.SBq),T.Y36(rn),T.$8M("aria-hidden"),T.Y36(oi),T.Y36(T.qLn),T.Y36(mn,8))},Ln.\u0275cmp=T.Xpm({type:Ln,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(Rt,Kt){2&Rt&&(T.uIk("data-mat-icon-type",Kt._usingFontIcon()?"font":"svg")("data-mat-icon-name",Kt._svgName||Kt.fontIcon)("data-mat-icon-namespace",Kt._svgNamespace||Kt.fontSet),T.ekj("mat-icon-inline",Kt.inline)("mat-icon-no-color","primary"!==Kt.color&&"accent"!==Kt.color&&"warn"!==Kt.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[T.qOj],ngContentSelectors:Ft,decls:1,vars:0,template:function(Rt,Kt){1&Rt&&(T.F$t(),T.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),Ln})(),Pi=(()=>{class Ln{}return Ln.\u0275fac=function(Rt){return new(Rt||Ln)},Ln.\u0275mod=T.oAB({type:Ln}),Ln.\u0275inj=T.cJS({imports:[d.BQ,d.BQ]}),Ln})()},4385:(Bn,kt,j)=>{"use strict";j.d(kt,{LD:()=>Wi,gD:()=>En});var T=j(8184),d=j(6895),W=j(4650),c=j(3238),Ce=j(9549),Ve=j(8605),Je=j(2687),ye=j(445),Me=j(1281),Ye=j(5017),ft=j(9521),Pe=j(4006),ut=j(7579),gt=j(9770),et=j(6451),Ut=j(8675),Ft=j(3900),St=j(5698),Pn=j(9300),Xn=j(4004),Xt=j(1884),Fe=j(2722),Qe=j(7340);const fn=["trigger"],Jt=["panel"];function rn(li,ct){if(1&li&&(W.TgZ(0,"span",8),W._uU(1),W.qZA()),2&li){const K=W.oxw();W.xp6(1),W.Oqu(K.placeholder)}}function vn(li,ct){if(1&li&&(W.TgZ(0,"span",12),W._uU(1),W.qZA()),2&li){const K=W.oxw(2);W.xp6(1),W.Oqu(K.triggerValue)}}function xt(li,ct){1&li&&W.Hsn(0,0,["*ngSwitchCase","true"])}function Tt(li,ct){if(1&li&&(W.TgZ(0,"span",9),W.YNc(1,vn,2,1,"span",10),W.YNc(2,xt,1,0,"ng-content",11),W.qZA()),2&li){const K=W.oxw();W.Q6J("ngSwitch",!!K.customTrigger),W.xp6(2),W.Q6J("ngSwitchCase",!0)}}function Gt(li,ct){if(1&li){const K=W.EpF();W.TgZ(0,"div",13)(1,"div",14,15),W.NdJ("@transformPanel.done",function(De){W.CHM(K);const dt=W.oxw();return W.KtG(dt._panelDoneAnimatingStream.next(De.toState))})("keydown",function(De){W.CHM(K);const dt=W.oxw();return W.KtG(dt._handleKeydown(De))}),W.Hsn(3,1),W.qZA()()}if(2&li){const K=W.oxw();W.Q6J("@transformPanelWrap",void 0),W.xp6(1),W.Gre("mat-select-panel ",K._getPanelTheme(),""),W.Udp("transform-origin",K._transformOrigin)("font-size",K._triggerFontSize,"px"),W.Q6J("ngClass",K.panelClass)("@transformPanel",K.multiple?"showing-multiple":"showing"),W.uIk("id",K.id+"-panel")("aria-multiselectable",K.multiple)("aria-label",K.ariaLabel||null)("aria-labelledby",K._getPanelAriaLabelledby())}}const Bt=[[["mat-select-trigger"]],"*"],Cn=["mat-select-trigger","*"],mn={transformPanelWrap:(0,Qe.X$)("transformPanelWrap",[(0,Qe.eR)("* => void",(0,Qe.IO)("@transformPanel",[(0,Qe.pV)()],{optional:!0}))]),transformPanel:(0,Qe.X$)("transformPanel",[(0,Qe.SB)("void",(0,Qe.oB)({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),(0,Qe.SB)("showing",(0,Qe.oB)({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),(0,Qe.SB)("showing-multiple",(0,Qe.oB)({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),(0,Qe.eR)("void => *",(0,Qe.jt)("120ms cubic-bezier(0, 0, 0.2, 1)")),(0,Qe.eR)("* => void",(0,Qe.jt)("100ms 25ms linear",(0,Qe.oB)({opacity:0})))])};let On=0;const Kt=new W.OlP("mat-select-scroll-strategy"),zn=new W.OlP("MAT_SELECT_CONFIG"),gn={provide:Kt,deps:[T.aV],useFactory:function kn(li){return()=>li.scrollStrategies.reposition()}};class wi{constructor(ct,K){this.source=ct,this.value=K}}const Ei=(0,c.Kr)((0,c.sb)((0,c.Id)((0,c.FD)(class{constructor(li,ct,K,ie,De){this._elementRef=li,this._defaultErrorStateMatcher=ct,this._parentForm=K,this._parentFormGroup=ie,this.ngControl=De,this.stateChanges=new ut.x}})))),Ii=new W.OlP("MatSelectTrigger");let Oi=(()=>{class li extends Ei{constructor(K,ie,De,dt,ze,he,ce,de,We,ht,Qt,_n,An,ii){super(ze,dt,ce,de,ht),this._viewportRuler=K,this._changeDetectorRef=ie,this._ngZone=De,this._dir=he,this._parentFormField=We,this._liveAnnouncer=An,this._defaultOptions=ii,this._panelOpen=!1,this._compareWith=(qn,gr)=>qn===gr,this._uid="mat-select-"+On++,this._triggerAriaLabelledBy=null,this._destroy=new ut.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+On++,this._panelDoneAnimatingStream=new ut.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=(0,gt.P)(()=>{const qn=this.options;return qn?qn.changes.pipe((0,Ut.O)(qn),(0,Ft.w)(()=>(0,et.T)(...qn.map(gr=>gr.onSelectionChange)))):this._ngZone.onStable.pipe((0,St.q)(1),(0,Ft.w)(()=>this.optionSelectionChanges))}),this.openedChange=new W.vpe,this._openedStream=this.openedChange.pipe((0,Pn.h)(qn=>qn),(0,Xn.U)(()=>{})),this._closedStream=this.openedChange.pipe((0,Pn.h)(qn=>!qn),(0,Xn.U)(()=>{})),this.selectionChange=new W.vpe,this.valueChange=new W.vpe,this.ngControl&&(this.ngControl.valueAccessor=this),null!=ii?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=ii.typeaheadDebounceInterval),this._scrollStrategyFactory=_n,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(Qt)||0,this.id=this.id}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(K){this._placeholder=K,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(Pe.kI.required)??!1}set required(K){this._required=(0,Me.Ig)(K),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(K){this._multiple=(0,Me.Ig)(K)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(K){this._disableOptionCentering=(0,Me.Ig)(K)}get compareWith(){return this._compareWith}set compareWith(K){this._compareWith=K,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(K){this._assignValue(K)&&this._onChange(K)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(K){this._typeaheadDebounceInterval=(0,Me.su)(K)}get id(){return this._id}set id(K){this._id=K||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new Ye.Ov(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe((0,Xt.x)(),(0,Fe.R)(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe((0,Fe.R)(this._destroy)).subscribe(K=>{K.added.forEach(ie=>ie.select()),K.removed.forEach(ie=>ie.deselect())}),this.options.changes.pipe((0,Ut.O)(null),(0,Fe.R)(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const K=this._getTriggerAriaLabelledby(),ie=this.ngControl;if(K!==this._triggerAriaLabelledBy){const De=this._elementRef.nativeElement;this._triggerAriaLabelledBy=K,K?De.setAttribute("aria-labelledby",K):De.removeAttribute("aria-labelledby")}ie&&(this._previousControl!==ie.control&&(void 0!==this._previousControl&&null!==ie.disabled&&ie.disabled!==this.disabled&&(this.disabled=ie.disabled),this._previousControl=ie.control),this.updateErrorState())}ngOnChanges(K){(K.disabled||K.userAriaDescribedBy)&&this.stateChanges.next(),K.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(K){this._assignValue(K)}registerOnChange(K){this._onChange=K}registerOnTouched(K){this._onTouched=K}setDisabledState(K){this.disabled=K,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const K=this._selectionModel.selected.map(ie=>ie.viewValue);return this._isRtl()&&K.reverse(),K.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(K){this.disabled||(this.panelOpen?this._handleOpenKeydown(K):this._handleClosedKeydown(K))}_handleClosedKeydown(K){const ie=K.keyCode,De=ie===ft.JH||ie===ft.LH||ie===ft.oh||ie===ft.SV,dt=ie===ft.K5||ie===ft.L_,ze=this._keyManager;if(!ze.isTyping()&&dt&&!(0,ft.Vb)(K)||(this.multiple||K.altKey)&&De)K.preventDefault(),this.open();else if(!this.multiple){const he=this.selected;ze.onKeydown(K);const ce=this.selected;ce&&he!==ce&&this._liveAnnouncer.announce(ce.viewValue,1e4)}}_handleOpenKeydown(K){const ie=this._keyManager,De=K.keyCode,dt=De===ft.JH||De===ft.LH,ze=ie.isTyping();if(dt&&K.altKey)K.preventDefault(),this.close();else if(ze||De!==ft.K5&&De!==ft.L_||!ie.activeItem||(0,ft.Vb)(K))if(!ze&&this._multiple&&De===ft.A&&K.ctrlKey){K.preventDefault();const he=this.options.some(ce=>!ce.disabled&&!ce.selected);this.options.forEach(ce=>{ce.disabled||(he?ce.select():ce.deselect())})}else{const he=ie.activeItemIndex;ie.onKeydown(K),this._multiple&&dt&&K.shiftKey&&ie.activeItem&&ie.activeItemIndex!==he&&ie.activeItem._selectViaInteraction()}else K.preventDefault(),ie.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe((0,St.q)(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(K){if(this._selectionModel.selected.forEach(ie=>ie.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&K)Array.isArray(K),K.forEach(ie=>this._selectOptionByValue(ie)),this._sortValues();else{const ie=this._selectOptionByValue(K);ie?this._keyManager.updateActiveItem(ie):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(K){const ie=this.options.find(De=>{if(this._selectionModel.isSelected(De))return!1;try{return null!=De.value&&this._compareWith(De.value,K)}catch{return!1}});return ie&&this._selectionModel.select(ie),ie}_assignValue(K){return!!(K!==this._value||this._multiple&&Array.isArray(K))&&(this.options&&this._setSelectionByValue(K),this._value=K,!0)}_initKeyManager(){this._keyManager=new Je.s1(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe((0,Fe.R)(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe((0,Fe.R)(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const K=(0,et.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe((0,Fe.R)(K)).subscribe(ie=>{this._onSelect(ie.source,ie.isUserInput),ie.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,et.T)(...this.options.map(ie=>ie._stateChanges)).pipe((0,Fe.R)(K)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(K,ie){const De=this._selectionModel.isSelected(K);null!=K.value||this._multiple?(De!==K.selected&&(K.selected?this._selectionModel.select(K):this._selectionModel.deselect(K)),ie&&this._keyManager.setActiveItem(K),this.multiple&&(this._sortValues(),ie&&this.focus())):(K.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(K.value)),De!==this._selectionModel.isSelected(K)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const K=this.options.toArray();this._selectionModel.sort((ie,De)=>this.sortComparator?this.sortComparator(ie,De,K):K.indexOf(ie)-K.indexOf(De)),this.stateChanges.next()}}_propagateChanges(K){let ie=null;ie=this.multiple?this.selected.map(De=>De.value):this.selected?this.selected.value:K,this._value=ie,this.valueChange.emit(ie),this._onChange(ie),this.selectionChange.emit(this._getChangeEvent(ie)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(K){this._elementRef.nativeElement.focus(K)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const K=this._parentFormField?.getLabelId();return this.ariaLabelledby?(K?K+" ":"")+this.ariaLabelledby:K}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const K=this._parentFormField?.getLabelId();let ie=(K?K+" ":"")+this._valueId;return this.ariaLabelledby&&(ie+=" "+this.ariaLabelledby),ie}_panelDoneAnimating(K){this.openedChange.emit(K)}setDescribedByIds(K){K.length?this._elementRef.nativeElement.setAttribute("aria-describedby",K.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return li.\u0275fac=function(K){return new(K||li)(W.Y36(Ve.rL),W.Y36(W.sBO),W.Y36(W.R0b),W.Y36(c.rD),W.Y36(W.SBq),W.Y36(ye.Is,8),W.Y36(Pe.F,8),W.Y36(Pe.sg,8),W.Y36(Ce.G_,8),W.Y36(Pe.a5,10),W.$8M("tabindex"),W.Y36(Kt),W.Y36(Je.Kd),W.Y36(zn,8))},li.\u0275dir=W.lG2({type:li,viewQuery:function(K,ie){if(1&K&&(W.Gf(fn,5),W.Gf(Jt,5),W.Gf(T.pI,5)),2&K){let De;W.iGM(De=W.CRH())&&(ie.trigger=De.first),W.iGM(De=W.CRH())&&(ie.panel=De.first),W.iGM(De=W.CRH())&&(ie._overlayDir=De.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[W.qOj,W.TTD]}),li})(),En=(()=>{class li extends Oi{constructor(){super(...arguments),this._scrollTop=0,this._triggerFontSize=0,this._transformOrigin="top",this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}]}_calculateOverlayScroll(K,ie,De){const dt=this._getItemHeight();return Math.min(Math.max(0,dt*K-ie+dt/2),De)}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe((0,Fe.R)(this._destroy)).subscribe(()=>{this.panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}open(){super._canOpen()&&(super.open(),this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._calculateOverlayPosition(),this._ngZone.onStable.pipe((0,St.q)(1)).subscribe(()=>{this._triggerFontSize&&this._overlayDir.overlayRef&&this._overlayDir.overlayRef.overlayElement&&(this._overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}_scrollOptionIntoView(K){const ie=(0,c.CB)(K,this.options,this.optionGroups),De=this._getItemHeight();this.panel.nativeElement.scrollTop=0===K&&1===ie?0:(0,c.jH)((K+ie)*De,De,this.panel.nativeElement.scrollTop,256)}_positioningSettled(){this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop}_panelDoneAnimating(K){this.panelOpen?this._scrollTop=0:(this._overlayDir.offsetX=0,this._changeDetectorRef.markForCheck()),super._panelDoneAnimating(K)}_getChangeEvent(K){return new wi(this,K)}_calculateOverlayOffsetX(){const K=this._overlayDir.overlayRef.overlayElement.getBoundingClientRect(),ie=this._viewportRuler.getViewportSize(),De=this._isRtl(),dt=this.multiple?56:32;let ze;if(this.multiple)ze=40;else if(this.disableOptionCentering)ze=16;else{let de=this._selectionModel.selected[0]||this.options.first;ze=de&&de.group?32:16}De||(ze*=-1);const he=0-(K.left+ze-(De?dt:0)),ce=K.right+ze-ie.width+(De?0:dt);he>0?ze+=he+8:ce>0&&(ze-=ce+8),this._overlayDir.offsetX=Math.round(ze),this._overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(K,ie,De){const dt=this._getItemHeight(),ze=(dt-this._triggerRect.height)/2,he=Math.floor(256/dt);let ce;return this.disableOptionCentering?0:(ce=0===this._scrollTop?K*dt:this._scrollTop===De?(K-(this._getItemCount()-he))*dt+(dt-(this._getItemCount()*dt-256)%dt):ie-dt/2,Math.round(-1*ce-ze))}_checkOverlayWithinViewport(K){const ie=this._getItemHeight(),De=this._viewportRuler.getViewportSize(),dt=this._triggerRect.top-8,ze=De.height-this._triggerRect.bottom-8,he=Math.abs(this._offsetY),de=Math.min(this._getItemCount()*ie,256)-he-this._triggerRect.height;de>ze?this._adjustPanelUp(de,ze):he>dt?this._adjustPanelDown(he,dt,K):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(K,ie){const De=Math.round(K-ie);this._scrollTop-=De,this._offsetY-=De,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(K,ie,De){const dt=Math.round(K-ie);if(this._scrollTop+=dt,this._offsetY+=dt,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=De)return this._scrollTop=De,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_calculateOverlayPosition(){const K=this._getItemHeight(),ie=this._getItemCount(),De=Math.min(ie*K,256),ze=ie*K-De;let he;he=this.empty?0:Math.max(this.options.toArray().indexOf(this._selectionModel.selected[0]),0),he+=(0,c.CB)(he,this.options,this.optionGroups);const ce=De/2;this._scrollTop=this._calculateOverlayScroll(he,ce,ze),this._offsetY=this._calculateOverlayOffsetY(he,ce,ze),this._checkOverlayWithinViewport(ze)}_getOriginBasedOnOption(){const K=this._getItemHeight(),ie=(K-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-ie+K/2}px 0px`}_getItemHeight(){return 3*this._triggerFontSize}_getItemCount(){return this.options.length+this.optionGroups.length}}return li.\u0275fac=function(){let ct;return function(ie){return(ct||(ct=W.n5z(li)))(ie||li)}}(),li.\u0275cmp=W.Xpm({type:li,selectors:[["mat-select"]],contentQueries:function(K,ie,De){if(1&K&&(W.Suo(De,Ii,5),W.Suo(De,c.ey,5),W.Suo(De,c.K7,5)),2&K){let dt;W.iGM(dt=W.CRH())&&(ie.customTrigger=dt.first),W.iGM(dt=W.CRH())&&(ie.options=dt),W.iGM(dt=W.CRH())&&(ie.optionGroups=dt)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:19,hostBindings:function(K,ie){1&K&&W.NdJ("keydown",function(dt){return ie._handleKeydown(dt)})("focus",function(){return ie._onFocus()})("blur",function(){return ie._onBlur()}),2&K&&(W.uIk("id",ie.id)("tabindex",ie.tabIndex)("aria-controls",ie.panelOpen?ie.id+"-panel":null)("aria-expanded",ie.panelOpen)("aria-label",ie.ariaLabel||null)("aria-required",ie.required.toString())("aria-disabled",ie.disabled.toString())("aria-invalid",ie.errorState)("aria-activedescendant",ie._getAriaActiveDescendant()),W.ekj("mat-select-disabled",ie.disabled)("mat-select-invalid",ie.errorState)("mat-select-required",ie.required)("mat-select-empty",ie.empty)("mat-select-multiple",ie.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matSelect"],features:[W._Bn([{provide:Ce.Eo,useExisting:li},{provide:c.HF,useExisting:li}]),W.qOj],ngContentSelectors:Cn,decls:9,vars:12,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder mat-select-min-line",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder","mat-select-min-line"],[1,"mat-select-value-text",3,"ngSwitch"],["class","mat-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-min-line"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(K,ie){if(1&K&&(W.F$t(Bt),W.TgZ(0,"div",0,1),W.NdJ("click",function(){return ie.toggle()}),W.TgZ(3,"div",2),W.YNc(4,rn,2,1,"span",3),W.YNc(5,Tt,3,2,"span",4),W.qZA(),W.TgZ(6,"div",5),W._UZ(7,"div",6),W.qZA()(),W.YNc(8,Gt,4,14,"ng-template",7),W.NdJ("backdropClick",function(){return ie.close()})("attach",function(){return ie._onAttached()})("detach",function(){return ie.close()})),2&K){const De=W.MAs(1);W.uIk("aria-owns",ie.panelOpen?ie.id+"-panel":null),W.xp6(3),W.Q6J("ngSwitch",ie.empty),W.uIk("id",ie._valueId),W.xp6(1),W.Q6J("ngSwitchCase",!0),W.xp6(1),W.Q6J("ngSwitchCase",!1),W.xp6(3),W.Q6J("cdkConnectedOverlayPanelClass",ie._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",ie._scrollStrategy)("cdkConnectedOverlayOrigin",De)("cdkConnectedOverlayOpen",ie.panelOpen)("cdkConnectedOverlayPositions",ie._positions)("cdkConnectedOverlayMinWidth",null==ie._triggerRect?null:ie._triggerRect.width)("cdkConnectedOverlayOffsetY",ie._offsetY)}},dependencies:[d.mk,d.RF,d.n9,d.ED,T.pI,T.xu],styles:['.mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{height:16px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;margin:0 4px}.mat-form-field.mat-focused .mat-select-arrow{transform:translateX(0)}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px;outline:0}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[mn.transformPanelWrap,mn.transformPanel]},changeDetection:0}),li})(),Wi=(()=>{class li{}return li.\u0275fac=function(K){return new(K||li)},li.\u0275mod=W.oAB({type:li}),li.\u0275inj=W.cJS({providers:[gn],imports:[d.ez,T.U8,c.Ng,c.BQ,Ve.ZD,Ce.lN,c.Ng,c.BQ]}),li})()},3683:(Bn,kt,j)=>{"use strict";j.d(kt,{Ye:()=>Me,g0:()=>ft});var T=j(4650),d=j(3238),W=j(3353),c=j(6895);const Ce=["*",[["mat-toolbar-row"]]],Ve=["*","mat-toolbar-row"],Je=(0,d.pj)(class{constructor(Pe){this._elementRef=Pe}});let ye=(()=>{class Pe{}return Pe.\u0275fac=function(gt){return new(gt||Pe)},Pe.\u0275dir=T.lG2({type:Pe,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),Pe})(),Me=(()=>{class Pe extends Je{constructor(gt,et,Ut){super(gt),this._platform=et,this._document=Ut}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return Pe.\u0275fac=function(gt){return new(gt||Pe)(T.Y36(T.SBq),T.Y36(W.t4),T.Y36(c.K0))},Pe.\u0275cmp=T.Xpm({type:Pe,selectors:[["mat-toolbar"]],contentQueries:function(gt,et,Ut){if(1&gt&&T.Suo(Ut,ye,5),2&gt){let Ft;T.iGM(Ft=T.CRH())&&(et._toolbarRows=Ft)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(gt,et){2&gt&&T.ekj("mat-toolbar-multiple-rows",et._toolbarRows.length>0)("mat-toolbar-single-row",0===et._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[T.qOj],ngContentSelectors:Ve,decls:2,vars:0,template:function(gt,et){1&gt&&(T.F$t(Ce),T.Hsn(0),T.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),Pe})(),ft=(()=>{class Pe{}return Pe.\u0275fac=function(gt){return new(gt||Pe)},Pe.\u0275mod=T.oAB({type:Pe}),Pe.\u0275inj=T.cJS({imports:[d.BQ,d.BQ]}),Pe})()},1481:(Bn,kt,j)=>{"use strict";j.d(kt,{Dx:()=>he,H7:()=>lt,b2:()=>K,q6:()=>En,se:()=>Bt});var T=j(6895),d=j(4650);class W extends T.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class c extends W{static makeCurrent(){(0,T.HT)(new c)}onAndCancel(Ge,Oe,tt){return Ge.addEventListener(Oe,tt,!1),()=>{Ge.removeEventListener(Oe,tt,!1)}}dispatchEvent(Ge,Oe){Ge.dispatchEvent(Oe)}remove(Ge){Ge.parentNode&&Ge.parentNode.removeChild(Ge)}createElement(Ge,Oe){return(Oe=Oe||this.getDefaultDocument()).createElement(Ge)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Ge){return Ge.nodeType===Node.ELEMENT_NODE}isShadowRoot(Ge){return Ge instanceof DocumentFragment}getGlobalEventTarget(Ge,Oe){return"window"===Oe?window:"document"===Oe?Ge:"body"===Oe?Ge.body:null}getBaseHref(Ge){const Oe=function Ve(){return Ce=Ce||document.querySelector("base"),Ce?Ce.getAttribute("href"):null}();return null==Oe?null:function ye(Le){Je=Je||document.createElement("a"),Je.setAttribute("href",Le);const Ge=Je.pathname;return"/"===Ge.charAt(0)?Ge:`/${Ge}`}(Oe)}resetBaseElement(){Ce=null}getUserAgent(){return window.navigator.userAgent}getCookie(Ge){return(0,T.Mx)(document.cookie,Ge)}}let Je,Ce=null;const Me=new d.OlP("TRANSITION_ID"),ft=[{provide:d.ip1,useFactory:function Ye(Le,Ge,Oe){return()=>{Oe.get(d.CZH).donePromise.then(()=>{const tt=(0,T.q)(),Nt=Ge.querySelectorAll(`style[ng-transition="${Le}"]`);for(let bn=0;bn<Nt.length;bn++)tt.remove(Nt[bn])})}},deps:[Me,T.K0,d.zs3],multi:!0}];let ut=(()=>{class Le{build(){return new XMLHttpRequest}}return Le.\u0275fac=function(Oe){return new(Oe||Le)},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();const gt=new d.OlP("EventManagerPlugins");let et=(()=>{class Le{constructor(Oe,tt){this._zone=tt,this._eventNameToPlugin=new Map,Oe.forEach(Nt=>Nt.manager=this),this._plugins=Oe.slice().reverse()}addEventListener(Oe,tt,Nt){return this._findPluginFor(tt).addEventListener(Oe,tt,Nt)}addGlobalEventListener(Oe,tt,Nt){return this._findPluginFor(tt).addGlobalEventListener(Oe,tt,Nt)}getZone(){return this._zone}_findPluginFor(Oe){const tt=this._eventNameToPlugin.get(Oe);if(tt)return tt;const Nt=this._plugins;for(let bn=0;bn<Nt.length;bn++){const ti=Nt[bn];if(ti.supports(Oe))return this._eventNameToPlugin.set(Oe,ti),ti}throw new Error(`No event manager plugin found for event ${Oe}`)}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(gt),d.LFG(d.R0b))},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();class Ut{constructor(Ge){this._doc=Ge}addGlobalEventListener(Ge,Oe,tt){const Nt=(0,T.q)().getGlobalEventTarget(this._doc,Ge);if(!Nt)throw new Error(`Unsupported event target ${Nt} for event ${Oe}`);return this.addEventListener(Nt,Oe,tt)}}let Ft=(()=>{class Le{constructor(){this._stylesSet=new Set}addStyles(Oe){const tt=new Set;Oe.forEach(Nt=>{this._stylesSet.has(Nt)||(this._stylesSet.add(Nt),tt.add(Nt))}),this.onStylesAdded(tt)}onStylesAdded(Oe){}getAllStyles(){return Array.from(this._stylesSet)}}return Le.\u0275fac=function(Oe){return new(Oe||Le)},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})(),St=(()=>{class Le extends Ft{constructor(Oe){super(),this._doc=Oe,this._hostNodes=new Map,this._hostNodes.set(Oe.head,[])}_addStylesToHost(Oe,tt,Nt){Oe.forEach(bn=>{const ti=this._doc.createElement("style");ti.textContent=bn,Nt.push(tt.appendChild(ti))})}addHost(Oe){const tt=[];this._addStylesToHost(this._stylesSet,Oe,tt),this._hostNodes.set(Oe,tt)}removeHost(Oe){const tt=this._hostNodes.get(Oe);tt&&tt.forEach(Pn),this._hostNodes.delete(Oe)}onStylesAdded(Oe){this._hostNodes.forEach((tt,Nt)=>{this._addStylesToHost(Oe,Nt,tt)})}ngOnDestroy(){this._hostNodes.forEach(Oe=>Oe.forEach(Pn))}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(T.K0))},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();function Pn(Le){(0,T.q)().remove(Le)}const Xn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Xt=/%COMP%/g;function xt(Le,Ge,Oe){for(let tt=0;tt<Ge.length;tt++){let Nt=Ge[tt];Array.isArray(Nt)?xt(Le,Nt,Oe):(Nt=Nt.replace(Xt,Le),Oe.push(Nt))}return Oe}function Tt(Le){return Ge=>{if("__ngUnwrap__"===Ge)return Le;!1===Le(Ge)&&(Ge.preventDefault(),Ge.returnValue=!1)}}let Bt=(()=>{class Le{constructor(Oe,tt,Nt){this.eventManager=Oe,this.sharedStylesHost=tt,this.appId=Nt,this.rendererByCompId=new Map,this.defaultRenderer=new Cn(Oe)}createRenderer(Oe,tt){if(!Oe||!tt)return this.defaultRenderer;switch(tt.encapsulation){case d.ifc.Emulated:{let Nt=this.rendererByCompId.get(tt.id);return Nt||(Nt=new fi(this.eventManager,this.sharedStylesHost,tt,this.appId),this.rendererByCompId.set(tt.id,Nt)),Nt.applyToHost(Oe),Nt}case 1:case d.ifc.ShadowDom:return new On(this.eventManager,this.sharedStylesHost,Oe,tt);default:if(!this.rendererByCompId.has(tt.id)){const Nt=xt(tt.id,tt.styles,[]);this.sharedStylesHost.addStyles(Nt),this.rendererByCompId.set(tt.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(et),d.LFG(St),d.LFG(d.AFp))},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();class Cn{constructor(Ge){this.eventManager=Ge,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Ge,Oe){return Oe?document.createElementNS(Xn[Oe]||Oe,Ge):document.createElement(Ge)}createComment(Ge){return document.createComment(Ge)}createText(Ge){return document.createTextNode(Ge)}appendChild(Ge,Oe){(Yn(Ge)?Ge.content:Ge).appendChild(Oe)}insertBefore(Ge,Oe,tt){Ge&&(Yn(Ge)?Ge.content:Ge).insertBefore(Oe,tt)}removeChild(Ge,Oe){Ge&&Ge.removeChild(Oe)}selectRootElement(Ge,Oe){let tt="string"==typeof Ge?document.querySelector(Ge):Ge;if(!tt)throw new Error(`The selector "${Ge}" did not match any elements`);return Oe||(tt.textContent=""),tt}parentNode(Ge){return Ge.parentNode}nextSibling(Ge){return Ge.nextSibling}setAttribute(Ge,Oe,tt,Nt){if(Nt){Oe=Nt+":"+Oe;const bn=Xn[Nt];bn?Ge.setAttributeNS(bn,Oe,tt):Ge.setAttribute(Oe,tt)}else Ge.setAttribute(Oe,tt)}removeAttribute(Ge,Oe,tt){if(tt){const Nt=Xn[tt];Nt?Ge.removeAttributeNS(Nt,Oe):Ge.removeAttribute(`${tt}:${Oe}`)}else Ge.removeAttribute(Oe)}addClass(Ge,Oe){Ge.classList.add(Oe)}removeClass(Ge,Oe){Ge.classList.remove(Oe)}setStyle(Ge,Oe,tt,Nt){Nt&(d.JOm.DashCase|d.JOm.Important)?Ge.style.setProperty(Oe,tt,Nt&d.JOm.Important?"important":""):Ge.style[Oe]=tt}removeStyle(Ge,Oe,tt){tt&d.JOm.DashCase?Ge.style.removeProperty(Oe):Ge.style[Oe]=""}setProperty(Ge,Oe,tt){Ge[Oe]=tt}setValue(Ge,Oe){Ge.nodeValue=Oe}listen(Ge,Oe,tt){return"string"==typeof Ge?this.eventManager.addGlobalEventListener(Ge,Oe,Tt(tt)):this.eventManager.addEventListener(Ge,Oe,Tt(tt))}}function Yn(Le){return"TEMPLATE"===Le.tagName&&void 0!==Le.content}class fi extends Cn{constructor(Ge,Oe,tt,Nt){super(Ge),this.component=tt;const bn=xt(Nt+"-"+tt.id,tt.styles,[]);Oe.addStyles(bn),this.contentAttr=function rn(Le){return"_ngcontent-%COMP%".replace(Xt,Le)}(Nt+"-"+tt.id),this.hostAttr=function vn(Le){return"_nghost-%COMP%".replace(Xt,Le)}(Nt+"-"+tt.id)}applyToHost(Ge){super.setAttribute(Ge,this.hostAttr,"")}createElement(Ge,Oe){const tt=super.createElement(Ge,Oe);return super.setAttribute(tt,this.contentAttr,""),tt}}class On extends Cn{constructor(Ge,Oe,tt,Nt){super(Ge),this.sharedStylesHost=Oe,this.hostEl=tt,this.shadowRoot=tt.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const bn=xt(Nt.id,Nt.styles,[]);for(let ti=0;ti<bn.length;ti++){const Ri=document.createElement("style");Ri.textContent=bn[ti],this.shadowRoot.appendChild(Ri)}}nodeOrShadowRoot(Ge){return Ge===this.hostEl?this.shadowRoot:Ge}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(Ge,Oe){return super.appendChild(this.nodeOrShadowRoot(Ge),Oe)}insertBefore(Ge,Oe,tt){return super.insertBefore(this.nodeOrShadowRoot(Ge),Oe,tt)}removeChild(Ge,Oe){return super.removeChild(this.nodeOrShadowRoot(Ge),Oe)}parentNode(Ge){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Ge)))}}let Di=(()=>{class Le extends Ut{constructor(Oe){super(Oe)}supports(Oe){return!0}addEventListener(Oe,tt,Nt){return Oe.addEventListener(tt,Nt,!1),()=>this.removeEventListener(Oe,tt,Nt)}removeEventListener(Oe,tt,Nt){return Oe.removeEventListener(tt,Nt)}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(T.K0))},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();const Ui=["alt","control","meta","shift"],Ln={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Zn={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Rt={alt:Le=>Le.altKey,control:Le=>Le.ctrlKey,meta:Le=>Le.metaKey,shift:Le=>Le.shiftKey};let Kt=(()=>{class Le extends Ut{constructor(Oe){super(Oe)}supports(Oe){return null!=Le.parseEventName(Oe)}addEventListener(Oe,tt,Nt){const bn=Le.parseEventName(tt),ti=Le.eventCallback(bn.fullKey,Nt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,T.q)().onAndCancel(Oe,bn.domEventName,ti))}static parseEventName(Oe){const tt=Oe.toLowerCase().split("."),Nt=tt.shift();if(0===tt.length||"keydown"!==Nt&&"keyup"!==Nt)return null;const bn=Le._normalizeKey(tt.pop());let ti="";if(Ui.forEach(jn=>{const At=tt.indexOf(jn);At>-1&&(tt.splice(At,1),ti+=jn+".")}),ti+=bn,0!=tt.length||0===bn.length)return null;const Ri={};return Ri.domEventName=Nt,Ri.fullKey=ti,Ri}static getEventFullKey(Oe){let tt="",Nt=function kn(Le){let Ge=Le.key;if(null==Ge){if(Ge=Le.keyIdentifier,null==Ge)return"Unidentified";Ge.startsWith("U+")&&(Ge=String.fromCharCode(parseInt(Ge.substring(2),16)),3===Le.location&&Zn.hasOwnProperty(Ge)&&(Ge=Zn[Ge]))}return Ln[Ge]||Ge}(Oe);return Nt=Nt.toLowerCase()," "===Nt?Nt="space":"."===Nt&&(Nt="dot"),Ui.forEach(bn=>{bn!=Nt&&(0,Rt[bn])(Oe)&&(tt+=bn+".")}),tt+=Nt,tt}static eventCallback(Oe,tt,Nt){return bn=>{Le.getEventFullKey(bn)===Oe&&Nt.runGuarded(()=>tt(bn))}}static _normalizeKey(Oe){return"esc"===Oe?"escape":Oe}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(T.K0))},Le.\u0275prov=d.Yz7({token:Le,factory:Le.\u0275fac}),Le})();const En=(0,d.eFA)(d._c5,"browser",[{provide:d.Lbi,useValue:T.bD},{provide:d.g9A,useValue:function Ei(){c.makeCurrent()},multi:!0},{provide:T.K0,useFactory:function or(){return(0,d.RDi)(document),document},deps:[]}]),Wi=new d.OlP(""),li=[{provide:d.rWj,useClass:class Pe{addToWindow(Ge){d.dqk.getAngularTestability=(tt,Nt=!0)=>{const bn=Ge.findTestabilityInTree(tt,Nt);if(null==bn)throw new Error("Could not find testability for element.");return bn},d.dqk.getAllAngularTestabilities=()=>Ge.getAllTestabilities(),d.dqk.getAllAngularRootElements=()=>Ge.getAllRootElements(),d.dqk.frameworkStabilizers||(d.dqk.frameworkStabilizers=[]),d.dqk.frameworkStabilizers.push(tt=>{const Nt=d.dqk.getAllAngularTestabilities();let bn=Nt.length,ti=!1;const Ri=function(jn){ti=ti||jn,bn--,0==bn&&tt(ti)};Nt.forEach(function(jn){jn.whenStable(Ri)})})}findTestabilityInTree(Ge,Oe,tt){return null==Oe?null:Ge.getTestability(Oe)??(tt?(0,T.q)().isShadowRoot(Oe)?this.findTestabilityInTree(Ge,Oe.host,!0):this.findTestabilityInTree(Ge,Oe.parentElement,!0):null)}},deps:[]},{provide:d.lri,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]},{provide:d.dDg,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]}],ct=[{provide:d.zSh,useValue:"root"},{provide:d.qLn,useFactory:function Ii(){return new d.qLn},deps:[]},{provide:gt,useClass:Di,multi:!0,deps:[T.K0,d.R0b,d.Lbi]},{provide:gt,useClass:Kt,multi:!0,deps:[T.K0]},{provide:Bt,useClass:Bt,deps:[et,St,d.AFp]},{provide:d.FYo,useExisting:Bt},{provide:Ft,useExisting:St},{provide:St,useClass:St,deps:[T.K0]},{provide:et,useClass:et,deps:[gt,d.R0b]},{provide:T.JF,useClass:ut,deps:[]},[]];let K=(()=>{class Le{constructor(Oe){}static withServerTransition(Oe){return{ngModule:Le,providers:[{provide:d.AFp,useValue:Oe.appId},{provide:Me,useExisting:d.AFp},ft]}}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(Wi,12))},Le.\u0275mod=d.oAB({type:Le}),Le.\u0275inj=d.cJS({providers:[...ct,...li],imports:[T.ez,d.hGG]}),Le})(),he=(()=>{class Le{constructor(Oe){this._doc=Oe}getTitle(){return this._doc.title}setTitle(Oe){this._doc.title=Oe||""}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(T.K0))},Le.\u0275prov=d.Yz7({token:Le,factory:function(Oe){let tt=null;return tt=Oe?new Oe:function ze(){return new he((0,d.LFG)(T.K0))}(),tt},providedIn:"root"}),Le})();typeof window<"u"&&window;let lt=(()=>{class Le{}return Le.\u0275fac=function(Oe){return new(Oe||Le)},Le.\u0275prov=d.Yz7({token:Le,factory:function(Oe){let tt=null;return tt=Oe?new(Oe||Le):d.LFG(Et),tt},providedIn:"root"}),Le})(),Et=(()=>{class Le extends lt{constructor(Oe){super(),this._doc=Oe}sanitize(Oe,tt){if(null==tt)return null;switch(Oe){case d.q3G.NONE:return tt;case d.q3G.HTML:return(0,d.qzn)(tt,"HTML")?(0,d.z3N)(tt):(0,d.EiD)(this._doc,String(tt)).toString();case d.q3G.STYLE:return(0,d.qzn)(tt,"Style")?(0,d.z3N)(tt):tt;case d.q3G.SCRIPT:if((0,d.qzn)(tt,"Script"))return(0,d.z3N)(tt);throw new Error("unsafe value used in a script context");case d.q3G.URL:return(0,d.qzn)(tt,"URL")?(0,d.z3N)(tt):(0,d.mCW)(String(tt));case d.q3G.RESOURCE_URL:if((0,d.qzn)(tt,"ResourceURL"))return(0,d.z3N)(tt);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${Oe} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(Oe){return(0,d.JVY)(Oe)}bypassSecurityTrustStyle(Oe){return(0,d.L6k)(Oe)}bypassSecurityTrustScript(Oe){return(0,d.eBb)(Oe)}bypassSecurityTrustUrl(Oe){return(0,d.LAX)(Oe)}bypassSecurityTrustResourceUrl(Oe){return(0,d.pB0)(Oe)}}return Le.\u0275fac=function(Oe){return new(Oe||Le)(d.LFG(T.K0))},Le.\u0275prov=d.Yz7({token:Le,factory:function(Oe){let tt=null;return tt=Oe?new Oe:function Ot(Le){return new Et(Le.get(T.K0))}(d.LFG(d.zs3)),tt},providedIn:"root"}),Le})()},2510:(Bn,kt,j)=>{"use strict";j.d(kt,{gz:()=>Hs,F0:()=>Do,Od:()=>zl,yS:()=>lu,Bz:()=>wh,lC:()=>Bo});var T=j(4650),d=j(9751),W=j(727),c=j(4482),Ce=j(5403);function Ve(){return(0,c.e)((F,L)=>{let O=null;F._refCount++;const H=(0,Ce.x)(L,void 0,void 0,void 0,()=>{if(!F||F._refCount<=0||0<--F._refCount)return void(O=null);const Q=F._connection,ge=O;O=null,Q&&(!ge||Q===ge)&&Q.unsubscribe(),L.unsubscribe()});F.subscribe(H),H.closed||(O=F.connect())})}class Je extends d.y{constructor(L,O){super(),this.source=L,this.subjectFactory=O,this._subject=null,this._refCount=0,this._connection=null,(0,c.A)(L)&&(this.lift=L.lift)}_subscribe(L){return this.getSubject().subscribe(L)}getSubject(){const L=this._subject;return(!L||L.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:L}=this;this._subject=this._connection=null,L?.unsubscribe()}connect(){let L=this._connection;if(!L){L=this._connection=new W.w0;const O=this.getSubject();L.add(this.source.subscribe((0,Ce.x)(O,void 0,()=>{this._teardown(),O.complete()},H=>{this._teardown(),O.error(H)},()=>this._teardown()))),L.closed&&(this._connection=null,L=W.w0.EMPTY)}return L}refCount(){return Ve()(this)}}var ye=j(2076),Me=j(9646),Ye=j(1135),ft=j(9841),Pe=j(7272),ut=j(9770),gt=j(9635),et=j(2843),Ut=j(6805),Ft=j(515),St=j(7579),Pn=j(6895);function Xn(F,L,O,H,Q){return(ge,qe)=>{let pt=O,an=L,ni=0;ge.subscribe((0,Ce.x)(qe,ur=>{const di=ni++;an=pt?F(an,ur,di):(pt=!0,ur),H&&qe.next(an)},Q&&(()=>{pt&&qe.next(an),qe.complete()})))}}function Xt(F,L){return(0,c.e)(Xn(F,L,arguments.length>=2,!0))}var Fe=j(9300);function Qe(F){return F<=0?()=>Ft.E:(0,c.e)((L,O)=>{let H=[];L.subscribe((0,Ce.x)(O,Q=>{H.push(Q),F<H.length&&H.shift()},()=>{for(const Q of H)O.next(Q);O.complete()},void 0,()=>{H=null}))})}var fn=j(8068),Jt=j(6590),rn=j(4671);function vn(F,L){const O=arguments.length>=2;return H=>H.pipe(F?(0,Fe.h)((Q,ge)=>F(Q,ge,H)):rn.y,Qe(1),O?(0,Jt.d)(L):(0,fn.T)(()=>new Ut.K))}var xt=j(4004),Tt=j(3900),Gt=j(5698),Bt=j(8675),Cn=j(5577),mn=j(590),oi=j(4351),Yn=j(8505),fi=j(262),On=j(2529),Di=j(9718),Ui=j(8746),Pi=j(8189),Ln=j(1481);const Zn="primary";class Rt{constructor(L){this.params=L||{}}has(L){return Object.prototype.hasOwnProperty.call(this.params,L)}get(L){if(this.has(L)){const O=this.params[L];return Array.isArray(O)?O[0]:O}return null}getAll(L){if(this.has(L)){const O=this.params[L];return Array.isArray(O)?O:[O]}return[]}get keys(){return Object.keys(this.params)}}function Kt(F){return new Rt(F)}function kn(F,L,O){const H=O.path.split("/");if(H.length>F.length||"full"===O.pathMatch&&(L.hasChildren()||H.length<F.length))return null;const Q={};for(let ge=0;ge<H.length;ge++){const qe=H[ge],pt=F[ge];if(qe.startsWith(":"))Q[qe.substring(1)]=pt;else if(qe!==pt.path)return null}return{consumed:F.slice(0,H.length),posParams:Q}}function gn(F,L){const O=F?Object.keys(F):void 0,H=L?Object.keys(L):void 0;if(!O||!H||O.length!=H.length)return!1;let Q;for(let ge=0;ge<O.length;ge++)if(Q=O[ge],!wi(F[Q],L[Q]))return!1;return!0}function wi(F,L){if(Array.isArray(F)&&Array.isArray(L)){if(F.length!==L.length)return!1;const O=[...F].sort(),H=[...L].sort();return O.every((Q,ge)=>H[ge]===Q)}return F===L}function Ei(F){return Array.prototype.concat.apply([],F)}function Ii(F){return F.length>0?F[F.length-1]:null}function Oi(F,L){for(const O in F)F.hasOwnProperty(O)&&L(F[O],O)}function En(F){return(0,T.CqO)(F)?F:(0,T.QGY)(F)?(0,ye.D)(Promise.resolve(F)):(0,Me.of)(F)}const ct={exact:function dt(F,L,O){if(!An(F.segments,L.segments)||!de(F.segments,L.segments,O)||F.numberOfChildren!==L.numberOfChildren)return!1;for(const H in L.children)if(!F.children[H]||!dt(F.children[H],L.children[H],O))return!1;return!0},subset:he},K={exact:function De(F,L){return gn(F,L)},subset:function ze(F,L){return Object.keys(L).length<=Object.keys(F).length&&Object.keys(L).every(O=>wi(F[O],L[O]))},ignored:()=>!0};function ie(F,L,O){return ct[O.paths](F.root,L.root,O.matrixParams)&&K[O.queryParams](F.queryParams,L.queryParams)&&!("exact"===O.fragment&&F.fragment!==L.fragment)}function he(F,L,O){return ce(F,L,L.segments,O)}function ce(F,L,O,H){if(F.segments.length>O.length){const Q=F.segments.slice(0,O.length);return!(!An(Q,O)||L.hasChildren()||!de(Q,O,H))}if(F.segments.length===O.length){if(!An(F.segments,O)||!de(F.segments,O,H))return!1;for(const Q in L.children)if(!F.children[Q]||!he(F.children[Q],L.children[Q],H))return!1;return!0}{const Q=O.slice(0,F.segments.length),ge=O.slice(F.segments.length);return!!(An(F.segments,Q)&&de(F.segments,Q,H)&&F.children[Zn])&&ce(F.children[Zn],L,ge,H)}}function de(F,L,O){return L.every((H,Q)=>K[O](F[Q].parameters,H.parameters))}class We{constructor(L,O,H){this.root=L,this.queryParams=O,this.fragment=H}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kt(this.queryParams)),this._queryParamMap}toString(){return mi.serialize(this)}}class ht{constructor(L,O){this.segments=L,this.children=O,this.parent=null,Oi(O,(H,Q)=>H.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zt(this)}}class Qt{constructor(L,O){this.path=L,this.parameters=O}get parameterMap(){return this._parameterMap||(this._parameterMap=Kt(this.parameters)),this._parameterMap}toString(){return Y(this)}}function An(F,L){return F.length===L.length&&F.every((O,H)=>O.path===L[H].path)}class qn{}class gr{parse(L){const O=new Et(L);return new We(O.parseRootSegment(),O.parseQueryParams(),O.parseFragment())}serialize(L){const O=`/${mt(L.root,!0)}`,H=function Te(F){const L=Object.keys(F).map(O=>{const H=F[O];return Array.isArray(H)?H.map(Q=>`${Ke(O)}=${Ke(Q)}`).join("&"):`${Ke(O)}=${Ke(H)}`}).filter(O=>!!O);return L.length?`?${L.join("&")}`:""}(L.queryParams);return`${O}${H}${"string"==typeof L.fragment?`#${function nt(F){return encodeURI(F)}(L.fragment)}`:""}`}}const mi=new gr;function zt(F){return F.segments.map(L=>Y(L)).join("/")}function mt(F,L){if(!F.hasChildren())return zt(F);if(L){const O=F.children[Zn]?mt(F.children[Zn],!1):"",H=[];return Oi(F.children,(Q,ge)=>{ge!==Zn&&H.push(`${ge}:${mt(Q,!1)}`)}),H.length>0?`${O}(${H.join("//")})`:O}{const O=function ii(F,L){let O=[];return Oi(F.children,(H,Q)=>{Q===Zn&&(O=O.concat(L(H,Q)))}),Oi(F.children,(H,Q)=>{Q!==Zn&&(O=O.concat(L(H,Q)))}),O}(F,(H,Q)=>Q===Zn?[mt(F.children[Zn],!1)]:[`${Q}:${mt(H,!1)}`]);return 1===Object.keys(F.children).length&&null!=F.children[Zn]?`${zt(F)}/${O[0]}`:`${zt(F)}/(${O.join("//")})`}}function _t(F){return encodeURIComponent(F).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ke(F){return _t(F).replace(/%3B/gi,";")}function Be(F){return _t(F).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Dt(F){return decodeURIComponent(F)}function ae(F){return Dt(F.replace(/\+/g,"%20"))}function Y(F){return`${Be(F.path)}${function le(F){return Object.keys(F).map(L=>`;${Be(L)}=${Be(F[L])}`).join("")}(F.parameters)}`}const He=/^[^\/()?;=#]+/;function Xe(F){const L=F.match(He);return L?L[0]:""}const Mt=/^[^=?&#]+/,lt=/^[^&#]+/;class Et{constructor(L){this.url=L,this.remaining=L}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ht([],{}):new ht([],this.parseChildren())}parseQueryParams(){const L={};if(this.consumeOptional("?"))do{this.parseQueryParam(L)}while(this.consumeOptional("&"));return L}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const L=[];for(this.peekStartsWith("(")||L.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),L.push(this.parseSegment());let O={};this.peekStartsWith("/(")&&(this.capture("/"),O=this.parseParens(!0));let H={};return this.peekStartsWith("(")&&(H=this.parseParens(!1)),(L.length>0||Object.keys(O).length>0)&&(H[Zn]=new ht(L,O)),H}parseSegment(){const L=Xe(this.remaining);if(""===L&&this.peekStartsWith(";"))throw new T.vHH(4009,!1);return this.capture(L),new Qt(Dt(L),this.parseMatrixParams())}parseMatrixParams(){const L={};for(;this.consumeOptional(";");)this.parseParam(L);return L}parseParam(L){const O=Xe(this.remaining);if(!O)return;this.capture(O);let H="";if(this.consumeOptional("=")){const Q=Xe(this.remaining);Q&&(H=Q,this.capture(H))}L[Dt(O)]=Dt(H)}parseQueryParam(L){const O=function Ct(F){const L=F.match(Mt);return L?L[0]:""}(this.remaining);if(!O)return;this.capture(O);let H="";if(this.consumeOptional("=")){const qe=function Ot(F){const L=F.match(lt);return L?L[0]:""}(this.remaining);qe&&(H=qe,this.capture(H))}const Q=ae(O),ge=ae(H);if(L.hasOwnProperty(Q)){let qe=L[Q];Array.isArray(qe)||(qe=[qe],L[Q]=qe),qe.push(ge)}else L[Q]=ge}parseParens(L){const O={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const H=Xe(this.remaining),Q=this.remaining[H.length];if("/"!==Q&&")"!==Q&&";"!==Q)throw new T.vHH(4010,!1);let ge;H.indexOf(":")>-1?(ge=H.slice(0,H.indexOf(":")),this.capture(ge),this.capture(":")):L&&(ge=Zn);const qe=this.parseChildren();O[ge]=1===Object.keys(qe).length?qe[Zn]:new ht([],qe),this.consumeOptional("//")}return O}peekStartsWith(L){return this.remaining.startsWith(L)}consumeOptional(L){return!!this.peekStartsWith(L)&&(this.remaining=this.remaining.substring(L.length),!0)}capture(L){if(!this.consumeOptional(L))throw new T.vHH(4011,!1)}}function en(F){return F.segments.length>0?new ht([],{[Zn]:F}):F}function Le(F){const L={};for(const H of Object.keys(F.children)){const ge=Le(F.children[H]);(ge.segments.length>0||ge.hasChildren())&&(L[H]=ge)}return function Ge(F){if(1===F.numberOfChildren&&F.children[Zn]){const L=F.children[Zn];return new ht(F.segments.concat(L.segments),L.children)}return F}(new ht(F.segments,L))}function Oe(F){return F instanceof We}function Ri(F,L,O,H,Q){if(0===O.length)return nr(L.root,L.root,L.root,H,Q);const ge=function Zr(F){if("string"==typeof F[0]&&1===F.length&&"/"===F[0])return new jr(!0,0,F);let L=0,O=!1;const H=F.reduce((Q,ge,qe)=>{if("object"==typeof ge&&null!=ge){if(ge.outlets){const pt={};return Oi(ge.outlets,(an,ni)=>{pt[ni]="string"==typeof an?an.split("/"):an}),[...Q,{outlets:pt}]}if(ge.segmentPath)return[...Q,ge.segmentPath]}return"string"!=typeof ge?[...Q,ge]:0===qe?(ge.split("/").forEach((pt,an)=>{0==an&&"."===pt||(0==an&&""===pt?O=!0:".."===pt?L++:""!=pt&&Q.push(pt))}),Q):[...Q,ge]},[]);return new jr(O,L,H)}(O);return ge.toRoot()?nr(L.root,L.root,new ht([],{}),H,Q):function qe(an){const ni=function jo(F,L,O,H){if(F.isAbsolute)return new Br(L.root,!0,0);if(-1===H)return new Br(O,O===L.root,0);return function as(F,L,O){let H=F,Q=L,ge=O;for(;ge>Q;){if(ge-=Q,H=H.parent,!H)throw new T.vHH(4005,!1);Q=H.segments.length}return new Br(H,!1,Q-ge)}(O,H+(jn(F.commands[0])?0:1),F.numberOfDoubleDots)}(ge,L,F.snapshot?._urlSegment,an),ur=ni.processChildren?ki(ni.segmentGroup,ni.index,ge.commands):ri(ni.segmentGroup,ni.index,ge.commands);return nr(L.root,ni.segmentGroup,ur,H,Q)}(F.snapshot?._lastPathIndex)}function jn(F){return"object"==typeof F&&null!=F&&!F.outlets&&!F.segmentPath}function At(F){return"object"==typeof F&&null!=F&&F.outlets}function nr(F,L,O,H,Q){let qe,ge={};H&&Oi(H,(an,ni)=>{ge[ni]=Array.isArray(an)?an.map(ur=>`${ur}`):`${an}`}),qe=F===L?O:br(F,L,O);const pt=en(Le(qe));return new We(pt,ge,Q)}function br(F,L,O){const H={};return Oi(F.children,(Q,ge)=>{H[ge]=Q===L?O:br(Q,L,O)}),new ht(F.segments,H)}class jr{constructor(L,O,H){if(this.isAbsolute=L,this.numberOfDoubleDots=O,this.commands=H,L&&H.length>0&&jn(H[0]))throw new T.vHH(4003,!1);const Q=H.find(At);if(Q&&Q!==Ii(H))throw new T.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Br{constructor(L,O,H){this.segmentGroup=L,this.processChildren=O,this.index=H}}function ri(F,L,O){if(F||(F=new ht([],{})),0===F.segments.length&&F.hasChildren())return ki(F,L,O);const H=function ls(F,L,O){let H=0,Q=L;const ge={match:!1,pathIndex:0,commandIndex:0};for(;Q<F.segments.length;){if(H>=O.length)return ge;const qe=F.segments[Q],pt=O[H];if(At(pt))break;const an=`${pt}`,ni=H<O.length-1?O[H+1]:null;if(Q>0&&void 0===an)break;if(an&&ni&&"object"==typeof ni&&void 0===ni.outlets){if(!Go(an,ni,qe))return ge;H+=2}else{if(!Go(an,{},qe))return ge;H++}Q++}return{match:!0,pathIndex:Q,commandIndex:H}}(F,L,O),Q=O.slice(H.commandIndex);if(H.match&&H.pathIndex<F.segments.length){const ge=new ht(F.segments.slice(0,H.pathIndex),{});return ge.children[Zn]=new ht(F.segments.slice(H.pathIndex),F.children),ki(ge,0,Q)}return H.match&&0===Q.length?new ht(F.segments,{}):H.match&&!F.hasChildren()?po(F,L,O):H.match?ki(F,0,Q):po(F,L,O)}function ki(F,L,O){if(0===O.length)return new ht(F.segments,{});{const H=function Gn(F){return At(F[0])?F[0].outlets:{[Zn]:F}}(O),Q={};return Oi(H,(ge,qe)=>{"string"==typeof ge&&(ge=[ge]),null!==ge&&(Q[qe]=ri(F.children[qe],L,ge))}),Oi(F.children,(ge,qe)=>{void 0===H[qe]&&(Q[qe]=ge)}),new ht(F.segments,Q)}}function po(F,L,O){const H=F.segments.slice(0,L);let Q=0;for(;Q<O.length;){const ge=O[Q];if(At(ge)){const an=vi(ge.outlets);return new ht(H,an)}if(0===Q&&jn(O[0])){H.push(new Qt(F.segments[L].path,so(O[0]))),Q++;continue}const qe=At(ge)?ge.outlets[Zn]:`${ge}`,pt=Q<O.length-1?O[Q+1]:null;qe&&pt&&jn(pt)?(H.push(new Qt(qe,so(pt))),Q+=2):(H.push(new Qt(qe,{})),Q++)}return new ht(H,{})}function vi(F){const L={};return Oi(F,(O,H)=>{"string"==typeof O&&(O=[O]),null!==O&&(L[H]=po(new ht([],{}),0,O))}),L}function so(F){const L={};return Oi(F,(O,H)=>L[H]=`${O}`),L}function Go(F,L,O){return F==O.path&&gn(L,O.parameters)}class zr{constructor(L,O){this.id=L,this.url=O}}class yr extends zr{constructor(L,O,H="imperative",Q=null){super(L,O),this.type=0,this.navigationTrigger=H,this.restoredState=Q}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Xi extends zr{constructor(L,O,H){super(L,O),this.urlAfterRedirects=H,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Gr extends zr{constructor(L,O,H,Q){super(L,O),this.reason=H,this.code=Q,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ao extends zr{constructor(L,O,H,Q){super(L,O),this.error=H,this.target=Q,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class xa extends zr{constructor(L,O,H,Q){super(L,O),this.urlAfterRedirects=H,this.state=Q,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ys extends zr{constructor(L,O,H,Q){super(L,O),this.urlAfterRedirects=H,this.state=Q,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vs extends zr{constructor(L,O,H,Q,ge){super(L,O),this.urlAfterRedirects=H,this.state=Q,this.shouldActivate=ge,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ko extends zr{constructor(L,O,H,Q){super(L,O),this.urlAfterRedirects=H,this.state=Q,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jr extends zr{constructor(L,O,H,Q){super(L,O),this.urlAfterRedirects=H,this.state=Q,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xr{constructor(L){this.route=L,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Lo{constructor(L){this.route=L,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ra{constructor(L){this.snapshot=L,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lo{constructor(L){this.snapshot=L,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ps{constructor(L){this.snapshot=L,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ho{constructor(L){this.snapshot=L,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class el{constructor(L,O,H){this.routerEvent=L,this.position=O,this.anchor=H,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class oa{constructor(L){this._root=L}get root(){return this._root.value}parent(L){const O=this.pathFromRoot(L);return O.length>1?O[O.length-2]:null}children(L){const O=Oa(L,this._root);return O?O.children.map(H=>H.value):[]}firstChild(L){const O=Oa(L,this._root);return O&&O.children.length>0?O.children[0].value:null}siblings(L){const O=sa(L,this._root);return O.length<2?[]:O[O.length-2].children.map(Q=>Q.value).filter(Q=>Q!==L)}pathFromRoot(L){return sa(L,this._root).map(O=>O.value)}}function Oa(F,L){if(F===L.value)return L;for(const O of L.children){const H=Oa(F,O);if(H)return H}return null}function sa(F,L){if(F===L.value)return[L];for(const O of L.children){const H=sa(F,O);if(H.length)return H.unshift(L),H}return[]}class Sr{constructor(L,O){this.value=L,this.children=O}toString(){return`TreeNode(${this.value})`}}function vs(F){const L={};return F&&F.children.forEach(O=>L[O.value.outlet]=O),L}class Us extends oa{constructor(L,O){super(L),this.snapshot=O,nl(this,L)}toString(){return this.snapshot.toString()}}function js(F,L){const O=function Gs(F,L){const qe=new $s([],{},{},"",{},Zn,L,null,F.root,-1,{});return new Sc("",new Sr(qe,[]))}(F,L),H=new Ye.X([new Qt("",{})]),Q=new Ye.X({}),ge=new Ye.X({}),qe=new Ye.X({}),pt=new Ye.X(""),an=new Hs(H,Q,qe,pt,ge,Zn,L,O.root);return an.snapshot=O.root,new Us(new Sr(an,[]),O)}class Hs{constructor(L,O,H,Q,ge,qe,pt,an){this.url=L,this.params=O,this.queryParams=H,this.fragment=Q,this.data=ge,this.outlet=qe,this.component=pt,this._futureSnapshot=an}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,xt.U)(L=>Kt(L)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,xt.U)(L=>Kt(L)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function tl(F,L="emptyOnly"){const O=F.pathFromRoot;let H=0;if("always"!==L)for(H=O.length-1;H>=1;){const Q=O[H],ge=O[H-1];if(Q.routeConfig&&""===Q.routeConfig.path)H--;else{if(ge.component)break;H--}}return function wa(F){return F.reduce((L,O)=>({params:{...L.params,...O.params},data:{...L.data,...O.data},resolve:{...O.data,...L.resolve,...O.routeConfig?.data,...O._resolvedData}}),{params:{},data:{},resolve:{}})}(O.slice(H))}class $s{constructor(L,O,H,Q,ge,qe,pt,an,ni,ur,di,rr){this.url=L,this.params=O,this.queryParams=H,this.fragment=Q,this.data=ge,this.outlet=qe,this.component=pt,this.routeConfig=an,this._urlSegment=ni,this._lastPathIndex=ur,this._correctedLastPathIndex=rr??ur,this._resolve=di}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Kt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(H=>H.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Sc extends oa{constructor(L,O){super(O),this.url=L,nl(this,O)}toString(){return Fo(this._root)}}function nl(F,L){L.value._routerState=F,L.children.forEach(O=>nl(F,O))}function Fo(F){const L=F.children.length>0?` { ${F.children.map(Fo).join(", ")} } `:"";return`${F.value}${L}`}function $o(F){if(F.snapshot){const L=F.snapshot,O=F._futureSnapshot;F.snapshot=O,gn(L.queryParams,O.queryParams)||F.queryParams.next(O.queryParams),L.fragment!==O.fragment&&F.fragment.next(O.fragment),gn(L.params,O.params)||F.params.next(O.params),function zn(F,L){if(F.length!==L.length)return!1;for(let O=0;O<F.length;++O)if(!gn(F[O],L[O]))return!1;return!0}(L.url,O.url)||F.url.next(O.url),gn(L.data,O.data)||F.data.next(O.data)}else F.snapshot=F._futureSnapshot,F.data.next(F._futureSnapshot.data)}function Xo(F,L){const O=gn(F.params,L.params)&&function _n(F,L){return An(F,L)&&F.every((O,H)=>gn(O.parameters,L[H].parameters))}(F.url,L.url);return O&&!(!F.parent!=!L.parent)&&(!F.parent||Xo(F.parent,L.parent))}function la(F,L,O){if(O&&F.shouldReuseRoute(L.value,O.value.snapshot)){const H=O.value;H._futureSnapshot=L.value;const Q=function ka(F,L,O){return L.children.map(H=>{for(const Q of O.children)if(F.shouldReuseRoute(H.value,Q.value.snapshot))return la(F,H,Q);return la(F,H)})}(F,L,O);return new Sr(H,Q)}{if(F.shouldAttach(L.value)){const ge=F.retrieve(L.value);if(null!==ge){const qe=ge.route;return qe.value._futureSnapshot=L.value,qe.children=L.children.map(pt=>la(F,pt)),qe}}const H=function Ra(F){return new Hs(new Ye.X(F.url),new Ye.X(F.params),new Ye.X(F.queryParams),new Ye.X(F.fragment),new Ye.X(F.data),F.outlet,F.component,F)}(L.value),Q=L.children.map(ge=>la(F,ge));return new Sr(H,Q)}}const _l="ngNavigationCancelingError";function Al(F,L){const{redirectTo:O,navigationBehaviorOptions:H}=Oe(L)?{redirectTo:L,navigationBehaviorOptions:void 0}:L,Q=La(!1,0,L);return Q.url=O,Q.navigationBehaviorOptions=H,Q}function La(F,L,O){const H=new Error("NavigationCancelingError: "+(F||""));return H[_l]=!0,H.cancellationCode=L,O&&(H.url=O),H}function ca(F){return cs(F)&&Oe(F.url)}function cs(F){return F&&F[_l]}class Fa{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ba,this.attachRef=null}}class Ba{constructor(){this.contexts=new Map}onChildOutletCreated(L,O){const H=this.getOrCreateContext(L);H.outlet=O,this.contexts.set(L,H)}onChildOutletDestroyed(L){const O=this.getContext(L);O&&(O.outlet=null,O.attachRef=null)}onOutletDeactivated(){const L=this.contexts;return this.contexts=new Map,L}onOutletReAttached(L){this.contexts=L}getOrCreateContext(L){let O=this.getContext(L);return O||(O=new Fa,this.contexts.set(L,O)),O}getContext(L){return this.contexts.get(L)||null}}const Zs=!1;let Bo=(()=>{class F{constructor(O,H,Q,ge,qe){this.parentContexts=O,this.location=H,this.changeDetector=ge,this.environmentInjector=qe,this.activated=null,this._activatedRoute=null,this.activateEvents=new T.vpe,this.deactivateEvents=new T.vpe,this.attachEvents=new T.vpe,this.detachEvents=new T.vpe,this.name=Q||Zn,O.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const O=this.parentContexts.getContext(this.name);O&&O.route&&(O.attachRef?this.attach(O.attachRef,O.route):this.activateWith(O.route,O.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new T.vHH(4012,Zs);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new T.vHH(4012,Zs);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new T.vHH(4012,Zs);this.location.detach();const O=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(O.instance),O}attach(O,H){this.activated=O,this._activatedRoute=H,this.location.insert(O.hostView),this.attachEvents.emit(O.instance)}deactivate(){if(this.activated){const O=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(O)}}activateWith(O,H){if(this.isActivated)throw new T.vHH(4013,Zs);this._activatedRoute=O;const Q=this.location,qe=O._futureSnapshot.component,pt=this.parentContexts.getOrCreateContext(this.name).children,an=new Ca(O,pt,Q.injector);if(H&&function Qr(F){return!!F.resolveComponentFactory}(H)){const ni=H.resolveComponentFactory(qe);this.activated=Q.createComponent(ni,Q.length,an)}else this.activated=Q.createComponent(qe,{index:Q.length,injector:an,environmentInjector:H??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return F.\u0275fac=function(O){return new(O||F)(T.Y36(Ba),T.Y36(T.s_b),T.$8M("name"),T.Y36(T.sBO),T.Y36(T.lqb))},F.\u0275dir=T.lG2({type:F,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),F})();class Ca{constructor(L,O,H){this.route=L,this.childContexts=O,this.parent=H}get(L,O){return L===Hs?this.route:L===Ba?this.childContexts:this.parent.get(L,O)}}let za=(()=>{class F{}return F.\u0275fac=function(O){return new(O||F)},F.\u0275cmp=T.Xpm({type:F,selectors:[["ng-component"]],decls:1,vars:0,template:function(O,H){1&O&&T._UZ(0,"router-outlet")},dependencies:[Bo],encapsulation:2}),F})();function Ws(F,L){return F.providers&&!F._injector&&(F._injector=(0,T.MMx)(F.providers,L,`Route: ${F.path}`)),F._injector??L}function Ae(F){const L=F.children&&F.children.map(Ae),O=L?{...F,children:L}:{...F};return!O.component&&!O.loadComponent&&(L||O.loadChildren)&&O.outlet&&O.outlet!==Zn&&(O.component=za),O}function vt(F){return F.outlet||Zn}function sn(F,L){const O=F.filter(H=>vt(H)===L);return O.push(...F.filter(H=>vt(H)!==L)),O}function xn(F){if(!F)return null;if(F.routeConfig?._injector)return F.routeConfig._injector;for(let L=F.parent;L;L=L.parent){const O=L.routeConfig;if(O?._loadedInjector)return O._loadedInjector;if(O?._injector)return O._injector}return null}class wr{constructor(L,O,H,Q){this.routeReuseStrategy=L,this.futureState=O,this.currState=H,this.forwardEvent=Q}activate(L){const O=this.futureState._root,H=this.currState?this.currState._root:null;this.deactivateChildRoutes(O,H,L),$o(this.futureState.root),this.activateChildRoutes(O,H,L)}deactivateChildRoutes(L,O,H){const Q=vs(O);L.children.forEach(ge=>{const qe=ge.value.outlet;this.deactivateRoutes(ge,Q[qe],H),delete Q[qe]}),Oi(Q,(ge,qe)=>{this.deactivateRouteAndItsChildren(ge,H)})}deactivateRoutes(L,O,H){const Q=L.value,ge=O?O.value:null;if(Q===ge)if(Q.component){const qe=H.getContext(Q.outlet);qe&&this.deactivateChildRoutes(L,O,qe.children)}else this.deactivateChildRoutes(L,O,H);else ge&&this.deactivateRouteAndItsChildren(O,H)}deactivateRouteAndItsChildren(L,O){L.value.component&&this.routeReuseStrategy.shouldDetach(L.value.snapshot)?this.detachAndStoreRouteSubtree(L,O):this.deactivateRouteAndOutlet(L,O)}detachAndStoreRouteSubtree(L,O){const H=O.getContext(L.value.outlet),Q=H&&L.value.component?H.children:O,ge=vs(L);for(const qe of Object.keys(ge))this.deactivateRouteAndItsChildren(ge[qe],Q);if(H&&H.outlet){const qe=H.outlet.detach(),pt=H.children.onOutletDeactivated();this.routeReuseStrategy.store(L.value.snapshot,{componentRef:qe,route:L,contexts:pt})}}deactivateRouteAndOutlet(L,O){const H=O.getContext(L.value.outlet),Q=H&&L.value.component?H.children:O,ge=vs(L);for(const qe of Object.keys(ge))this.deactivateRouteAndItsChildren(ge[qe],Q);H&&H.outlet&&(H.outlet.deactivate(),H.children.onOutletDeactivated(),H.attachRef=null,H.resolver=null,H.route=null)}activateChildRoutes(L,O,H){const Q=vs(O);L.children.forEach(ge=>{this.activateRoutes(ge,Q[ge.value.outlet],H),this.forwardEvent(new Ho(ge.value.snapshot))}),L.children.length&&this.forwardEvent(new lo(L.value.snapshot))}activateRoutes(L,O,H){const Q=L.value,ge=O?O.value:null;if($o(Q),Q===ge)if(Q.component){const qe=H.getOrCreateContext(Q.outlet);this.activateChildRoutes(L,O,qe.children)}else this.activateChildRoutes(L,O,H);else if(Q.component){const qe=H.getOrCreateContext(Q.outlet);if(this.routeReuseStrategy.shouldAttach(Q.snapshot)){const pt=this.routeReuseStrategy.retrieve(Q.snapshot);this.routeReuseStrategy.store(Q.snapshot,null),qe.children.onOutletReAttached(pt.contexts),qe.attachRef=pt.componentRef,qe.route=pt.route.value,qe.outlet&&qe.outlet.attach(pt.componentRef,pt.route.value),$o(pt.route.value),this.activateChildRoutes(L,null,qe.children)}else{const pt=xn(Q.snapshot),an=pt?.get(T._Vd)??null;qe.attachRef=null,qe.route=Q,qe.resolver=an,qe.injector=pt,qe.outlet&&qe.outlet.activateWith(Q,qe.injector),this.activateChildRoutes(L,null,qe.children)}}else this.activateChildRoutes(L,null,H)}}class vr{constructor(L){this.path=L,this.route=this.path[this.path.length-1]}}class _r{constructor(L,O){this.component=L,this.route=O}}function Vi(F,L,O){const H=F._root;return co(H,L?L._root:null,O,[H.value])}function Dr(F,L,O){return(xn(L)??O).get(F)}function co(F,L,O,H,Q={canDeactivateChecks:[],canActivateChecks:[]}){const ge=vs(L);return F.children.forEach(qe=>{(function il(F,L,O,H,Q={canDeactivateChecks:[],canActivateChecks:[]}){const ge=F.value,qe=L?L.value:null,pt=O?O.getContext(F.value.outlet):null;if(qe&&ge.routeConfig===qe.routeConfig){const an=function yn(F,L,O){if("function"==typeof O)return O(F,L);switch(O){case"pathParamsChange":return!An(F.url,L.url);case"pathParamsOrQueryParamsChange":return!An(F.url,L.url)||!gn(F.queryParams,L.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xo(F,L)||!gn(F.queryParams,L.queryParams);default:return!Xo(F,L)}}(qe,ge,ge.routeConfig.runGuardsAndResolvers);an?Q.canActivateChecks.push(new vr(H)):(ge.data=qe.data,ge._resolvedData=qe._resolvedData),co(F,L,ge.component?pt?pt.children:null:O,H,Q),an&&pt&&pt.outlet&&pt.outlet.isActivated&&Q.canDeactivateChecks.push(new _r(pt.outlet.component,qe))}else qe&&ji(L,pt,Q),Q.canActivateChecks.push(new vr(H)),co(F,null,ge.component?pt?pt.children:null:O,H,Q)})(qe,ge[qe.value.outlet],O,H.concat([qe.value]),Q),delete ge[qe.value.outlet]}),Oi(ge,(qe,pt)=>ji(qe,O.getContext(pt),Q)),Q}function ji(F,L,O){const H=vs(F),Q=F.value;Oi(H,(ge,qe)=>{ji(ge,Q.component?L?L.children.getContext(qe):null:L,O)}),O.canDeactivateChecks.push(new _r(Q.component&&L&&L.outlet&&L.outlet.isActivated?L.outlet.component:null,Q))}function Eo(F){return"function"==typeof F}const Ci=Symbol("INITIAL_VALUE");function Ar(){return(0,Tt.w)(F=>(0,ft.a)(F.map(L=>L.pipe((0,Gt.q)(1),(0,Bt.O)(Ci)))).pipe((0,xt.U)(L=>{for(const O of L)if(!0!==O){if(O===Ci)return Ci;if(!1===O||O instanceof We)return O}return!0}),(0,Fe.h)(L=>L!==Ci),(0,Gt.q)(1)))}function Nu(F){return(0,gt.z)((0,Yn.b)(L=>{if(Oe(L))throw Al(0,L)}),(0,xt.U)(L=>!0===L))}const nc={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Il(F,L,O,H,Q){const ge=Pl(F,L,O);return ge.matched?function tc(F,L,O,H){const Q=L.canMatch;if(!Q||0===Q.length)return(0,Me.of)(!0);const ge=Q.map(qe=>{const pt=F.get(qe),an=function $(F){return F&&Eo(F.canMatch)}(pt)?pt.canMatch(L,O):pt(L,O);return En(an)});return(0,Me.of)(ge).pipe(Ar(),Nu())}(H=Ws(L,H),L,O).pipe((0,xt.U)(qe=>!0===qe?ge:{...nc})):(0,Me.of)(ge)}function Pl(F,L,O){if(""===L.path)return"full"===L.pathMatch&&(F.hasChildren()||O.length>0)?{...nc}:{matched:!0,consumedSegments:[],remainingSegments:O,parameters:{},positionalParamSegments:{}};const Q=(L.matcher||kn)(O,F,L);if(!Q)return{...nc};const ge={};Oi(Q.posParams,(pt,an)=>{ge[an]=pt.path});const qe=Q.consumed.length>0?{...ge,...Q.consumed[Q.consumed.length-1].parameters}:ge;return{matched:!0,consumedSegments:Q.consumed,remainingSegments:O.slice(Q.consumed.length),parameters:qe,positionalParamSegments:Q.posParams??{}}}function yl(F,L,O,H,Q="corrected"){if(O.length>0&&function kd(F,L,O){return O.some(H=>ic(F,L,H)&&vt(H)!==Zn)}(F,O,H)){const qe=new ht(L,function Vu(F,L,O,H){const Q={};Q[Zn]=H,H._sourceSegment=F,H._segmentIndexShift=L.length;for(const ge of O)if(""===ge.path&&vt(ge)!==Zn){const qe=new ht([],{});qe._sourceSegment=F,qe._segmentIndexShift=L.length,Q[vt(ge)]=qe}return Q}(F,L,H,new ht(O,F.children)));return qe._sourceSegment=F,qe._segmentIndexShift=L.length,{segmentGroup:qe,slicedSegments:[]}}if(0===O.length&&function ds(F,L,O){return O.some(H=>ic(F,L,H))}(F,O,H)){const qe=new ht(F.segments,function Od(F,L,O,H,Q,ge){const qe={};for(const pt of H)if(ic(F,O,pt)&&!Q[vt(pt)]){const an=new ht([],{});an._sourceSegment=F,an._segmentIndexShift="legacy"===ge?F.segments.length:L.length,qe[vt(pt)]=an}return{...Q,...qe}}(F,L,O,H,F.children,Q));return qe._sourceSegment=F,qe._segmentIndexShift=L.length,{segmentGroup:qe,slicedSegments:O}}const ge=new ht(F.segments,F.children);return ge._sourceSegment=F,ge._segmentIndexShift=L.length,{segmentGroup:ge,slicedSegments:O}}function ic(F,L,O){return(!(F.hasChildren()||L.length>0)||"full"!==O.pathMatch)&&""===O.path}function fo(F,L,O,H){return!!(vt(F)===H||H!==Zn&&ic(L,O,F))&&("**"===F.path||Pl(L,F,O).matched)}function to(F,L,O){return 0===L.length&&!F.children[O]}const rc=!1;class Na{constructor(L){this.segmentGroup=L||null}}class Qo{constructor(L){this.urlTree=L}}function xs(F){return(0,et._)(new Na(F))}function ir(F){return(0,et._)(new Qo(F))}class zo{constructor(L,O,H,Q,ge){this.injector=L,this.configLoader=O,this.urlSerializer=H,this.urlTree=Q,this.config=ge,this.allowRedirects=!0}apply(){const L=yl(this.urlTree.root,[],[],this.config).segmentGroup,O=new ht(L.segments,L.children);return this.expandSegmentGroup(this.injector,this.config,O,Zn).pipe((0,xt.U)(ge=>this.createUrlTree(Le(ge),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,fi.K)(ge=>{if(ge instanceof Qo)return this.allowRedirects=!1,this.match(ge.urlTree);throw ge instanceof Na?this.noMatchError(ge):ge}))}match(L){return this.expandSegmentGroup(this.injector,this.config,L.root,Zn).pipe((0,xt.U)(Q=>this.createUrlTree(Le(Q),L.queryParams,L.fragment))).pipe((0,fi.K)(Q=>{throw Q instanceof Na?this.noMatchError(Q):Q}))}noMatchError(L){return new T.vHH(4002,rc)}createUrlTree(L,O,H){const Q=en(L);return new We(Q,O,H)}expandSegmentGroup(L,O,H,Q){return 0===H.segments.length&&H.hasChildren()?this.expandChildren(L,O,H).pipe((0,xt.U)(ge=>new ht([],ge))):this.expandSegment(L,H,O,H.segments,Q,!0)}expandChildren(L,O,H){const Q=[];for(const ge of Object.keys(H.children))"primary"===ge?Q.unshift(ge):Q.push(ge);return(0,ye.D)(Q).pipe((0,oi.b)(ge=>{const qe=H.children[ge],pt=sn(O,ge);return this.expandSegmentGroup(L,pt,qe,ge).pipe((0,xt.U)(an=>({segment:an,outlet:ge})))}),Xt((ge,qe)=>(ge[qe.outlet]=qe.segment,ge),{}),vn())}expandSegment(L,O,H,Q,ge,qe){return(0,ye.D)(H).pipe((0,oi.b)(pt=>this.expandSegmentAgainstRoute(L,O,H,pt,Q,ge,qe).pipe((0,fi.K)(ni=>{if(ni instanceof Na)return(0,Me.of)(null);throw ni}))),(0,mn.P)(pt=>!!pt),(0,fi.K)((pt,an)=>{if(pt instanceof Ut.K||"EmptyError"===pt.name)return to(O,Q,ge)?(0,Me.of)(new ht([],{})):xs(O);throw pt}))}expandSegmentAgainstRoute(L,O,H,Q,ge,qe,pt){return fo(Q,O,ge,qe)?void 0===Q.redirectTo?this.matchSegmentAgainstRoute(L,O,Q,ge,qe):pt&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(L,O,H,Q,ge,qe):xs(O):xs(O)}expandSegmentAgainstRouteUsingRedirect(L,O,H,Q,ge,qe){return"**"===Q.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(L,H,Q,qe):this.expandRegularSegmentAgainstRouteUsingRedirect(L,O,H,Q,ge,qe)}expandWildCardWithParamsAgainstRouteUsingRedirect(L,O,H,Q){const ge=this.applyRedirectCommands([],H.redirectTo,{});return H.redirectTo.startsWith("/")?ir(ge):this.lineralizeSegments(H,ge).pipe((0,Cn.z)(qe=>{const pt=new ht(qe,{});return this.expandSegment(L,pt,O,qe,Q,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(L,O,H,Q,ge,qe){const{matched:pt,consumedSegments:an,remainingSegments:ni,positionalParamSegments:ur}=Pl(O,Q,ge);if(!pt)return xs(O);const di=this.applyRedirectCommands(an,Q.redirectTo,ur);return Q.redirectTo.startsWith("/")?ir(di):this.lineralizeSegments(Q,di).pipe((0,Cn.z)(rr=>this.expandSegment(L,O,H,rr.concat(ni),qe,!1)))}matchSegmentAgainstRoute(L,O,H,Q,ge){return"**"===H.path?(L=Ws(H,L),H.loadChildren?(H._loadedRoutes?(0,Me.of)({routes:H._loadedRoutes,injector:H._loadedInjector}):this.configLoader.loadChildren(L,H)).pipe((0,xt.U)(pt=>(H._loadedRoutes=pt.routes,H._loadedInjector=pt.injector,new ht(Q,{})))):(0,Me.of)(new ht(Q,{}))):Il(O,H,Q,L).pipe((0,Tt.w)(({matched:qe,consumedSegments:pt,remainingSegments:an})=>qe?this.getChildConfig(L=H._injector??L,H,Q).pipe((0,Cn.z)(ur=>{const di=ur.injector??L,rr=ur.routes,{segmentGroup:Jo,slicedSegments:ms}=yl(O,pt,an,rr),Vl=new ht(Jo.segments,Jo.children);if(0===ms.length&&Vl.hasChildren())return this.expandChildren(di,rr,Vl).pipe((0,xt.U)(Ku=>new ht(pt,Ku)));if(0===rr.length&&0===ms.length)return(0,Me.of)(new ht(pt,{}));const Rs=vt(H)===ge;return this.expandSegment(di,Vl,rr,ms,Rs?Zn:ge,!0).pipe((0,xt.U)(Ul=>new ht(pt.concat(Ul.segments),Ul.children)))})):xs(O)))}getChildConfig(L,O,H){return O.children?(0,Me.of)({routes:O.children,injector:L}):O.loadChildren?void 0!==O._loadedRoutes?(0,Me.of)({routes:O._loadedRoutes,injector:O._loadedInjector}):function Ac(F,L,O,H){const Q=L.canLoad;if(void 0===Q||0===Q.length)return(0,Me.of)(!0);const ge=Q.map(qe=>{const pt=F.get(qe),an=function qr(F){return F&&Eo(F.canLoad)}(pt)?pt.canLoad(L,O):pt(L,O);return En(an)});return(0,Me.of)(ge).pipe(Ar(),Nu())}(L,O,H).pipe((0,Cn.z)(Q=>Q?this.configLoader.loadChildren(L,O).pipe((0,Yn.b)(ge=>{O._loadedRoutes=ge.routes,O._loadedInjector=ge.injector})):function Uu(F){return(0,et._)(La(rc,3))}())):(0,Me.of)({routes:[],injector:L})}lineralizeSegments(L,O){let H=[],Q=O.root;for(;;){if(H=H.concat(Q.segments),0===Q.numberOfChildren)return(0,Me.of)(H);if(Q.numberOfChildren>1||!Q.children[Zn])return(0,et._)(new T.vHH(4e3,rc));Q=Q.children[Zn]}}applyRedirectCommands(L,O,H){return this.applyRedirectCreateUrlTree(O,this.urlSerializer.parse(O),L,H)}applyRedirectCreateUrlTree(L,O,H,Q){const ge=this.createSegmentGroup(L,O.root,H,Q);return new We(ge,this.createQueryParams(O.queryParams,this.urlTree.queryParams),O.fragment)}createQueryParams(L,O){const H={};return Oi(L,(Q,ge)=>{if("string"==typeof Q&&Q.startsWith(":")){const pt=Q.substring(1);H[ge]=O[pt]}else H[ge]=Q}),H}createSegmentGroup(L,O,H,Q){const ge=this.createSegments(L,O.segments,H,Q);let qe={};return Oi(O.children,(pt,an)=>{qe[an]=this.createSegmentGroup(L,pt,H,Q)}),new ht(ge,qe)}createSegments(L,O,H,Q){return O.map(ge=>ge.path.startsWith(":")?this.findPosParam(L,ge,Q):this.findOrReturn(ge,H))}findPosParam(L,O,H){const Q=H[O.path.substring(1)];if(!Q)throw new T.vHH(4001,rc);return Q}findOrReturn(L,O){let H=0;for(const Q of O){if(Q.path===L.path)return O.splice(H),Q;H++}return L}}class Ol{}class ws{constructor(L,O,H,Q,ge,qe,pt,an){this.injector=L,this.rootComponentType=O,this.config=H,this.urlTree=Q,this.url=ge,this.paramsInheritanceStrategy=qe,this.relativeLinkResolution=pt,this.urlSerializer=an}recognize(){const L=yl(this.urlTree.root,[],[],this.config.filter(O=>void 0===O.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,L,Zn).pipe((0,xt.U)(O=>{if(null===O)return null;const H=new $s([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Zn,this.rootComponentType,null,this.urlTree.root,-1,{}),Q=new Sr(H,O),ge=new Sc(this.url,Q);return this.inheritParamsAndData(ge._root),ge}))}inheritParamsAndData(L){const O=L.value,H=tl(O,this.paramsInheritanceStrategy);O.params=Object.freeze(H.params),O.data=Object.freeze(H.data),L.children.forEach(Q=>this.inheritParamsAndData(Q))}processSegmentGroup(L,O,H,Q){return 0===H.segments.length&&H.hasChildren()?this.processChildren(L,O,H):this.processSegment(L,O,H,H.segments,Q)}processChildren(L,O,H){return(0,ye.D)(Object.keys(H.children)).pipe((0,oi.b)(Q=>{const ge=H.children[Q],qe=sn(O,Q);return this.processSegmentGroup(L,qe,ge,Q)}),Xt((Q,ge)=>Q&&ge?(Q.push(...ge),Q):null),(0,On.o)(Q=>null!==Q),(0,Jt.d)(null),vn(),(0,xt.U)(Q=>{if(null===Q)return null;const ge=Rr(Q);return function Zo(F){F.sort((L,O)=>L.value.outlet===Zn?-1:O.value.outlet===Zn?1:L.value.outlet.localeCompare(O.value.outlet))}(ge),ge}))}processSegment(L,O,H,Q,ge){return(0,ye.D)(O).pipe((0,oi.b)(qe=>this.processSegmentAgainstRoute(qe._injector??L,qe,H,Q,ge)),(0,mn.P)(qe=>!!qe),(0,fi.K)(qe=>{if(qe instanceof Ut.K)return to(H,Q,ge)?(0,Me.of)([]):(0,Me.of)(null);throw qe}))}processSegmentAgainstRoute(L,O,H,Q,ge){if(O.redirectTo||!fo(O,H,Q,ge))return(0,Me.of)(null);let qe;if("**"===O.path){const pt=Q.length>0?Ii(Q).parameters:{},an=ha(H)+Q.length,ni=new $s(Q,pt,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,bo(O),vt(O),O.component??O._loadedComponent??null,O,Cs(H),an,ju(O),an);qe=(0,Me.of)({snapshot:ni,consumedSegments:[],remainingSegments:[]})}else qe=Il(H,O,Q,L).pipe((0,xt.U)(({matched:pt,consumedSegments:an,remainingSegments:ni,parameters:ur})=>{if(!pt)return null;const di=ha(H)+an.length;return{snapshot:new $s(an,ur,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,bo(O),vt(O),O.component??O._loadedComponent??null,O,Cs(H),di,ju(O),di),consumedSegments:an,remainingSegments:ni}}));return qe.pipe((0,Tt.w)(pt=>{if(null===pt)return(0,Me.of)(null);const{snapshot:an,consumedSegments:ni,remainingSegments:ur}=pt;L=O._injector??L;const di=O._loadedInjector??L,rr=function cr(F){return F.children?F.children:F.loadChildren?F._loadedRoutes:[]}(O),{segmentGroup:Jo,slicedSegments:ms}=yl(H,ni,ur,rr.filter(Rs=>void 0===Rs.redirectTo),this.relativeLinkResolution);if(0===ms.length&&Jo.hasChildren())return this.processChildren(di,rr,Jo).pipe((0,xt.U)(Rs=>null===Rs?null:[new Sr(an,Rs)]));if(0===rr.length&&0===ms.length)return(0,Me.of)([new Sr(an,[])]);const Vl=vt(O)===ge;return this.processSegment(di,rr,Jo,ms,Vl?Zn:ge).pipe((0,xt.U)(Rs=>null===Rs?null:[new Sr(an,Rs)]))}))}}function Mo(F){const L=F.value.routeConfig;return L&&""===L.path&&void 0===L.redirectTo}function Rr(F){const L=[],O=new Set;for(const H of F){if(!Mo(H)){L.push(H);continue}const Q=L.find(ge=>H.value.routeConfig===ge.value.routeConfig);void 0!==Q?(Q.children.push(...H.children),O.add(Q)):L.push(H)}for(const H of O){const Q=Rr(H.children);L.push(new Sr(H.value,Q))}return L.filter(H=>!O.has(H))}function Cs(F){let L=F;for(;L._sourceSegment;)L=L._sourceSegment;return L}function ha(F){let L=F,O=L._segmentIndexShift??0;for(;L._sourceSegment;)L=L._sourceSegment,O+=L._segmentIndexShift??0;return O-1}function bo(F){return F.data||{}}function ju(F){return F.resolve||{}}const vl=Symbol("RouteTitle");function zi(F){return"string"==typeof F.title||null===F.title}function Hn(F){return(0,Tt.w)(L=>{const O=F(L);return O?(0,ye.D)(O).pipe((0,xt.U)(()=>L)):(0,Me.of)(L)})}let Ys=(()=>{class F{buildTitle(O){let H,Q=O.root;for(;void 0!==Q;)H=this.getResolvedTitleForRoute(Q)??H,Q=Q.children.find(ge=>ge.outlet===Zn);return H}getResolvedTitleForRoute(O){return O.data[vl]}}return F.\u0275fac=function(O){return new(O||F)},F.\u0275prov=T.Yz7({token:F,factory:function(){return(0,T.f3M)(hs)},providedIn:"root"}),F})(),hs=(()=>{class F extends Ys{constructor(O){super(),this.title=O}updateTitle(O){const H=this.buildTitle(O);void 0!==H&&this.title.setTitle(H)}}return F.\u0275fac=function(O){return new(O||F)(T.LFG(Ln.Dx))},F.\u0275prov=T.Yz7({token:F,factory:F.\u0275fac,providedIn:"root"}),F})();class ja{}class Ll extends class ac{shouldDetach(L){return!1}store(L,O){}shouldAttach(L){return!1}retrieve(L){return null}shouldReuseRoute(L,O){return L.routeConfig===O.routeConfig}}{}const bl=new T.OlP("",{providedIn:"root",factory:()=>({})}),Wo=new T.OlP("ROUTES");let au=(()=>{class F{constructor(O,H){this.injector=O,this.compiler=H,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(O){if(this.componentLoaders.get(O))return this.componentLoaders.get(O);if(O._loadedComponent)return(0,Me.of)(O._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(O);const H=En(O.loadComponent()).pipe((0,Yn.b)(ge=>{this.onLoadEndListener&&this.onLoadEndListener(O),O._loadedComponent=ge}),(0,Ui.x)(()=>{this.componentLoaders.delete(O)})),Q=new Je(H,()=>new St.x).pipe(Ve());return this.componentLoaders.set(O,Q),Q}loadChildren(O,H){if(this.childrenLoaders.get(H))return this.childrenLoaders.get(H);if(H._loadedRoutes)return(0,Me.of)({routes:H._loadedRoutes,injector:H._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(H);const ge=this.loadModuleFactoryOrRoutes(H.loadChildren).pipe((0,xt.U)(pt=>{this.onLoadEndListener&&this.onLoadEndListener(H);let an,ni,ur=!1;Array.isArray(pt)?ni=pt:(an=pt.create(O).injector,ni=Ei(an.get(Wo,[],T.XFs.Self|T.XFs.Optional)));return{routes:ni.map(Ae),injector:an}}),(0,Ui.x)(()=>{this.childrenLoaders.delete(H)})),qe=new Je(ge,()=>new St.x).pipe(Ve());return this.childrenLoaders.set(H,qe),qe}loadModuleFactoryOrRoutes(O){return En(O()).pipe((0,Cn.z)(H=>H instanceof T.YKP||Array.isArray(H)?(0,Me.of)(H):(0,ye.D)(this.compiler.compileModuleAsync(H))))}}return F.\u0275fac=function(O){return new(O||F)(T.LFG(T.zs3),T.LFG(T.Sil))},F.\u0275prov=T.Yz7({token:F,factory:F.\u0275fac}),F})();class Fl{}class Ga{shouldProcessUrl(L){return!0}extract(L){return L}merge(L,O){return L}}function kc(F){throw F}function Ha(F,L,O){return L.parse("/")}const Bl={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ps={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function Gu(){const F=(0,T.f3M)(qn),L=(0,T.f3M)(Ba),O=(0,T.f3M)(Pn.Ye),H=(0,T.f3M)(T.zs3),Q=(0,T.f3M)(T.Sil),ge=(0,T.f3M)(Wo,{optional:!0})??[],qe=(0,T.f3M)(bl,{optional:!0})??{},pt=(0,T.f3M)(hs),an=(0,T.f3M)(Ys,{optional:!0}),ni=(0,T.f3M)(Fl,{optional:!0}),ur=(0,T.f3M)(ja,{optional:!0}),di=new Do(null,F,L,O,H,Q,Ei(ge));return ni&&(di.urlHandlingStrategy=ni),ur&&(di.routeReuseStrategy=ur),di.titleStrategy=an??pt,function $a(F,L){F.errorHandler&&(L.errorHandler=F.errorHandler),F.malformedUriErrorHandler&&(L.malformedUriErrorHandler=F.malformedUriErrorHandler),F.onSameUrlNavigation&&(L.onSameUrlNavigation=F.onSameUrlNavigation),F.paramsInheritanceStrategy&&(L.paramsInheritanceStrategy=F.paramsInheritanceStrategy),F.relativeLinkResolution&&(L.relativeLinkResolution=F.relativeLinkResolution),F.urlUpdateStrategy&&(L.urlUpdateStrategy=F.urlUpdateStrategy),F.canceledNavigationResolution&&(L.canceledNavigationResolution=F.canceledNavigationResolution)}(qe,di),di}let Do=(()=>{class F{constructor(O,H,Q,ge,qe,pt,an){this.rootComponentType=O,this.urlSerializer=H,this.rootContexts=Q,this.location=ge,this.config=an,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new St.x,this.errorHandler=kc,this.malformedUriErrorHandler=Ha,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>(0,Me.of)(void 0),this.urlHandlingStrategy=new Ga,this.routeReuseStrategy=new Ll,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=qe.get(au),this.configLoader.onLoadEndListener=rr=>this.triggerEvent(new Lo(rr)),this.configLoader.onLoadStartListener=rr=>this.triggerEvent(new xr(rr)),this.ngModule=qe.get(T.h0i),this.console=qe.get(T.c2e);const di=qe.get(T.R0b);this.isNgZoneEnabled=di instanceof T.R0b&&T.R0b.isInAngularZone(),this.resetConfig(an),this.currentUrlTree=function li(){return new We(new ht([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=js(this.currentUrlTree,this.rootComponentType),this.transitions=new Ye.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(O){const H=this.events;return O.pipe((0,Fe.h)(Q=>0!==Q.id),(0,xt.U)(Q=>({...Q,extractedUrl:this.urlHandlingStrategy.extract(Q.rawUrl)})),(0,Tt.w)(Q=>{let ge=!1,qe=!1;return(0,Me.of)(Q).pipe((0,Yn.b)(pt=>{this.currentNavigation={id:pt.id,initialUrl:pt.rawUrl,extractedUrl:pt.extractedUrl,trigger:pt.source,extras:pt.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Tt.w)(pt=>{const an=this.browserUrlTree.toString(),ni=!this.navigated||pt.extractedUrl.toString()!==an||an!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||ni)&&this.urlHandlingStrategy.shouldProcessUrl(pt.rawUrl))return Rc(pt.source)&&(this.browserUrlTree=pt.extractedUrl),(0,Me.of)(pt).pipe((0,Tt.w)(di=>{const rr=this.transitions.getValue();return H.next(new yr(di.id,this.serializeUrl(di.extractedUrl),di.source,di.restoredState)),rr!==this.transitions.getValue()?Ft.E:Promise.resolve(di)}),function ll(F,L,O,H){return(0,Tt.w)(Q=>function Ic(F,L,O,H,Q){return new zo(F,L,O,H,Q).apply()}(F,L,O,Q.extractedUrl,H).pipe((0,xt.U)(ge=>({...Q,urlAfterRedirects:ge}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Yn.b)(di=>{this.currentNavigation={...this.currentNavigation,finalUrl:di.urlAfterRedirects},Q.urlAfterRedirects=di.urlAfterRedirects}),function qs(F,L,O,H,Q,ge){return(0,Cn.z)(qe=>function Ma(F,L,O,H,Q,ge,qe="emptyOnly",pt="legacy"){return new ws(F,L,O,H,Q,qe,pt,ge).recognize().pipe((0,Tt.w)(an=>null===an?function Ea(F){return new d.y(L=>L.error(F))}(new Ol):(0,Me.of)(an)))}(F,L,O,qe.urlAfterRedirects,H.serialize(qe.urlAfterRedirects),H,Q,ge).pipe((0,xt.U)(pt=>({...qe,targetSnapshot:pt}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Yn.b)(di=>{if(Q.targetSnapshot=di.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!di.extras.skipLocationChange){const Jo=this.urlHandlingStrategy.merge(di.urlAfterRedirects,di.rawUrl);this.setBrowserUrl(Jo,di)}this.browserUrlTree=di.urlAfterRedirects}const rr=new xa(di.id,this.serializeUrl(di.extractedUrl),this.serializeUrl(di.urlAfterRedirects),di.targetSnapshot);H.next(rr)}));if(ni&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:rr,extractedUrl:Jo,source:ms,restoredState:Vl,extras:Rs}=pt,hu=new yr(rr,this.serializeUrl(Jo),ms,Vl);H.next(hu);const Ul=js(Jo,this.rootComponentType).snapshot;return Q={...pt,targetSnapshot:Ul,urlAfterRedirects:Jo,extras:{...Rs,skipLocationChange:!1,replaceUrl:!1}},(0,Me.of)(Q)}return this.rawUrlTree=pt.rawUrl,pt.resolve(null),Ft.E}),(0,Yn.b)(pt=>{const an=new ys(pt.id,this.serializeUrl(pt.extractedUrl),this.serializeUrl(pt.urlAfterRedirects),pt.targetSnapshot);this.triggerEvent(an)}),(0,xt.U)(pt=>Q={...pt,guards:Vi(pt.targetSnapshot,pt.currentSnapshot,this.rootContexts)}),function bs(F,L){return(0,Cn.z)(O=>{const{targetSnapshot:H,currentSnapshot:Q,guards:{canActivateChecks:ge,canDeactivateChecks:qe}}=O;return 0===qe.length&&0===ge.length?(0,Me.of)({...O,guardsResult:!0}):function eo(F,L,O,H){return(0,ye.D)(F).pipe((0,Cn.z)(Q=>function Pd(F,L,O,H,Q){const ge=L&&L.routeConfig?L.routeConfig.canDeactivate:null;if(!ge||0===ge.length)return(0,Me.of)(!0);const qe=ge.map(pt=>{const an=Dr(pt,L,Q);return En(function q(F){return F&&Eo(F.canDeactivate)}(an)?an.canDeactivate(F,L,O,H):an(F,L,O,H)).pipe((0,mn.P)())});return(0,Me.of)(qe).pipe(Ar())}(Q.component,Q.route,O,L,H)),(0,mn.P)(Q=>!0!==Q,!0))}(qe,H,Q,F).pipe((0,Cn.z)(pt=>pt&&function rl(F){return"boolean"==typeof F}(pt)?function us(F,L,O,H){return(0,ye.D)(L).pipe((0,oi.b)(Q=>(0,Pe.z)(function sl(F,L){return null!==F&&L&&L(new ra(F)),(0,Me.of)(!0)}(Q.route.parent,H),function ru(F,L){return null!==F&&L&&L(new Ps(F)),(0,Me.of)(!0)}(Q.route,H),function zu(F,L,O){const H=L[L.length-1],ge=L.slice(0,L.length-1).reverse().map(qe=>function kr(F){const L=F.routeConfig?F.routeConfig.canActivateChild:null;return L&&0!==L.length?{node:F,guards:L}:null}(qe)).filter(qe=>null!==qe).map(qe=>(0,ut.P)(()=>{const pt=qe.guards.map(an=>{const ni=Dr(an,qe.node,O);return En(function ne(F){return F&&Eo(F.canActivateChild)}(ni)?ni.canActivateChild(H,F):ni(H,F)).pipe((0,mn.P)())});return(0,Me.of)(pt).pipe(Ar())}));return(0,Me.of)(ge).pipe(Ar())}(F,Q.path,O),function al(F,L,O){const H=L.routeConfig?L.routeConfig.canActivate:null;if(!H||0===H.length)return(0,Me.of)(!0);const Q=H.map(ge=>(0,ut.P)(()=>{const qe=Dr(ge,L,O);return En(function ol(F){return F&&Eo(F.canActivate)}(qe)?qe.canActivate(L,F):qe(L,F)).pipe((0,mn.P)())}));return(0,Me.of)(Q).pipe(Ar())}(F,Q.route,O))),(0,mn.P)(Q=>!0!==Q,!0))}(H,ge,F,L):(0,Me.of)(pt)),(0,xt.U)(pt=>({...O,guardsResult:pt})))})}(this.ngModule.injector,pt=>this.triggerEvent(pt)),(0,Yn.b)(pt=>{if(Q.guardsResult=pt.guardsResult,Oe(pt.guardsResult))throw Al(0,pt.guardsResult);const an=new Vs(pt.id,this.serializeUrl(pt.extractedUrl),this.serializeUrl(pt.urlAfterRedirects),pt.targetSnapshot,!!pt.guardsResult);this.triggerEvent(an)}),(0,Fe.h)(pt=>!!pt.guardsResult||(this.restoreHistory(pt),this.cancelNavigationTransition(pt,"",3),!1)),Hn(pt=>{if(pt.guards.canActivateChecks.length)return(0,Me.of)(pt).pipe((0,Yn.b)(an=>{const ni=new Ko(an.id,this.serializeUrl(an.extractedUrl),this.serializeUrl(an.urlAfterRedirects),an.targetSnapshot);this.triggerEvent(ni)}),(0,Tt.w)(an=>{let ni=!1;return(0,Me.of)(an).pipe(function Ua(F,L){return(0,Cn.z)(O=>{const{targetSnapshot:H,guards:{canActivateChecks:Q}}=O;if(!Q.length)return(0,Me.of)(O);let ge=0;return(0,ye.D)(Q).pipe((0,oi.b)(qe=>function kl(F,L,O,H){const Q=F.routeConfig,ge=F._resolve;return void 0!==Q?.title&&!zi(Q)&&(ge[vl]=Q.title),function oc(F,L,O,H){const Q=function Rl(F){return[...Object.keys(F),...Object.getOwnPropertySymbols(F)]}(F);if(0===Q.length)return(0,Me.of)({});const ge={};return(0,ye.D)(Q).pipe((0,Cn.z)(qe=>function sc(F,L,O,H){const Q=Dr(F,L,H);return En(Q.resolve?Q.resolve(L,O):Q(L,O))}(F[qe],L,O,H).pipe((0,mn.P)(),(0,Yn.b)(pt=>{ge[qe]=pt}))),Qe(1),(0,Di.h)(ge),(0,fi.K)(qe=>qe instanceof Ut.K?Ft.E:(0,et._)(qe)))}(ge,F,L,H).pipe((0,xt.U)(qe=>(F._resolvedData=qe,F.data=tl(F,O).resolve,Q&&zi(Q)&&(F.data[vl]=Q.title),null)))}(qe.route,H,F,L)),(0,Yn.b)(()=>ge++),Qe(1),(0,Cn.z)(qe=>ge===Q.length?(0,Me.of)(O):Ft.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Yn.b)({next:()=>ni=!0,complete:()=>{ni||(this.restoreHistory(an),this.cancelNavigationTransition(an,"",2))}}))}),(0,Yn.b)(an=>{const ni=new Jr(an.id,this.serializeUrl(an.extractedUrl),this.serializeUrl(an.urlAfterRedirects),an.targetSnapshot);this.triggerEvent(ni)}))}),Hn(pt=>{const an=ni=>{const ur=[];ni.routeConfig?.loadComponent&&!ni.routeConfig._loadedComponent&&ur.push(this.configLoader.loadComponent(ni.routeConfig).pipe((0,Yn.b)(di=>{ni.component=di}),(0,xt.U)(()=>{})));for(const di of ni.children)ur.push(...an(di));return ur};return(0,ft.a)(an(pt.targetSnapshot.root)).pipe((0,Jt.d)(),(0,Gt.q)(1))}),Hn(()=>this.afterPreactivation()),(0,xt.U)(pt=>{const an=function aa(F,L,O){const H=la(F,L._root,O?O._root:void 0);return new Us(H,L)}(this.routeReuseStrategy,pt.targetSnapshot,pt.currentRouterState);return Q={...pt,targetRouterState:an}}),(0,Yn.b)(pt=>{this.currentUrlTree=pt.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(pt.urlAfterRedirects,pt.rawUrl),this.routerState=pt.targetRouterState,"deferred"===this.urlUpdateStrategy&&(pt.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,pt),this.browserUrlTree=pt.urlAfterRedirects)}),((F,L,O)=>(0,xt.U)(H=>(new wr(L,H.targetRouterState,H.currentRouterState,O).activate(F),H)))(this.rootContexts,this.routeReuseStrategy,pt=>this.triggerEvent(pt)),(0,Yn.b)({next(){ge=!0},complete(){ge=!0}}),(0,Ui.x)(()=>{ge||qe||this.cancelNavigationTransition(Q,"",1),this.currentNavigation?.id===Q.id&&(this.currentNavigation=null)}),(0,fi.K)(pt=>{if(qe=!0,cs(pt)){ca(pt)||(this.navigated=!0,this.restoreHistory(Q,!0));const an=new Gr(Q.id,this.serializeUrl(Q.extractedUrl),pt.message,pt.cancellationCode);if(H.next(an),ca(pt)){const ni=this.urlHandlingStrategy.merge(pt.url,this.rawUrlTree),ur={skipLocationChange:Q.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Rc(Q.source)};this.scheduleNavigation(ni,"imperative",null,ur,{resolve:Q.resolve,reject:Q.reject,promise:Q.promise})}else Q.resolve(!1)}else{this.restoreHistory(Q,!0);const an=new ao(Q.id,this.serializeUrl(Q.extractedUrl),pt,Q.targetSnapshot??void 0);H.next(an);try{Q.resolve(this.errorHandler(pt))}catch(ni){Q.reject(ni)}}return Ft.E}))}))}resetRootComponentType(O){this.rootComponentType=O,this.routerState.root.component=this.rootComponentType}setTransition(O){this.transitions.next({...this.transitions.value,...O})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(O=>{const H="popstate"===O.type?"popstate":"hashchange";"popstate"===H&&setTimeout(()=>{const Q={replaceUrl:!0},ge=O.state?.navigationId?O.state:null;if(ge){const pt={...ge};delete pt.navigationId,delete pt.\u0275routerPageId,0!==Object.keys(pt).length&&(Q.state=pt)}const qe=this.parseUrl(O.url);this.scheduleNavigation(qe,H,ge,Q)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(O){this.events.next(O)}resetConfig(O){this.config=O.map(Ae),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(O,H={}){const{relativeTo:Q,queryParams:ge,fragment:qe,queryParamsHandling:pt,preserveFragment:an}=H,ni=Q||this.routerState.root,ur=an?this.currentUrlTree.fragment:qe;let di=null;switch(pt){case"merge":di={...this.currentUrlTree.queryParams,...ge};break;case"preserve":di=this.currentUrlTree.queryParams;break;default:di=ge||null}return null!==di&&(di=this.removeEmptyProps(di)),Ri(ni,this.currentUrlTree,O,di,ur??null)}navigateByUrl(O,H={skipLocationChange:!1}){const Q=Oe(O)?O:this.parseUrl(O),ge=this.urlHandlingStrategy.merge(Q,this.rawUrlTree);return this.scheduleNavigation(ge,"imperative",null,H)}navigate(O,H={skipLocationChange:!1}){return function Rd(F){for(let L=0;L<F.length;L++){if(null==F[L])throw new T.vHH(4008,false)}}(O),this.navigateByUrl(this.createUrlTree(O,H),H)}serializeUrl(O){return this.urlSerializer.serialize(O)}parseUrl(O){let H;try{H=this.urlSerializer.parse(O)}catch(Q){H=this.malformedUriErrorHandler(Q,this.urlSerializer,O)}return H}isActive(O,H){let Q;if(Q=!0===H?{...Bl}:!1===H?{...ps}:H,Oe(O))return ie(this.currentUrlTree,O,Q);const ge=this.parseUrl(O);return ie(this.currentUrlTree,ge,Q)}removeEmptyProps(O){return Object.keys(O).reduce((H,Q)=>{const ge=O[Q];return null!=ge&&(H[Q]=ge),H},{})}processNavigations(){this.navigations.subscribe(O=>{this.navigated=!0,this.lastSuccessfulId=O.id,this.currentPageId=O.targetPageId,this.events.next(new Xi(O.id,this.serializeUrl(O.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),O.resolve(!0)},O=>{this.console.warn(`Unhandled Navigation Error: ${O}`)})}scheduleNavigation(O,H,Q,ge,qe){if(this.disposed)return Promise.resolve(!1);let pt,an,ni;qe?(pt=qe.resolve,an=qe.reject,ni=qe.promise):ni=new Promise((rr,Jo)=>{pt=rr,an=Jo});const ur=++this.navigationId;let di;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(Q=this.location.getState()),di=Q&&Q.\u0275routerPageId?Q.\u0275routerPageId:ge.replaceUrl||ge.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):di=0,this.setTransition({id:ur,targetPageId:di,source:H,restoredState:Q,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:O,extras:ge,resolve:pt,reject:an,promise:ni,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),ni.catch(rr=>Promise.reject(rr))}setBrowserUrl(O,H){const Q=this.urlSerializer.serialize(O),ge={...H.extras.state,...this.generateNgRouterState(H.id,H.targetPageId)};this.location.isCurrentPathEqualTo(Q)||H.extras.replaceUrl?this.location.replaceState(Q,"",ge):this.location.go(Q,"",ge)}restoreHistory(O,H=!1){if("computed"===this.canceledNavigationResolution){const Q=this.currentPageId-O.targetPageId;"popstate"!==O.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===Q?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===Q&&(this.resetState(O),this.browserUrlTree=O.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(Q)}else"replace"===this.canceledNavigationResolution&&(H&&this.resetState(O),this.resetUrlToCurrentUrlTree())}resetState(O){this.routerState=O.currentRouterState,this.currentUrlTree=O.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,O.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(O,H,Q){const ge=new Gr(O.id,this.serializeUrl(O.extractedUrl),H,Q);this.triggerEvent(ge),O.resolve(!1)}generateNgRouterState(O,H){return"computed"===this.canceledNavigationResolution?{navigationId:O,\u0275routerPageId:H}:{navigationId:O}}}return F.\u0275fac=function(O){T.$Z()},F.\u0275prov=T.Yz7({token:F,factory:function(){return Gu()},providedIn:"root"}),F})();function Rc(F){return"imperative"!==F}let Za=(()=>{class F{constructor(O,H,Q,ge,qe){this.router=O,this.route=H,this.tabIndexAttribute=Q,this.renderer=ge,this.el=qe,this.commands=null,this.onChanges=new St.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(O){if(null!=this.tabIndexAttribute)return;const H=this.renderer,Q=this.el.nativeElement;null!==O?H.setAttribute(Q,"tabindex",O):H.removeAttribute(Q,"tabindex")}ngOnChanges(O){this.onChanges.next(this)}set routerLink(O){null!=O?(this.commands=Array.isArray(O)?O:[O],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const O={skipLocationChange:(0,T.D6c)(this.skipLocationChange),replaceUrl:(0,T.D6c)(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,O),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:(0,T.D6c)(this.preserveFragment)})}}return F.\u0275fac=function(O){return new(O||F)(T.Y36(Do),T.Y36(Hs),T.$8M("tabindex"),T.Y36(T.Qsj),T.Y36(T.SBq))},F.\u0275dir=T.lG2({type:F,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(O,H){1&O&&T.NdJ("click",function(){return H.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[T.TTD]}),F})(),lu=(()=>{class F{constructor(O,H,Q){this.router=O,this.route=H,this.locationStrategy=Q,this.commands=null,this.href=null,this.onChanges=new St.x,this.subscription=O.events.subscribe(ge=>{ge instanceof Xi&&this.updateTargetUrlAndHref()})}set routerLink(O){this.commands=null!=O?Array.isArray(O)?O:[O]:null}ngOnChanges(O){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(O,H,Q,ge,qe){if(0!==O||H||Q||ge||qe||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const pt={skipLocationChange:(0,T.D6c)(this.skipLocationChange),replaceUrl:(0,T.D6c)(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,pt),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:(0,T.D6c)(this.preserveFragment)})}}return F.\u0275fac=function(O){return new(O||F)(T.Y36(Do),T.Y36(Hs),T.Y36(Pn.S$))},F.\u0275dir=T.lG2({type:F,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(O,H){1&O&&T.NdJ("click",function(ge){return H.onClick(ge.button,ge.ctrlKey,ge.shiftKey,ge.altKey,ge.metaKey)}),2&O&&T.uIk("target",H.target)("href",H.href,T.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[T.TTD]}),F})(),zl=(()=>{class F{constructor(O,H,Q,ge,qe,pt){this.router=O,this.element=H,this.renderer=Q,this.cdr=ge,this.link=qe,this.linkWithHref=pt,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new T.vpe,this.routerEventsSubscription=O.events.subscribe(an=>{an instanceof Xi&&this.update()})}ngAfterContentInit(){(0,Me.of)(this.links.changes,this.linksWithHrefs.changes,(0,Me.of)(null)).pipe((0,Pi.J)()).subscribe(O=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const O=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(H=>!!H).map(H=>H.onChanges);this.linkInputChangesSubscription=(0,ye.D)(O).pipe((0,Pi.J)()).subscribe(H=>{this.isActive!==this.isLinkActive(this.router)(H)&&this.update()})}set routerLinkActive(O){const H=Array.isArray(O)?O:O.split(" ");this.classes=H.filter(Q=>!!Q)}ngOnChanges(O){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const O=this.hasActiveLinks();this.isActive!==O&&(this.isActive=O,this.cdr.markForCheck(),this.classes.forEach(H=>{O?this.renderer.addClass(this.element.nativeElement,H):this.renderer.removeClass(this.element.nativeElement,H)}),O&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(O))})}isLinkActive(O){const H=function Hu(F){return!!F.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return Q=>!!Q.urlTree&&O.isActive(Q.urlTree,H)}hasActiveLinks(){const O=this.isLinkActive(this.router);return this.link&&O(this.link)||this.linkWithHref&&O(this.linkWithHref)||this.links.some(O)||this.linksWithHrefs.some(O)}}return F.\u0275fac=function(O){return new(O||F)(T.Y36(Do),T.Y36(T.SBq),T.Y36(T.Qsj),T.Y36(T.sBO),T.Y36(Za,8),T.Y36(lu,8))},F.\u0275dir=T.lG2({type:F,selectors:[["","routerLinkActive",""]],contentQueries:function(O,H,Q){if(1&O&&(T.Suo(Q,Za,5),T.Suo(Q,lu,5)),2&O){let ge;T.iGM(ge=T.CRH())&&(H.links=ge),T.iGM(ge=T.CRH())&&(H.linksWithHrefs=ge)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[T.TTD]}),F})();class Ks{}let Es=(()=>{class F{constructor(O,H,Q,ge,qe){this.router=O,this.injector=Q,this.preloadingStrategy=ge,this.loader=qe}setUpPreloading(){this.subscription=this.router.events.pipe((0,Fe.h)(O=>O instanceof Xi),(0,oi.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(O,H){const Q=[];for(const ge of H){ge.providers&&!ge._injector&&(ge._injector=(0,T.MMx)(ge.providers,O,`Route: ${ge.path}`));const qe=ge._injector??O,pt=ge._loadedInjector??qe;ge.loadChildren&&!ge._loadedRoutes&&void 0===ge.canLoad||ge.loadComponent&&!ge._loadedComponent?Q.push(this.preloadConfig(qe,ge)):(ge.children||ge._loadedRoutes)&&Q.push(this.processRoutes(pt,ge.children??ge._loadedRoutes))}return(0,ye.D)(Q).pipe((0,Pi.J)())}preloadConfig(O,H){return this.preloadingStrategy.preload(H,()=>{let Q;Q=H.loadChildren&&void 0===H.canLoad?this.loader.loadChildren(O,H):(0,Me.of)(null);const ge=Q.pipe((0,Cn.z)(qe=>null===qe?(0,Me.of)(void 0):(H._loadedRoutes=qe.routes,H._loadedInjector=qe.injector,this.processRoutes(qe.injector??O,qe.routes))));if(H.loadComponent&&!H._loadedComponent){const qe=this.loader.loadComponent(H);return(0,ye.D)([ge,qe]).pipe((0,Pi.J)())}return ge})}}return F.\u0275fac=function(O){return new(O||F)(T.LFG(Do),T.LFG(T.Sil),T.LFG(T.lqb),T.LFG(Ks),T.LFG(au))},F.\u0275prov=T.Yz7({token:F,factory:F.\u0275fac}),F})();const cu=new T.OlP("");let pa=(()=>{class F{constructor(O,H,Q={}){this.router=O,this.viewportScroller=H,this.options=Q,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},Q.scrollPositionRestoration=Q.scrollPositionRestoration||"disabled",Q.anchorScrolling=Q.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(O=>{O instanceof yr?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=O.navigationTrigger,this.restoredId=O.restoredState?O.restoredState.navigationId:0):O instanceof Xi&&(this.lastId=O.id,this.scheduleScrollEvent(O,this.router.parseUrl(O.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(O=>{O instanceof el&&(O.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(O.position):O.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(O.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(O,H){this.router.triggerEvent(new el(O,"popstate"===this.lastSource?this.store[this.restoredId]:null,H))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return F.\u0275fac=function(O){T.$Z()},F.\u0275prov=T.Yz7({token:F,factory:F.\u0275fac}),F})();const xl=new T.OlP("ROUTER_FORROOT_GUARD"),fa=new T.OlP(""),Zu=[Pn.Ye,{provide:qn,useClass:gr},{provide:Do,useFactory:Gu},Ba,{provide:Hs,useFactory:function Wu(F){return F.routerState.root},deps:[Do]},au];function fs(){return new T.PXZ("Router",Do)}let wh=(()=>{class F{constructor(O){}static forRoot(O,H){return{ngModule:F,providers:[Zu,[],Yu(O),{provide:xl,useFactory:Jn,deps:[[Do,new T.FiY,new T.tp0]]},{provide:bl,useValue:H||{}},H?.useHash?{provide:Pn.S$,useClass:Pn.Do}:{provide:Pn.S$,useClass:Pn.b0},{provide:cu,useFactory:()=>{const F=(0,T.f3M)(Do),L=(0,T.f3M)(Pn.EM),O=(0,T.f3M)(bl);return O.scrollOffset&&L.setOffset(O.scrollOffset),new pa(F,L,O)}},H?.preloadingStrategy?qa(H.preloadingStrategy):[],{provide:T.PXZ,multi:!0,useFactory:fs},H?.initialNavigation?uu(H):[],[{provide:Wa,useFactory:Ch},{provide:T.tb,multi:!0,useExisting:Wa}]]}}static forChild(O){return{ngModule:F,providers:[Yu(O)]}}}return F.\u0275fac=function(O){return new(O||F)(T.LFG(xl,8))},F.\u0275mod=T.oAB({type:F}),F.\u0275inj=T.cJS({}),F})();function Jn(F){return"guarded"}function Yu(F){return[{provide:Wo,multi:!0,useValue:F}]}function Ch(){const F=(0,T.f3M)(T.zs3);return L=>{const O=F.get(T.z2F);if(L!==O.components[0])return;const H=F.get(Do),Q=F.get(Nl);1===F.get(dc)&&H.initialNavigation(),F.get(fa,null,T.XFs.Optional)?.setUpPreloading(),F.get(cu,null,T.XFs.Optional)?.init(),H.resetRootComponentType(O.componentTypes[0]),Q.next(),Q.complete()}}const Wa=new T.OlP("");function uu(F){return["disabled"===F.initialNavigation?[{provide:T.ip1,multi:!0,useFactory:()=>{const F=(0,T.f3M)(Do);return()=>{F.setUpLocationChangeListener()}}},{provide:dc,useValue:2}]:[],"enabledBlocking"===F.initialNavigation?[{provide:dc,useValue:0},{provide:T.ip1,multi:!0,deps:[T.zs3],useFactory:F=>{const L=F.get(Pn.V_,Promise.resolve(null));let O=!1;return()=>L.then(()=>new Promise(Q=>{const ge=F.get(Do),qe=F.get(Nl);(function H(Q){F.get(Do).events.pipe((0,Fe.h)(qe=>qe instanceof Xi||qe instanceof Gr||qe instanceof ao),(0,xt.U)(qe=>qe instanceof Xi||qe instanceof Gr&&(0===qe.code||1===qe.code)&&null),(0,Fe.h)(qe=>null!==qe),(0,Gt.q)(1)).subscribe(()=>{Q()})})(()=>{Q(!0),O=!0}),ge.afterPreactivation=()=>(Q(!0),O||qe.closed?(0,Me.of)(void 0):qe),ge.initialNavigation()}))}}]:[]]}const Nl=new T.OlP("",{factory:()=>new St.x}),dc=new T.OlP("",{providedIn:"root",factory:()=>1});function qa(F){return[Es,{provide:fa,useExisting:Es},{provide:Ks,useExisting:F}]}}},Bn=>{Bn(Bn.s=9121)}]);